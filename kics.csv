,ID,Title,Tool,Severity,Category,CWE,Related Document,Subcategory,Description,Secure Code Example,Insecure Code Example,Insecure Code Line
0,0e75052f-cc02-41b8-ac39-a78017527e95,Privilege Escalation Using Become Plugin,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/privilege_escalation_using_become_plugin,ansible-queries,"In order to perform an action as a different user with the become_user, 'become' must be defined and set to 'true'<br>
[Documentation](https://ansible.readthedocs.io/projects/lint/rules/partial-become/#problematic-code)","---
- hosts: localhost
  become_user: postgres
  become: true
  tasks:
    - name: some task
      ansible.builtin.command: whoamyou
      changed_when: false

---
- hosts: localhost
  tasks:
    - name: become from the same scope
      ansible.builtin.command: whoami
      become: true
      become_user: postgres
      changed_when: false","---
- hosts: localhost
  name: become_user without become
  become_user: bar

  tasks:
    - name: Simple hello
      ansible.builtin.debug:
        msg: hello

---
- hosts: localhost
  name: become_user with become false
  become_user: root
  become: false

  tasks:
    - name: Simple hello
      ansible.builtin.debug:
        msg: hello

---
- hosts: localhost
  tasks:
    - name: become and become_user on different tasks
      block:
        - name: Sample become
          become: true
          ansible.builtin.command: ls .
        - name: Sample become_user
          become_user: foo
          ansible.builtin.command: ls .

---
- hosts: localhost
  tasks:
    - name: become false
      block:
        - name: Sample become
          become: true
          ansible.builtin.command: ls .
        - name: Sample become_user
          become_user: postgres
          become: false
          ansible.builtin.command: ls .

---
- hosts: localhost
  tasks:
    - name: become_user with become task as false
      ansible.builtin.command: whoami
      become_user: mongodb
      become: false
      changed_when: false

---
- hosts: localhost
  tasks:
    - name: become_user without become
      ansible.builtin.command: whoami
      become_user: mysql
      changed_when: false","[[4, 44, 15, 53, 61, 31]]"
1,1b2bf3ff-31e9-460e-bbfb-45e48f4f20cc,Ansible Tower Exposed To Internet,Ansible,Medium,Best Practices,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/hosts/ansible_tower_exposed_to_internet,ansible-queries,"Avoid exposing Ansible Tower to the public internet, effectively reducing the potential attack surface of your deployment<br>
[Documentation](https://docs.ansible.com/ansible-tower/latest/html/administration/security_best_practices.html#understand-the-architecture-of-ansible-and-tower)","all:
  children:
    automationhub:
      hosts:
        automationhub.acme.org:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    database:
      hosts:
        database-01.acme.org:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    tower:
      hosts:
        172.27.0.5:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    ungrouped: {}","all:
  children:
    automationhub:
      hosts:
        automationhub.acme.org:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    database:
      hosts:
        database-01.acme.org:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    tower:
      hosts:
        139.50.1.1:
          admin_password: <password>
          pg_database: awx
          pg_host: database-01.acme.org
          pg_password: <password>
          pg_port: '5432'
          pg_sslmode: prefer
          pg_username: awx
    ungrouped: {}",[[24]]
2,2e8d4922-8362-4606-8c14-aa10466a1ce3,Communication Over HTTP,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/communication_over_http,ansible-queries,"Using HTTP URLs (without encryption) could lead to security vulnerabilities and risks<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/ansible/builtin/uri_module.html#parameter-url)","- name: Verificar o status de um site usando o módulo uri
  hosts: localhost
  tasks:
    - name: Verificar o status do site
      ansible.builtin.uri:
        url: ""https://www.example.com""
        method: GET
      register: site_response

    - name: Exibir resposta do site
      debug:
        var: site_response","- name: Verificar o status de um site usando o módulo uri
  hosts: localhost
  tasks:
    - name: Verificar o status do site
      ansible.builtin.uri:
        url: ""http://www.example.com""
        method: GET
      register: site_response

    - name: Exibir resposta do site
      debug:
        var: site_response",[[6]]
3,404908b6-4954-4611-98f0-e8ceacdabcb1,Privilege Escalation Using Become Plugin In Defaults,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/config/privilege_escalation_using_become_plugin_in_defaults,ansible-queries,"In order to perform an action as a different user with the become_user, 'become' must be defined and set to 'true'<br>
[Documentation](https://docs.ansible.com/ansible/latest/plugins/become.html)",,,[]
4,59029ddf-e651-412b-ae7b-ff6d403184bc,Logging of Sensitive Data,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/logging_of_sensitive_data,ansible-queries,"To keep sensitive values out of logs, tasks that expose them need to be marked defining 'no_log' and setting to True<br>
[Documentation](https://ansible.readthedocs.io/projects/lint/rules/no-log-password/)","---
- name: Negative playbook
  hosts: localhost
  tasks:
    - name: foo
      ansible.builtin.user:
        name: john_doe
        comment: John Doe
        uid: 1040
        group: admin
        password: ""{{ item }}""
      with_items:
        - wow
      no_log: true
  
---
- name: Negative Playbook 2
  hosts: localhost
  tasks:
    - name: bar
      ansible.builtin.user:
        name: john_doe
        comment: John Doe
        uid: 1040
        group: admin
      with_items:
        - wow
      no_log: false

---
- name: Negative Playbook 3
  hosts: localhost
  tasks:
    - name: bar
      ansible.builtin.user:
        name: john_doe
        comment: John Doe
        uid: 1040
        group: admin
      with_items:
        - wow","---
- name: Positive Playbook
  hosts: localhost
  tasks:
    - name: bar
      ansible.builtin.user:
        name: john_doe
        comment: John Doe
        uid: 1040
        group: admin
        password: ""{{ item }}""
      with_items:
        - wow
      no_log: false

---
- name: Positive Playbook
  hosts: localhost
  tasks:
    - name: bar
      ansible.builtin.user:
        name: john_doe
        comment: John Doe
        uid: 1040
        group: admin
        password: ""{{ item }}""
      with_items:
        - wow","[[14], [5]]"
5,86b97bb4-85c9-462d-8635-cbc057c5c8c5,Allow Unsafe Lookups Enabled In Defaults,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/config/allow_unsafe_lookups_enabled_in_defaults,ansible-queries,"When enabled, this option allows lookup plugins to return data that is not marked 'unsafe'.<br>
[Documentation](https://docs.ansible.com/ansible/latest/reference_appendices/config.html#default-allow-unsafe-lookups)",,,[]
6,88841d5c-d22d-4b7e-a6a0-89ca50e44b9f,Risky File Permissions,Ansible,Info,Supply-Chain,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/risky_file_permissions,ansible-queries,"Some modules could end up creating new files on disk with permissions that might be too open or unpredictable<br>
[Documentation](https://ansible.readthedocs.io/projects/lint/rules/risky-file-permissions/)","---
- name: SUCCESS_PERMISSIONS_PRESENT
  hosts: all
  tasks:
    - name: Permissions not missing and numeric
      ansible.builtin.file:
        path: foo
        mode: ""0600""

---
- name: SUCCESS_PERMISSIONS_PRESENT_GET_URL
  hosts: all
  tasks:
    - name: Permissions not missing and numeric
      ansible.builtin.get_url:
        url: http://foo
        dest: foo
        mode: ""0600""

---
- name: SUCCESS_ABSENT_STATE
  hosts: all
  tasks:
    - name: Permissions missing while state is absent is fine
      ansible.builtin.file:
        path: foo
        state: absent

---
- name: SUCCESS_DEFAULT_STATE
  hosts: all
  tasks:
    - name: Permissions missing while state is file (default) is fine
      ansible.builtin.file:
        path: foo

---
- name: SUCCESS_LINK_STATE
  hosts: all
  tasks:
    - name: Permissions missing while state is link is fine
      ansible.builtin.file:
        path: foo2
        src: foo
        state: link

---
- name: SUCCESS_CREATE_FALSE
  hosts: all
  tasks:
    - name: File edit when create is false
      ansible.builtin.lineinfile:
        path: foo
        create: false
        line: some content here

---
- name: SUCCESS_REPLACE
  hosts: all
  tasks:
    - name: Replace should not require mode
      ansible.builtin.replace:
        path: foo
        regexp: foo

---
- name: SUCCESS_RECURSE
  hosts: all
  tasks:
    - name: File with recursive does not require mode
      ansible.builtin.file:
        state: directory
        recurse: true
        path: foo
    - name: Permissions not missing and numeric (fqcn)
      ansible.builtin.file:
        path: bar
        mode: ""755""
    - name: File edit when create is false (fqcn)
      ansible.builtin.lineinfile:
        path: foo
        create: false
        line: some content here

---
- name: LINIINFILE_CREATE
  tasks: 
    - name: create is true 2x
      lineinfile:
        path: foo
        line: some content here
        mode: ""0600""

---
- name: PRESERVE_MODE
  tasks:
    - name: not preserve value
      copy:
        path: foo
        mode: preserve

---
- name: LINEINFILE_CREATE2
  tasks:
    - name: create_false
      ansible.builtin.lineinfile:
        path: foo
        create: true
        line: some content here
        mode: ""644""","---
- name: PRESERVE_MODE
  tasks:
    - name: not preserve value
      ansible.builtin.file:
        path: foo
        mode: preserve

---
- name: MISSING_PERMISSIONS_TOUCH
  tasks:
    - name: Permissions missing
      file:
        path: foo
        state: touch
    - name: Permissions missing 2x
      ansible.builtin.file:
        path: foo
        state: touch

---
- name: MISSING_PERMISSIONS_DIRECTORY
  tasks:
    - name: Permissions missing 3x
      file:
        path: foo
        state: directory
    - name: create is true
      ansible.builtin.lineinfile:
        path: foo
        create: true
        line: some content here

---
- name: MISSING_PERMISSIONS_GET_URL
  tasks:
    - name: Permissions missing 4x
      get_url:
        url: http://foo
        dest: foo

---
- name: LINEINFILE_CREATE
  tasks:
    - name: create is true 2x
      ansible.builtin.lineinfile:
        path: foo
        create: true
        line: some content here

---
- name: REPLACE_PRESERVE
  tasks:
    - name: not preserve mode 2x
      replace:
        path: foo
        mode: preserve
        regexp: foo

---
- name: NOT_PERMISSION
  tasks:
    - name: Not Permissions
      file:
        path: foo
        owner: root
        group: root
        state: directory

---
- name: LINEINFILE_CREATE2
  tasks:
    - name: create_false
      ansible.builtin.lineinfile:
        path: foo
        create: true
        line: some content here
        mode: preserve","[[64, 5, 38, 74, 13, 46, 17, 55, 25, 29]]"
7,8d22ae91-6ac1-459f-95be-d37bd373f244,Insecure Relative Path Resolution,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/insecure_relative_path_resolution,ansible-queries,"Using relative paths can lead to unexpected behavior as the path is resolved relative to the current working directory, which can change.<br>
[Documentation](https://ansible.readthedocs.io/projects/lint/rules/no-relative-paths/)","---
- name: Negative Example
  hosts: localhost
  tasks:
    - name: One
      ansible.builtin.copy:
        content:
        dest: /etc/mine.conf
        mode: ""0644""
    - name: Two
      ansible.builtin.copy:
        src: /home/example/files/foo.conf
        dest: /etc/foo.conf
        mode: ""0644""

---
- name: Negative Example 2
  hosts: localhost
  tasks:
    - name: One
      ansible.builtin.template:
        src: ../example/foo.j2
        dest: /etc/file.conf
        mode: ""0644""
    - name: Two
      ansible.builtin.copy:
        src: ../example/foo.conf
        dest: /etc/foo.conf
        mode: ""0644""
    - name: Three
      win_template:
        src: ../example/foo2.j2
        dest: /etc/file.conf
        mode: ""0644""","---
- name: Positive Example
  hosts: localhost
  tasks:
    - name: One
      ansible.builtin.template:
        src: ../templates/foo.j2
        dest: /etc/file.conf
        mode: ""0644""
    - name: Two
      ansible.builtin.copy:
        src: ../files/foo.conf
        dest: /etc/foo.conf
        mode: ""0644""","[[12, 7]]"
8,c05e2c20-0a2c-4686-b1f8-5f0a5612d4e8,Unpinned Package Version,Ansible,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/706.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/general/unpinned_package_version,ansible-queries,"Setting state to latest performs an update and installs additional packages possibly resulting in performance degradation or loss of service<br>
[Documentation](https://ansible.readthedocs.io/projects/lint/rules/package-latest/)","---
- name: Example playbook
  hosts: localhost
  tasks:
    - name: Install Ansible
      ansible.builtin.yum:
        name: ansible-2.12.7.0
        state: present

    - name: Install Ansible-lint
      ansible.builtin.pip:
        name: ansible-lint
        state: present
        version: 5.4.0

    - name: Update Ansible with update_only to true
      ansible.builtin.yum:
        name: sudo
        state: latest
        update_only: true

    - name: Install nmap
      community.general.zypper:
        name: nmap
        state: present

    - name: Install package without using cache
      community.general.apk:
        name: foo
        state: present
        no_cache: true

    - name: Install apache httpd
      ansible.builtin.apt:
        name: apache2
        state: present

    - name: Update Gemfile in another directory
      community.general.bundler:
        state: present
        chdir: ~/rails_project

    - name: Install a modularity appstream with defined profile
      ansible.builtin.dnf:
        name: ""@postgresql/client""
        state: present

    - name: Install rake
      community.general.gem:
        name: rake
        state: present

    - name: Install formula foo with 'brew' from cask
      community.general.homebrew:
        name: homebrew/cask/foo
        state: present

    - name: Install Green Balls plugin
      community.general.jenkins_plugin:
        name: greenballs
        version: present
        state: present
        url: http://host_jenkins:8080
        username: user_jenkins
        password: userpass_jenkins
      register: result

    - name: Install packages based on package.json
      community.general.npm:
        path: /app/location
        state: present

    - name: Install nmap
      community.general.openbsd_pkg:
        name: nmap
        state: present

    - name: Install ntpdate
      ansible.builtin.package:
        name: ntpdate
        state: present

    - name: Install package bar from file
      community.general.pacman:
        name: ~/bar-1.0-1-any.pkg.tar.xz
        state: present

    - name: Install package bar from file
      community.general.pacman:
        name: ~/bar-1.0-1-any.pkg.tar.xz
        state: present

    - name: Install finger daemon
      community.general.pkg5:
        name: service/network/finger
        state: present

    - name: Install several packages
      community.general.pkgutil:
        name:
          - CSWsudo
          - CSWtop
        state: present

    - name: Install package foo
      community.general.portage:
        package: foo
        state: present

    - name: Make sure that it is the most updated package
      community.general.slackpkg:
        name: foo
        state: present

    - name: Make sure spell foo is installed
      community.general.sorcery:
        spell: foo
        state: present

    - name: Install package unzip
      community.general.swdepot:
        name: unzip
        state: present
        depot: ""repository:/path""

    - name: Install multiple packages
      win_chocolatey:
        name:
          - procexp
          - putty
          - windirstat
        state: present

    - name: Install ""imagemin"" node.js package globally.
      community.general.yarn:
        name: imagemin
        global: true

    - name: Install a list of packages (suitable replacement for 2.11 loop deprecation warning)
      ansible.builtin.yum:
        name:
          - nginx
          - postgresql
          - postgresql-server
        state: present

    - name: Install local rpm file
      community.general.zypper:
        name: /tmp/fancy-software.rpm
        state: present","---
- name: Example playbook
  hosts: localhost
  tasks:
    - name: Install Ansible
      ansible.builtin.yum:
        name: ansible
        state: latest

    - name: Install Ansible-lint
      ansible.builtin.pip:
        name: ansible-lint
        state: latest

    - name: Install some-package
      ansible.builtin.package:
        name: some-package
        state: latest

    - name: Install Ansible with update_only to false
      ansible.builtin.yum:
        name: sudo
        state: latest
        update_only: false

    - name: Install nmap
      community.general.zypper:
        name: nmap
        state: latest

    - name: Install package without using cache
      community.general.apk:
        name: foo
        state: latest
        no_cache: true

    - name: Install apache httpd
      ansible.builtin.apt:
        name: apache2
        state: latest

    - name: Update Gemfile in another directory
      community.general.bundler:
        state: latest
        chdir: ~/rails_project

    - name: Install a modularity appstream with defined profile
      ansible.builtin.dnf:
        name: ""@postgresql/client""
        state: latest

    - name: Install rake
      community.general.gem:
        name: rake
        state: latest

    - name: Install formula foo with 'brew' from cask
      community.general.homebrew:
        name: homebrew/cask/foo
        state: latest

    - name: Install Green Balls plugin
      community.general.jenkins_plugin:
        name: greenballs
        state: latest
        url: http://host_jenkins:8080
        username: user_jenkins
        password: userpass_jenkins
      register: result

    - name: Install packages based on package.json
      community.general.npm:
        path: /app/location
        state: latest

    - name: Install nmap
      community.general.openbsd_pkg:
        name: nmap
        state: latest

    - name: Install ntpdate
      ansible.builtin.package:
        name: ntpdate
        state: latest

    - name: Install package bar from file
      community.general.pacman:
        name: ~/bar-1.0-1-any.pkg.tar.xz
        state: latest

    - name: Install finger daemon
      community.general.pkg5:
        name: service/network/finger
        state: latest

    - name: Install several packages
      community.general.pkgutil:
        name:
          - CSWsudo
          - CSWtop
        state: latest

    - name: Install package foo
      community.general.portage:
        package: foo
        state: latest

    - name: Make sure that it is the most updated package
      community.general.slackpkg:
        name: foo
        state: latest

    - name: Make sure spell foo is installed
      community.general.sorcery:
        spell: foo
        state: latest

    - name: Install package unzip
      community.general.swdepot:
        name: unzip
        state: latest
        depot: ""repository:/path""

    - name: Install multiple packages
      win_chocolatey:
        name:
          - procexp
          - putty
          - windirstat
        state: latest

    - name: Install ""imagemin"" node.js package globally.
      community.general.yarn:
        name: imagemin
        global: true
        state: latest

    - name: Install a list of packages (suitable replacement for 2.11 loop deprecation warning)
      ansible.builtin.yum:
        name:
          - nginx
          - postgresql
          - postgresql-server
        state: latest

    - name: Install local rpm file
      community.general.zypper:
        name: /tmp/fancy-software.rpm
        state: latest","[[130, 8, 136, 13, 144, 18, 149, 23, 29, 34, 40, 44, 50, 55, 60, 65, 74, 79, 84, 89, 94, 101, 106, 111, 116, 121]]"
9,c6473dae-8477-4119-88b7-b909b435ce7b,Logging of Sensitive Data In Defaults,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/config/logging_of_sensitive_data_in_defaults,ansible-queries,"To keep sensitive values out of logs, tasks that expose them need to be marked defining 'no_log' and setting to True<br>
[Documentation](https://docs.ansible.com/ansible/latest/reference_appendices/logging.html#protecting-sensitive-data-with-no-log)",,,[]
10,d7dc9350-74bc-485b-8c85-fed22d276c43,Communication Over HTTP In Defaults,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/config/communication_over_http_in_defaults,ansible-queries,"Using HTTP URLs (without encryption) could lead to security vulnerabilities and risks<br>
[Documentation](https://docs.ansible.com/ansible/latest/plugins/httpapi.html)",,,[]
11,01aec7c2-3e4d-4274-ae47-2b8fea22fd1f,ECS Task Definition Network Mode Not Recommended,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecs_task_definition_network_mode_not_recommended,Unknown,"Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_taskdefinition_module.html#parameter-network_mode)","- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: nginx
      portMappings:
      - containerPort: 8080
        hostPort: 8080
    launch_type: FARGATE
    cpu: 512
    memory: 1024
    state: present
    network_mode: awsvpc","---
- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: ""nginx""
      portMappings:
      - containerPort: 8080
        hostPort: 8080
      cpu: 512
      memory: 1024
    state: present
    network_mode: default

- name: Create task definition2
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: ""nginx""
      portMappings:
      - containerPort: 8080
        hostPort: 8080
    launch_type: FARGATE
    cpu: 512
    memory: 1024
    state: present
    network_mode: none","[[31, 15]]"
12,050f085f-a8db-4072-9010-2cca235cc02f,Auto Scaling Group With No Associated ELB,Ansible,Medium,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/auto_scaling_group_with_no_associated_elb,Unknown,"AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ec2_asg_module.html#parameter-load_balancers)","- name: elb12
  community.aws.ec2_asg:
    name: special
    load_balancers: [ 'lb1', 'lb2' ]
    availability_zones: [ 'eu-west-1a', 'eu-west-1b' ]
    launch_config_name: 'lc-1'
    min_size: 1
    max_size: 10
    desired_capacity: 5
    vpc_zone_identifier: [ 'subnet-abcd1234', 'subnet-1a2b3c4d' ]
    tags:
      - environment: production
        propagate_at_launch: no

- name: elb22
  ec2_asg:
    name: special
    load_balancers: [ 'lb1', 'lb2' ]
    availability_zones: [ 'eu-west-1a', 'eu-west-1b' ]
    launch_config_name: 'lc-1'
    min_size: 1
    max_size: 10
    desired_capacity: 5
    vpc_zone_identifier: [ 'subnet-abcd1234', 'subnet-1a2b3c4d' ]
    tags:
      - environment: production
        propagate_at_launch: no","- name: elb1
  community.aws.ec2_asg:
    name: special
    load_balancers: []
    availability_zones: [ 'eu-west-1a', 'eu-west-1b' ]
    launch_config_name: 'lc-1'
    min_size: 1
    max_size: 10
    desired_capacity: 5
    vpc_zone_identifier: [ 'subnet-abcd1234', 'subnet-1a2b3c4d' ]
    tags:
      - environment: production
        propagate_at_launch: no

- name: elb2
  ec2_asg:
    name: special
    availability_zones: [ 'eu-west-1a', 'eu-west-1b' ]
    launch_config_name: 'lc-1'
    min_size: 1
    max_size: 10
    desired_capacity: 5
    vpc_zone_identifier: [ 'subnet-abcd1234', 'subnet-1a2b3c4d' ]
    tags:
      - environment: production
        propagate_at_launch: no","[[4], [2]]"
13,0956aedf-6a7a-478b-ab56-63e2b19923ad,DB Security Group With Public Scope,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/db_security_group_with_public_scope,Unknown,"The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group2
  ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 10.1.1.1/32
  rules_egress:
  - proto: tcp
    from_port: 80
    to_port: 80
    cidr_ip: 10.1.1.1/32
    group_name: example-other
        # description to use if example-other needs to be created
    group_desc: other example EC2 group","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    db_security_groups: [""example""]
- name: example ec2 group
  ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ip: 0.0.0.0/0
      - proto: tcp
        from_port: 22
        to_port: 22
        cidr_ip: 10.0.0.0/8
      - proto: tcp
        from_port: 443
        to_port: 443
        group_id: amazon-elb/sg-87654321/amazon-elb-sg
      - proto: tcp
        from_port: 3306
        to_port: 3306
        group_id: 123412341234/sg-87654321/exact-name-of-sg
      - proto: udp
        from_port: 10050
        to_port: 10050
        cidr_ip: 10.0.0.0/8
      - proto: udp
        from_port: 10051
        to_port: 10051
        group_id: sg-12345678
      - proto: icmp
        from_port: 8 # icmp type, -1 = any type
        to_port: -1 # icmp subtype, -1 = any subtype
        cidr_ip: 192.168.1.0/24
      - proto: all
        group_name: example
    rules_egress:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ip: 0.0.0.0/0
        group_name: example-other
        group_desc: other example EC2 group","[[53, 22]]"
14,0ed012a4-9199-43d2-b9e4-9bd049a48aa4,IAM Database Auth Not Enabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_database_auth_not_enabled,Unknown,"IAM Database Auth Enabled should be configured to true when using compatible engine and version<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html)","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster
    enable_iam_database_authentication: true


- name: Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: true
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
    enable_iam_database_authentication: true

- name: remove the DB instance without a final snapshot
  community.aws.rds_instance:
    id: '{{ instance_id }}'
    state: absent
    skip_final_snapshot: true
    enable_iam_database_authentication: true

- name: remove the DB instance with a final snapshot
  community.aws.rds_instance:
    id: '{{ instance_id }}'
    state: absent
    final_snapshot_identifier: '{{ snapshot_id }}'
    enable_iam_database_authentication: true

- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    enable_iam_database_authentication: ""No""

- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: mariadb
    engine_version: 10.2.43
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: mysql
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    enable_iam_database_authentication: ""No""


- name: Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: True
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""
    enable_iam_database_authentication: false","[[9, 22]]"
15,12a7a7ce-39d6-49dd-923d-aeb4564eb66c,IAM Policy Grants 'AssumeRole' Permission Across All Services,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_policy_grants_assumerole_permission_across_all_services,Unknown,"IAM Policy should not grant 'AssumeRole' permission across all services.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_managed_policy_module.html)","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ManagedPolicy
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: logs:CreateLogGroup
        Resource: '*'
    make_default: false
    state: present","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ""ManagedPolicy""
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""logs:CreateLogGroup""
        Resource: ""*""
        Principal:
          Service: ""ec2.amazonaws.com""
          AWS: ""*""
    make_default: false
    state: present",[[4]]
16,133fee21-37ef-45df-a563-4d07edc169f4,CMK Is Unusable,Ansible,Medium,Availability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cmk_is_unusable,Unknown,"AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'enabled' set to true and the attribute 'pending_window' must be undefined.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_kms_module.html#parameter-enabled)","- name: Update IAM policy on an existing KMS key
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    enabled: true","- name: Update IAM policy on an existing KMS key1
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    enabled: false

- name: Update IAM policy on an existing KMS key2
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    pending_window: 8","[[6], [6]]"
17,16732649-4ff6-4cd2-8746-e72c13fae4b8,RDS Associated with Public Subnet,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/rds_associated_with_public_subnet,Unknown,"RDS should not run in public subnet<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-db_subnet_group_name)","- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    db_subnet_group_name: my_subnet_group2
- name: Add or change a subnet group2
  community.aws.rds_subnet_group:
    state: present
    name: my_subnet_group2
    description: My Fancy Ex Parrot Subnet Group
    subnets:
    - ""{{ subnet22.subnet.id }}""
  register: my_subnet_group2
- name: Create subnet for database servers22
  amazon.aws.ec2_vpc_subnet:
    state: present
    vpc_id: vpc-123456
    cidr: 10.0.1.16/28
    tags:
      Name: Database Subnet
  register: subnet22","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    db_subnet_group_name: my_subnet_group
- name: Add or change a subnet group
  community.aws.rds_subnet_group:
    state: present
    name: my_subnet_group
    description: My Fancy Ex Parrot Subnet Group
    subnets:
      - ""{{ subnet1.subnet.id }}""
      - ""{{ subnet2.subnet.id }}""
  register: my_subnet_group
- name: Create subnet for database servers
  amazon.aws.ec2_vpc_subnet:
    state: present
    vpc_id: vpc-123456
    cidr: 0.0.0.0/0
    tags:
      Name: Database Subnet
  register: subnet1
- name: Create subnet for database servers2
  amazon.aws.ec2_vpc_subnet:
    state: present
    vpc_id: vpc-123456
    cidr: 10.0.1.16/28
    tags:
      Name: Database Subnet
  register: subnet2",[[9]]
18,17d5ba1d-7667-4729-b1a6-b11fde3db7f7,Stack Retention Disabled,Ansible,Medium,Backup,https://cwe.mitre.org/data/definitions/404.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/stack_retention_disabled,Unknown,"Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudformation_stack_set_module.html#parameter-purge_stacks)","- name: Create a stack set with instances in two accounts
  community.aws.cloudformation_stack_set:
    name: my-stack
    description: Test stack in two accounts
    state: present
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1
    purge_stacks: false","- name: Create a stack set with instances in two accounts
  community.aws.cloudformation_stack_set:
    name: my-stack2
    description: Test stack in two accounts
    state: present
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1

- name: on subsequent calls, templates are optional but parameters and tags can be altered
  community.aws.cloudformation_stack_set:
    name: my-stack3
    state: present
    parameters:
      InstanceName: my_stacked_instance
    tags:
      foo: bar
      test: stack
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1
    purge_stacks: true","[[2, 23]]"
19,1d972c56-8ec2-48c1-a578-887adb09c57a,Lambda Permission Principal Is Wildcard,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/lambda_permission_principal_is_wildcard,Unknown,"Lambda Permission Principal should not contain a wildcard.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_policy_module.html)","- name: Lambda S3 event notification negative
  community.aws.lambda_policy:
    state: present
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:AddPermission
    principal: s3.amazonaws.com
    source_arn: arn:aws:s3:eu-central-1:123456789012:bucketName
    source_account: 123456789012","- name: Lambda S3 event notification
  community.aws.lambda_policy:
    state: present
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:AddPermission
    principal: ""*""
    source_arn: arn:aws:s3:eu-central-1:123456789012:bucketName
    source_account: 123456789012",[[8]]
20,2034fb37-bc23-4ca0-8d95-2b9f15829ab5,ELB Using Weak Ciphers,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/elb_using_weak_ciphers,Unknown,"ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of weak ciphers.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elb_application_lb_module.html)","#this code is a correct code for which the query should not find any result
- name: elb1
  community.aws.elb_application_lb:
    name: myelb1
    security_groups:
    - sg-12345678
    - my-sec-group
    subnets:
    - subnet-012345678
    - subnet-abcdef000
    listeners:
    - Protocol: HTTP   # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
      Port: 80   # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:   # The ARN of the certificate (only one certficate ARN should be provided)
      - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
      - Type: forward     # Required.
        TargetGroupName:     # Required. The name of the target group
    state: present
- name: elb2
  community.aws.elb_network_lb:
    name: myelb2
    security_groups:
    - sg-12345678
    - my-sec-group
    subnets:
    - subnet-012345678
    - subnet-abcdef000
    listeners:
    - Protocol: HTTP   # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
      Port: 80   # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:   # The ARN of the certificate (only one certficate ARN should be provided)
      - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
      - Type: forward     # Required.
        TargetGroupName:     # Required. The name of the target group
    state: present","#this is a problematic code where the query should report a result(s)
- name: elb1
  community.aws.elb_application_lb:
    name: myelb1
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    state: present
- name: elb2
  community.aws.elb_application_lb:
    name: myelb2
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present
- name: elb3
  community.aws.elb_application_lb:
    name: myelb3
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        SslPolicy: DHE-DSS-DES-CBC3-SHA
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present
- name: elb4
  community.aws.elb_network_lb:
    name: myelb4
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    state: present
- name: elb5
  community.aws.elb_network_lb:
    name: myelb5
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP
        Port: 80
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        Certificates:
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward
            TargetGroupName: target
    state: present
- name: elb6
  community.aws.elb_network_lb:
    name: myelb6
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP
        Port: 80
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        SslPolicy: TLS_RSA_NULL_MD5
        Certificates:
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward
            TargetGroupName: target
    state: present","[[3, 70, 40, 52, 21, 89]]"
21,2059155b-27fd-441e-b616-6966c468561f,API Gateway X-Ray Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_xray_disabled,Unknown,"API Gateway should have X-Ray Tracing enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_api_gateway_module.html#parameter-tracing_enabled)","- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present","---
- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: false
    endpoint_type: EDGE
    state: present
- name: Update API definition to deploy new version
  community.aws.aws_api_gateway:
    api_id: 'abc123321cba'
    swagger_file: my_api.yml
    deploy_desc: Make auth fix available.
    cache_enabled: true
    cache_size: '1.6'
    endpoint_type: EDGE
    state: present","[[8, 12]]"
22,218413a0-c716-4b94-9e08-0bb70d854709,Secure Ciphers Disabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/secure_ciphers_disabled,Unknown,"Check if secure ciphers aren't used in CloudFront<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: example
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
    - id: my test origin-000111
      domain_name: www.example.com
      origin_path: /production
      custom_headers:
      - header_name: MyCustomHeaderName
        header_value: MyCustomHeaderValue
    viewer_certificate:
      cloudfront_default_certificate: true","- name: example
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    viewer_certificate:
      cloudfront_default_certificate: false
      minimum_protocol_version: 'SSLv3'",[[14]]
23,22c80725-e390-4055-8d14-a872230f6607,CloudFront Without WAF,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudfront_without_waf,Unknown,"All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: create a basic distribution with defaults and tags
  community.aws.cloudfront_distribution:
    state: present
    default_origin_domain_name: www.my-cloudfront-origin.com
    tags:
      Name: example distribution
      Project: example project
      Priority: '1'
    web_acl_id: my-web-acl-id","- name: create a basic distribution with defaults and tags
  community.aws.cloudfront_distribution:
    state: present
    default_origin_domain_name: www.my-cloudfront-origin.com
    tags:
      Name: example distribution
      Project: example project
      Priority: '1'",[[2]]
24,265d9725-2fb8-42a2-bc57-3279c5db82d5,Lambda Function Without Tags,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/lambda_function_without_tags,Unknown,"AWS Lambda Functions must have associated tags.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_module.html)","- name: add tags
  community.aws.lambda:
    name: 'Lambda function'
    state: present
    zip_file: 'code.zip'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'
    tags:
      key1: 'value1'","- name: add tags
  community.aws.lambda:
    name: 'Lambda function'
    state: present
    zip_file: 'code.zip'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'",[[2]]
25,2cb674f6-32f9-40be-97f2-62c0dc38f0d5,RDS Using Default Port,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/rds_using_default_port,Unknown,"RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-port)","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 3307

- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: postgres
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 5433

- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: oracle-ee
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 1522","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 3306

- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: postgres
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 5432

- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: oracle-ee
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 7
    port: 1521","[[10], [10], [10]]"
26,32d31f1f-0f83-4721-b7ec-1e6948c60145,Stack Without Template,Ansible,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/stack_without_template,Unknown,"AWS CloudFormation should have a template defined through the attribute template, template_url or attribute template_body<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/cloudformation_module.html)","- name: create a stack, pass in the template body via lookup template v3
  amazon.aws.cloudformation:
    stack_name: ansible-cloudformation
    state: present
    region: us-east-1
    disable_rollback: true
    template_body: ""{{ lookup('template', 'cloudformation.j2') }}""
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation


- name: create a stack, pass in the template via an URL v4
  amazon.aws.cloudformation:
    stack_name: ansible-cloudformation
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation


- name: Create a stack set with instances in two accounts  v5
  community.aws.cloudformation_stack_set:
    name: my-stack
    description: Test stack in two accounts
    state: present
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1","- name: create a stack, pass in the template via an URL
  amazon.aws.cloudformation:
    stack_name: ""ansible-cloudformation""
    state: present
    region: us-east-1
    disable_rollback: true
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation
- name: create a stack, pass in the template via an URL v2
  amazon.aws.cloudformation:
    stack_name: ""ansible-cloudformation""
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_body: ""{{ lookup('template', 'cloudformation.j2') }}""
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation
- name: Create a stack set with instances in two accounts
  community.aws.cloudformation_stack_set:
    name: my-stack
    description: Test stack in two accounts
    state: present
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_body: ""{{ lookup('template', 'cloudformation.j2') }}""
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1
- name: Create a stack set with instances in two accounts v2
  community.aws.cloudformation_stack_set:
    name: my-stack
    description: Test stack in two accounts
    state: present
    accounts: [1234567890, 2345678901]
    regions:
    - us-east-1","[[40, 2, 30, 15]]"
27,338b6cab-961d-4998-bb49-e5b6a11c9a5c,EC2 Not EBS Optimized,Ansible,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ec2_not_ebs_optimized,Unknown,"It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html#parameter-ebs_optimized)","- name: example4
  amazon.aws.ec2:
    key_name: mykey
    image: ami-123456
    wait: yes
    group: my_sg
    count: 3
    vpc_subnet_id: subnet-29e63245
    ebs_optimized: true

- name: example5
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t3.nano
    image: ami-123456
    wait: yes
    group: my_sg
    count: 3
    vpc_subnet_id: subnet-29e63245

- name: example5
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t3.nano
    image: ami-123456
    wait: yes
    group: my_sg
    count: 3
    vpc_subnet_id: subnet-29e63245
    ebs_optimized: false","- name: example
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: default
    count: 3
    vpc_subnet_id: subnet-29e63245

- name: example2
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: default
    count: 3
    vpc_subnet_id: subnet-29e63245
    ebs_optimized: false

- name: example3
  amazon.aws.ec2:
    key_name: mykey
    image: ami-123456
    wait: yes
    group: default
    count: 3
    vpc_subnet_id: subnet-29e63245","[[2], [10], [2]]"
28,3505094c-f77c-4ba0-95da-f83db712f86c,S3 Bucket with Unsecured CORS Rule,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_with_unsecured_cors_rule,Unknown,"If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_s3_cors_module.html#parameter-rules)","- name: Create s3 bucket
  community.aws.aws_s3_cors:
    name: mys3bucket3
    state: present
    rules:
      - allowed_origins:
          - http://www.example.com/
        allowed_methods:
          - GET
          - POST
        allowed_headers:
          - Authorization
        expose_headers:
          - x-amz-server-side-encryption
          - x-amz-request-id
        max_age_seconds: 30000

- name: Create s3 bucket1
  aws_s3_cors:
    name: mys3bucket4
    state: present
    rules:
      - allowed_origins:
          - http://www.example.com/
        allowed_methods:
          - GET
          - POST
        allowed_headers:
          - Authorization
        expose_headers:
          - x-amz-server-side-encryption
          - x-amz-request-id
        max_age_seconds: 30000","- name: Create s3 bucket2
  community.aws.aws_s3_cors:
    name: mys3bucket
    state: present
    rules:
      - allowed_origins:
          - http://www.example.com/
        allowed_methods:
          - GET
          - POST
          - PUT
          - DELETE
          - HEAD
        allowed_headers:
          - Authorization
        expose_headers:
          - x-amz-server-side-encryption
          - x-amz-request-id
        max_age_seconds: 30000

- name: Create s3 bucket4
  aws_s3_cors:
    name: mys3bucket2
    state: present
    rules:
      - allowed_origins:
          - http://www.example.com/
        allowed_methods:
          - GET
          - POST
          - PUT
          - DELETE
          - HEAD
        allowed_headers:
          - Authorization
        expose_headers:
          - x-amz-server-side-encryption
          - x-amz-request-id
        max_age_seconds: 30000","[[5], [5]]"
29,3ab1f27d-52cc-4943-af1d-43c1939e739a,S3 Bucket Access to Any Principal,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_access_to_any_principal,Unknown,"Checks if the S3 bucket is accessible for all users<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html#ansible-collections-amazon-aws-s3-bucket-module)","- name: Create a simple s3 bucket with a policy
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy:
      Version: '2012-10-17'
      Id: sqspolicy
      Statement:
      - Sid: First
        Effect: Deny
        Principal: '*'
        Action: '*'
        Resource: ${aws_sqs_queue.q.arn}
        Condition:
          ArnEquals:
            aws:SourceArn: ${aws_sns_topic.example.arn}","- name: Create a simple s3 bucket with a policy
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy:
      Version: ""2012-10-17""
      Id: ""sqspolicy""
      Statement:
      - Sid: First
        Effect: Allow
        Principal: ""*""
        Action: ""*""
        Resource: ${aws_sqs_queue.q.arn}
        Condition:
          ArnEquals:
            aws:SourceArn: ${aws_sns_topic.example.arn}",[[4]]
30,3ddf3417-424d-420d-8275-0724dc426520,Lambda Permission Misconfigured,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/lambda_permission_misconfigured,Unknown,"Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_policy_module.html)","- name: Lambda S3 notification negative
  community.aws.lambda_policy:
    state: present
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:InvokeFunction
    principal: s3.amazonaws.com
    source_arn: arn:aws:s3:eu-central-1:123456789012:bucketName
    source_account: 123456789012","- name: Lambda S3 notification positive
  community.aws.lambda_policy:
    state: present
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:CreateFunction
    principal: s3.amazonaws.com
    source_arn: arn:aws:s3:eu-central-1:123456789012:bucketName
    source_account: 123456789012",[[7]]
31,3f2cf811-88fa-4eda-be45-7a191a18aba9,Misconfigured Password Policy Expiration,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/misconfigured_password_policy_expiration,Unknown,"No password expiration policy<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_password_policy_module.html)","- name: Missing Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 20
    pw_reuse_prevent: 5
    pw_expire: false","- name: Missing Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_reuse_prevent: 5
    pw_expire: false
- name: Extreme Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 180
    pw_reuse_prevent: 5
    pw_expire: false
- name: Alias extreme Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    password_max_age: 95
    pw_reuse_prevent: 5
    pw_expire: false","[[33, 2, 21]]"
32,445dce51-7e53-4e50-80ef-7f94f14169e4,Route53 Record Undefined,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/route53_record_undefined,Unknown,"Route53 Record should have a list of records<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/route53_module.html#parameter-value)","- name: Use a routing policy to distribute traffic
  community.aws.route53:
    state: present
    zone: foo.com
    record: www.foo.com
    type: CNAME
    value: host1.foo.com
    ttl: 30
    identifier: host1@www
    weight: 100
    health_check: d994b780-3150-49fd-9205-356abdd42e75","---
- name: Use a routing policy to distribute traffic02
  community.aws.route53:
    state: present
    zone: foo.com
    record: www.foo.com
    type: CNAME
    value:
    ttl: 30
    identifier: ""host1@www""
    weight: 100
    health_check: ""d994b780-3150-49fd-9205-356abdd42e75""
- name: Use a routing policy to distribute traffic03
  community.aws.route53:
    state: present
    zone: foo.com
    record: www.foo.com
    type: CNAME
    ttl: 30
    identifier: ""host1@www""
    weight: 100
    health_check: ""d994b780-3150-49fd-9205-356abdd42e75""","[[3, 14]]"
33,4b6012e7-7176-46e4-8108-e441785eae57,EBS Volume Encryption Disabled,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ebs_volume_encryption_disabled,Unknown,"EBS volumes should be encrypted<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_vol_module.html#parameter-encrypted)","- name: Creating EBS volume05
  amazon.aws.ec2_vol:
    instance: XXXXXX
    encrypted: yes
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf
- name: Creating EBS volume06
  amazon.aws.ec2_vol:
    instance: XXXXXX
    encrypted: 'True'
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf","---
- name: Creating EBS volume01
  amazon.aws.ec2_vol:
    instance: XXXXXX
    encrypted: no
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf
- name: Creating EBS volume02
  amazon.aws.ec2_vol:
    instance: XXXXXX
    encrypted: false
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf
- name: Creating EBS volume03
  amazon.aws.ec2_vol:
    instance: XXXXXX
    encrypted: ""false""
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf
- name: Creating EBS volume04
  amazon.aws.ec2_vol:
    instance: XXXXXX
    volume_size: 50
    volume_type: gp2
    device_name: /dev/xvdf","[[24, 19, 12, 5]]"
34,4d8681a2-3d30-4c89-8070-08acd142748e,CloudTrail Log File Validation Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_log_file_validation_disabled,Unknown,"CloudTrail log file validation should be enabled to determine whether a log file has not been tampered<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html)","- name: create multi-region trail with validation and tags v2
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role
    cloudwatch_logs_log_group_arn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*
    kms_key_id: alias/MyAliasName
    tags:
      environment: dev
      Name: default
- name: create multi-region trail with validation and tags v3
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    log_file_validation_enabled: true
    cloudwatch_logs_role_arn: arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role
    cloudwatch_logs_log_group_arn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*
    kms_key_id: alias/MyAliasName
    tags:
      environment: dev
      Name: default","- name: create multi-region trail with validation and tags
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default
- name: create multi-region trail with validation and tags v7
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: false
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default","[[2, 21]]"
35,5330b503-3319-44ff-9b1c-00ee873f728a,EC2 Group Has Public Interface,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ec2_group_has_public_interface,Unknown,"The CIDR IP should not be a public interface<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group2
  ec2_group1:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 10.1.1.1/32","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    db_security_groups: [""example""]
- name: example ec2 group
  ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ip: 0.0.0.0/0",[[22]]
36,53bce6a8-5492-4b1b-81cf-664385f0c4bf,S3 Bucket Allows Get Action From All Principals,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_allows_get_action_from_all_principals,Unknown,"S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html)","#this code is a correct code for which the query should not find any result
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: '2020-10-07'
      Statement:
      - Effect: Allow
        Action: GetObject
        Principal: NotAll","#this is a problematic code where the query should report a result(s)
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: ""2020-10-07""
      Statement:
      - Effect: Allow
        Action: GetObject
        Principal: ""*""",[[6]]
37,5527dcfc-94f9-4bf6-b7d4-1b78850cf41f,ElastiCache Without VPC,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/elasticache_without_vpc,Unknown,"ElastiCache should be launched in a Virtual Private Cloud (VPC)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elasticache_module.html#parameter-cache_subnet_group)","- name: Basic example2
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: memcached
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 11211
    cache_subnet_group: default
    zone: us-east-1d","- name: Basic example
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: memcached
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 11211
    cache_security_groups:
      - default
    zone: us-east-1d",[[2]]
38,559439b2-3e9c-4739-ac46-17e3b24ec215,API Gateway Endpoint Config is Not Private,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_endpoint_config_is_not_private,Unknown,"The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_api_gateway_module.html)","- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: PRIVATE
    state: present","- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present",[[8]]
39,57ced4b9-6ba4-487b-8843-b65562b90c77,Security Group With Unrestricted Access To SSH,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/security_group_with_unrestricted_access_to_ssh,Unknown,"'SSH' (TCP:22) should not be public in AWS Security Group<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group v2
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 79.32.0.0/8
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ipv6: 64:ff9b::/96","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        from_port: 22
        to_port: 22
        cidr_ip: 79.32.0.0/12
      - proto: tcp
        from_port: -1
        to_port: -1
        cidr_ip: 79.32.0.0/12
      - proto: tcp
        from_port: 22
        to_port: 22
        cidr_ipv6: 2607:F8B0::/24",[[7]]
40,594f54e7-f744-45ab-93e4-c6dbaf6cd571,S3 Bucket Without Server-side-encryption,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_without_server-side_encryption,Unknown,"AWS S3 Storage should be protected with SSE (Server-Side Encryption)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html)","- name: Create a simple s3 bucket v2
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    encryption: aws:kms","- name: Create a simple s3 bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    encryption: ""none""",[[5]]
41,5a443297-19d4-4381-9e5b-24faf947ec22,Certificate Has Expired,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/298.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/certificate_has_expired,Unknown,"Expired SSL/TLS certificates should be removed<br>
[Documentation](https://docs.ansible.com/ansible/2.10/collections/community/aws/aws_acm_module.html)","- name: upload a self-signed certificate2
  community.aws.aws_acm:
    certificate: ""{{ lookup('file', 'validCertificate.pem' ) }}""
    privateKey: ""{{ lookup('file', 'key.pem' ) }}""
    name_tag: my_cert
    region: ap-southeast-2","- name: upload a self-signed certificate
  community.aws.aws_acm:
    certificate: ""{{ lookup('file', 'expiredCertificate.pem' ) }}""
    privateKey: ""{{ lookup('file', 'key.pem' ) }}""
    name_tag: my_cert
    region: ap-southeast-2",[[3]]
42,5b9d237a-57d5-4177-be0e-71434b0fef47,KMS Key With Vulnerable Policy,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/807.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/kms_key_with_full_permissions,Unknown,"Checks if the policy is vulnerable and needs updating.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_kms_module.html)","- name: Update IAM policy on an existing KMS key
  community.aws.aws_kms:
    alias: my-kms-key
    policy: |
      { Id: auto-ebs-2, Statement: [{Action: [kms:Encrypt, kms:Decrypt, kms:ReEncrypt*,
        kms:GenerateDataKey*, kms:CreateGrant, kms:DescribeKey], Condition: {
        StringEquals: {kms:CallerAccount: '111111111111', kms:ViaService: ec2.ap-southeast-2.amazonaws.com}},
        Effect: Allow, Principal: {AWS: '*'}, Resource: '*',
        Sid: Allow access through EBS for all principals in the account that are authorized to use EBS },
      { Action: [kms:Describe*, kms:Get*, kms:List*, kms:RevokeGrant], Effect: Allow,
        Principal: {AWS: arn:aws:iam::111111111111:root}, Resource: '*',
        Sid: Allow direct access to key metadata to the account}], Version: '2012-10-17' }
    state: present","---
- name: Update IAM policy on an existing KMS key
  community.aws.aws_kms:
    alias: my-kms-key
    policy: {'Id': 'auto-ebs-2', 'Statement': [{'Action': ['kms:*'], 'Effect': 'Allow', 'Principal': {'AWS': '*'}, 'Resource': '*', 'Sid': 'Allow access through EBS for all principals in the account that are authorized to use EBS'}, {'Action': ['kms:Describe*', 'kms:Get*', 'kms:List*', 'kms:RevokeGrant'], 'Effect': 'Allow', 'Principal': {'AWS': 'arn:aws:iam::111111111111:root'}, 'Resource': '*', 'Sid': 'Allow direct access to key metadata to the account'}], 'Version': '2012-10-17'}
    state: present

---
- name: Update IAM policy on an existing KMS key2
  community.aws.aws_kms:
    alias: my-kms-key
    state: present","[[5], [3]]"
43,5ba316a9-c466-4ec1-8d5b-bc6107dc9a92,CloudTrail SNS Topic Name Undefined,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_sns_topic_name_undefined,Unknown,"Check if SNS topic name is set for CloudTrail<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html)","- name: sns topic name defined
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    s3_key_prefix: cloudtrail
    region: us-east-1
    sns_topic_name: some_topic_name","- name: no sns topic name
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    s3_key_prefix: cloudtrail
    region: us-east-1
- name: sns topic name defined
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    s3_key_prefix: cloudtrail
    region: us-east-1
    sns_topic_name:","[[2, 15]]"
44,5c6b727b-1382-4629-8ba9-abd1365e5610,Redshift Publicly Accessible,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/redshift_publicly_accessible,Unknown,"AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true (default is false)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/redshift_module.html)","- name: Basic cluster provisioning example01
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    publicly_accessible: no
- name: Basic cluster provisioning example02
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
- name: Basic cluster provisioning example03
  redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    publicly_accessible: false","---
- name: Basic cluster provisioning example04
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    publicly_accessible: yes
- name: Basic cluster provisioning example05
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    publicly_accessible: True
- name: Basic cluster provisioning example06
  redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    publicly_accessible: Yes","[[9, 17, 25]]"
45,5e92d816-2177-4083-85b4-f61b4f7176d9,Public Lambda via API Gateway,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/public_lambda_via_api_gateway,Unknown,"Allowing to run lambda function using public API Gateway<br>
[Documentation](https://docs.ansible.com/ansible/2.4/lambda_policy_module.html)","- name: Lambda S3 event notification
  lambda_policy:
    state: ""{{ state | default('present') }}""
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:InvokeFunction
    principal: s3.amazonaws.com
    source_arn: arn:aws:s3:eu-central-1:123456789012:bucketname","- name: Lambda S3 event notification
  lambda_policy:
    state: ""{{ state | default('present') }}""
    function_name: functionName
    alias: Dev
    statement_id: lambda-s3-myBucket-create-data-log
    action: lambda:InvokeFunction
    principal: apigateway.amazonaws.com
    source_arn: arn:aws:s3:eu-central-1:123456789012/*/*",[[9]]
46,5eccd62d-8b4d-46d3-83ea-1879f3cbd3ce,CA Certificate Identifier Is Outdated,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ca_certificate_identifier_is_outdated,Unknown,"The CA certificate Identifier must be 'rds-ca-2019'.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-ca_certificate_identifier)","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster
    ca_certificate_identifier: rds-ca-2019
- name: Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: true
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
    ca_certificate_identifier: rds-ca-2019","---
- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    ca_certificate_identifier: rds-ca-2015
- name: create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: True
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""","[[10, 12]]"
47,60bfbb8a-c72f-467f-a6dd-a46b7d612789,ECR Image Tag Not Immutable,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecr_image_tag_not_immutable,Unknown,"ECR should have an image tag be immutable. This prevents image tags from being overwritten.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_ecr_module.html)","- name: create immutable ecr-repo v4
  community.aws.ecs_ecr:
    name: super/cool
    image_tag_mutability: immutable","- name: create immutable ecr-repo
  community.aws.ecs_ecr:
    name: super/cool
- name: create immutable ecr-repo v2
  community.aws.ecs_ecr:
    name: super/cool
    image_tag_mutability: mutable","[[2, 7]]"
48,61d1a2d0-4db8-405a-913d-5d2ce49dff6f,Instance With No VPC,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/instance_with_no_vpc,Unknown,"EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html)","- name: Start an instance and have it begin a Tower callback on boot v3
  community.aws.ec2_instance:
    name: tower-callback-test
    key_name: prod-ssh-key
    vpc_subnet_id: subnet-5ca1ab1e
    security_group: default
    tower_callback:
      # IP or hostname of tower server
      tower_address: 1.2.3.4
      job_template_id: 876
      host_config_key: '[secret config key goes here]'
    network:
      assign_public_ip: true
    image_id: ami-123456
    cpu_credit_specification: unlimited
    tags:
      SomeThing: A value
- name: Start an instance and have it begin a Tower callback on boot v4
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: webserver
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: yes","- name: Start an instance and have it begin a Tower callback on boot
  community.aws.ec2_instance:
    name: ""tower-callback-test""
    key_name: ""prod-ssh-key""
    security_group: default
    tower_callback:
      # IP or hostname of tower server
      tower_address: 1.2.3.4
      job_template_id: 876
      host_config_key: '[secret config key goes here]'
    network:
      assign_public_ip: true
    image_id: ami-123456
    cpu_credit_specification: unlimited
    tags:
      SomeThing: ""A value""
- name: Start an instance and have it begin a Tower callback on boot v2
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: webserver
    count: 3
    assign_public_ip: yes","[[2, 18]]"
49,66477506-6abb-49ed-803d-3fa174cd5f6a,Launch Configuration Is Not Encrypted,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/launch_configuration_is_not_encrypted,Unknown,"Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ec2_lc_module.html)","- name: note that encrypted volumes are only supported in >= Ansible 2.4 v4
  ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: [group, group2]
    instance_type: t1.micro
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: yes
- name: note that encrypted volumes are only supported in >= Ansible 2.4 v5
  community.aws.ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: [group, group2]
    instance_type: t1.micro
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: yes","- name: note that encrypted volumes are only supported in >= Ansible 2.4
  community.aws.ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: ['group', 'group2' ]
    instance_type: t1.micro
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: no
- name: note that encrypted volumes are only supported in >= Ansible 2.4 v2
  ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: ['group', 'group2' ]
    instance_type: t1.micro
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
- name: note that encrypted volumes are only supported in >= Ansible 2.4 v3
  ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: ['group', 'group2' ]
    instance_type: t1.micro","[[8, 29, 22]]"
50,6a647814-def5-4b85-88f5-897c19f509cd,Redshift Not Encrypted,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/redshift_not_encrypted,Unknown,"AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted)","- name: Basic cluster provisioning example
  community.aws.redshift:
    identifier: tf-redshift-cluster
    command: create
    db_name: mydb
    username: foo
    password: Mustbe8characters
    node_type: dc1.large
    cluster_type: single-node
    encrypted: true
- name: Basic cluster provisioning example2
  community.aws.redshift:
    identifier: tf-redshift-cluster
    command: create
    db_name: mydb
    username: foo
    password: Mustbe8characters
    node_type: dc1.large
    cluster_type: single-node
    encrypted: yes","- name: Basic cluster provisioning example
  community.aws.redshift:
    identifier: tf-redshift-cluster
    command: create
    db_name: mydb
    username: foo
    password: Mustbe8characters
    node_type: dc1.large
    cluster_type: single-node
- name: Basic cluster provisioning example2
  community.aws.redshift:
    identifier: tf-redshift-cluster
    command: create
    db_name: mydb
    username: foo
    password: Mustbe8characters
    node_type: dc1.large
    cluster_type: single-node
    encrypted: false
- name: Basic cluster provisioning example3
  community.aws.redshift:
    identifier: tf-redshift-cluster
    command: create
    db_name: mydb
    username: foo
    password: Mustbe8characters
    node_type: dc1.large
    cluster_type: single-node
    encrypted: no","[[2, 19, 29]]"
51,6a6d7e56-c913-4549-b5c5-5221e624d2ec,S3 Bucket With All Permissions,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_with_all_permissions,Unknown,"S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html#parameter-policy)","- name: Create s3 bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy:
      Id: id113
      Version: '2012-10-17'
      Statement:
      - Action: s3:put
        Effect: Allow
        Resource: arn:aws:s3:::S3B_181355/*
        Principal: '*'
    requester_pays: yes
    versioning: yes","---
- name: Create s3 bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy:
      Id: ""id113""
      Version: ""2012-10-17""
      Statement:
      - Action: ""s3:*""
        Effect: ""Allow""
        Resource: ""arn:aws:s3:::S3B_181355/*""
        Principal: ""*""
    requester_pays: yes
    versioning: yes",[[5]]
52,6ad087d7-a509-4b20-b853-9ef6f5ebaa98,CloudTrail Multi Region Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_multi_region_disabled,Unknown,"CloudTrail multi region should be enabled, which means attribute 'is_multi_region_trail' should be set to true<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html#parameter-is_multi_region_trail)","- name: example1
  community.aws.cloudtrail: 
    sns_topic_name: random
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role
    cloudwatch_logs_log_group_arn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*
    kms_key_id: alias/MyAliasName
    tags:
      environment: dev
      Name: default","- name: example1
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: false
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    sns_topic_name: random1
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default

- name: example2
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    s3_key_prefix: cloudtrail
    region: us-east-1
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    sns_topic_name: random2
    enable_log_file_validation: true
    kms_key_id: ""alias/MyAliasName""","[[18, 7]]"
53,6f5f5444-1422-495f-81ef-24cefd61ed2c,Password Without Reuse Prevention,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/password_without_reuse_prevention,Unknown,"Password policy `password_reuse_prevention` doesn't exist or is equal to 0<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_password_policy_module.html#parameter-pw_reuse_prevent)","- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false
- name: Password policy for AWS account2
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    password_reuse_prevent: 5
    pw_expire: false
- name: Password policy for AWS account3
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    prevent_reuse: 5
    pw_expire: false","---
- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_expire: false
- name: Password policy for AWS account2
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    password_reuse_prevent: 0
    pw_expire: false
- name: Password policy for AWS account3
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_expire: false","[[26, 3, 23]]"
54,6fa44721-ef21-41c6-8665-330d59461163,S3 Bucket Allows Delete Action From All Principals,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_allows_delete_action_from_all_principals,Unknown,"S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html)","#this code is a correct code for which the query should not find any result
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: '2020-10-07'
      Statement:
      - Effect: Deny
        Action: DeleteObject
        Principal: '*'","#this is a problematic code where the query should report a result(s)
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: ""2020-10-07""
      Statement:
      - Effect: Allow
        Action: DeleteObject
        Principal: ""*""",[[6]]
55,71397b34-1d50-4ee1-97cb-c96c34676f74,Lambda Functions Without X-Ray Tracing,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/lambda_functions_without_x-ray_tracing,Unknown,"AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_mode' should have the value 'Active'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_module.html)","- name: looped creation V3
  community.aws.lambda:
    name: '{{ item.name }}'
    state: present
    zip_file: '{{ item.zip_file }}'
    runtime: python2.7
    role: arn:aws:iam::987654321012:role/lambda_basic_execution
    handler: hello_python.my_handler
    tracing_mode: Active
    vpc_subnet_ids:
    - subnet-123abcde
    - subnet-edcba321
    vpc_security_group_ids:
    - sg-123abcde
    - sg-edcba321
    environment_variables: '{{ item.env_vars }}'
    tags:
      key1: value1
  loop:
  - name: HelloWorld
    zip_file: hello-code.zip
    env_vars:
      key1: first
      key2: second
  - name: ByeBye
    zip_file: bye-code.zip
    env_vars:
      key1: '1'
      key2: '2'","- name: looped creation
  community.aws.lambda:
    name: '{{ item.name }}'
    state: present
    zip_file: '{{ item.zip_file }}'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'
    vpc_subnet_ids:
    - subnet-123abcde
    - subnet-edcba321
    vpc_security_group_ids:
    - sg-123abcde
    - sg-edcba321
    environment_variables: '{{ item.env_vars }}'
    tags:
      key1: 'value1'
  loop:
  - name: HelloWorld
    zip_file: hello-code.zip
    env_vars:
      key1: ""first""
      key2: ""second""
  - name: ByeBye
    zip_file: bye-code.zip
    env_vars:
      key1: ""1""
      key2: ""2""
- name: looped creation V2
  community.aws.lambda:
    name: '{{ item.name }}'
    state: present
    zip_file: '{{ item.zip_file }}'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'
    tracing_mode: ""PassThrough""
    vpc_subnet_ids:
    - subnet-123abcde
    - subnet-edcba321
    vpc_security_group_ids:
    - sg-123abcde
    - sg-edcba321
    environment_variables: '{{ item.env_vars }}'
    tags:
      key1: 'value1'
  loop:
  - name: HelloWorld
    zip_file: hello-code.zip
    env_vars:
      key1: ""first""
      key2: ""second""
  - name: ByeBye
    zip_file: bye-code.zip
    env_vars:
      key1: ""1""
      key2: ""2""","[[2, 37]]"
56,71ea648a-d31a-4b5a-a589-5674243f1c33,Public Port Wide,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/public_port_wide,Unknown,"AWS Security Group should not have public port wide<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group v2
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 0.0.0.0/0
    - proto: tcp
      from_port: 22
      to_port: 22
      cidr_ip: 10.0.0.0/8","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        from_port: 80
        to_port: 82
        cidr_ip: 0.0.0.0/0
      - proto: tcp
        from_port: 2
        to_port: 22
        cidr_ipv6: ::/0",[[7]]
57,722b0f24-5a64-4cca-aa96-cfc26b7e3a5b,Unknown Port Exposed To Internet,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/unknown_port_exposed_to_internet,Unknown,"AWS Security Group should not have an unknown port exposed to the entire Internet<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 0.0.0.0/0
    - proto: tcp
      from_port: 22
      to_port: 22
      cidr_ip: 10.0.0.0/8","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        from_port: 8001
        to_port: 8002
        cidr_ip: 0.0.0.0/0
      - proto: tcp
        from_port: 2222
        to_port: 2226
        cidr_ipv6: ::/0","[[9, 13]]"
58,727c4fd4-d604-4df6-a179-7713d3c85e20,EFS Not Encrypted,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/efs_not_encrypted,Unknown,"Elastic File System (EFS) must be encrypted<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/efs_module.html#parameter-encrypt)","- name: foo
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: yes
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
    - subnet_id: subnet-748c5d03
      security_groups: [sg-1a2b3c4d]
- name: foo2
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: true
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
    - subnet_id: subnet-748c5d03
      security_groups: [sg-1a2b3c4d]","---
- name: foo
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: no
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [""sg-1a2b3c4d""]
- name: foo2
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: false
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [""sg-1a2b3c4d""]
- name: foo3
  community.aws.efs:
    state: present
    name: myTestEFS
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [""sg-1a2b3c4d""]","[[17, 6, 25]]"
59,72a931c2-12f5-40d1-93cc-47bff2f7aa2a,API Gateway With CloudWatch Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_with_cloudwatch_logging_disabled,Unknown,"AWS CloudWatch Logs for APIs is not enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudwatchlogs_log_group_module.html#ansible-collections-community-aws-cloudwatchlogs-log-group-module)","- name: Setup AWS API Gateway setup on AWS cloudwatchlogs
  community.aws.cloudwatchlogs_log_group:
    state: present
    log_group_name: test-log-group
    tags: {Name: test-log-group, Env: QA}
    kms_key_id: arn:aws:kms:region:account-id:key/key-id","---
- name: Setup AWS API Gateway setup on AWS cloudwatchlogs
  community.aws.cloudwatchlogs_log_group:
    state: present
    kms_key_id: arn:aws:kms:region:account-id:key/key-id",[[3]]
60,730a5951-2760-407a-b032-dd629b55c23a,ELB Using Insecure Protocols,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/elb_using_insecure_protocols,Unknown,"ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'SslPolicy' of 'listeners' must not coincide with any of a predefined list of insecure protocols.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elb_application_lb_module.html)","#this code is a correct code for which the query should not find any result
- name: elb1
  community.aws.elb_application_lb:
    name: myelb1
    security_groups:
    - sg-12345678
    - my-sec-group
    subnets:
    - subnet-012345678
    - subnet-abcdef000
    listeners:
    - Protocol: HTTP   # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
      Port: 80   # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:   # The ARN of the certificate (only one certficate ARN should be provided)
      - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
      - Type: forward     # Required.
        TargetGroupName:     # Required. The name of the target group
    state: present
- name: elb2
  community.aws.elb_network_lb:
    name: myelb2
    security_groups:
    - sg-12345678
    - my-sec-group
    subnets:
    - subnet-012345678
    - subnet-abcdef000
    listeners:
    - Protocol: HTTP   # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
      Port: 80   # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:   # The ARN of the certificate (only one certficate ARN should be provided)
      - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
      - Type: forward     # Required.
        TargetGroupName:     # Required. The name of the target group
    state: present","#this is a problematic code where the query should report a result(s)
- name: elb1
  community.aws.elb_application_lb:
    name: myelb1
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    state: present
- name: elb2
  community.aws.elb_application_lb:
    name: myelb2
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present
- name: elb3
  community.aws.elb_application_lb:
    name: myelb3
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        SslPolicy: Protocol-SSLv2
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present
- name: elb4
  community.aws.elb_network_lb:
    name: myelb4
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    state: present
- name: elb5
  community.aws.elb_network_lb:
    name: myelb5
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present
- name: elb6
  community.aws.elb_network_lb:
    name: myelb6
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP # Required. The protocol for connections from clients to the load balancer (HTTP or HTTPS) (case-sensitive).
        Port: 80 # Required. The port on which the load balancer is listening.
        # The security policy that defines which ciphers and protocols are supported. The default is the current predefined security policy.
        SslPolicy: Protocol-TLSv1.1
        Certificates: # The ARN of the certificate (only one certficate ARN should be provided)
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward # Required.
            TargetGroupName: # Required. The name of the target group
    state: present","[[3, 70, 40, 52, 21, 89]]"
61,75480b31-f349-4b9a-861f-bce19588e674,S3 Bucket ACL Allows Read to Any Authenticated User,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_acl_allows_read_to_any_authenticated_user,Unknown,"S3 Buckets should not be readable to any authenticated user<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_s3_module.html#parameter-permission)","- name: Create an empty bucket
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
- name: Create an empty bucket2
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: private","---
- name: Create an empty bucket2
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: authenticated-read",[[6]]
62,7674a686-e4b1-4a95-83d4-1fd53c623d84,Config Rule For Encrypted Volumes Disabled,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/config_rule_for_encrypted_volumes_is_disabled,Unknown,"Check if AWS config rules do not identify Encrypted Volumes as a source.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_config_rule_module.html#parameter-source/identifier)","- name: foo
  community.aws.aws_config_rule:
    name: test_config_rule
    state: present
    description: This AWS Config rule checks for public write access on S3 buckets
    scope:
      compliance_types:
      - AWS::S3::Bucket
    source:
      owner: AWS
      identifier: ENCRYPTED_VOLUMES","---
- name: foo
  community.aws.aws_config_rule:
    name: test_config_rule
    state: present
    description: 'This AWS Config rule checks for public write access on S3 buckets'
    scope:
      compliance_types:
        - 'AWS::S3::Bucket'
    source:
      owner: AWS
      identifier: 'S3_BUCKET_PUBLIC_WRITE_PROHIBITED'",[[2]]
63,7af1c447-c014-4f05-bd8b-ebe3a15734ac,SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sql_analysis_services_port_2383_is_publicly_accessible,Unknown,"Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example using security group rule descriptions
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: '{{ aws_profile }}'
    region: us-east-1
    rules:
    - proto: tcp
      ports:
      - 2383
      cidr_ip: aws_vpc.main.cidr_block
      rule_desc: allow all on port 2383

- name: example using security group rule descriptions 2
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: '{{ aws_profile }}'
    region: us-east-1
    rules:
    - proto: udp
      ports:
      - 2383
      cidr_ip: 0.0.0.0/0
      rule_desc: allow all on port 2383

- name: example using security group rule descriptions 3
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: '{{ aws_profile }}'
    region: us-east-1
    rules:
    - proto: tcp
      to_port: 4000
      from_port: 3000
      cidr_ip: 0.0.0.0/0
      rule_desc: allow all on port 2383","---
- name: example using security group rule descriptions
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: ""{{ aws_profile }}""
    region: us-east-1
    rules:
      - proto: tcp
        ports:
          - 2383
        cidr_ip: 0.0.0.0/0
        rule_desc: allow all on port 2383

- name: example using security group rule descriptions 2
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: ""{{ aws_profile }}""
    region: us-east-1
    rules:
      - proto: tcp
        ports:
          - 2383
        cidr_ip: 0.0.0.0/0
        rule_desc: allow all on port 2383

- name: example using security group rule descriptions 3
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: ""{{ aws_profile }}""
    region: us-east-1
    rules:
      - proto: tcp
        to_port: -1
        from_port: -1
        cidr_ip: 0.0.0.0/0
        rule_desc: allow all on port 2383

- name: example using security group rule descriptions 4
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: ""{{ aws_profile }}""
    region: us-east-1
    rules:
      - proto: tcp
        ports:
          - 2000-3000
        cidr_ip: 0.0.0.0/0
        rule_desc: allow all on port 2383

- name: example using security group rule descriptions 5
  amazon.aws.ec2_group:
    name: awsEc2
    description: sg with rule descriptions
    vpc_id: vpc-xxxxxxxx
    profile: ""{{ aws_profile }}""
    region: us-east-1
    rules:
      - proto: tcp
        to_port: 3000
        from_port: 2000
        cidr_ip: 0.0.0.0/0
        rule_desc: allow all on port 2383","[[65, 37, 9, 51, 23]]"
64,7cc6c791-5f68-4816-a564-b9b699f9d26e,ElastiCache Using Default Port,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/elasticache_using_default_port,Unknown,"ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elasticache_module.html#parameter-cache_port)","- name: Basic example2
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: memcached
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 11212
    cache_subnet_group: default
    zone: us-east-1d

- name: Basic example2
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: redis
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 6380
    cache_subnet_group: default
    zone: us-east-1d","- name: Basic example
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: memcached
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 11211
    cache_subnet_group: default
    zone: us-east-1d

- name: Basic example2
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: redis
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1
    cache_port: 6379
    cache_subnet_group: default
    zone: us-east-1d","[[9], [9]]"
65,7db727c1-1720-468e-b80e-06697f71e09e,ECS Service Admin Role Is Present,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecs_service_admin_role_is_present,Unknown,"ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_service_module.html)","#this code is a correct code for which the query should not find any result
- name: ECS Service
  community.aws.ecs_service:
    state: present
    name: console-test-service
    cluster: new_cluster
    task_definition: new_cluster-task:1
    desired_count: 0","#this is a problematic code where the query should report a result(s)
- name: ECS Service
  community.aws.ecs_service:
    state: present
    name: console-test-service
    cluster: new_cluster
    task_definition: 'new_cluster-task:1'
    desired_count: 0
    role: admin",[[9]]
66,7dfb316c-a6c2-454d-b8a2-97f147b0c0ff,DB Instance Storage Not Encrypted,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/db_instance_storage_not_encrypted,Unknown,"AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html)","- name: foo
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: true
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
- name: foo2
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: yes
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
- name: foo3
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    kms_key_id: sup3rstr0ngK3y
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'","---
- name: foo
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: False
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""
- name: foo2
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: no
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""
- name: foo3
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""","[[17, 23, 7]]"
67,7f79f858-fbe8-4186-8a2c-dfd0d958a40f,IAM Access Key Is Exposed,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_access_key_is_exposed,Unknown,"Check if IAM Access Key is active for some user besides 'root'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_module.html)","# Basic user creation example
- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: '{{ item }}'
    state: present
    password: '{{ temp_pass }}'
    access_key_state: create
  loop:
  - jcleese
  - mpython

# Basic user creation example
- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: root
    state: present
    password: '{{ temp_pass }}'
    access_key_state: active

- name: Create Two Groups, Mario and Luigi
  community.aws.iam:
    iam_type: group
    name: '{{ item }}'
    state: present
  loop:
  - Mario
  - Luigi
  register: new_groups

- name: Update user
  community.aws.iam:
    iam_type: user
    name: jdavila
    state: update
    access_key_state: inactive
    groups: '{{ item.created_group.group_name }}'
  loop: '{{ new_groups.results }}'","- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: ""{{ item }}""
    state: present
    password: ""{{ temp_pass }}""
    access_key_state: active
  loop:
    - jcleese
    - mpython
- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: ""{{ item }}""
    state: present
    password: ""{{ temp_pass }}""
    access_key_state: active
  loop:
    - root
    - mpython
- name: Create Two Groups, Mario and Luigi
  community.aws.iam:
    iam_type: group
    name: ""{{ item }}""
    state: present
    access_key_state: active
  loop:
    - Mario
    - Luigi
  register: new_groups
- name: Update user
  community.aws.iam:
    iam_type: user
    name: jdavila
    state: update
    access_key_state: active
    groups: ""{{ item.created_group.group_name }}""
  loop: ""{{ new_groups.results }}""","[[26, 36, 7]]"
68,8010e17a-00e9-4635-a692-90d6bcec68bd,Default Security Groups With Unrestricted Traffic,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/default_security_groups_with_unrestricted_traffic,Unknown,"Check if default security group does not restrict all inbound and outbound traffic.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: all
        # in the 'proto' attribute, if you specify -1, all, or a protocol number other than tcp, udp, icmp, or 58 (ICMPv6),
        # traffic on all ports is allowed, regardless of any ports you specify
      from_port: 10050   # this value is ignored
      to_port: 10050   # this value is ignored
      cidr_ip: 10.1.0.0/16
      cidr_ipv6: 64:ff9b::/96
    rules_egress:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 10.1.0.0/16
      cidr_ipv6: 64:ff9b::/96
      group_name: example-other
        # description to use if example-other needs to be created
      group_desc: other example EC2 group","---
- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: all
        # in the 'proto' attribute, if you specify -1, all, or a protocol number other than tcp, udp, icmp, or 58 (ICMPv6),
        # traffic on all ports is allowed, regardless of any ports you specify
        from_port: 10050 # this value is ignored
        to_port: 10050 # this value is ignored
        cidr_ip:
          - 0.0.0.0/0
- name: example2 ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules_egress:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ip: 0.0.0.0/0
        group_name: example-other
        # description to use if example-other needs to be created
        group_desc: other example EC2 group
- name: example3 ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: all
        # in the 'proto' attribute, if you specify -1, all, or a protocol number other than tcp, udp, icmp, or 58 (ICMPv6),
        # traffic on all ports is allowed, regardless of any ports you specify
        from_port: 10050 # this value is ignored
        to_port: 10050 # this value is ignored
        cidr_ipv6: ::/0
- name: example4 ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules_egress:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ipv6: ::/0
        group_name: example-other
        # description to use if example-other needs to be created
        group_desc: other example EC2 group
- name: example5 ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      # 'ports' rule keyword was introduced in version 2.4. It accepts a single port value or a list of values including ranges (from_port-to_port).
      - proto: tcp
        ports: 22
        group_name: example-vpn
    rules_egress:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ipv6:
          - ::/0
        group_name: example-other
        # description to use if example-other needs to be created
        group_desc: other example EC2 group","[[48, 17, 83, 61, 30]]"
69,83c5fa4c-e098-48fc-84ee-0a537287ddd2,Unrestricted Security Group Ingress,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/unrestricted_security_group_ingress,Unknown,"Security groups allow ingress from 0.0.0.0/0<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example1
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      ports:
      - 80
      - 443
      - 8080-8099
      cidr_ip: 172.16.17.0/24
- name: example2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      ports:
      - 80
      - 443
      - 8080-8099
      cidr_ip:
      - 172.16.1.0/24
- name: example3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      ports:
      - 80
      - 443
      - 8080-8099
      cidr_ipv6: 2607:F8B0::/32
- name: example4
  amazon.aws.ec2_group:
    name: example4
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      ports:
      - 80
      - 443
      - 8080-8099
      cidr_ipv6:
      - 64:ff9b::/96
      - 2607:F8B0::/32","---
- name: example1
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        ports:
          - 80
          - 443
          - 8080-8099
        cidr_ip: 0.0.0.0/0
- name: example2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        ports:
          - 80
          - 443
          - 8080-8099
        cidr_ip:
          - 0.0.0.0/0
- name: example3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        ports:
          - 80
          - 443
          - 8080-8099
        cidr_ipv6: ::/0
- name: example4
  amazon.aws.ec2_group:
    name: example4
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: tcp
        ports:
          - 80
          - 443
          - 8080-8099
        cidr_ipv6:
          - ::/0","[[41, 28, 14, 55]]"
70,857f8808-e96a-4ba8-a9b7-f2d4ec6cad94,Automatic Minor Upgrades Disabled,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/automatic_minor_upgrades_disabled,Unknown,"RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-auto_minor_version_upgrade)","- name: negative - create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster
    auto_minor_version_upgrade: true
- name: negative - Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: true
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
    auto_minor_version_upgrade: yes
- name: negative - Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: true
    db_instance_class: db.t2.medium
    username: '{{ username }}'
    password: '{{ password }}'
    allocated_storage: '{{ allocated_storage }}'
    auto_minor_version_upgrade: true","---
- name: community - create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    auto_minor_version_upgrade: false
- name: community - Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: True
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""","[[10, 12]]"
71,86b0efa7-4901-4edd-a37a-c034bec6645a,SQS Queue Exposed,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sqs_queue_exposed,Unknown,"Checks if the SQS Queue is exposed<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/sqs_queue_module.html#parameter-policy)","- name: example
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: '2012-10-17'
      Id: sqspolicy
      Statement:
        Sid: First
        Effect: Allow
        Action: sqs:SendMessage
        Resource: ${aws_sqs_queue.q.arn}
        Condition:
          ArnEquals:
          aws:SourceArn: ${aws_sns_topic.example.arn}","- name: example
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: '2012-10-17'
      Id: sqspolicy
      Statement:
        Sid: First
        Effect: Allow
        Principal: '*'
        Action: sqs:SendMessage
        Resource: ${aws_sqs_queue.q.arn}
        Condition:
          ArnEquals:
          aws:SourceArn: ${aws_sns_topic.example.arn}
- name: example with list
  community.aws.sqs_queue:
    name: my-queue12
    region: ap-southeast-1
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""sqs:*""
        Resource: ""*""
        Principal: ""*""
    make_default: false
    state: present","[[10, 31]]"
72,8833f180-96f1-46f4-9147-849aafa56029,EC2 Instance Using Default VPC,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ec2_instance_using_default_vpc,Unknown,"EC2 Instances should not be configured under a default VPC network<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html#parameter-vpc_subnet_id)","- name: example2
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    count: 3
    vpc_subnet_id: ""{{ my_subnet2.subnet.id }}""
    assign_public_ip: yes
- name: Create subnet for database server2
  amazon.aws.ec2_vpc_subnet:
    state: present
    vpc_id: ""{{ myVPC.vpcs.0.id }}""
    cidr: 10.0.1.16/28
    tags:
      Name: Database Subnet
  register: my_subnet2","- name: example
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    count: 3
    vpc_subnet_id: ""{{ my_subnet.subnet.id }}""
    assign_public_ip: yes
- name: Create subnet for database server
  amazon.aws.ec2_vpc_subnet:
    state: present
    vpc_id: ""{{ defaultVPC.vpcs.0.id }}""
    cidr: 10.0.1.16/28
    tags:
      Name: Database Subnet
  register: my_subnet",[[8]]
73,8bc2168c-1723-4eeb-a6f3-a1ba614b9a6d,IAM Password Without Minimum Length,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_password_without_minimum_length,Unknown,"IAM password should have the required minimum length<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_password_policy_module.html)","- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false

- name: aws_iam_account_password_policy
  community.aws.iam_password_policy:
    state: present
    minimum_password_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false","- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false

- name: aws_iam_account_password_policy
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 3
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false

- name: aws_iam_account_password_policy_2
  community.aws.iam_password_policy:
    state: present
    minimum_password_length: 3
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false","[[16, 2, 27]]"
74,8d03993b-8384-419b-a681-d1f55149397c,EC2 Instance Using Default Security Group,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ec2_instance_using_default_security_group,Unknown,"EC2 instances should not use default security group(s)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html#parameter-group)","- name: example2
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: my_sg
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: yes","- name: example
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group: default
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: yes

- name: example2
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    image: ami-123456
    wait: yes
    group:
      - default
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: yes","[[7], [8]]"
75,8ed0bfce-f780-46d4-b086-21c3628f09ad,SES Policy With Allowed IAM Actions,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ses_policy_with_allowed_iam_actions,Unknown,"SES policy should not allow IAM actions to all principals<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_ses_identity_policy_module.html#parameter-policy)","- name: add sending authorization policy to email identity2
  community.aws.aws_ses_identity_policy:
    identity: example@example.com
    policy_name: ExamplePolicy
    policy: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Action"": ""*"",
            ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """"
          }
        ]
      }
    state: present","- name: add sending authorization policy to email identityyy
  community.aws.aws_ses_identity_policy:
    identity: example@example.com
    policy_name: ExamplePolicy
    policy: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Action"": ""*"",
            ""Principal"": {
              ""AWS"": ""*""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """"
          }
        ]
      }
    state: present",[[5]]
76,905f4741-f965-45c1-98db-f7a00a0e5c73,SNS Topic is Publicly Accessible,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sns_topic_is_publicly_accessible,Unknown,"SNS Topic Policy should not allow any principal to access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/sns_topic_module.html)","- name: Create alarm SNS topic community
  community.aws.sns_topic:
    name: alarms
    state: present
    display_name: alarm SNS topic
    delivery_policy:
      http:
        defaultHealthyRetryPolicy:
          minDelayTarget: 2
          maxDelayTarget: 4
          numRetries: 3
          numMaxDelayRetries: 5
          backoffFunction: <linear|arithmetic|geometric|exponential>
        disableSubscriptionOverrides: true
        defaultThrottlePolicy:
          maxReceivesPerSecond: 10
    policy:
      Version: '2022-05-02'
      Statement:
      - Effect: Allow
        Action: Publish
        Principal: NotAll

- name: Create alarm SNS topic
  sns_topic:
    name: alarms
    state: present
    display_name: alarm SNS topic
    delivery_policy:
      http:
        defaultHealthyRetryPolicy:
          minDelayTarget: 2
          maxDelayTarget: 4
          numRetries: 3
          numMaxDelayRetries: 5
          backoffFunction: <linear|arithmetic|geometric|exponential>
        disableSubscriptionOverrides: true
        defaultThrottlePolicy:
          maxReceivesPerSecond: 10
    policy:
      Version: '2022-05-02'
      Statement:
      - Effect: Allow
        Action: Publish
        Principal: NotAll","---
- name: Create alarm SNS topic community
  community.aws.sns_topic:
    name: ""alarms""
    state: present
    display_name: ""alarm SNS topic""
    delivery_policy:
      http:
        defaultHealthyRetryPolicy:
          minDelayTarget: 2
          maxDelayTarget: 4
          numRetries: 3
          numMaxDelayRetries: 5
          backoffFunction: ""<linear|arithmetic|geometric|exponential>""
        disableSubscriptionOverrides: True
        defaultThrottlePolicy:
          maxReceivesPerSecond: 10
    subscriptions:
      - endpoint: ""my_email_address@example.com""
        protocol: ""email""
      - endpoint: ""my_mobile_number""
        protocol: ""sms""
    policy:
      Version: '2022-05-02'
      Statement:
        - Action: Publish
          Effect: Allow
          Principal: ""*""
- name: Create alarm SNS topic
  sns_topic:
    name: ""alarms""
    state: present
    display_name: ""alarm SNS topic""
    delivery_policy:
      http:
        defaultHealthyRetryPolicy:
          minDelayTarget: 2
          maxDelayTarget: 4
          numRetries: 3
          numMaxDelayRetries: 5
          backoffFunction: ""<linear|arithmetic|geometric|exponential>""
        disableSubscriptionOverrides: True
        defaultThrottlePolicy:
          maxReceivesPerSecond: 10
    subscriptions:
      - endpoint: ""my_email_address@example.com""
        protocol: ""email""
      - endpoint: ""my_mobile_number""
        protocol: ""sms""
    policy:
      Version: '2022-05-02'
      Statement:
        - Effect: Allow
          Action: Publish
          Principal: '*'","[[50, 23]]"
77,9232306a-f839-40aa-b3ef-b352001da9a5,S3 Bucket Without Versioning,Ansible,Medium,Backup,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_without_versioning,Unknown,"S3 bucket should have versioning enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html#parameter-versioning)","- name: foo
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy: ""{{ lookup('file','policy.json') }}""
    requester_pays: yes
    versioning: yes
    tags:
      example: tag1
      another: tag2","---
- name: foo
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy: ""{{ lookup('file','policy.json') }}""
    requester_pays: yes
    tags:
      example: tag1
      another: tag2
- name: foo2
  amazon.aws.s3_bucket:
    name: mys3bucket
    policy: ""{{ lookup('file','policy.json') }}""
    requester_pays: yes
    versioning: no
    tags:
      example: tag1
      another: tag2","[[3, 15]]"
78,97707503-a22c-4cd7-b7c0-f088fa7cf830,AMI Not Encrypted,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ami_not_encrypted,Unknown,"AWS AMI Encryption is not enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_ami_module.html)","- name: Basic AMI Creation
  amazon.aws.ec2_ami:
    instance_id: i-xxxxxx
    device_mapping:
      device_name: /dev/sda
      encrypted: yes
    wait: yes
    name: newtest
    tags:
      Name: newtest
      Service: TestService","- name: Basic AMI Creation
  amazon.aws.ec2_ami:
    instance_id: i-xxxxxx
    device_mapping:
      device_name: /dev/sda
      encrypted: no
    wait: yes
    name: newtest
    tags:
      Name: newtest
      Service: TestService
- name: Basic AMI Creation2
  amazon.aws.ec2_ami:
    instance_id: i-xxxxxx
    device_mapping:
      device_name: /dev/sda
    wait: yes
    name: newtest
    tags:
      Name: newtest
      Service: TestService","[[13, 6]]"
79,9f34885e-c08f-4d13-a7d1-cf190c5bd268,Redis Not Compliant,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/redis_not_compliant,Unknown,"Check if the redis version is compliant with the necessary AWS PCI DSS requirements<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elasticache_module.html#parameter-cache_engine_version)","- name: Basic example
  community.aws.elasticache:
    name: test-please-delete
    state: present
    engine: memcached
    cache_engine_version: 5.1.10
    node_type: cache.m1.small
    num_nodes: 1","- name: Basic example
  community.aws.elasticache:
    name: ""test-please-delete""
    state: present
    engine: memcached
    cache_engine_version: 1.4.14
    node_type: cache.m1.small
    num_nodes: 1",[[6]]
80,a0f1bfe0-741e-473f-b3b2-13e66f856fab,S3 Bucket Allows Put Action From All Principals,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_allows_put_action_from_all_principals,Unknown,"S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html)","#this code is a correct code for which the query should not find any result
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: '2020-10-07'
      Statement:
      - Effect: Allow
        Action: PutObject
        Principal: NotAll","#this is a problematic code where the query should report a result(s)
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: ""2020-10-07""
      Statement:
      - Effect: Allow
        Action: PutObject
        Principal: ""*""",[[6]]
81,a1423864-2fbc-4f46-bfe1-fbbf125c71c9,CodeBuild Not Encrypted,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/codebuild_not_encrypted,Unknown,"CodeBuild Project should be encrypted<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_codebuild_module.html)","- name: My project v2
  community.aws.aws_codebuild:
    description: My nice little project
    service_role: arn:aws:iam::123123:role/service-role/code-build-service-role
    source:
      type: CODEPIPELINE
      buildspec: ''
    artifacts:
      namespaceType: NONE
      packaging: NONE
      type: CODEPIPELINE
      name: my_project
    environment:
      computeType: BUILD_GENERAL1_SMALL
      privilegedMode: 'true'
      image: aws/codebuild/docker:17.09.0
      type: LINUX_CONTAINER
    encryption_key: arn:aws:kms:us-east-1:123123:alias/aws/s3
    region: us-east-1
    state: present","- name: My project
  community.aws.aws_codebuild:
    description: My nice little project v2
    service_role: ""arn:aws:iam::123123:role/service-role/code-build-service-role""
    source:
      type: CODEPIPELINE
      buildspec: ''
    artifacts:
      namespaceType: NONE
      packaging: NONE
      type: CODEPIPELINE
      name: my_project
    environment:
      computeType: BUILD_GENERAL1_SMALL
      privilegedMode: ""true""
      image: ""aws/codebuild/docker:17.09.0""
      type: LINUX_CONTAINER
    region: us-east-1
    state: present",[[2]]
82,a14ad534-acbe-4a8e-9404-2f7e1045646e,HTTP Port Open To Internet,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/http_port_open_to_internet,Unknown,"The HTTP port is open to the internet in a Security Group<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html#ansible-collections-amazon-aws-ec2-group-module)","- name: example ec2 group1
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 67
      to_port: 82
      cidr_ip: 0.0.0.0/1

- name: example ec2 group2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports: 80
      cidr_ip: 0.0.1.0/0

- name: example ec2 group3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports: 79-90
      cidr_ip: 0.1.0.0/0

- name: example ec2 group4
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports:
      - 100
      - 70-90
      cidr_ip: 10.0.0.0/0

- name: example ec2 group5
  amazon.aws.ec2_group:
    name: example5
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports:
      - 80
      - 30-31
      cidr_ip: 0.0.0.0/10

- name: example ec2 group6
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: -1
      to_port: 82
      cidr_ip: 0.1.0.0/0

- name: example ec2 group7
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 67
      to_port: -1
      cidr_ip: 1.0.0.0/0","- name: example ec2 group1
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 67
        to_port: 82
        cidr_ip: 0.0.0.0/0

- name: example ec2 group2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports: 80
        cidr_ip: 0.0.0.0/0

- name: example ec2 group3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports: 79-90
        cidr_ip: 0.0.0.0/0

- name: example ec2 group4
  amazon.aws.ec2_group:
    name: example4
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports:
          - 100
          - 70-90
        cidr_ip: 0.0.0.0/0

- name: example ec2 group5
  amazon.aws.ec2_group:
    name: example5
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports:
          - 80
          - 30-31
        cidr_ip: 0.0.0.0/0

- name: example ec2 group6
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: -1
        to_port: 82
        cidr_ip: 0.0.0.0/0

- name: example ec2 group7
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 67
        to_port: -1
        cidr_ip: 0.0.0.0/0","[[64, 36, 9, 79, 49, 23, 93]]"
83,a19b2942-142e-4e2b-93b7-6cf6a6c8d90f,AMI Shared With Multiple Accounts,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ami_shared_with_multiple_accounts,Unknown,"Limits access to AWS AMIs by checking if more than one account is using the same image<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_ami_module.html)","- name: Allow AMI to be launched by another account V2
  amazon.aws.ec2_ami:
    image_id: '{{ instance.image_id }}'
    state: present
    launch_permissions:
      user_ids: ['123456789012']","- name: Update AMI Launch Permissions, making it public
  amazon.aws.ec2_ami:
    image_id: ""{{ instance.image_id }}""
    state: present
    launch_permissions:
      group_names: ['all']
- name: Allow AMI to be launched by another account
  amazon.aws.ec2_ami:
    image_id: ""{{ instance.image_id }}""
    state: present
    launch_permissions:
      user_ids: ['123456789012', '121212']","[[11, 5]]"
84,a1ef9d2e-4163-40cb-bd92-04f0d602a15d,S3 Bucket ACL Allows Read to All Users,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_acl_allows_read_to_all_users,Unknown,"S3 Buckets should not be readable to all users<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_s3_module.html#parameter-permission)","- name: Create an empty bucket
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: private
- name: Create an empty bucket2
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create","---
- name: Create an empty bucket
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: public-read
- name: Create an empty bucket2
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: public-read-write","[[11, 6]]"
85,a2fdf451-89dd-451e-af92-bf6c0f4bab96,Configuration Aggregator to All Regions Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/config_configuration_aggregator_to_all_regions_disabled,Unknown,"AWS Config Configuration Aggregator All Regions must be set to True<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_config_aggregator_module.html#parameter-organization_source)","- name: Create cross-account aggregator
  community.aws.aws_config_aggregator:
    name: test_config_rule
    state: present
    account_sources:
      account_ids:
      - 1234567890
      - 0123456789
      - 9012345678
      all_aws_regions: yes
    organization_source:
      all_aws_regions: yes","- name: Create cross-account aggregator
  community.aws.aws_config_aggregator:
    name: test_config_rule
    state: present
    account_sources:
      account_ids:
      - 1234567890
      - 0123456789
      - 9012345678
      all_aws_regions: no
    organization_source:
      all_aws_regions: yes
- name: Create cross-account aggregator2
  community.aws.aws_config_aggregator:
    name: test_config_rule
    state: present
    account_sources:
      account_ids:
      - 1234567890
      - 0123456789
      - 9012345678
      all_aws_regions: yes
    organization_source:
      all_aws_regions: no","[[24, 10]]"
86,a6d27cf7-61dc-4bde-ae08-3b353b609f76,Cloudfront Viewer Protocol Policy Allows HTTP,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/viewer_protocol_policy_allows_http,Unknown,"Checks if the connection between CloudFront and the viewer is encrypted<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: example1
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
    - id: my test origin-000111
      domain_name: www.example.com
      origin_path: /production
      custom_headers:
      - header_name: MyCustomHeaderName
        header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: my test origin-000111
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
        - '*'
      viewer_protocol_policy: https-only
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
        - GET
        - HEAD
        cached_methods:
        - GET
        - HEAD

- name: example2
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
    - id: my test origin-000111
      domain_name: www.example.com
      origin_path: /production
      custom_headers:
      - header_name: MyCustomHeaderName
        header_value: MyCustomHeaderValue
    cache_behaviors:
      target_origin_id: my test origin-000111
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
        - '*'
      viewer_protocol_policy: https-only
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
        - GET
        - HEAD
        cached_methods:
        - GET
        - HEAD","- name: example1
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD

- name: example2
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    cache_behaviors:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD","[[50, 20]]"
87,a8b0c58b-cd25-4b53-9ad0-55bca0be0bc1,EC2 Instance Has Public IP,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ec2_instance_has_public_ip,Unknown,"EC2 Instance should not have a public IP address.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_module.html#parameter-assign_public_ip)","- amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: false
- name: Create an ec2 launch template
  community.aws.ec2_launch_template:
    name: my_template
    image_id: ami-04b762b4289fba92b
    key_name: my_ssh_key
    instance_type: t2.micro
- name: Create an ec2 launch template
  community.aws.ec2_launch_template:
    name: ""my_template""
    image_id: ""ami-04b762b4289fba92b""
    key_name: my_ssh_key
    instance_type: t2.micro
    network_interfaces:
      - interface_type: interface
        ipv6_addresses: []
        mac_address: '0 e: 0 e: 36: 60: 67: cf'
        network_interface_id: eni - 061 dee20eba3b445a
        owner_id: '721066863947'
        source_dest_check: true
        status: "" in -use""","- name: example
  amazon.aws.ec2:
    key_name: mykey
    instance_type: t2.micro
    count: 3
    vpc_subnet_id: subnet-29e63245
    assign_public_ip: yes
- name: Create an ec2 launch template
  community.aws.ec2_launch_template:
    name: ""my_template""
    image_id: ""ami-04b762b4289fba92b""
    key_name: my_ssh_key
    instance_type: t2.micro
    network_interfaces:
      associate_public_ip_address: true
- name: start an instance with a public IP address
  community.aws.ec2_instance:
    name: ""public-compute-instance""
    key_name: ""prod-ssh-key""
    vpc_subnet_id: subnet-5ca1ab1e
    instance_type: c5.large
    security_group: default
    network:
      assign_public_ip: true","[[24, 15, 7]]"
88,af167837-9636-4086-b815-c239186b9dda,Cross-Account IAM Assume Role Policy Without ExternalId or MFA,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cross_account_iam_assume_role_policy_without_external_id_or_mfa,Unknown,"Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_role_module.html#parameter-assume_role_policy_document)","- name: Create a role with description and tags4
  community.aws.iam_role:
    name: mynewrole4
    assume_role_policy_document: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Action"": ""sts:AssumeRole"",
            ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """",
            ""Condition"": {
              ""StringEquals"": {
                ""sts:ExternalId"": ""98765""
              }
            }
          }
        ]
      }
    description: This is My New Role
    tags:
      env: dev

- name: Create a role with description and tags5
  community.aws.iam_role:
    name: mynewrole5
    assume_role_policy_document: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Action"": ""sts:AssumeRole"",
            ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """",
            ""Condition"": {
              ""Bool"": {
                ""aws:MultiFactorAuthPresent"": ""true""
              }
            }
          }
        ]
      }
    description: This is My New Role
    tags:
      env: dev","- name: Create a role with description and tags
  community.aws.iam_role:
    name: mynewrole
    assume_role_policy_document: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Action"": ""sts:AssumeRole"",
            ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """"
          }
        ]
      }
    description: This is My New Role
    tags:
      env: dev

- name: Create a role with description and tags2
  community.aws.iam_role:
    name: mynewrole2
    assume_role_policy_document: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": {
          ""Action"": ""sts:AssumeRole"",
          ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
          },
          ""Effect"": ""Allow"",
          ""Resource"": ""*"",
          ""Sid"": """",
          ""Condition"": {
            ""Bool"": {
                ""aws:MultiFactorAuthPresent"": ""false""
            }
          }
        }
      }
    description: This is My New Role
    tags:
      env: dev

- name: Create a role with description and tags3
  community.aws.iam_role:
    name: mynewrole3
    assume_role_policy_document: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"": {
            ""Action"": ""sts:AssumeRole"",
            ""Principal"": {
              ""AWS"": ""arn:aws:iam::987654321145:root""
            },
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Sid"": """",
            ""Condition"": {
              ""StringEquals"": {
                ""sts:ExternalId"": """"
              }
            }
        }
      }
    description: This is My New Role
    tags:
      env: dev","[[4], [4], [4]]"
89,af96d737-0818-4162-8c41-40d969bd65d1,CMK Rotation Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cmk_rotation_disabled,Unknown,"Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_kms_module.html#parameter-enable_key_rotation)","- name: Update IAM policy on an existing KMS key3
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    enabled: true
    enable_key_rotation: true","- name: Update IAM policy on an existing KMS key
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    enabled: true

- name: Update IAM policy on an existing KMS key2
  community.aws.aws_kms:
    alias: my-kms-key
    policy: '{""Version"": ""2012-10-17"", ""Id"": ""my-kms-key-permissions"", ""Statement"": [ { <SOME STATEMENT> } ]}'
    state: present
    enabled: true
    enable_key_rotation: false","[[2], [7]]"
90,b16cdb37-ce15-4ab2-8401-d42b05d123fc,API Gateway Without Configured Authorizer,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_without_configured_authorizer,Unknown,"API Gateway REST API should have an API Gateway Authorizer<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_api_gateway_module.html)","- name: Setup AWS API Gateway setup on AWS and deploy API definition3
  community.aws.aws_api_gateway:
    swagger_file: swaggerFile.yaml
    stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present

- name: Setup AWS API Gateway setup on AWS and deploy API definition22222
  community.aws.aws_api_gateway:
    swagger_dict:
      {
        ""openapi"": ""3.0.0"",
        ""info"":
          {
            ""title"": ""Simple API Overview"",
            ""version"": ""1.0.0"",
            ""contact"": { ""name"": ""contact"", ""email"": ""user@gmail.com"" },
          },
        ""components"":
          {
            ""securitySchemes"":
              {
                ""request_authorizer_single_stagevar"":
                  {
                    ""type"": ""apiKey"",
                    ""name"": ""Unused"",
                    ""in"": ""header"",
                    ""x-amazon-apigateway-authtype"": ""custom"",
                    ""x-amazon-apigateway-authorizer"":
                      {
                        ""type"": ""request"",
                        ""identitySource"": ""stageVariables.stage"",
                        ""authorizerCredentials"": ""arn:aws:iam::123456789012:role/AWSepIntegTest-CS-LambdaRole"",
                        ""authorizerUri"": ""arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:123456789012:function:APIGateway-Request-Authorizer:vtwo/invocations"",
                        ""authorizerResultTtlInSeconds"": 300,
                      },
                  },
              },
          },
      }
    stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present

- name: Setup AWS API Gateway setup on AWS and deploy API 222
  aws_api_gateway:
    swagger_text: |
      openapi: 3.0.0
      info:
        title: Sample API
        description: Optional multiline or single-line description
        version: 0.1.9
      components:
        securitySchemes:
          request_authorizer_single_stagevar:
            type: apiKey
            name: Unused
            in: header
            x-amazon-apigateway-authtype: custom
            x-amazon-apigateway-authorizer:
              type: request
              identitySource: stageVariables.stage
              authorizerCredentials: arn:aws:iam::123456789012:role/AWSepIntegTest-CS-LambdaRole
              authorizerUri: arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:123456789012:function:APIGateway-Request-Authorizer:vtwo/invocations
              authorizerResultTtlInSeconds: 300
          stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present","- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_dict:
      {
        ""openapi"": ""3.0.0"",
        ""info"":
          {
            ""title"": ""Simple API Overview"",
            ""version"": ""1.0.0"",
            ""contact"": { ""name"": ""contact"", ""email"": ""user@gmail.com"" },
          },
        ""components"":
          {
            ""securitySchemes"":
              {
                ""request_authorizer_single_stagevar"":
                  {
                    ""type"": ""apiKey"",
                    ""name"": ""Unused"",
                    ""in"": ""header"",
                    ""x-amazon-apigateway-authtype"": ""custom"",
                  },
              },
          },
      }
    stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present

- name: Setup AWS API Gateway setup on AWS and deploy API definition2
  aws_api_gateway:
    stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present

- name: Setup AWS API Gateway setup on AWS and deploy API 222
  aws_api_gateway:
    swagger_file: swaggerFileWithoutAuthorizer.yaml
    stage: production
    cache_enabled: true
    cache_size: ""1.6""
    tracing_enabled: true
    endpoint_type: EDGE
    state: present","[[3], [2], [3]]"
91,b25398a2-0625-4e61-8e4d-a1bb23905bf6,CDN Configuration Is Missing,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cdn_configuration_is_missing,Unknown,"Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: create a distribution with an origin, logging and default cache behavior
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    enabled: true
    comment: this is a CloudFront distribution with logging","- name: create a distribution without an origin and with enabled=false
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    default_cache_behavior:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD
    enabled: false
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/","[[2, 23]]"
92,b47b98ab-e481-4a82-8bb1-1ab39fd36e33,API Gateway Without SSL Certificate,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_without_ssl_certificate,Unknown,"SSL Client Certificate should be enabled<br>
[Documentation](https://docs.ansible.com/ansible/2.8/modules/aws_api_gateway_module.html)","- name: update API v2
  aws_api_gateway:
    api_id: abc123321cba
    state: present
    swagger_file: my_api.yml
    validate_certs: yes
- name: Setup AWS API Gateway setup on AWS and deploy API definition v2
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present
    validate_certs: yes","- name: update API
  aws_api_gateway:
    api_id: 'abc123321cba'
    state: present
    swagger_file: my_api.yml
    validate_certs: no
- name: update API v1
  aws_api_gateway:
    api_id: 'abc123321cba'
    state: present
    swagger_file: my_api.yml
- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present
    validate_certs: no
- name: Setup AWS API Gateway setup on AWS and deploy API definition v1
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present","[[8, 21, 6, 23]]"
93,b5ed026d-a772-4f07-97f9-664ba0b116f8,IAM Policy Grants Full Permissions,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_policy_grants_full_permissions,Unknown,"IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_managed_policy_module.html)","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ManagedPolicy
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: logs:CreateLogGroup
        Resource: SomeResource
    make_default: false
    state: present

- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ManagedPolicy
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: '*'
        Resource: ec2messages:GetEndpoint
    make_default: false
    state: present","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ""ManagedPolicy""
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""*""
        Resource: ""*""
    make_default: false
    state: present",[[4]]
94,b8a9852c-9943-4973-b8d5-77dae9352851,EFS Without Tags,Ansible,Low,Build Process,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/efs_without_tags,Unknown,"Amazon Elastic Filesystem should have filesystem tags associated<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/efs_module.html)","- name: EFS provisioning
  community.aws.efs:
    state: present
    name: myTestEFS
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [ ""sg-1a2b3c4d"" ]","- name: EFS provisioning without tags
  community.aws.efs:
    state: present
    name: myTestEFS
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [ ""sg-1a2b3c4d"" ]",[[2]]
95,babdedcf-d859-43da-9a7b-6d72e661a8fd,IAM Role Allows All Principals To Assume,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_role_allows_all_principals_to_assume,Unknown,"IAM role allows all services or principals to assume it<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_managed_policy_module.html)","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ManagedPolicy
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: logs:CreateLogGroup
        Resource: '*'
    make_default: false
    state: present","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ""ManagedPolicy""
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""logs:CreateLogGroup""
        Resource: ""*""
        Principal:
          AWS: ""arn:aws:iam::root""
    make_default: false
    state: present
- name: Create2 IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ""ManagedPolicy2""
    policy: >
      {
        ""Version"": ""2012-10-17"",
        ""Statement"":[{
          ""Effect"": ""Allow"",
          ""Action"": ""logs:PutRetentionPolicy"",
          ""Resource"": ""*"",
          ""Principal"" : { ""AWS"" : ""arn:aws:iam::root"" }
        }]
      }
    only_version: true
    state: present","[[17, 4]]"
96,bd77554e-f138-40c5-91b2-2a09f878608e,EFS Without KMS,Ansible,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/efs_without_kms,Unknown,"Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/efs_module.html#parameter-kms_key_id)","- name: foo
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: yes
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
    - subnet_id: subnet-748c5d03
      security_groups: [sg-1a2b3c4d]
    kms_key_id: ""some-key-id""","---
- name: foo
  community.aws.efs:
    state: present
    name: myTestEFS
    encrypt: no
    tags:
      Name: myTestNameTag
      purpose: file-storage
    targets:
      - subnet_id: subnet-748c5d03
        security_groups: [""sg-1a2b3c4d""]",[[3]]
97,c09e3ca5-f08a-4717-9c87-3919c5e6d209,RDS DB Instance Publicly Accessible,Ansible,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/rds_db_instance_publicly_accessible,Unknown,"RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false').<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-auto_minor_version_upgrade)","- name: create RDS instance in default VPC and default subnet group02
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster
    publicly_accessible: false
- name: create RDS instance in default VPC and default subnet group03
  rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster","---
- name: community - Create a DB instance using the default AWS KMS encryption key
  community.aws.rds_instance:
    id: test-encrypted-db
    state: present
    engine: mariadb
    storage_encrypted: True
    db_instance_class: db.t2.medium
    username: ""{{ username }}""
    password: ""{{ password }}""
    allocated_storage: ""{{ allocated_storage }}""
    publicly_accessible: Yes
- name: community - Basic mysql provisioning example
  community.aws.rds:
    command: create
    instance_name: new-database
    db_engine: MySQL
    size: 10
    instance_type: db.m1.small
    username: mysql_admin
    password: 1nsecure
    publicly_accessible: ""true""
    tags:
      Environment: testing
      Application: cms","[[12, 22]]"
98,c09f4d3e-27d2-4d46-9453-abbe9687a64e,User Data Contains Encoded Private Key,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/user_data_contains_encoded_private_key,Unknown,"User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ec2_lc_module.html)","- name: note that encrypted volumes are only supported in >= Ansible 2.4
  community.aws.ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: [group, group2]
    instance_type: t1.micro
    user_data: dGVzdA==
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: true
    - device_name: /dev/sdb
      ephemeral: ephemeral0
- name: note that encrypted volumes are only supported in >= Ansible 2.4.2
  community.aws.ec2_lc:
    name: special2
    image_id: ami-XXX
    key_name: default
    security_groups: [group, group2]
    instance_type: t1.micro
    user_data:
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: true
    - device_name: /dev/sdb
      ephemeral: ephemeral0","---
- name: note that encrypted volumes are only supported in >= Ansible 2.4
  community.aws.ec2_lc:
    name: special
    image_id: ami-XXX
    key_name: default
    security_groups: ['group', 'group2' ]
    instance_type: t1.micro
    user_data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpzb21lS2V5
    volumes:
    - device_name: /dev/sda1
      volume_size: 100
      volume_type: io1
      iops: 3000
      delete_on_termination: true
      encrypted: true
    - device_name: /dev/sdb
      ephemeral: ephemeral0",[[9]]
99,c2f15af3-66a0-4176-a56e-e4711e502e5c,Hardcoded AWS Access Key,Ansible,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/hardcoded_aws_access_key,Unknown,"AWS Access Key should not be hardcoded<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ec2_instance_module.html)","- name: start an instance with a cpu_options
  community.aws.ec2_instance:
    name: public-cpuoption-instance
    vpc_subnet_id: subnet-5ca1ab1e
    tags:
      Environment: Testing
    instance_type: c4.large
    volumes:
    - device_name: /dev/sda1
      ebs:
        delete_on_termination: true
    cpu_options:
      core_count: 1
      threads_per_core: 1","- name: start an instance with a cpu_options
  community.aws.ec2_instance:
    name: ""public-cpuoption-instance""
    vpc_subnet_id: subnet-5ca1ab1e
    tags:
      Environment: Testing
    user_data: ""1234567890123456789012345678901234567890$""",[[7]]
100,c3b9f7b0-f5a0-49ec-9cbc-f1e346b7274d,S3 Bucket Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_logging_disabled,Unknown,"Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html#parameter-debug_botocore_endpoint_logs)","- amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    debug_botocore_endpoint_logs: true","---
- name: ""Create S3 bucket""
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    debug_botocore_endpoint_logs: false",[[6]]
101,c3e073c1-f65e-4d18-bd67-4a8f20ad1ab9,S3 Bucket With Public Access,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_with_public_access,Unknown,"S3 Bucket allows public access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/aws_s3_module.html#parameter-permission)","- name: Create an empty bucket
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: private
- name: Create an empty bucket 02
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create","---
- name: Create an empty bucket
  amazon.aws.aws_s3:
    bucket: mybucket
    mode: create
    permission: public-read
- name: Create an empty bucket 01
  amazon.aws.aws_s3:
    bucket: mybucket 01
    mode: create
    permission: public-read-write","[[11, 6]]"
102,d0c13053-d2c8-44a6-95da-d592996e9e67,CloudFront Without Minimum Protocol TLS 1.2,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudfront_without_minimum_protocol_tls_1.2,Unknown,"CloudFront Minimum Protocol version should be at least TLS 1.2<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html#parameter-viewer_certificate/minimum_protocol_version)","- name: create a distribution with an origin and logging
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    viewer_certificate:
      minimum_protocol_version: TLSv1.2_2018
    comment: this is a CloudFront distribution with logging","- name: create a distribution with an origin and logging
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    viewer_certificate:
      minimum_protocol_version: TLSv1
    comment: this is a CloudFront distribution with logging
- name: create another distribution with an origin and logging
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    viewer_certificate:
      minimum_protocol_version: TLSv1.1_2016
    comment: this is a CloudFront distribution with logging
- name: create a third distribution
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    comment: this is a CloudFront distribution with logging","[[40, 18, 37]]"
103,d31cb911-bf5b-4eb6-9fc3-16780c77c7bd,CloudFront Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudfront_logging_disabled,Unknown,"AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' should be defined with 'enabled' set to true<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: create a distribution with an origin, logging and default cache behavior
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
    - id: my test origin-000111
      domain_name: www.example.com
      origin_path: /production
      custom_headers:
      - header_name: MyCustomHeaderName
        header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: my test origin-000111
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
        - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
        - GET
        - HEAD
        cached_methods:
        - GET
        - HEAD
    logging:
      enabled: true
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    enabled: false
    comment: this is a CloudFront distribution with logging","- name: create a distribution with an origin, logging and default cache behavior
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD
    enabled: false
    comment: this is a CloudFront distribution with logging
- name: create a second distribution with an origin, logging and default cache behavior
  community.aws.cloudfront_distribution:
    state: present
    caller_reference: unique test distribution ID
    origins:
      - id: 'my test origin-000111'
        domain_name: www.example.com
        origin_path: /production
        custom_headers:
          - header_name: MyCustomHeaderName
            header_value: MyCustomHeaderValue
    default_cache_behavior:
      target_origin_id: 'my test origin-000111'
      forwarded_values:
        query_string: true
        cookies:
          forward: all
        headers:
          - '*'
      viewer_protocol_policy: allow-all
      smooth_streaming: true
      compress: true
      allowed_methods:
        items:
          - GET
          - HEAD
        cached_methods:
          - GET
          - HEAD
    logging:
      enabled: false
      include_cookies: false
      bucket: mylogbucket.s3.amazonaws.com
      prefix: myprefix/
    enabled: false
    comment: this is a CloudFront distribution with logging","[[2, 62]]"
104,d395a950-12ce-4314-a742-ac5a785ab44e,S3 Bucket Allows List Action From All Principals,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/s3_bucket_allows_list_action_from_all_principals,Unknown,"S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/s3_bucket_module.html)","#this code is a correct code for which the query should not find any result
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: '2020-10-07'
      Statement:
      - Effect: Allow
        Action: ListObject
        Principal: NotAll","#this is a problematic code where the query should report a result(s)
- name: Bucket
  amazon.aws.s3_bucket:
    name: mys3bucket
    state: present
    policy:
      Version: ""2020-10-07""
      Statement:
      - Effect: Allow
        Action: ListObject
        Principal: ""*""",[[6]]
105,d39761d7-94ab-45b0-ab5e-27c44e381d58,Stack Notifications Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/stack_notifications_disabled,Unknown,"AWS CloudFormation should have stack notifications enabled to be notified when an event occurs<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/cloudformation_module.html#parameter-notification_arns)","- name: create a stack, pass in the template via an URL
  amazon.aws.cloudformation:
    stack_name: ansible-cloudformation
    stack_policy: wowowowoowow
    notification_arns: a, b
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation","- name: create a stack, pass in the template via an URL
  amazon.aws.cloudformation:
    stack_name: ""ansible-cloudformation""
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation",[[2]]
106,d4a73c49-cbaa-4c6f-80ee-d6ef5a3a26f5,CloudTrail Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_logging_disabled,Unknown,"Checks if logging is enabled for CloudTrail.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html#parameter-enable_logging)","- name: example
  community.aws.cloudtrail:
    state: present
    name: default
    enable_logging: true","- name: example
  community.aws.cloudtrail:
    state: present
    name: default
    enable_logging: false",[[5]]
107,d5ec2080-340a-4259-b885-f833c4ea6a31,Certificate RSA Key Bytes Lower Than 256,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/certificate_rsa_key_bytes_lower_than_256,Unknown,"The certificate should use a RSA key with a length equal to or higher than 256 bytes<br>
[Documentation](https://docs.ansible.com/ansible/2.10/collections/community/aws/aws_acm_module.html)","- name: upload a self-signed certificate2
  community.aws.aws_acm:
    certificate: ""{{ lookup('file', 'rsa4096.pem' ) }}""
    privateKey: ""{{ lookup('file', 'key.pem' ) }}""
    name_tag: my_cert
    region: ap-southeast-2","- name: upload a self-signed certificate
  community.aws.aws_acm:
    certificate: ""{{ lookup('file', 'rsa1024.pem' ) }}""
    privateKey: ""{{ lookup('file', 'key.pem' ) }}""
    name_tag: my_cert
    region: ap-southeast-2",[[3]]
108,d6c2d06f-43c1-488a-9ba1-8d75b40fc62d,Elasticsearch with HTTPS disabled,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/elasticsearch_with_https_disabled,Unknown,"Amazon Elasticsearch does not have encryption for its domains enabled. To prevent such a scenario, update the attribute 'EnforceHTTPS' to true.<br>
[Documentation](https://docs.ansible.com/ansible/devel/collections/community/aws/opensearch_module.html)","- name: Create OpenSearch domain with dedicated masters
  community.aws.opensearch:
    domain_name: ""my-domain""
    engine_version: OpenSearch_1.1
    cluster_config:
      instance_type: ""t2.small.search""
      instance_count: 12
      dedicated_master: true
      zone_awareness: true
      availability_zone_count: 2
      dedicated_master_instance_type: ""t2.small.search""
      dedicated_master_instance_count: 3
      warm_enabled: true
      warm_type: ""ultrawarm1.medium.search""
      warm_count: 1
      cold_storage_options:
        enabled: false
    domain_endpoint_options:
      enforce_https: true
    ebs_options:
      ebs_enabled: true
      volume_type: ""io1""
      volume_size: 10
      iops: 1000
    vpc_options:
      subnets:
        - ""subnet-e537d64a""
        - ""subnet-e537d64b""
      security_groups:
        - ""sg-dd2f13cb""
        - ""sg-dd2f13cc""
    snapshot_options:
      automated_snapshot_start_hour: 13
    access_policies: ""{{ lookup('file', 'policy.json') | from_json }}""
    encryption_at_rest_options:
      enabled: false
    node_to_node_encryption_options:
      enabled: false
    tags:
      Environment: Development
      Application: Search
    wait: true","- name: Create OpenSearch domain for dev environment, no zone awareness, no dedicated masters
  community.aws.opensearch:
    domain_name: ""dev-cluster""
    engine_version: Elasticsearch_1.1
    cluster_config:
      instance_type: ""t2.small.search""
      instance_count: 2
      zone_awareness: false
      dedicated_master: false
    domain_endpoint_options:
      enforce_https: false
    ebs_options:
      ebs_enabled: true
      volume_type: ""gp2""
      volume_size: 10
    access_policies: ""{{ lookup('file', 'policy.json') | from_json }}""

- name: Create OpenSearch domain for dev environment, no zone awareness, no dedicated masters
  community.aws.opensearch:
    domain_name: ""dev-cluster""
    engine_version: Elasticsearch_1.1
    cluster_config:
      instance_type: ""t2.small.search""
      instance_count: 2
      zone_awareness: false
      dedicated_master: false
    domain_endpoint_options:
      custom_endpoint_enabled: false
    ebs_options:
      ebs_enabled: true
      volume_type: ""gp2""
      volume_size: 10
    access_policies: ""{{ lookup('file', 'policy.json') | from_json }}""

- name: Create OpenSearch domain for dev environment, no zone awareness, no dedicated masters
  community.aws.opensearch:
    domain_name: ""dev-cluster""
    engine_version: Elasticsearch_1.1
    cluster_config:
      instance_type: ""t2.small.search""
      instance_count: 2
      zone_awareness: false
      dedicated_master: false
    ebs_options:
      ebs_enabled: true
      volume_type: ""gp2""
      volume_size: 10
    access_policies: ""{{ lookup('file', 'policy.json') | from_json }}""","[[11], [10], [2]]"
109,d994585f-defb-4b51-b6d2-c70f020ceb10,SQS Policy With Public Access,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sqs_policy_with_public_access,Unknown,"Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/sqs_queue_module.html)","- name: First SQS queue with policy
  community.aws.sqs_queue:
    name: my-queue1
    region: ap-southeast-1
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: sqs:*
        Resource: '*'
        Principal: Principal
    make_default: false
    state: present","- name: First SQS queue with policy
  community.aws.sqs_queue:
    name: my-queue1
    region: ap-southeast-1
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""sqs:*""
        Resource: ""*""
        Principal: ""*""
    make_default: false
    state: present
- name: Second SQS queue with policy
  community.aws.sqs_queue:
    name: my-queue2
    region: ap-southeast-3
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""*""
        Resource: ""*""
        Principal:
          AWS: ""*""
    make_default: false
    state: present","[[10, 28]]"
110,defe5b18-978d-4722-9325-4d1975d3699f,Batch Job Definition With Privileged Container Properties,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/batch_job_definition_with_privileged_container_properties,Unknown,"Batch Job Definition should not have Privileged Container Properties<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/aws_batch_job_definition_module.html)","- name: My Batch Job Definition
  community.aws.aws_batch_job_definition:
    job_definition_name: My Batch Job Definition without privilege
    state: present
    type: container
    parameters:
      Param1: Val1
      Param2: Val2
    privileged: false
    image: <Docker Image URL>
    vcpus: 1
    memory: 512
    command:
      - python
      - run_my_script.py
      - arg1
    job_role_arn: <Job Role ARN>
    attempts: 3
  register: job_definition_create_result
- name: My Batch Job Definition without explicit privilege
  community.aws.aws_batch_job_definition:
    job_definition_name: My Batch Job Definition
    state: present
    type: container
    parameters:
      Param1: Val1
      Param2: Val2
    image: <Docker Image URL>
    vcpus: 1
    memory: 512
    command:
      - python
      - run_my_script.py
      - arg1
    job_role_arn: <Job Role ARN>
    attempts: 3
  register: job_definition_create_result","- name: My Batch Job Definition
  community.aws.aws_batch_job_definition:
    job_definition_name: My Batch Job Definition
    state: present
    type: container
    parameters:
      Param1: Val1
      Param2: Val2
    privileged: true
    image: <Docker Image URL>
    vcpus: 1
    memory: 512
    command:
      - python
      - run_my_script.py
      - arg1
    job_role_arn: <Job Role ARN>
    attempts: 3
  register: job_definition_create_result",[[9]]
111,e01de151-a7bd-4db4-b49b-3c4775a5e881,Redshift Using Default Port,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/redshift_using_default_port,Unknown,"Redshift should not use the default port (5439) because an attacker can easily guess the port<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/redshift_module.html#parameter-port)","- name: Redshift2
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    port: 1150","- name: Redshift
  community.aws.redshift:
    command: create
    node_type: ds1.xlarge
    identifier: new_cluster
    username: cluster_admin
    password: 1nsecur3
    port: 5439",[[8]]
112,e1e7b278-2a8b-49bd-a26e-66a7f70b17eb,SQS With SSE Disabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sqs_with_sse_disabled,Unknown,"Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/sqs_queue_module.html#ansible-collections-community-aws-sqs-queue-module)","- name: Configure Encryption, automatically uses a new data key every hour
  community.aws.sqs_queue:
    name: fifo-queue
    region: ap-southeast-2
    kms_master_key_id: alias/MyQueueKey
    kms_data_key_reuse_period_seconds: 3600

- name: Delete SQS queue
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    state: absent","- name: Create SQS queue with redrive policy
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy: ""{{ json_dict }}""
    redrive_policy:
      maxReceiveCount: 5
      deadLetterTargetArn: arn:aws:sqs:eu-west-1:123456789012:my-dead-queue

- name: Drop redrive policy
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    redrive_policy: {}

- name: Create FIFO queue
  community.aws.sqs_queue:
    name: fifo-queue
    region: ap-southeast-2
    queue_type: fifo
    content_based_deduplication: yes

- name: Tag queue
  community.aws.sqs_queue:
    name: fifo-queue
    region: ap-southeast-2
    tags:
      example: SomeValue","[[16, 2, 29, 22]]"
113,e24e18d9-4c2b-4649-b3d0-18c088145e24,CloudWatch Without Retention Period Specified,Ansible,Info,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudwatch_without_retention_period_specified,Unknown,"AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudwatchlogs_log_group_module.html)","- name: example3 ec2 group
  community.aws.cloudwatchlogs_log_group:
    log_group_name: test-log-group
    retention: 5","- name: example ec2 group
  community.aws.cloudwatchlogs_log_group:
    log_group_name: test-log-group
- name: example2 ec2 group
  community.aws.cloudwatchlogs_log_group:
    log_group_name: test-log-group
    retention: 111111","[[2, 7]]"
114,e28ceb92-d588-4166-aac5-766c8f5b7472,AWS Password Policy With Unchangeable Passwords,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/620.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/aws_password_policy_with_unchangeable_passwords,Unknown,"Unchangeable passwords in AWS password policy<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_password_policy_module.html)","- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: true
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false","- name: Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_pw_change: false
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false
- name: Alias Password policy for AWS account
  community.aws.iam_password_policy:
    state: present
    min_pw_length: 8
    require_symbols: false
    require_numbers: true
    require_uppercase: true
    require_lowercase: true
    allow_password_change: false
    pw_max_age: 60
    pw_reuse_prevent: 5
    pw_expire: false","[[9, 21]]"
115,e401d614-8026-4f4b-9af9-75d1197461ba,IAM Policies With Full Privileges,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_policies_with_full_privileges,Unknown,"IAM policies shouldn't allow full administrative privileges (for all resources)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_managed_policy_module.html)","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ManagedPolicy
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: logs:CreateLogGroup
        Resource: '*'
    make_default: false
    state: present","- name: Create IAM Managed Policy
  community.aws.iam_managed_policy:
    policy_name: ""ManagedPolicy""
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: [""*""]
        Resource: ""*""
    make_default: false
    state: present",[[4]]
116,e69890e6-fce5-461d-98ad-cb98318dfc96,RDS With Backup Disabled,Ansible,Medium,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/rds_with_backup_disabled,Unknown,"Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/rds_instance_module.html#parameter-backup_retention_period)","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 5
- name: create minimal aurora instance in default VPC and default subnet group2
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: '{{ password }}'
    username: '{{ username }}'
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it","---
- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster  # This cluster must exist - see rds_cluster to manage it
    backup_retention_period: 0",[[10]]
117,e71d0bc7-d9e8-4e6e-ae90-0a4206db6f40,Root Account Has Active Access Keys,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/root_account_has_active_access_keys,Unknown,"The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_module.html)","#this code is a correct code for which the query should not find any result
- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: '{{ root }}'
    state: present
    password: '{{ temp_pass }}'
    access_key_state: inactive
  loop:
  - jcleese
  - mpython","#this is a problematic code where the query should report a result(s)
- name: Create two new IAM users with API keys
  community.aws.iam:
    iam_type: user
    name: ""{{ root }}""
    state: present
    password: ""{{ temp_pass }}""
    access_key_state: active
  loop:
    - jcleese
    - mpython",[[3]]
118,ea0ed1c7-9aef-4464-b7c7-94c762da3640,DB Security Group Open To Large Scope,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/db_security_group_open_to_large_scope,Unknown,"The IP address in a DB Security Group must not have more than 256 hosts.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html#ansible-collections-amazon-aws-ec2-group-module)","- name: example ec2 group2
  ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 10.1.1.1/32","- name: create minimal aurora instance in default VPC and default subnet group
  community.aws.rds_instance:
    engine: aurora
    db_instance_identifier: ansible-test-aurora-db-instance
    instance_type: db.t2.small
    password: ""{{ password }}""
    username: ""{{ username }}""
    cluster_id: ansible-test-cluster
    db_security_groups: [""example""]
- name: example ec2 group
  ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1a
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 80
        to_port: 80
        cidr_ip: 0.0.0.0/0
      - proto: tcp
        from_port: 22
        to_port: 22
        cidr_ip: 10.0.0.0/8
      - proto: tcp
        from_port: 443
        to_port: 443
        group_id: amazon-elb/sg-87654321/amazon-elb-sg
      - proto: tcp
        from_port: 3306
        to_port: 3306
        group_id: 123412341234/sg-87654321/exact-name-of-sg
      - proto: udp
        from_port: 10050
        to_port: 10050
        cidr_ip: 10.0.0.0/8
      - proto: udp
        from_port: 10051
        to_port: 10051
        group_id: sg-12345678
      - proto: icmp
        from_port: 8 # icmp type, -1 = any type
        to_port: -1 # icmp subtype, -1 = any subtype
        cidr_ip: 192.168.1.0/24
      - proto: all
        # the containing group name may be specified here
        group_name: example",[[22]]
119,ea6bc7a6-d696-4dcf-a788-17fa03c17c81,Security Group Ingress Not Restricted,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/security_group_ingress_not_restricted,Unknown,"AWS Security Group should restrict ingress access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html)","- name: example ec2 group v3
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ip: 10.0.0.0/8
- name: example ec2 group v4
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
    - proto: tcp
      from_port: 80
      to_port: 80
      cidr_ipv6: 2001:DB8:8086:6502::/32","- name: example ec2 group
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: -1
        from_port: 0
        to_port: 0
        cidr_ip: 0.0.0.0/0
      - proto: all
        from_port: 0
        to_port: 0
        cidr_ip: 0.0.0.0/0
      - proto: 12121
        from_port: 0
        to_port: 0
        cidr_ip: 0.0.0.0/0
- name: example ec2 group v2
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    rules:
      - proto: -1
        from_port: 0
        to_port: 0
        cidr_ipv6: ::/0
      - proto: all
        from_port: 0
        to_port: 0
        cidr_ipv6: ::/0
      - proto: 121212
        from_port: 0
        to_port: 0
        cidr_ipv6: ::/0","[[26, 7]]"
120,eafe4bc3-1042-4f88-b988-1939e64bf060,IAM Policies Attached To User,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_policies_attached_to_user,Unknown,"IAM policies should be attached only to groups or roles<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_policy_module.html)","- name: Assign a policy called Admin to the administrators group
  community.aws.iam_policy:
    iam_type: group
    iam_name: administrators
    policy_name: Admin
    state: present
    policy_document: admin_policy.json","- name: Assign a policy called Admin to user
  community.aws.iam_policy:
    iam_type: user
    iam_name: administrators
    policy_name: Admin
    state: present
    policy_document: admin_policy.json",[[3]]
121,ebb2118a-03bc-4d53-ab43-d8750f5cb8d3,CloudTrail Not Integrated With CloudWatch,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_not_integrated_with_cloudwatch,Unknown,"CloudTrail should be integrated with CloudWatch<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html)","- name: create multi-region trail with validation and tags negative
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default","- name: positive1
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default
- name: positive2
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: ""arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role""
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default
- name: positive3
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_log_group_arn: ""arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*""
    kms_key_id: ""alias/MyAliasName""
    tags:
      environment: dev
      Name: default","[[2, 27, 14]]"
122,ed9b3beb-92cf-44d9-a9d2-171eeba569d4,SQS Policy Allows All Actions,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/sqs_policy_allows_all_actions,Unknown,"SQS policy allows ALL (*) actions<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/sqs_queue_module.html)","- name: Create SQS queue with redrive policy
  community.aws.sqs_queue:
    name: my-queue
    region: ap-southeast-2
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: '2012-10-17'
      Statement:
      - Effect: Allow
        Action: logs:CreateLogGroup
        Resource: '*'
    make_default: false
    state: present","- name: Second SQS queue with policy
  community.aws.sqs_queue:
    name: my-queue2
    region: ap-southeast-3
    default_visibility_timeout: 120
    message_retention_period: 86400
    maximum_message_size: 1024
    delivery_delay: 30
    receive_message_wait_time: 20
    policy:
      Version: ""2012-10-17""
      Statement:
      - Effect: ""Allow""
        Action: ""aws:action""
        Resource: ""*""
      - Effect: ""Allow""
        Action: ""*""
        Resource: ""*""
    make_default: false
    state: present",[[10]]
123,eda7301d-1f3e-47cf-8d4e-976debc64341,Remote Desktop Port Open To Internet,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/remote_desktop_port_open,Unknown,"The Remote Desktop port is open to the internet in a Security Group<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/ec2_group_module.html#ansible-collections-amazon-aws-ec2-group-module)","- name: example ec2 group1
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 3380
      to_port: 3450
      cidr_ip: 0.0.0.0/1

- name: example ec2 group2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports: 3389
      cidr_ip: 0.0.1.0/0

- name: example ec2 group3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports: 3380-3450
      cidr_ip: 0.1.0.0/0

- name: example ec2 group4
  amazon.aws.ec2_group:
    name: example4
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports:
      - 80
      - 3380-3450
      cidr_ip: 10.0.0.0/0

- name: example ec2 group5
  amazon.aws.ec2_group:
    name: example5
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      ports:
      - 3389
      - 10-50
      cidr_ip: 10.0.0.0/0

- name: example ec2 group6
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: -1
      to_port: 25
      cidr_ip: 0.1.0.0/0

- name: example ec2 group7
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
    - proto: tcp
      from_port: 15
      to_port: -1
      cidr_ip: 0.0.0.1/0","- name: example ec2 group1
  amazon.aws.ec2_group:
    name: example
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 3380
        to_port: 3450
        cidr_ip: 0.0.0.0/0

- name: example ec2 group2
  amazon.aws.ec2_group:
    name: example2
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports: 3389
        cidr_ip: 0.0.0.0/0

- name: example ec2 group3
  amazon.aws.ec2_group:
    name: example3
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports: 3380-3450
        cidr_ip: 0.0.0.0/0

- name: example ec2 group4
  amazon.aws.ec2_group:
    name: example4
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports:
          - 80
          - 3380-3450
        cidr_ip: 0.0.0.0/0

- name: example ec2 group5
  amazon.aws.ec2_group:
    name: example5
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        ports:
          - 3389
          - 10-50
        cidr_ip: 0.0.0.0/0

- name: example ec2 group6
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: -1
        to_port: 25
        cidr_ip: 0.0.0.0/0

- name: example ec2 group7
  amazon.aws.ec2_group:
    name: example1
    description: an example EC2 group
    vpc_id: 12345
    region: eu-west-1
    aws_secret_key: SECRET
    aws_access_key: ACCESS
    rules:
      - proto: tcp
        from_port: 15
        to_port: -1
        cidr_ip: 0.0.0.0/0","[[64, 36, 9, 79, 49, 23, 93]]"
124,eee107f9-b3d8-45d3-b9c6-43b5a7263ce1,Authentication Without MFA,Ansible,Low,Access Control,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/authentication_without_mfa,Unknown,"Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_mfa_device_info_module.html)","- name: Assume an existing role
  community.aws.sts_assume_role:
    mfa_serial_number: '{{ mfa_devices.mfa_devices[0].serial_number }}'
    mfa_token: weewew
    role_arn: arn:aws:iam::123456789012:role/someRole
    role_session_name: someRoleSession
  register: assumed_role

- name: Hello
  sts_assume_role:
    mfa_serial_number: '{{ mfa_devices.mfa_devices[0].serial_number }}'
    mfa_token: weewew
    role_arn: arn:aws:iam::123456789012:role/someRole
    role_session_name: someRoleSession
  register: assumed_role","- name: Assume an existing role
  community.aws.sts_assume_role:
    mfa_serial_number: ""{{ mfa_devices.mfa_devices[0].serial_number }}""
    role_arn: ""arn:aws:iam::123456789012:role/someRole""
    role_session_name: ""someRoleSession""
  register: assumed_role

- name: Hello
  sts_assume_role:
    role_arn: ""arn:aws:iam::123456789012:role/someRole""
    role_session_name: ""someRoleSession""
  register: assumed_role","[[9, 2]]"
125,f2ea6481-1d31-4d40-946a-520dc6321dd7,Kinesis Not Encrypted With KMS,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/kinesis_not_encrypted_with_kms,Unknown,"AWS Kinesis Streams and metadata should be protected with KMS<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/kinesis_stream_module.html)","- name: Encrypt Kinesis Stream test-stream. v6
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_state: enabled
    encryption_type: KMS
    key_id: alias/aws/kinesis
    wait: yes
    wait_timeout: 600","- name: Encrypt Kinesis Stream test-stream.
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_type: KMS
    key_id: alias/aws/kinesis
    wait: yes
    wait_timeout: 600
  register: test_stream
- name: Encrypt Kinesis Stream test-stream. v2
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_state: disabled
    encryption_type: KMS
    key_id: alias/aws/kinesis
    wait: yes
    wait_timeout: 600
  register: test_stream
- name: Encrypt Kinesis Stream test-stream. v3
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_state: enabled
    key_id: alias/aws/kinesis
    wait: yes
    wait_timeout: 600
  register: test_stream
- name: Encrypt Kinesis Stream test-stream. v4
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_state: enabled
    encryption_type: NONE
    key_id: alias/aws/kinesis
    wait: yes
    wait_timeout: 600
  register: test_stream
- name: Encrypt Kinesis Stream test-stream. v5
  community.aws.kinesis_stream:
    name: test-stream
    state: present
    shards: 1
    encryption_state: enabled
    encryption_type: KMS
    wait: yes
    wait_timeout: 600
  register: test_stream","[[2, 38, 44, 16, 23]]"
126,f34508b9-f574-4330-b42d-88c44cced645,Hardcoded AWS Access Key In Lambda,Ansible,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/hardcoded_aws_access_key_in_lambda,Unknown,"Lambda access/secret keys should not be hardcoded<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_module.html)","- name: looped creation
  community.aws.lambda:
    name: '{{ item.name }}'
    state: present
    zip_file: '{{ item.zip_file }}'
    runtime: python2.7
    role: arn:aws:iam::987654321012:role/lambda_basic_execution
    handler: hello_python.my_handler
    vpc_subnet_ids:
    - subnet-123abcde
    - subnet-edcba321
    vpc_security_group_ids:
    - sg-123abcde
    - sg-edcba321
    environment_variables: '{{ item.env_vars }}'
    tags:
      key1: value1
  loop:
  - name: HelloWorld
    zip_file: hello-code.zip
    env_vars:
      key1: first
      key2: second
  - name: ByeBye
    zip_file: bye-code.zip
    env_vars:
      key1: '1'
      key2: '2'
- name: remove tags
  community.aws.lambda:
    name: Lambda function
    state: present
    zip_file: code.zip
    runtime: python2.7
    role: arn:aws:iam::987654321012:role/lambda_basic_execution
    handler: hello_python.my_handler
    tags: {}

- name: Delete Lambda functions HelloWorld and ByeBye
  community.aws.lambda:
    name: '{{ item }}'
    state: absent
  loop:
  - HelloWorld
  - ByeBye","- name: looped creation
  community.aws.lambda:
    aws_access_key: 'wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY'
    name: '{{ item.name }}'
    state: present
    zip_file: '{{ item.zip_file }}'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'
    vpc_subnet_ids:
    - subnet-123abcde
    - subnet-edcba321
    vpc_security_group_ids:
    - sg-123abcde
    - sg-edcba321
    environment_variables: '{{ item.env_vars }}'
    tags:
      key1: 'value1'
  loop:
  - name: HelloWorld
    zip_file: hello-code.zip
    env_vars:
      key1: ""first""
      key2: ""second""
  - name: ByeBye
    zip_file: bye-code.zip
    env_vars:
      key1: ""1""
      key2: ""2""
- name: remove tags
  community.aws.lambda:
    aws_access_key: 'wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY'
    name: 'Lambda function'
    state: present
    zip_file: 'code.zip'
    runtime: 'python2.7'
    role: 'arn:aws:iam::987654321012:role/lambda_basic_execution'
    handler: 'hello_python.my_handler'
    tags: {}

- name: Delete Lambda functions HelloWorld and ByeBye
  community.aws.lambda:
    name: '{{ item }}'
    state: absent
  loop:
  - HelloWorld
  - ByeBye","[[32, 3]]"
127,f509931b-bbb0-443c-bd9b-10e92ecf2193,IAM Group Without Users,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/iam_group_without_users,Unknown,"IAM Group should have at least one user associated<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/iam_group_module.html)","- name: Group3
  iam_group:
    name: testgroup2
    managed_policy:
      - arn:aws:iam::aws:policy/AmazonSNSFullAccess
    users:
      - test_user1
      - test_user2
    state: present","- name: Group1
  iam_group:
    name: testgroup1
    state: present

- name: Group2
  iam_group:
    name: testgroup2
    managed_policy:
      - arn:aws:iam::aws:policy/AmazonSNSFullAccess
    users:
    state: present","[[2], [2]]"
128,f5587077-3f57-4370-9b4e-4eb5b1bac85b,CloudTrail Log Files Not Encrypted With KMS,Ansible,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/cloudtrail_log_files_not_encrypted_with_kms,Unknown,"Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudtrail_module.html)","- name: create multi-region trail with validation and tags v2
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    region: us-east-1
    is_multi_region_trail: true
    enable_log_file_validation: true
    cloudwatch_logs_role_arn: arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role
    cloudwatch_logs_log_group_arn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*
    kms_key_id: alias/MyAliasName
    tags:
      environment: dev
      Name: default","- name: no sns topic name
  community.aws.cloudtrail:
    state: present
    name: default
    s3_bucket_name: mylogbucket
    s3_key_prefix: cloudtrail
    region: us-east-1",[[2]]
129,f5c45127-1d28-4b49-a692-0b97da1c3a84,ECS Service Without Running Tasks,Ansible,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecs_service_without_running_tasks,Unknown,"ECS Service should have at least 1 task running<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_service_module.html#ansible-collections-community-aws-ecs-service-module)","- name: ECS Service
  community.aws.ecs_service:
    state: present
    name: test-service
    cluster: test-cluster
    task_definition: test-task-definition
    desired_count: 3
    deployment_configuration:
      minimum_healthy_percent: 75
      maximum_percent: 150
    placement_constraints:
      - type: memberOf
        expression: 'attribute:flavor==test'
    placement_strategy:
      - type: binpack
        field: memory","- name: ECS Service
  community.aws.ecs_service:
    state: present
    name: test-service
    cluster: test-cluster
    task_definition: test-task-definition
    desired_count: 3
    placement_constraints:
      - type: memberOf
        expression: 'attribute:flavor==test'
    placement_strategy:
      - type: binpack
        field: memory",[[2]]
130,f5f38943-664b-4acc-ab11-f292fa10ed0b,API Gateway without WAF,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/api_gateway_without_waf,Unknown,"API Gateway should have WAF (Web Application Firewall) enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/wafv2_resources_module.html#parameter-arn)","- name: add test alb to waf string03
  community.aws.wafv2_resources:
    name: string03
    scope: REGIONAL
    state: present
    arn: ""arn:aws:apigateway:region::/restapis/api-id/stages/produ""
- name: Setup AWS API Gateway setup on AWS and deploy API definition
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: produ
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present","- name: add test alb to waf string032
  community.aws.wafv2_resources:
    name: string03
    scope: REGIONAL
    state: present
    arn: ""arn:aws:apigateway:region::/restapis/api-id/stages/prod""
- name: Setup AWS API Gateway setup on AWS and deploy API definition2
  community.aws.aws_api_gateway:
    swagger_file: my_api.yml
    stage: production
    cache_enabled: true
    cache_size: '1.6'
    tracing_enabled: true
    endpoint_type: EDGE
    state: present",[[8]]
131,f81d63d2-c5d7-43a4-a5b5-66717a41c895,ALB Listening on HTTP,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/alb_listening_on_http,Unknown,"AWS Application Load Balancer (alb) should not listen on HTTP<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/elb_application_lb_module.html)","- name: my_elb_application
  community.aws.elb_application_lb:
    name: myelb
    security_groups:
    - sg-12345678
    - my-sec-group
    subnets:
    - subnet-012345678
    - subnet-abcdef000
    listeners:
    - Protocol: HTTPS
      Port: 80
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:
      - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
      - Type: forward
        TargetGroupName: targetname
    state: present
    # trigger validation","- name: my_elb_application
  community.aws.elb_application_lb:
    name: myelb
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      - Protocol: HTTP
        Port: 80
        SslPolicy: ELBSecurityPolicy-2015-05
        Certificates:
          - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
        DefaultActions:
          - Type: forward
            TargetGroupName: targetname
    state: present
- name: my_elb_application2
  community.aws.elb_application_lb:
    name: myelb2
    security_groups:
      - sg-12345678
      - my-sec-group
    subnets:
      - subnet-012345678
      - subnet-abcdef000
    listeners:
      Port: 80
      SslPolicy: ELBSecurityPolicy-2015-05
      Certificates:
        - CertificateArn: arn:aws:iam::12345678987:server-certificate/test.domain.com
      DefaultActions:
        - Type: forward
          TargetGroupName: targetname
    state: present","[[11, 29]]"
132,fb5a5df7-6d74-4243-ab82-ff779a958bfd,ECR Repository Is Publicly Accessible,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecr_repository_is_publicly_accessible,Unknown,"Amazon ECR image repositories shouldn't have public access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_ecr_module.html#parameter-policy)","- name: set-policy as object
  community.aws.ecs_ecr:
    name: needs-policy-object
    policy:
      Version: '2008-10-17'
      Statement:
      - Sid: read-only
        Effect: Allow
        Action:
        - ecr:GetDownloadUrlForLayer
        - ecr:BatchGetImage
        - ecr:BatchCheckLayerAvailability","- name: set-policy as object
  community.aws.ecs_ecr:
    name: needs-policy-object
    policy:
      Version: '2008-10-17'
      Statement:
        - Sid: read-only
          Effect: Allow
          Principal: '*'
          Action:
            - ecr:GetDownloadUrlForLayer
            - ecr:BatchGetImage
            - ecr:BatchCheckLayerAvailability
- name: set-policy as string
  community.aws.ecs_ecr:
    name: needs-policy-string
    policy: >
        {
          ""Id"": ""id113"",
          ""Version"": ""2012-10-17"",
          ""Statement"": [
            {
              ""Action"": [
                ""s3:put""
              ],
              ""Effect"": ""Allow"",
              ""Resource"": ""arn:aws:s3:::S3B_181355/*"",
              ""Principal"": ""*""
            }
          ]
        }","[[17, 4]]"
133,fb8f8929-afeb-4c46-99f0-a6cf410f7df4,Vulnerable Default SSL Certificate,Ansible,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/vulnerable_default_ssl_certificate,Unknown,"CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/cloudfront_distribution_module.html)","- name: create a basic distribution with defaults, tags and custom SSL certificate
  community.aws.cloudfront_distribution:
    state: present
    default_origin_domain_name: www.my-cloudfront-origin.com
    viewer_certificate:
      acm_certificate_arn: arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-123456789012
      ssl_support_method: sni-only
      minimum_protocol_version: TLS1.2_2018
    tags:
      Name: example distribution
      Project: example project
      Priority: '1'","- name: create a basic distribution with defaults, tags and default SSL certificate
  community.aws.cloudfront_distribution:
    state: present
    default_origin_domain_name: www.my-cloudfront-origin.com
    viewer_certificate:
      cloudfront_default_certificate: true
    tags:
      Name: example distribution
      Project: example project
      Priority: '1'
- name: create a basic distribution with defaults, tags and misconfigured custom SSL certificate
  community.aws.cloudfront_distribution:
    state: present
    default_origin_domain_name: www.my-cloudfront-origin.com
    viewer_certificate:
      acm_certificate_arn: arn:aws:acm:region:123456789012:certificate/12345678-1234-1234-1234-123456789012
    tags:
      Name: example distribution
      Project: example project
      Priority: '1'","[[6, 15]]"
134,ffe0fd52-7a8b-4a5c-8fc7-49844418e6c9,No Stack Policy,Ansible,Medium,Resource Management,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/no_stack_policy,Unknown,"AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/amazon/aws/cloudformation_module.html)","- name: create a stack, pass in the template via an URL
  amazon.aws.cloudformation:
    stack_name: ansible-cloudformation
    stack_policy: wowowowoowow
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation","- name: create a stack, pass in the template via an URL
  amazon.aws.cloudformation:
    stack_name: ""ansible-cloudformation""
    state: present
    region: us-east-1
    disable_rollback: true
    template_url: https://s3.amazonaws.com/my-bucket/cloudformation.template
    template_parameters:
      KeyName: jmartin
      DiskType: ephemeral
      InstanceType: m1.small
      ClusterSize: 3
    tags:
      Stack: ansible-cloudformation",[[2]]
135,0461b4fd-21ef-4687-929e-484ee4796785,Log Retention Is Not Set,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/log_retention_is_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: Update PostgreSQL Server setting
  azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_retention
    value: on","---
- name: Update PostgreSQL Server setting
  azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_retention
    value: off",[[7]]
136,054d07b5-941b-4c28-8eef-18989dc62323,PostgreSQL Log Disconnections Not Set,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/postgresql_log_disconnections_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: on
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: On
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: ON
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: on
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: On
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: ON","---
- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: off
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: Off
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: OFF
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: ""off""
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: ""Off""
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_disconnections
    value: ""OFF""","[[37, 7, 13, 19, 25, 31]]"
137,0632d0db-9190-450a-8bb3-c283bffea445,Redis Publicly Accessible,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/redis_publicly_accessible,Unknown,"Firewall rule allowing unrestricted access to Redis from other Azure sources<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_rediscachefirewallrule_module.html#parameter-start_ip_address)","- name: Create a Firewall rule for Azure Cache for Redis
  azure_rm_rediscachefirewallrule:
    resource_group: myResourceGroup
    cache_name: myRedisCache
    name: myRule
    start_ip_address: 192.168.1.1
    end_ip_address: 192.168.1.4","---
- name: Create a Firewall rule for Azure Cache for Redis
  azure_rm_rediscachefirewallrule:
      resource_group: myResourceGroup
      cache_name: myRedisCache
      name: myRule
      start_ip_address: 1.2.3.4
      end_ip_address: 2.3.4.5",[[7]]
138,0ac9abbc-6d7a-41cf-af23-2e57ddb3dbfc,Sensitive Port Is Exposed To Entire Network,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/sensitive_port_is_exposed_to_entire_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_securitygroup_module.html#parameter-rules)","- name: foo1
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example1
      priority: 100
      direction: Inbound
      access: Deny
      protocol: TCP
      source_port_range: '*'
      destination_port_range: 23
      source_address_prefix: '*'
      destination_address_prefix: '*'
- name: foo2
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example2
      priority: 100
      direction: Inbound
      access: Allow
      protocol: Icmp
      source_port_range: '*'
      destination_port_range: 23-24
      source_address_prefix: '*'
      destination_address_prefix: '*'
- name: foo3
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example3
      priority: 100
      direction: Inbound
      access: Allow
      protocol: TCP
      source_port_range: '*'
      destination_port_range: 8-174
      source_address_prefix: 0.0.0.0
      destination_address_prefix: '*'
- name: foo4
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example4
      priority: 100
      direction: Inbound
      access: Allow
      protocol: TCP
      source_port_range: '*'
      destination_port_range: 23-196
      source_address_prefix: 192.168.0.0
      destination_address_prefix: '*'
- name: foo5
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example5
      priority: 100
      direction: Inbound
      access: Allow
      protocol: TCP
      source_port_range: '*'
      destination_port_range: 23
      source_address_prefix: /1
      destination_address_prefix: '*'
- name: foo6
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example6
      priority: 100
      direction: Inbound
      access: Allow
      protocol: '*'
      source_port_range: '*'
      destination_port_range: 43
      source_address_prefix: /0
      destination_address_prefix: '*'
- name: foo7
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example7
      priority: 100
      direction: Inbound
      access: Allow
      protocol: Icmp
      source_port_range: '*'
      destination_port_range: 23
      source_address_prefix: internet
      destination_address_prefix: '*'
- name: foo8
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example8
      priority: 100
      direction: Inbound
      access: Allow
      protocol: '*'
      source_port_range: '*'
      destination_port_range: 22, 24,49-67
      source_address_prefix: any
      destination_address_prefix: '*'
- name: foo9
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example9
      priority: 100
      direction: Inbound
      access: Allow
      protocol: Icmp
      source_port_range: '*'
      destination_port_range: 23
      source_address_prefix: /0
      destination_address_prefix: '*'
- name: foo10
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
    - name: example10
      priority: 100
      direction: Inbound
      access: Allow
      protocol: TCP
      source_port_range: '*'
      destination_port_range:
      - 23
      - 69
      source_address_prefix: 0.0.1.0
      destination_address_prefix: '*'
    - name: example11
      priority: 100
      direction: Inbound
      access: Allow
      protocol: TCP
      source_port_range: '*'
      destination_port_range:
      - 2
      - 310
      source_address_prefix: 0.0.0.0
      destination_address_prefix: '*'","---
- name: foo1
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example1
        priority: 100
        direction: Inbound
        access: Allow
        protocol: UDP
        source_port_range: ""*""
        destination_port_range: ""61621""
        source_address_prefix: ""/0""
        destination_address_prefix: ""*""
- name: foo2
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example2
        priority: 100
        direction: Inbound
        access: Allow
        protocol: TCP
        source_port_range: ""*""
        destination_port_range: ""23-34""
        source_address_prefix: ""1.1.1.1/0""
        destination_address_prefix: ""*""
- name: foo3
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example3
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""*""
        source_port_range: ""*""
        destination_port_range: ""21-23""
        source_address_prefix: ""/0""
        destination_address_prefix: ""*""
- name: foo4
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example4
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""*""
        source_port_range: ""*""
        destination_port_range: ""23""
        source_address_prefix: ""0.0.0.0/0""
        destination_address_prefix: ""*""
- name: foo5
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example5
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""UDP""
        source_port_range: ""*""
        destination_port_range:
          - ""23""
          - ""245""
        source_address_prefix: ""34.15.11.3/0""
        destination_address_prefix: ""*""
- name: foo6
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example6
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""TCP""
        source_port_range: ""*""
        destination_port_range: ""23""
        source_address_prefix: ""/0""
        destination_address_prefix: ""*""
- name: foo7
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example7
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""UDP""
        source_port_range: ""*""
        destination_port_range: ""22-64, 94""
        source_address_prefix: ""10.0.0.0/0""
        destination_address_prefix: ""*""
- name: foo8
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example8
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""TCP""
        source_port_range: ""*""
        destination_port_range:
          - ""14""
          - ""23""
          - ""48""
        source_address_prefix: ""12.12.12.12/0""
        destination_address_prefix: ""*""
- name: foo9
  azure_rm_securitygroup:
    resource_group: myResourceGroup
    name: mysecgroup
    rules:
      - name: example9
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""*""
        source_port_range: ""*""
        destination_port_range:
          - ""12""
          - ""23-24""
          - ""46""
        source_address_prefix: ""/0""
        destination_address_prefix: ""*""
      - name: example10
        priority: 100
        direction: Inbound
        access: Allow
        protocol: ""*""
        source_port_range: ""*""
        destination_port_range: 46-146, 18-36, 1-2, 3
        source_address_prefix: ""1.2.3.4/0""
        destination_address_prefix: ""*""","[[130, 99, 69, 41, 13, 142, 113, 85, 55, 27]]"
139,0d0c12b9-edce-4510-9065-13f6a758750c,Redis Entirely Accessible,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/redis_entirely_accessible,Unknown,"Firewall rule allowing unrestricted access to Redis from the Internet<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_rediscachefirewallrule_module.html#parameter-start_ip_address)","- name: Create a Firewall rule for Azure Cache for Redis
  azure_rm_rediscachefirewallrule:
    resource_group: myResourceGroup
    cache_name: myRedisCache
    name: myRule
    start_ip_address: 192.168.1.1
    end_ip_address: 192.168.1.4","---
- name: Create a Firewall rule for Azure Cache for Redis
  azure_rm_rediscachefirewallrule:
      resource_group: myResourceGroup
      cache_name: myRedisCache
      name: myRule
      start_ip_address: 0.0.0.0
      end_ip_address: 0.0.0.0",[[7]]
140,149fa56c-4404-4f90-9e25-d34b676d5b39,AKS RBAC Disabled,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/aks_rbac_disabled,Unknown,"Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_aks_module.html)","- name: Create an AKS instance v3
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: cf72ca99-f6b9-4004-b0e0-bee10c521948
      client_secret: Password1234!
    agent_pool_profiles:
    - name: default
      count: 1
      vm_size: Standard_DS1_v2
      type: VirtualMachineScaleSets
      max_count: 3
      min_count: 1
    enable_rbac: yes","- name: Create an AKS instance
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1
    enable_rbac: no
- name: Create an AKS instance v2
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1","[[21, 23]]"
141,1bc398a8-d274-47de-a4c8-6ac867b353de,Trusted Microsoft Services Not Enabled,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/trusted_microsoft_services_not_enabled,Unknown,"Trusted Microsoft Services should be enabled for Storage Account access<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageaccount_module.html#parameter-network_acls/bypass)","- name: configure firewall and virtual networks
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    network_acls:
      bypass: AzureServices,Metrics
      default_action: Deny
      virtual_network_rules:
      - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
        action: Allow
      ip_rules:
      - value: 1.2.3.4
        action: Allow
      - value: 123.234.123.0/24
        action: Allow
- name: configure firewall and virtual networks2
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0003
    type: Standard_RAGRS
    network_acls:
      default_action: Deny
      virtual_network_rules:
      - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
        action: Allow
      ip_rules:
      - value: 1.2.3.4
        action: Allow
      - value: 123.234.123.0/24
        action: Allow
- name: configure firewall and virtual networks3
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0004
    type: Standard_RAGRS
    network_acls:
      default_action: Deny
      bypass: AzureServices
      virtual_network_rules:
      - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
        action: Allow
      ip_rules:
      - value: 1.2.3.4
        action: Allow
      - value: 123.234.123.0/24
        action: Allow","- name: configure firewall and virtual networks
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    network_acls:
      bypass: Metrics
      default_action: Deny
      virtual_network_rules:
        - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
          action: Allow
      ip_rules:
        - value: 1.2.3.4
          action: Allow
        - value: 123.234.123.0/24
          action: Allow
- name: configure firewall and virtual networks2
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0003
    type: Standard_RAGRS
    network_acls:
      default_action: Deny
      bypass: Metrics,Logging
      virtual_network_rules:
        - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
          action: Allow
      ip_rules:
        - value: 1.2.3.4
          action: Allow
        - value: 123.234.123.0/24
          action: Allow
- name: configure firewall and virtual networks3
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0004
    type: Standard_RAGRS
    network_acls:
      default_action: Deny
      bypass: """"
      virtual_network_rules:
        - id: /subscriptions/mySubscriptionId/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVnet/subnets/mySubnet
          action: Allow
      ip_rules:
        - value: 1.2.3.4
          action: Allow
        - value: 123.234.123.0/24
          action: Allow","[[24, 40, 7]]"
142,1e5f5307-3e01-438d-8da6-985307ed25ce,VM Not Attached To Network,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/vm_not_attached_to_network,Unknown,"No Network Security Group is attached to the Virtual Machine<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_virtualmachine_module.html#parameter-network_interface_names)","- name: Create a VM with a custom image
  azure_rm_virtualmachine:
    resource_group: myResourceGroup
    name: testvm001
    vm_size: Standard_DS1_v2
    admin_username: adminUser
    admin_password: password01
    image: customimage001
    network_interfaces: testvm001","---
- name: Create a VM with a custom image
  azure_rm_virtualmachine:
    resource_group: myResourceGroup
    name: testvm001
    vm_size: Standard_DS1_v2
    admin_username: adminUser
    admin_password: password01
    image: customimage001",[[3]]
143,23a4dc83-4959-4d99-8056-8e051a82bc1e,Cosmos DB Account Without Tags,Ansible,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/cosmosdb_account_without_tags,Unknown,"Cosmos DB Account must have a mapping of tags.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_cosmosdbaccount_module.html)","- name: Create Cosmos DB Account - min
  azure_rm_cosmosdbaccount:
    resource_group: myResourceGroup
    name: myDatabaseAccount
    location: westus
    geo_rep_locations:
    - name: southcentralus
      failover_priority: 0
    database_account_offer_type: Standard
    tags:
      t1: t1
      t2: t2","---
- name: Create Cosmos DB Account - min
  azure_rm_cosmosdbaccount:
    resource_group: myResourceGroup
    name: myDatabaseAccount
    location: westus
    geo_rep_locations:
      - name: southcentralus
        failover_priority: 0
    database_account_offer_type: Standard",[[3]]
144,29f35127-98e6-43af-8ec1-201b79f99604,Admin User Enabled For Container Registry,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/admin_user_enabled_for_container_registry,Unknown,"Admin user is enabled for Container Registry<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_containerregistry_module.html)","- name: Create an azure container registry
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroup
    admin_user_enabled: false
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
- name: Create an azure container registry2
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroup
    admin_user_enabled: false
    sku: Premium
    tags:
      Release: beta1
      Environment: Production","---
- name: Create an azure container registry
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroup
    admin_user_enabled: true
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
- name: Create an azure container registry2
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroup
    admin_user_enabled: ""true""
    sku: Premium
    tags:
      Release: beta1
      Environment: Production","[[17, 7]]"
145,2a901825-0f3b-4655-a0fe-e0470e50f8e6,MySQL SSL Connection Disabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/mysql_ssl_connection_disabled,Unknown,"Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_mysqlserver_module.html)","- name: Create (or update) MySQL Server
  azure.azcollection.azure_rm_mysqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: true
    version: 5.6
    admin_username: cloudsa
    admin_password: password","---
- name: Create (or update) MySQL Server
  azure.azcollection.azure_rm_mysqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    version: 5.6
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) MySQL Server2
  azure.azcollection.azure_rm_mysqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: false
    version: 5.6
    admin_username: cloudsa
    admin_password: password","[[3, 23]]"
146,2c99a474-2a3c-4c17-8294-53ffa5ed0522,Storage Account Not Forcing HTTPS,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/storage_account_not_forcing_https,Unknown,"Storage Accounts should enforce the use of HTTPS<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageaccount_module.html#parameter-https_only)","- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: yes
    tags:
      testing: testing
      delete: on-exit
- name: create an account2
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: true
    tags:
      testing: testing
      delete: on-exit
- name: create an account3
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: true
    tags:
      testing: testing
      delete: on-exit
- name: create an account4
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: 'true'
    tags:
      testing: testing
      delete: on-exit
- name: create an account5
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: 'True'
    tags:
      testing: testing
      delete: on-exit
- name: create an account6
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: yes
    tags:
      testing: testing
      delete: on-exit
- name: create an account7
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: Yes
    tags:
      testing: testing
      delete: on-exit
- name: create an account8
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: Yes
    tags:
      testing: testing
      delete: on-exit","---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit
- name: create an account2
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: false
    tags:
      testing: testing
      delete: on-exit
- name: create an account3
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: False
    tags:
      testing: testing
      delete: on-exit
- name: create an account4
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: no
    tags:
      testing: testing
      delete: on-exit
- name: create an account5
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: No
    tags:
      testing: testing
      delete: on-exit
- name: create an account6
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: ""false""
    tags:
      testing: testing
      delete: on-exit
- name: create an account7
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: ""False""
    tags:
      testing: testing
      delete: on-exit
- name: create an account8
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: ""no""
    tags:
      testing: testing
      delete: on-exit
- name: create an account9
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    https_only: ""No""
    tags:
      testing: testing
      delete: on-exit","[[33, 3, 69, 42, 78, 15, 51, 24, 60]]"
147,2fc5ab5a-c5eb-4ae4-b687-0f16fe77c255,WAF Is Disabled For Azure Application Gateway,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/waf_is_disabled_for_azure_application_gateway,Unknown,"Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_appgateway_module.html)","- name: Create instance of Application Gateway
  azure_rm_appgateway:
    resource_group: myResourceGroup
    name: myAppGateway
    sku:
      name: waf_medium
      tier: waf
      capacity: 2","- name: Create instance of Application Gateway
  azure_rm_appgateway:
    resource_group: myResourceGroup
    name: myAppGateway
    sku:
      name: standard_small
      tier: standard
      capacity: 2",[[7]]
148,35e2f133-a395-40de-a79d-b260d973d1bd,Public Storage Account,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/public_storage_account,Unknown,"Storage Account should not be public to grant the principle of least privileges<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageaccount_module.html#parameter-network_acls)","- name: configure firewall and virtual networks
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    network_acls:
      bypass: AzureServices,Metrics
      default_action: Deny
      ip_rules:
      - value: 1.2.3.4
        action: Allow","- name: configure firewall and virtual networks
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    network_acls:
      bypass: AzureServices,Metrics
      default_action: Deny
      ip_rules:
        - value: 0.0.0.0/0
          action: Allow
- name: configure firewall and more virtual networks
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0003
    type: Standard_RAGRS
    network_acls:
      bypass: AzureServices,Metrics
      default_action: Allow","[[9, 19]]"
149,37fafbea-dedb-4e0d-852e-d16ee0589326,Small Activity Log Retention Period,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/345.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/small_activity_log_retention_period,Unknown,"Ensure that Activity Log Retention is set 365 days or greater<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_monitorlogprofile_module.html)","- name: Create a log profile
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
    - eastus
    - westus
    categories:
    - Write
    - Action
    retention_policy:
      enabled: true
      days: 380
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output","---
- name: Create a log profile
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
      - eastus
      - westus
    categories:
      - Write
      - Action
    retention_policy:
      enabled: False
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output

- name: Create a log profile2
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
      - eastus
      - westus
    categories:
      - Write
      - Action
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output

- name: Create a log profile3
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
      - eastus
      - westus
    categories:
      - Write
      - Action
    retention_policy:
      enabled: True
      days: 50
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output","[[20, 13, 46]]"
150,3f23c96c-f9f5-488d-9b17-605b8da5842f,Unrestricted SQL Server Access,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/unrestricted_sql_server_acess,Unknown,"Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' should be less than 256. Additionally, both ips should be different from '0.0.0.0'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_sqlfirewallrule_module.html)","#this code is a correct code for which the query should not find any result
- name: Create (or update) Firewall Rule
  azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 172.28.10.136
    end_ip_address: 172.28.10.138","#this is a problematic code where the query should report a result(s)
- name: Create (or update) Firewall Rule1
  azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup1
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 0.0.0.0
    end_ip_address: 172.28.11.138
- name: Create (or update) Firewall Rule2
  azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup2
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 172.28.10.136
    end_ip_address: 172.28.11.138","[[10, 3]]"
151,4d3817db-dd35-4de4-a80d-3867157e7f7f,Storage Container Is Publicly Accessible,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/storage_container_is_publicly_accessible,Unknown,"Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageblob_module.html#parameter-public_access)","- name: Create container foo and upload a file
  azure_rm_storageblob:
    resource_group: myResourceGroup
    storage_account_name: clh0002
    container: foo
    blob: graylog.png
    src: ./files/graylog.png
    content_type: application/image
# access mode defaults to private","- name: Create container foo and upload a file
  azure_rm_storageblob:
    resource_group: myResourceGroup
    storage_account_name: clh0002
    container: foo
    blob: graylog.png
    src: ./files/graylog.png
    content_type: 'application/image'
    public_access: blob
- name: Create container foo2 and upload a file
  azure_rm_storageblob:
    resource_group: myResourceGroup
    storage_account_name: clh0002
    container: foo2
    blob: graylog.png
    src: ./files/graylog.png
    public_access: container
    content_type: 'application/image'","[[9, 17]]"
152,530e8291-2f22-4bab-b7ea-306f1bc2a308,SQL Server Predictable Active Directory Account Name,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/sql_server_predictable_active_directory_admin_account_name,Unknown,"Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'ad_user' must be set to a name that is not easy to predict<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_adserviceprincipal_module.html)","#this code is a correct code for which the query should not find any result
- name: create ad sp
  azure_ad_serviceprincipal:
    app_id: '{{ app_id }}'
    state: present
    tenant: '{{ tenant_id }}'
    ad_user: unpredictableName","#this is a problematic code where the query should report a result(s)
- name: create ad sp
  azure_ad_serviceprincipal:
    app_id: ""{{ app_id }}""
    state: present
    tenant: ""{{ tenant_id }}""
    ad_user: admin
- name: create ad sp2
  azure_ad_serviceprincipal:
    app_id: ""{{ app_id2 }}""
    state: present
    tenant: ""{{ tenant_id2 }}""
    ad_user: """"
- name: create ad sp3
  azure_ad_serviceprincipal:
    app_id: ""{{ app_id3 }}""
    state: present
    tenant: ""{{ tenant_id3 }}""
    ad_user:","[[19, 13, 7]]"
153,581dae78-307d-45d5-aae4-fe2b0db267a5,Azure Container Registry With No Locks,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/639.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/azure_container_registry_with_no_locks,Unknown,"Azurerm Container Registry should contain associated locks, which means 'azure_rm_lock.managed_resource_id' or 'azure_rm_lock.resource_group' association should be defined<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_lock_module.html)","- name: Create an azure container registry
  azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroup
    admin_user_enabled: true
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
- name: Create a lock for a resource group
  azure_rm_lock:
    resource_group: myResourceGroup
    name: myLock
    level: read_only

- name: Create an azure container registry11
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    admin_user_enabled: ""true""
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
  register: acr2
- name: ""Create lock for ACR11""
  azure.azcollection.azure_rm_lock:
    managed_resource_id: ""{{ acr2.id }}""
    name: ""acr_lock""
    level: can_not_delete","- name: Create an azure container registry
  azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: myResourceGroupFake
    admin_user_enabled: true
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
- name: Create a lock for a resource group
  azure_rm_lock:
    resource_group: myResourceGroup32
    name: myLock
    level: read_only
- name: Create an azure container registry2
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    resource_group: someResourceGroup
    admin_user_enabled: ""true""
    sku: Premium
    tags:
      Release: beta1
      Environment: Production

- name: Create an azure container registryy1
  azure.azcollection.azure_rm_containerregistry:
    name: myRegistry
    location: eastus
    admin_user_enabled: ""true""
    sku: Premium
    tags:
      Release: beta1
      Environment: Production
  register: acr
- name: ""Create lock for ACR1""
  azure.azcollection.azure_rm_lock:
    managed_resource_id: ""{{ acr3.id }}""
    name: ""acr_lock""
    level: can_not_delete","[[17, 2], [2]]"
154,5c80db8e-03f5-43a2-b4af-1f3f87018157,Role Definition Allows Custom Role Creation,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/role_definition_allows_custom_role_creation,Unknown,"Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_roledefinition_module.html#parameter-permissions/actions)","---
- name: Create a role definition3
  azure_rm_roledefinition:
    name: myTestRole3
    scope: /subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myresourceGroup
    permissions:
      - actions:
          - ""Microsoft.Compute/virtualMachines/read""
        data_actions:
          - ""Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write""
    assignable_scopes:
      - ""/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx""","---
- name: Create a role definition
  azure_rm_roledefinition:
    name: myTestRole
    scope: /subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myresourceGroup
    permissions:
      - actions:
          - ""Microsoft.Authorization/roleDefinitions/write""
    assignable_scopes:
      - ""/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx""

---
- name: Create a role definition2
  azure_rm_roledefinition:
    name: myTestRole2
    scope: /subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myresourceGroup
    permissions:
      - actions:
          - ""*""
    assignable_scopes:
      - ""/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx""","[[7], [7]]"
155,663062e9-473d-4e87-99bc-6f3684b3df40,SQL Server Predictable Admin Account Name,Ansible,Low,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/sql_server_predictable_admin_account_name,Unknown,"Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'admin_username' must be set to a name that is not easy to predict<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_sqlserver_module.html)","#this code is a correct code for which the query should not find any result
- name: Create (or update) SQL Server
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name
    location: westus
    admin_username: mylogin
    admin_password: Testpasswordxyz12!","#this is a problematic code where the query should report a result(s)
- name: Create (or update) SQL Server1
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name1
    location: westus
    admin_username: """"
    admin_password: Testpasswordxyz12!
- name: Create (or update) SQL Server2
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name2
    location: westus
    admin_username:
    admin_password: Testpasswordxyz12!
- name: Create (or update) SQL Server3
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name3
    location: westus
    admin_username: admin
    admin_password: Testpasswordxyz12!","[[21, 14, 7]]"
156,69f72007-502e-457b-bd2d-5012e31ac049,Firewall Rule Allows Too Many Hosts To Access Redis Cache,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/firewall_rule_allows_too_many_hosts_to_access_redis_cache,Unknown,"Check if any firewall rule allows too many hosts to access Redis Cache.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_rediscachefirewallrule_module.html)","- name: reduced_hosts
  azure_rm_rediscachefirewallrule:
    resource_group: myResourceGroup
    cache_name: myRedisCache
    name: myRule
    start_ip_address: 192.168.1.1
    end_ip_address: 192.168.1.4","- name: too_many_hosts
  azure_rm_rediscachefirewallrule:
      resource_group: myResourceGroup
      cache_name: myRedisCache
      name: myRule
      start_ip_address: 192.168.1.1
      end_ip_address: 192.169.1.4",[[6]]
157,729ebb15-8060-40f7-9017-cb72676a5487,PostgreSQL Log Duration Not Set,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/postgresql_log_duration_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: example1
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: on
- name: example2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: On
- name: example3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: ON
- name: example4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: on
- name: example5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: On
- name: example6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: ON","- name: example1
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: off
- name: example2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: Off
- name: example3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: OFF
- name: example4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: ""off""
- name: example5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: ""Off""
- name: example6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_duration
    value: ""OFF""","[[36, 6, 12, 18, 24, 30]]"
158,7ab33ac0-e4a3-418f-a673-50da4e34df21,PostgreSQL Log Checkpoints Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/postgresql_log_checkpoints_disabled,Unknown,"Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: on
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: On
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: ON
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: on
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: On
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: ON","---
- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: off
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: Off
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: OFF
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: ""off""
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: ""Off""
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_checkpoints
    value: ""OFF""","[[37, 7, 13, 19, 25, 31]]"
159,7b47138f-ec0e-47dc-8516-e7728fe3cc17,PostgreSQL Log Connections Not Set,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/postgresql_log_connections_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: on
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: On
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: ON
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: on
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: On
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: ON","---
- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: off
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: Off
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: OFF
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: ""off""
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: ""Off""
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: log_connections
    value: ""OFF""","[[37, 7, 13, 19, 25, 31]]"
160,869e7fb4-30f0-4bdb-b360-ad548f337f2f,Redis Cache Allows Non SSL Connections,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/redis_cache_allows_non_ssl_connections,Unknown,"Redis Cache resources should not allow non-SSL connections<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_rediscache_module.html)","- name: Non SSl Disallowed
  azure_rm_rediscache:
    resource_group: myResourceGroup
    name: myRedis
    enable_non_ssl_port: no
- name: Non SSl Undefined
  azure_rm_rediscache:
    resource_group: myResourceGroup
    name: myRedis","- name: Non SSl Allowed
  azure_rm_rediscache:
      resource_group: myResourceGroup
      name: myRedis
      enable_non_ssl_port: yes",[[5]]
161,881696a8-68c5-4073-85bc-7c38a3deb854,Key Vault Soft Delete Is Disabled,Ansible,Medium,Backup,https://cwe.mitre.org/data/definitions/451.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/key_vault_soft_delete_is_disabled,Unknown,"Make sure Soft Delete is enabled for Key Vault<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_keyvault_module.html#parameter-enable_soft_delete)","- name: Create instance of Key Vault
  azure_rm_keyvault:
    resource_group: myResourceGroup
    vault_name: samplekeyvault
    enabled_for_deployment: yes
    enable_soft_delete: yes
    vault_tenant: 72f98888-8666-4144-9199-2d7cd0111111
    sku:
      name: standard
    access_policies:
    - tenant_id: 72f98888-8666-4144-9199-2d7cd0111111
      object_id: 99998888-8666-4144-9199-2d7cd0111111
      keys:
      - get
      - list","---
- name: Create instance of Key Vault
  azure_rm_keyvault:
    resource_group: myResourceGroup
    vault_name: samplekeyvault
    enabled_for_deployment: yes
    enable_soft_delete: no
    vault_tenant: 72f98888-8666-4144-9199-2d7cd0111111
    sku:
      name: standard
    access_policies:
      - tenant_id: 72f98888-8666-4144-9199-2d7cd0111111
        object_id: 99998888-8666-4144-9199-2d7cd0111111
        keys:
          - get
          - list
- name: Create instance of Key Vault 02
  azure_rm_keyvault:
    resource_group: myResourceGroup 02
    vault_name: samplekeyvault
    enabled_for_deployment: yes
    vault_tenant: 72f98888-8666-4144-9199-2d7cd0111111
    sku:
      name: standard
    access_policies:
      - tenant_id: 72f98888-8666-4144-9199-2d7cd0111111
        object_id: 99998888-8666-4144-9199-2d7cd0111111
        keys:
          - get
          - list","[[18, 7]]"
162,89f84a1e-75f8-47c5-83b5-bee8e2de4168,Monitoring Log Profile Without All Activities,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/monitoring_log_profile_without_all_activities,Unknown,"Monitoring log profile captures all the activities (Action, Write, Delete)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_monitorlogprofile_module.html)","- name: Create a log profile
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
    - eastus
    - westus
    categories:
    - Write
    - Action
    - Delete
    retention_policy:
      enabled: false
      days: 1
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output","---
- name: Create a log profile
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
      - eastus
      - westus
    categories:
      - Write
      - Action
    retention_policy:
      enabled: False
      days: 1
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output

- name: Create a log profile2
  azure_rm_monitorlogprofile:
    name: myProfile
    location: eastus
    locations:
      - eastus
      - westus
    retention_policy:
      enabled: False
      days: 1
    storage_account:
      resource_group: myResourceGroup
      name: myStorageAccount
  register: output","[[9, 21]]"
163,8c3bedf1-c570-4c3b-b414-d068cd39a00c,AKS Network Policy Misconfigured,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/aks_network_policy_misconfigured,Unknown,"Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_aks_module.html#parameter-network_profile/network_policy)","- name: Create a managed Azure Container Services (AKS) instance01
  azure_rm_aks:
    name: myAKS
    location: eastus
    resource_group: myResourceGroup
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    network_profile:
      network_policy: calico
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: cf72ca99-f6b9-4004-b0e0-bee10c521948
      client_secret: Password123!
    agent_pool_profiles:
    - name: default
      count: 5
      vm_size: Standard_D2_v2
    tags:
      Environment: Production
- name: Create a managed Azure Container Services (AKS) instance02
  azure_rm_aks:
    name: myAKS
    location: eastus
    resource_group: myResourceGroup
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    network_profile:
      network_policy: azure
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: cf72ca99-f6b9-4004-b0e0-bee10c521948
      client_secret: Password123!
    agent_pool_profiles:
    - name: default
      count: 5
      vm_size: Standard_D2_v2
    tags:
      Environment: Production","---
- name: Create a managed Azure Container Services (AKS) instance03
  azure_rm_aks:
    name: myAKS
    location: eastus
    resource_group: myResourceGroup
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    network_profile:
      network_policy: istio
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password123!""
    agent_pool_profiles:
      - name: default
        count: 5
        vm_size: Standard_D2_v2
    tags:
      Environment: Production
- name: Create a managed Azure Container Services (AKS) instance04
  azure_rm_aks:
    name: myAKS
    location: eastus
    resource_group: myResourceGroup
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password123!""
    agent_pool_profiles:
      - name: default
        count: 5
        vm_size: Standard_D2_v2
    tags:
      Environment: Production","[[24, 10]]"
164,961ce567-a16d-4d7d-9027-f0ec2628a555,SSL Enforce Disabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/ssl_enforce_is_disabled,Unknown,"Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlserver_module.html#parameter-enforce_ssl)","- name: Create (or update) PostgreSQL Server
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: yes
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server2
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: Yes
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server3
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: true
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server4
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: true
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server5
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: yes
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server6
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: Yes
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server7
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: 'true'
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server8
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: 'True'
    admin_username: cloudsa
    admin_password: password","- name: Create (or update) PostgreSQL Server
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    admin_username: cloudsa
    admin_password: password
- name: Create (or update) PostgreSQL Server2
  azure.azcollection.azure_rm_postgresqlserver:
    resource_group: myResourceGroup
    name: testserver
    sku:
      name: B_Gen5_1
      tier: Basic
    location: eastus
    storage_mb: 1024
    enforce_ssl: no
    admin_username: cloudsa
    admin_password: password","[[2, 21]]"
165,a9becca7-892a-4af7-b9e1-44bf20a4cd9a,PostgreSQL Server Without Connection Throttling,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/postgresql_server_without_connection_throttling,Unknown,"Ensure that Connection Throttling is set for the PostgreSQL server<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_postgresqlconfiguration_module.html)","- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: on
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: On
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: ON
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: on
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: On
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: ON","---
- name: Update PostgreSQL Server setting
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: off
- name: Update PostgreSQL Server setting2
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: Off
- name: Update PostgreSQL Server setting3
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: OFF
- name: Update PostgreSQL Server setting4
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: ""off""
- name: Update PostgreSQL Server setting5
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: ""Off""
- name: Update PostgreSQL Server setting6
  azure.azcollection.azure_rm_postgresqlconfiguration:
    resource_group: myResourceGroup
    server_name: myServer
    name: connection_throttling
    value: ""OFF""","[[37, 7, 13, 19, 25, 31]]"
166,b176e927-bbe2-44a6-a9c3-041417137e5f,AD Admin Not Configured For SQL Server,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/ad_admin_not_configured_for_sql_server,Unknown,"The Active Directory Administrator is not configured for a SQL server<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_sqlserver_module.html#parameter-ad_user)","- name: Create (or update) SQL Server
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name
    location: westus
    admin_username: mylogin
    admin_password: Testpasswordxyz12!
    ad_user: sqladmin","---
- name: Create (or update) SQL Server
  azure_rm_sqlserver:
    resource_group: myResourceGroup
    name: server_name
    location: westus
    admin_username: mylogin
    admin_password: Testpasswordxyz12!",[[3]]
167,c62746cf-92d5-4649-9acf-7d48d086f2ee,Storage Account Not Using Latest TLS Encryption Version,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/storage_account_not_using_latest_tls_encryption_version,Unknown,"Ensure Storage Account is using the latest version of TLS encryption<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageaccount_module.html#parameter-minimum_tls_version)","- name: Create an account with kind of FileStorage
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: c1h0002
    type: Premium_LRS
    kind: FileStorage
    minimum_tls_version: TLS1_2
    tags:
      testing: testing","---
- name: Create an account with kind of FileStorage
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: c1h0002
    type: Premium_LRS
    kind: FileStorage
    minimum_tls_version: TLS1_0
    tags:
      testing: testing
- name: Create a second account with kind of FileStorage
  azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0003
    type: Premium_LRS
    kind: FileStorage","[[8, 12]]"
168,ca4df748-613a-4fbf-9c76-f02cbd580307,Default Azure Storage Account Network Access Is Too Permissive,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/default_azure_storage_account_network_access_is_too_permissive,Unknown,"Make sure that your Azure Storage Account access is limited to those who require it.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_storageaccount_module.html#parameter-public_network_access)","---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit
    network_acls:
      default_action: Deny

---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit
    public_network_access: Disabled","---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit
    public_network_access: Enabled

---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit

---
- name: create an account
  azure.azcollection.azure_rm_storageaccount:
    resource_group: myResourceGroup
    name: clh0002
    type: Standard_RAGRS
    tags:
      testing: testing
      delete: on-exit
    network_acls:
      default_action: Allow","[[3], [3], [3]]"
169,d5e83b32-56dd-4247-8c2e-074f43b38a5e,AKS Monitoring Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/aks_monitoring_logging_disabled,Unknown,"Azure Container Service (AKS) instance should have logging enabled to Azure Monitoring<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_aks_module.html)","- name: Create an AKS instance v4
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: cf72ca99-f6b9-4004-b0e0-bee10c521948
      client_secret: Password1234!
    agent_pool_profiles:
    - name: default
      count: 1
      vm_size: Standard_DS1_v2
      type: VirtualMachineScaleSets
      max_count: 3
      min_count: 1
    enable_rbac: yes
    addon:
      monitoring:
        log_analytics_workspace_resource_id: qwqeqe
        enabled: yes","- name: Create an AKS instance v0
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1
    enable_rbac: yes
- name: Create an AKS instance
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1
    enable_rbac: yes
    addon:
      http_application_routing:
        enabled: yes
- name: Create an AKS instance v3
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1
    enable_rbac: yes
    addon:
      monitoring:
        log_analytics_workspace_resource_id: ""qwqeqe""
- name: Create an AKS instance v9
  azure_rm_aks:
    name: myAKS
    resource_group: myResourceGroup
    location: eastus
    dns_prefix: akstest
    kubernetes_version: 1.14.6
    linux_profile:
      admin_username: azureuser
      ssh_key: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAA...
    service_principal:
      client_id: ""cf72ca99-f6b9-4004-b0e0-bee10c521948""
      client_secret: ""Password1234!""
    agent_pool_profiles:
      - name: default
        count: 1
        vm_size: Standard_DS1_v2
        type: VirtualMachineScaleSets
        max_count: 3
        min_count: 1
    enable_rbac: yes
    addon:
      monitoring:
        log_analytics_workspace_resource_id: ""qwqeqe""
        enabled: no","[[2, 43, 68, 94]]"
170,da4f2739-174f-4cdd-b9ef-dc3f14b5931f,Security Group is Not Configured,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/security_group_is_not_configured,Unknown,"Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_subnet_module.html)","#this code is a correct code for which the query should not find any result
- name: Create a subnet
  azure_rm_subnet:
    resource_group: myResourceGroup
    virtual_network_name: myVirtualNetwork
    name: mySubnet
    address_prefix_cidr: 10.1.0.0/24
    security_group: mySecurityGroup","#this is a problematic code where the query should report a result(s)
- name: Create a subnet1
  azure_rm_subnet:
    resource_group: myResourceGroup1
    virtual_network_name: myVirtualNetwork1
    name: mySubnet1
    address_prefix_cidr: ""10.1.0.0/24""
- name: Create a subnet2
  azure_rm_subnet:
    resource_group: myResourceGroup2
    virtual_network_name: myVirtualNetwork2
    name: mySubnet2
    address_prefix_cidr: ""10.1.0.0/24""
    security_group:
- name: Create a subnet3
  azure_rm_subnet:
    resource_group: myResourceGroup3
    virtual_network_name: myVirtualNetwork3
    name: mySubnet3
    address_prefix_cidr: ""10.1.0.0/24""
    security_group_name:
- name: Create a subnet4
  azure_rm_subnet:
    resource_group: myResourceGroup4
    virtual_network_name: myVirtualNetwork4
    name: mySubnet4
    address_prefix_cidr: ""10.1.0.0/24""
    security_group: """"
- name: Create a subnet5
  azure_rm_subnet:
    resource_group: myResourceGroup5
    virtual_network_name: myVirtualNetwork5
    name: mySubnet5
    address_prefix_cidr: ""10.1.0.0/24""
    security_group_name: """"","[[3, 35, 9, 16, 28]]"
171,e2d834b7-8b25-4935-af53-4a60668dcbe0,Azure Instance Using Basic Authentication,Ansible,Medium,Best Practices,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/azure_instance_using_basic_authentication,Unknown,"Azure Instances should use SSH Key instead of basic authentication<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_virtualmachine_module.html#parameter-linux_config/disable_password_authentication)","---
- name: Create a VM with a custom image
  azure_rm_virtualmachine:
    resource_group: myResourceGroup
    name: testvm001
    vm_size: Standard_DS1_v2
    ssh_password_enabled: false
    ssh_public_keys:
      - path: ~/.ssh/id_rsa.pub
        key_data: somegeneratedkeydata
    image: customimage001
    os_type: Linux","---
- name: Create a VM with a custom image
  azure_rm_virtualmachine:
    resource_group: myResourceGroup
    name: testvm001
    vm_size: Standard_DS1_v2
    admin_username: adminUser
    admin_password: password01
    image: customimage001
    os_type: Linux",[[1]]
172,e8c80448-31d8-4755-85fc-6dbab69c2717,CosmosDB Account IP Range Filter Not Set,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/cosmosdb_account_ip_range_filter_not_set,Unknown,"The IP range filter should be defined to secure the data stored<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_cosmosdbaccount_module.html#parameter-ip_range_filter)","- name: Create Cosmos DB Account - max
  azure_rm_cosmosdbaccount:
    resource_group: myResourceGroup
    name: myDatabaseAccount
    location: westus
    kind: mongo_db
    geo_rep_locations:
    - name: southcentralus
      failover_priority: 0
    database_account_offer_type: Standard
    ip_range_filter: 10.10.10.10
    enable_multiple_write_locations: yes
    virtual_network_rules:
    - subnet: /subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVi
        rtualNetwork/subnets/mySubnet
    consistency_policy:
      default_consistency_level: bounded_staleness
      max_staleness_prefix: 10
      max_interval_in_seconds: 1000","- name: Create Cosmos DB Account - max
  azure_rm_cosmosdbaccount:
    resource_group: myResourceGroup
    name: myDatabaseAccount
    location: westus
    kind: mongo_db
    geo_rep_locations:
      - name: southcentralus
        failover_priority: 0
    database_account_offer_type: Standard
    enable_multiple_write_locations: yes
    virtual_network_rules:
      - subnet: ""/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/myResourceGroup/providers/Microsoft.Network/virtualNetworks/myVi
                 rtualNetwork/subnets/mySubnet""
    consistency_policy:
      default_consistency_level: bounded_staleness
      max_staleness_prefix: 10
      max_interval_in_seconds: 1000",[[2]]
173,eb8c2560-8bee-4248-9d0d-e80c8641dd91,Web App Accepting Traffic Other Than HTTPS,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/web_app_accepting_traffic_other_than_https,Unknown,"Web app should only accept HTTPS traffic in Azure Web App Service.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_webapp_module.html#parameter-https_only)","- name: Create a windows web app with non-exist app service plan
  azure_rm_webapp:
    resource_group: myResourceGroup
    name: myWinWebapp
    https_only: true
    plan:
      resource_group: myAppServicePlan_rg
      name: myAppServicePlan
      is_linux: false
      sku: S1","- name: Create a windows web app with non-exist app service plan
  azure_rm_webapp:
    resource_group: myResourceGroup
    name: myWinWebapp
    https_only: false
    plan:
      resource_group: myAppServicePlan_rg
      name: myAppServicePlan
      is_linux: false
      sku: S1
- name: Create another windows web app
  azure_rm_webapp:
    resource_group: myResourceGroup
    name: myWinWebapp
    plan:
      resource_group: myAppServicePlan_rg
      name: myAppServicePlan
      is_linux: false
      sku: S1","[[12, 5]]"
174,f4e9ff70-0f3b-4c50-a713-26cbe7ec4039,SQLServer Ingress From Any IP,Ansible,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/azure/sql_server_ingress_from_any_ip,Unknown,"Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/azure/azcollection/azure_rm_sqlfirewallrule_module.html)","- name: Create (or update) Firewall Rule
  azure.azcollection.azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 172.28.10.136
    end_ip_address: 172.28.10.138
- name: Create (or update) Firewall Rule2
  azure.azcollection.azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 0.0.0.0
    end_ip_address: 0.0.0.3
- name: Create (or update) Firewall Rule3
  azure.azcollection.azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 255.255.255.250
    end_ip_address: 255.255.255.255","---
- name: Create (or update) Firewall Rule
  azure.azcollection.azure_rm_sqlfirewallrule:
    resource_group: myResourceGroup
    server_name: firewallrulecrudtest-6285
    name: firewallrulecrudtest-5370
    start_ip_address: 0.0.0.0
    end_ip_address: 255.255.255.255",[[8]]
175,086031e1-9d4a-4249-acb3-5bfe4c363db2,Cloud Storage Anonymous or Publicly Accessible,Ansible,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_storage_anonymous_or_publicly_accessible,Unknown,"Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'entity' must not be 'allUsers' or 'allAuthenticatedUsers'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_storage_bucket_module.html)","#this code is a correct code for which the query should not find any result
- name: create a bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    acl:
      bucket: bucketName
      entity: group-example@googlegroups.com","#this is a problematic code where the query should report a result(s)
- name: create a bucket1
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    default_object_acl:
      bucket: bucketName1
      entity: allUsers
      role: READER
- name: create a bucket2
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module2
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    acl:
      bucket: bucketName2
      entity: allAuthenticatedUsers
    default_object_acl:
      bucket: bucketName2
      entity: allUsers
      role: READER
- name: create a bucket3
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module3
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[11, 28, 22]]"
176,092bae86-6105-4802-99d2-99cd7e7431f3,Disk Encryption Disabled,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/disk_encryption_disabled,Unknown,"VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_disk_module.html)","#this code is a correct code for which the query should not find any result
- name: create a disk
  google.cloud.gcp_compute_disk:
    name: test_object
    size_gb: 50
    disk_encryption_key:
      raw_key: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present

#this code is a correct code for which the query should not find any result
- name: create a disk
  google.cloud.gcp_compute_disk:
    name: test_object
    size_gb: 50
    disk_encryption_key:
      kms_key_name: disk-crypto-key
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","#this is a problematic code where the query should report a result(s)
- name: create a disk1
  google.cloud.gcp_compute_disk:
    name: test_object1
    size_gb: 50
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a disk3
  google.cloud.gcp_compute_disk:
    name: test_object3
    size_gb: 50
    disk_encryption_key:
      raw_key:
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a disk4
  google.cloud.gcp_compute_disk:
    name: test_object4
    size_gb: 50
    disk_encryption_key:
      raw_key: """"
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present

- name: create a disk3
  google.cloud.gcp_compute_disk:
    name: test_object3
    size_gb: 50
    disk_encryption_key:
      kms_key_name:
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a disk4
  google.cloud.gcp_compute_disk:
    name: test_object4
    size_gb: 50
    disk_encryption_key:
      kms_key_name: """"
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[27, 3, 15], [17, 5]]"
177,099b4411-d11e-4537-a0fc-146b19762a79,Project-wide SSH Keys Are Enabled In VM Instances,Ansible,Medium,Secret Management,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/project_wide_ssh_keys_are_enabled_in_vm_instances,Unknown,"VM Instance should block project-wide SSH keys<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","- name: ssh_keys_blocked
  google.cloud.gcp_compute_instance:
    metadata:
      block-project-ssh-keys: yes
    zone: us-central1-a
    auth_kind: serviceaccount","- name: ssh_keys_unblocked
  google.cloud.gcp_compute_instance:
    metadata:
      block-project-ssh-keys: no
    zone: us-central1-a
    auth_kind: serviceaccount
- name: ssh_keys_missing
  google.cloud.gcp_compute_instance:
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    zone: us-central1-a
    auth_kind: serviceaccount
- name: no_metadata
  google.cloud.gcp_compute_instance:
    zone: us-central1-a
    auth_kind: serviceaccount","[[9, 4, 15]]"
178,0c82eae2-aca0-401f-93e4-fb37a0f9e5e8,SQL DB Instance Backup Disabled,Ansible,Medium,Backup,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/sql_db_instance_backup_disabled,Unknown,"Checks if backup configuration is enabled for all Cloud SQL Database instances<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/backup_configuration/enabled)","- name: create a instance
  google.cloud.gcp_sql_instance:
    name: '{{ resource_name }}-2'
    settings:
      backup_configuration:
        binary_log_enabled: yes
        enabled: yes
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","---
- name: create a instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a second instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a third instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      backup_configuration:
        binary_log_enabled: yes
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a forth instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      backup_configuration:
        binary_log_enabled: yes
        enabled: no
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[24, 3, 13, 38]]"
179,11bd3554-cd56-4257-8e25-7aaf30cf8f5f,IP Forwarding Enabled,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/ip_forwarding_enabled,Unknown,"Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","#this code is a correct code for which the query should not find any result
- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: '{{ network }}'
      access_configs:
      - name: External NAT
        nat_ip: '{{ address }}'
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    can_ip_forward: no","#this is a problematic code where the query should report a result(s)
- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    can_ip_forward: yes",[[22]]
180,18d3a83d-4414-49dc-90ea-f0387b2856cc,Shielded VM Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/shielded_vm_disabled,Unknown,"Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","#this code is a correct code for which the query should not find any result
- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: '{{ disk }}'
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: '{{ network }}'
      access_configs:
      - name: External NAT
        nat_ip: '{{ address }}'
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: yes
      enable_secure_boot: yes
      enable_vtpm: yes","#this is a problematic code where the query should report a result(s)
- name: create a instance1
  google.cloud.gcp_compute_instance:
    name: test_object1
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a instance2
  google.cloud.gcp_compute_instance:
    name: test_object2
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_secure_boot: yes
      enable_vtpm: yes
- name: create a instance3
  google.cloud.gcp_compute_instance:
    name: test_object3
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: yes
      enable_vtpm: yes
- name: create a instance4
  google.cloud.gcp_compute_instance:
    name: test_object4
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: yes
      enable_secure_boot: yes
- name: create a instance5
  google.cloud.gcp_compute_instance:
    name: test_object5
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: no
      enable_secure_boot: yes
      enable_vtpm: yes
- name: create a instance6
  google.cloud.gcp_compute_instance:
    name: test_object6
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: yes
      enable_secure_boot: no
      enable_vtpm: yes
- name: create a instance7
  google.cloud.gcp_compute_instance:
    name: test_object7
    machine_type: n1-standard-1
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    shielded_instance_config:
      enable_integrity_monitoring: yes
      enable_secure_boot: yes
      enable_vtpm: no","[[65, 162, 3, 137, 42, 112, 88]]"
181,19c9e2a0-fc33-4264-bba1-e3682661e8f7,Stackdriver Logging Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/stackdriver_logging_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    logging_service: logging.googleapis.com","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    logging_service: none","[[32, 3]]"
182,20180133-a0d0-4745-bfe0-94049fbb12a9,Client Certificate Disabled,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/client_certificate_disabled,Unknown,"Kubernetes Clusters must be created with Client Certificate enabled, which means 'master_auth' must have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to true<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
      client_certificate_config:
        issue_client_certificate: yes
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
      client_certificate_config:
        issue_client_certificate: no
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[18, 3, 37]]"
183,20dcd953-a8b8-4892-9026-9afa6d05a525,Stackdriver Monitoring Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/stackdriver_monitoring_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    monitoring_service: monitoring.googleapis.com","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    monitoring_service: none","[[32, 3]]"
184,2263b286-2fe9-4747-a0ae-8b4768a2bbd2,BigQuery Dataset Is Public,Ansible,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/bigquery_dataset_is_public,Unknown,"BigQuery dataset is anonymously or publicly accessible<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_bigquery_dataset_module.html#parameter-access/special_group)","- name: create a dataset
  google.cloud.gcp_bigquery_dataset:
    name: my_example_dataset
    dataset_reference:
      dataset_id: my_example_dataset
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","---
- name: create a dataset
  google.cloud.gcp_bigquery_dataset:
    name: my_example_dataset
    access:
      - special_group: allAuthenticatedUsers
    dataset_reference:
      dataset_id: my_example_dataset
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present",[[5]]
185,2775e169-e708-42a9-9305-b58aadd2c4dd,Using Default Service Account,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/using_default_service_account,Unknown,"Instances must not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account_email' must be defined. Additionally, it must not be empty and must also not be a default Google Compute Engine service account.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","#this code is a correct code for which the query should not find any result
- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: '{{ disk }}'
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: '{{ network }}'
      access_configs:
      - name: External NAT
        nat_ip: '{{ address }}'
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_email: admin@admin.com
    state: present","#this is a problematic code where the query should report a result(s)
- name: create a instance1
  google.cloud.gcp_compute_instance:
    name: test_object1
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: ""{{ disk }}""
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    state: present
- name: create a instance2
  google.cloud.gcp_compute_instance:
    name: test_object2
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: ""{{ disk }}""
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_email: """"
    state: present
- name: create a instance3
  google.cloud.gcp_compute_instance:
    name: test_object3
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: ""{{ disk }}""
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_email: ""admin""
    state: present
- name: create a instance4
  google.cloud.gcp_compute_instance:
    name: test_object4
    machine_type: n1-standard-1
    disks:
    - auto_delete: 'true'
      boot: 'true'
      source: ""{{ disk }}""
    - auto_delete: 'true'
      interface: NVME
      type: SCRATCH
      initialize_params:
        disk_type: local-ssd
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    labels:
      environment: production
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_email: ""admin@developer.gserviceaccount.com""
    state: present","[[115, 57, 3, 86]]"
186,28a757fc-3d8f-424a-90c0-4233363b2711,PostgreSQL Misconfigured Log Messages Flag,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/postgresql_misconfigured_log_messages_flag,Unknown,"PostgreSQL database 'log_min_messages' flag isn't set to a valid value<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_min_messages
        value: log
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_min_messages
        value: debug6
      tier: db-n1-standard-1
    state: present",[[11]]
187,29b8224a-60e9-4011-8ac2-7916a659841f,Google Compute Network Using Default Firewall Rule,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_compute_network_using_default_firewall_rule,Unknown,"Google Compute Network should not use default firewall rule<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_firewall_module.html#parameter-name)","- name: create a firewall
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '22'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network: ""{{ my_network }}""
- name: create a network
  google.cloud.gcp_compute_network:
    name: test_object
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network","- name: create a firewall2
  google.cloud.gcp_compute_firewall:
    name: default
    allowed:
    - ip_protocol: tcp
      ports:
      - '22'
    state: present
    network: ""{{ my_network2 }}""
- name: create a network2
  google.cloud.gcp_compute_network:
    name: test_object2
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network2",[[11]]
188,300a9964-b086-41f7-9378-b6de3ba1c32b,GKE Legacy Authorization Enabled,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/gke_legacy_authorization_enabled,Unknown,"Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacy_abac.enabled' must be false.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    legacy_abac:
      enabled: no","#this is a problematic code where the query should report a result(s)
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    legacy_abac:
      enabled: yes",[[18]]
189,344bf8ab-9308-462b-a6b2-697432e40ba1,GKE Basic Authentication Enabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/gke_basic_authentication_enabled,Unknown,"GCP - Google Kubernetes Engine (GKE) Basic Authentication must be disabled, which means the username and password provided in the master_auth block must be empty<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: ''
      password: ''
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      password: """"
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: """"
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster4
  google.cloud.gcp_container_cluster:
    name: my-cluster4
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: """"
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster5
  google.cloud.gcp_container_cluster:
    name: my-cluster5
    initial_node_count: 2
    master_auth:
      username: """"
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[32, 3, 47, 18, 63]]"
190,3602d273-3290-47b2-80fa-720162b1a8af,Google Compute Network Using Firewall Rule that Allows All Ports,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_compute_network_using_firewall_rule_allows_all_ports,Unknown,"Google Compute Network should not use a firewall rule that allows all ports<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_firewall_module.html#parameter-allowed)","- name: create a firewall
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '22'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network: ""{{ my_network }}""
- name: create a network
  google.cloud.gcp_compute_network:
    name: test_object
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network","- name: create a firewall2
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '0-65535'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network: ""{{ my_network2 }}""
- name: create a network2
  google.cloud.gcp_compute_network:
    name: test_object
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network2",[[19]]
191,3b30e3d6-c99b-4318-b38f-b99db74578b5,Private Cluster Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/private_cluster_disabled,Unknown,"Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_endpoint' and 'enable_private_nodes' must be true.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    private_cluster_config:
      enable_private_endpoint: yes
      enable_private_nodes: yes","- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    private_cluster_config:
      enable_private_endpoint: yes
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    private_cluster_config:
      enable_private_nodes: yes
- name: create a cluster4
  google.cloud.gcp_container_cluster:
    name: my-cluster4
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    private_cluster_config:
      enable_private_endpoint: no
      enable_private_nodes: yes
- name: create a cluster5
  google.cloud.gcp_container_cluster:
    name: my-cluster5
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    private_cluster_config:
      enable_private_endpoint: yes
      enable_private_nodes: no","[[2, 66, 48, 85, 31]]"
192,507df964-ad97-4035-ab14-94a82eabdfdd,Cloud Storage Bucket Logging Not Enabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_storage_bucket_logging_not_enabled,Unknown,"Cloud storage bucket should have logging enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_storage_bucket_module.html#parameter-logging)","- name: create a bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    logging:
      log_bucket: a_bucket_for_logs
      log_object_prefix: log","---
- name: create a bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present",[[3]]
193,66dae697-507b-4aef-be18-eec5bd707f33,OSLogin Is Disabled In VM Instance,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/oslogin_is_disabled_for_vm_instance,Unknown,"VM instance should have OSLogin enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","- name: oslogin-enabled
  google.cloud.gcp_compute_instance:
    metadata:
      enable-oslogin: yes
    zone: us-central1-a
    auth_kind: serviceaccount
- name: oslogin-missing
  google.cloud.gcp_compute_instance:
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    zone: us-central1-a
    auth_kind: serviceaccount","- name: oslogin-disabled
  google.cloud.gcp_compute_instance:
    metadata:
      enable-oslogin: no
    zone: us-central1-a
    auth_kind: serviceaccount",[[4]]
194,6a4080ae-79bd-42f6-a924-8f534c1c018b,Google Compute Subnetwork with Private Google Access Disabled,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_compute_subnetwork_with_private_google_access_disabled,Unknown,"Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to yes<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_subnetwork_module.html#parameter-private_ip_google_access)","- name: create a subnetwork3
  google.cloud.gcp_compute_subnetwork:
    name: ansiblenet
    region: us-west1
    network: ""{{ network }}""
    ip_cidr_range: 172.16.0.0/16
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    private_ip_google_access: yes
    state: present","- name: create a subnetwork
  google.cloud.gcp_compute_subnetwork:
    name: ansiblenet
    region: us-west1
    network: ""{{ network }}""
    ip_cidr_range: 172.16.0.0/16
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present

- name: create a subnetwork2
  google.cloud.gcp_compute_subnetwork:
    name: ansiblenet
    region: us-west1
    network: ""{{ network }}""
    ip_cidr_range: 172.16.0.0/16
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    private_ip_google_access: no
    state: present","[[2], [10]]"
195,6cf4c3a7-ceb0-4475-8892-3745b84be24a,DNSSEC Using RSASHA1,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/dnssec_using_rsasha1,Unknown,"DNSSEC should not use the RSASHA1 algorithm<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_dns_managed_zone_module.html#return-dnssecConfig/defaultKeySpecs/algorithm)","- name: create a managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    dnssec_config:
      defaultKeySpecs:
        algorithm: RSASHA256
      state: off","---
- name: create a managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    dnssec_config:
      defaultKeySpecs:
        algorithm: RSASHA1
      state: off",[[13]]
196,6d34aff3-fdd2-460c-8190-756a3b4969e8,Cloud SQL Instance With Contained Database Authentication On,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_sql_instance_with_contained_database_authentication_on,Unknown,"SQL Instance should not have Contained Database Authentication On<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: name1
        value: value1
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: contained database authentication
        value: on
      tier: db-n1-standard-1
    state: present",[[10]]
197,7289eebd-a477-4064-8ad4-3c044bd70b00,Google Compute Network Using Firewall Rule that Allows Port Range,Ansible,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_compute_network_using_firewall_allows_port_range,Unknown,"Google Compute Network should not use a firewall rule that allows port range<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_firewall_module.html#parameter-allowed)","- name: create a firewall
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '22'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network: ""{{ my_network }}""
- name: create a network
  google.cloud.gcp_compute_network:
    name: test_object
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network","- name: create a firewall2
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '20-1000'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network: ""{{ my_network2 }}""
- name: create a network2
  google.cloud.gcp_compute_network:
    name: test_object
    auto_create_subnetworks: 'true'
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: my_network2",[[19]]
198,75418eb9-39ec-465f-913c-6f2b6a80dc77,RDP Access Is Not Restricted,Ansible,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/rdp_access_is_not_restricted,Unknown,"Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_firewall_module.html)","- name: create a firewall
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '80'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","- name: rdp_in_range
  google.cloud.gcp_compute_firewall:
    name: test_object
    source_ranges:
      - ""0.0.0.0/0""
    allowed:
      - ip_protocol: tcp
        ports:
          - ""22""
          - ""80""
          - ""8080""
          - ""2000-4000""
    target_tags:
      - test-ssh-server
      - staging-ssh-server
    source_tags:
      - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: rdp_in_port
  google.cloud.gcp_compute_firewall:
    name: test_object
    source_ranges:
      - ""0.0.0.0/0""
    allowed:
      - ip_protocol: tcp
        ports:
          - ""22""
          - ""80""
          - ""3389""
    target_tags:
      - test-ssh-server
      - staging-ssh-server
    source_tags:
      - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[8, 29]]"
199,7814ddda-e758-4a56-8be3-289a81ded929,Cloud Storage Bucket Versioning Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_storage_bucket_versioning_disabled,Unknown,"Cloud Storage Bucket should have versioning enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_storage_bucket_module.html#parameter-versioning)","- name: create a bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    versioning:
      enabled: yes","---
- name: create a bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a second bucket
  google.cloud.gcp_storage_bucket:
    name: ansible-storage-module
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    versioning:
      enabled: no","[[17, 3]]"
200,7d7054c0-3a52-4e9b-b9ff-cbfe16a2378b,SQL DB Instance Publicly Accessible,Ansible,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/sql_db_instance_is_publicly_accessible,Unknown,"Cloud SQL instances should not be publicly accessible.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      ip_configuration:
        authorized_networks:
        - name: google dns server
          value: 8.8.8.8/32
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      ip_configuration:
        authorized_networks:
          - name: ""google dns server""
            value: ""0.0.0.0""
      tier: db-n1-standard-1
    state: present
- name: sql_instance2
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      ip_configuration:
        ipv4_enabled: yes
      tier: db-n1-standard-1
    state: present
- name: sql_instance3
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      tier: db-n1-standard-1
    state: present","[[24, 34, 12]]"
201,80b15fb1-6207-40f4-a803-6915ae619a03,Cloud DNS Without DNSSEC,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/350.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_dns_without_dnnsec,Unknown,"DNSSEC must be enabled for Cloud DNS<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_dns_managed_zone_module.html#return-dnssecConfig/state)","- name: create a managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    dnssec_config:
      kind: some_kind
      state: on","---
- name: create a managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a second managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    dnssec_config:
      kind: some_kind
- name: create a third managed zone
  google.cloud.gcp_dns_managed_zone:
    name: test_object
    dns_name: test.somewild2.example.com.
    description: test zone
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    dnssec_config:
      kind: some_kind
      state: off","[[33, 3, 20]]"
202,829f1c60-2bab-44c6-8a21-5cd9d39a2c82,Compute Instance Is Publicly Accessible,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/compute_instance_is_publicly_accessible,Unknown,"Compute instances shouldn't be accessible from the Internet.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html#parameter-network_interfaces/access_configs)","- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    network_interfaces:
    - network: '{{ network }}'
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    state: present","- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    network_interfaces:
    - network: ""{{ network }}""
      access_configs:
      - name: External NAT
        nat_ip: ""{{ address }}""
        type: ONE_TO_ONE_NAT
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    state: present",[[6]]
203,89afe3f0-4681-4ce3-89ed-896cebd4277c,PostgreSQL log_checkpoints Flag Not Set To ON,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/postgresql_log_checkpoints_flag_not_set_to_on,Unknown,"PostgreSQL database instance should have a 'log_checkpoints' flag with its value set to 'on'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: create a instance
  google.cloud.gcp_sql_instance:
    name: GCP instance
    settings:
      databaseFlags:
      - name: log_checkpoints
        value: on
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","- name: create instance
  google.cloud.gcp_sql_instance:
    name: GCP instance
    settings:
      databaseFlags:
      - name: log_checkpoints
        value: off
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create another instance
  google.cloud.gcp_sql_instance:
    name: GCP instance 2
    settings:
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[16, 5]]"
204,98e04ca0-34f5-4c74-8fec-d2e611ce2790,Network Policy Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/network_policy_disabled,Unknown,"Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    network_policy:
      enabled: yes
    addons_config:
      network_policy_config:
        disabled: no","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    addons_config:
      network_policy_config:
        disabled: false
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network_policy:
      enabled: yes
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network_policy:
      enabled: yes
    addons_config:
      horizontal_pod_autoscaling:
        disabled: yes
- name: create a cluster4
  google.cloud.gcp_container_cluster:
    name: my-cluster4
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network_policy:
      enabled: no
    addons_config:
      network_policy_config:
        disabled: no
- name: create a cluster5
  google.cloud.gcp_container_cluster:
    name: my-cluster5
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    network_policy:
      enabled: yes
    addons_config:
      network_policy_config:
        disabled: yes","[[96, 3, 73, 21, 54]]"
205,9df7f78f-ebe3-432e-ac3b-b67189c15518,Cluster Master Authentication Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cluster_master_authentication_disabled,Unknown,"Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'master_auth' must have the subattributes 'username' and 'password' defined and not empty<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","#this code is a correct code for which the query should not find any result
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","#this is a problematic code where the query should report a result(s)
- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster4
  google.cloud.gcp_container_cluster:
    name: my-cluster4
    initial_node_count: 2
    master_auth:
      username:
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster5
  google.cloud.gcp_container_cluster:
    name: my-cluster5
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password:
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[32, 3, 46, 18, 61]]"
206,9e0c33ed-97f3-4ed6-8be9-bcbf3f65439f,Cloud SQL Instance With Cross DB Ownership Chaining On,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cloud_sql_instance_with_cross_db_ownership_chaining_on,Unknown,"GCP SQL Instance should not have Cross DB Ownership Chaining On<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: name1
        value: value1
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: cross db ownership chaining
        value: on
      tier: db-n1-standard-1
    state: present",[[10]]
207,a7b520bb-2509-4fb0-be05-bc38f54c7a4c,MySQL Instance With Local Infile On,Ansible,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/mysql_instance_with_local_infile_on,Unknown,"MySQL Instance should not have Local Infile On<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: name1
        value: value1
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: MYSQL_5_6
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: local_infile
        value: on
      tier: db-n1-standard-1
    state: present",[[10]]
208,aed98a2a-e680-497a-8886-277cea0f4514,PostgreSQL Misconfigured Logging Duration Flag,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/postgresql_misconfigured_logging_duration_flag,Unknown,"PostgreSQL database 'log_min_duration_statement' flag isn't set to '-1'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_min_duration_statement
        value: -1
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_min_duration_statement
        value: 0
      tier: db-n1-standard-1
    state: present",[[10]]
209,b28bcd2f-c309-490e-ab7c-35fc4023eb26,Google Compute SSL Policy Weak Cipher In Use,Ansible,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_compute_ssl_policy_weak_cipher_in_use,Unknown,"This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_ssl_policy_module.html)","- name: create a SSL policy
  google.cloud.gcp_compute_ssl_policy:
    name: test_object
    profile: CUSTOM
    min_tls_version: TLS_1_2
    custom_features:
    - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","- name: create a SSL policy
  google.cloud.gcp_compute_ssl_policy:
    name: test_object
    profile: CUSTOM
    custom_features:
    - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a SSL policy2
  google.cloud.gcp_compute_ssl_policy:
    name: test_object2
    profile: CUSTOM
    min_tls_version: TLS_1_1
    custom_features:
    - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[16, 2]]"
210,b2fbf1df-76dd-4d78-a6c0-e538f4a9b016,SSH Access Is Not Restricted,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/ssh_access_is_not_restricted,Unknown,"Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_firewall_module.html)","- name: ssh_restricted
  google.cloud.gcp_compute_firewall:
    name: test_object
    denied:
    - ip_protocol: tcp
      ports:
      - '22'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    source_ranges:
    - 0.0.0.0","- name: ssh_unrestricted
  google.cloud.gcp_compute_firewall:
    name: test_object
    allowed:
    - ip_protocol: tcp
      ports:
      - '22'
    target_tags:
    - test-ssh-server
    - staging-ssh-server
    source_tags:
    - test-ssh-clients
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    source_ranges:
    - ""0.0.0.0/0""",[[6]]
211,bc20bbc6-0697-4568-9a73-85af1dd97bdd,VM With Full Cloud Access,Ansible,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/vm_with_full_cloud_access,Unknown,"A VM instance is configured to use the default service account with full access to all Cloud APIs<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html#parameter-service_accounts/scopes)","- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    state: present","- name: create a instance
  google.cloud.gcp_compute_instance:
    name: test_object
    zone: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_accounts:
      - scopes:
          - cloud-platform
    state: present",[[7]]
212,be41f891-96b1-4b9d-b74f-b922a918c778,COS Node Image Not Used,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/1021.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cos_node_image_not_used,Unknown,"The node image should be Container-Optimized OS(COS)<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_node_pool_module.html#parameter-config/image_type)","- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: '{{ cluster }}'
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    config:
      image_type: COS

- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    config:
      image_type: COS_CONTAINERD","---
- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    config:
      image_type: WINDOWS_LTSC",[[13]]
213,c6fc6f29-dc04-46b6-99ba-683c01aff350,Serial Ports Are Enabled For VM Instances,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/serial_ports_enabled_for_vm_instances,Unknown,"Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_compute_instance_module.html)","- name: serial_disabled
  google.cloud.gcp_compute_instance:
    metadata:
      serial-port-enabled: no
    zone: us-central1-a
    auth_kind: serviceaccount
- name: serial_undefined
  google.cloud.gcp_compute_instance:
    metadata:
      startup-script-url: gs:://graphite-playground/bootstrap.sh
      cost-center: '12345'
    zone: us-central1-a
    auth_kind: serviceaccount","- name: serial_enabled
  google.cloud.gcp_compute_instance:
    metadata:
      serial-port-enable: yes
    zone: us-central1-a
    auth_kind: serviceaccount",[[4]]
214,d0f7da39-a2d5-4c78-bb85-4b7f338b3cbb,SQL DB Instance With SSL Disabled,Ansible,High,Encryption,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/sql_db_instance_with_ssl_disabled,Unknown,"Cloud SQL Database Instance should have SSL enabled<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/ip_configuration/require_ssl)","- name: create a instance
  google.cloud.gcp_sql_instance:
    name: '{{ resource_name }}-2'
    settings:
      ip_configuration:
        require_ssl: yes
        authorized_networks:
        - name: google dns server
          value: 8.8.8.8/32
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","---
- name: create a instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a second instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a third instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      ip_configuration:
        authorized_networks:
        - name: google dns server
          value: 8.8.8.8/32
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a forth instance
  google.cloud.gcp_sql_instance:
    name: ""{{ resource_name }}-2""
    settings:
      ip_configuration:
        require_ssl: no
        authorized_networks:
        - name: google dns server
          value: 8.8.8.8/32
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[24, 3, 13, 39]]"
215,d43366c5-80b0-45de-bbe8-2338f4ab0a83,GKE Master Authorized Networks Disabled,Ansible,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/gke_master_authorized_networks_disabled,Unknown,"Master authorized networks must be enabled in GKE clusters<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html#parameter-master_authorized_networks_config/enabled)","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    location: us-central1-a
    auth_kind: serviceaccount
    master_authorized_networks_config:
      cidr_blocks:
      - cidr_block: 192.0.2.0/24
      enabled: yes
    state: present","---
- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    location: us-central1-a
    auth_kind: serviceaccount
    master_authorized_networks_config:
      cidr_blocks:
        - cidr_block: 192.0.2.0/24
      enabled: no
    state: present
- name: create a second cluster
  google.cloud.gcp_container_cluster:
    name: my-second-cluster
    location: us-central1-a
    auth_kind: serviceaccount
    master_authorized_networks_config:
      cidr_blocks:
        - cidr_block: 192.0.2.0/24
    state: present
- name: create a third cluster
  google.cloud.gcp_container_cluster:
    name: my-third-cluster
    location: us-central1-a
    auth_kind: serviceaccount
    state: present","[[17, 10, 22]]"
216,d58c6f24-3763-4269-9f5b-86b2569a003b,Google Container Node Pool Auto Repair Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/google_container_node_pool_auto_repair_disabled,Unknown,"Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_node_pool_module.html)","- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: '{{ cluster }}'
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    management:
      auto_repair: yes

- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: '{{ cluster }}'
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    management:
      auto_repair: true","---
- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    management:
      auto_repair: no

- name: create a node pool2
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    management:
      auto_repair: false

- name: create a node pool3
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[26, 29, 13]]"
217,d6e10477-2e19-4bcd-b8a8-19c65b89ccdf,Node Auto Upgrade Disabled,Ansible,Medium,Resource Management,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/node_auto_upgrade_disabled,Unknown,"Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_node_pool_module.html#parameter-management/auto_upgrade)","- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: '{{ cluster }}'
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    management:
      auto-repair: yes
      auto_upgrade: yes","---
- name: create a node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a second node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    management:
      auto_repair: yes
- name: create a third node pool
  google.cloud.gcp_container_node_pool:
    name: my-pool
    initial_node_count: 4
    cluster: ""{{ cluster }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    management:
      auto_repair: yes
      auto_upgrade: no","[[3, 36, 22]]"
218,d6fae5b6-ada9-46c0-8b36-3108a2a2f77b,PostgreSQL Logging Of Temporary Files Disabled,Ansible,Low,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/postgresql_logging_of_temporary_files_disabled,Unknown,"PostgreSQL database 'log_temp_files' flag isn't set to '0'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: '{{ resource_name }}-2'
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_temp_files
        value: 0
      tier: db-n1-standard-1
    state: present","- name: sql_instance
  google.cloud.gcp_sql_instance:
    auth_kind: serviceaccount
    database_version: SQLSERVER_13_1
    name: ""{{ resource_name }}-2""
    project: test_project
    region: us-central1
    service_account_file: /tmp/auth.pem
    settings:
      database_flags:
      - name: log_temp_files
        value: 1
      tier: db-n1-standard-1
    state: present",[[10]]
219,d7a5616f-0a3f-4d43-bc2b-29d1a183e317,PostgreSQL Log Connections Disabled,Ansible,Medium,Observability,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/postgresql_log_connections_disabled,Unknown,"PostgreSQL database instance should have a 'log_connections' flag with its value set to 'on'<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_sql_instance_module.html#parameter-settings/database_flags)","- name: create a instance
  google.cloud.gcp_sql_instance:
    name: GCP instance
    settings:
      databaseFlags:
      - name: log_connections
        value: on
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present","- name: create instance
  google.cloud.gcp_sql_instance:
    name: GCP instance
    settings:
      databaseFlags:
      - name: log_connections
        value: off
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create another instance
  google.cloud.gcp_sql_instance:
    name: GCP instance 2
    settings:
      tier: db-n1-standard-1
    region: us-central1
    project: test_project
    database_version: POSTGRES_9_6
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[16, 5]]"
220,dc126833-125a-40fb-905a-ce5f2afde240,GKE Using Default Service Account,Ansible,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/gke_using_default_service_account,Unknown,"Kubernetes Engine Clusters should not be configured to use the default service account<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html#parameter-node_config/service_account)","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
      service_account: ""{{ myaccount }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a service account
  google.cloud.gcp_iam_service_account:
    name: sa-{{ resource_name.split(""-"")[-1] }}@graphite-playground.google.com.iam.gserviceaccount.com
    display_name: My Ansible test key
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: myaccount","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present

- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
      service_account: ""{{ default }}""
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a service account
  google.cloud.gcp_iam_service_account:
    name: sa-{{ resource_name.split(""-"")[-1] }}@graphite-playground.google.com.iam.gserviceaccount.com
    display_name: My Ansible test key
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
  register: default","[[8], [11]]"
221,ed672a9f-fbf0-44d8-a47d-779501b0db05,IP Aliasing Disabled,Ansible,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/ip_aliasing_disabled,Unknown,"Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ip_allocation_policy' must be defined and the subattribute 'use_ip_aliases' must be set to 'yes'.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    ip_allocation_policy:
      create_subnetwork: no
      use_ip_aliases: yes","- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster2
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    ip_allocation_policy:
      create_subnetwork: no
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    ip_allocation_policy:
      create_subnetwork: no
      use_ip_aliases: no","[[2, 50, 31]]"
222,f9b7086b-deb8-4034-9330-d7fd38f1b8de,High Google KMS Crypto Key Rotation Period,Ansible,Medium,Secret Management,https://cwe.mitre.org/data/definitions/325.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/high_google_kms_crypto_key_rotation_period,Unknown,"KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_kms_crypto_key_module.html)","- name: create a key ring
  google.cloud.gcp_kms_key_ring:
    name: key-key-ring
    location: us-central1
    project: '{{ gcp_project }}'
    auth_kind: '{{ gcp_cred_kind }}'
    service_account_file: '{{ gcp_cred_file }}'
    state: present
  register: keyring

- name: create a crypto key
  google.cloud.gcp_kms_crypto_key:
    name: test_object
    key_ring: projects/{{ gcp_project }}/locations/us-central1/keyRings/key-key-ring
    project: test_project
    auth_kind: serviceaccount
    rotation_period: 7776000s
    service_account_file: /tmp/auth.pem
    state: present","---
- name: create a key ring
  google.cloud.gcp_kms_key_ring:
    name: key-key-ring
    location: us-central1
    project: ""{{ gcp_project }}""
    auth_kind: ""{{ gcp_cred_kind }}""
    service_account_file: ""{{ gcp_cred_file }}""
    state: present
  register: keyring

- name: create a crypto key
  google.cloud.gcp_kms_crypto_key:
    name: test_object
    key_ring: projects/{{ gcp_project }}/locations/us-central1/keyRings/key-key-ring
    project: test_project
    auth_kind: serviceaccount
    rotation_period: ""315356000s""
    service_account_file: ""/tmp/auth.pem""
    state: present

- name: create a crypto key2
  google.cloud.gcp_kms_crypto_key:
    name: test_object
    key_ring: projects/{{ gcp_project }}/locations/us-central1/keyRings/key-key-ring
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present","[[18, 23]]"
223,fbe9b2d0-a2b7-47a1-a534-03775f3013f7,Cluster Labels Disabled,Ansible,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/gcp/cluster_labels_disabled,Unknown,"Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/google/cloud/gcp_container_cluster_module.html)","- name: create a cluster
  google.cloud.gcp_container_cluster:
    name: my-cluster
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: /tmp/auth.pem
    state: present
    resource_labels: label1","- name: create a cluster1
  google.cloud.gcp_container_cluster:
    name: my-cluster1
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
- name: create a cluster2
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    resource_labels:
- name: create a cluster3
  google.cloud.gcp_container_cluster:
    name: my-cluster3
    initial_node_count: 2
    master_auth:
      username: cluster_admin
      password: my-secret-password
    node_config:
      machine_type: n1-standard-4
      disk_size_gb: 500
    location: us-central1-a
    project: test_project
    auth_kind: serviceaccount
    service_account_file: ""/tmp/auth.pem""
    state: present
    resource_labels: """"","[[17, 2, 47]]"
224,1367dd13-2c90-4020-80b7-e4339a3dc2c4,Storage Account Allows Unsecure Transfer,AzureResourceManager,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/storage_account_allows_unsecure_transfer,Unknown,"'Microsoft.Storage/storageAccounts' should force the use of HTTPS<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#storageaccountpropertiescreateparameters-object)",,,[]
225,2081c7d6-2851-4cce-bda5-cb49d462da42,Standard Price Is Not Selected,AzureResourceManager,Low,Resource Management,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/standard_price_not_selected,Unknown,"Azure Security Center provides more features for standard pricing mode, so it must be activated.<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.security/pricings?tabs=json#pricingproperties-object)",,,[]
226,25684eac-daaa-4c2c-94b4-8d2dbb627909,Unrecommended Log Profile Retention Policy,AzureResourceManager,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/unrecommended_log_profile_retention_policy,Unknown,"Log Profile Retention Policy should be enabled and the recommended number of days for the retention should be higher than 365 or 0 (0 will retain the events indefinitely)<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2016-03-01/logprofiles?tabs=json#retentionpolicy-object)",,,[]
227,2583fab1-953b-4fae-bd02-4a136a6c21f9,AKS With Authorized IP Ranges Disabled,AzureResourceManager,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/aks_with_authorized_ip_ranges_disabled,Unknown,"Azure Kubernetes Service must have an authorized IP range for API Services enabled<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusterapiserveraccessprofile-object)",,,[]
228,25c0228e-4444-459b-a2df-93c7df40b7ed,AKS Cluster Network Policy Not Configured,AzureResourceManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/aks_cluster_network_policy_not_configured,Unknown,"Azure Kubernetes Service must have a network policy defined.<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#containerservicenetworkprofile-object)",,,[]
229,2ade1579-4b2c-4590-bebb-f99bf597f612,Network Security Group With Unrestricted Access To SSH,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/network_security_group_with_unrestricted_access_to_ssh,Unknown,"Port 22 (SSH) is exposed to the Internet<br>
[Documentation](https://learn.microsoft.com/en-us/azure/templates/microsoft.network/networksecuritygroups?pivots=deployment-language-bicep#securityrulepropertiesformat)",,,[]
230,350f3955-b5be-436f-afaa-3d2be2fa6cdd,Azure Managed Disk Without Encryption,AzureResourceManager,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/azure_managed_disk_without_encryption,Unknown,"Azure Disk Encryption should be enabled<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.compute/disks?tabs=json#encryptionsettingscollection-object)",,,[]
231,3e9fcc67-1f64-405f-b2f9-0a6be17598f0,Phone Number Not Set For Security Contacts,AzureResourceManager,Low,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/phone_number_not_set_security_contacts,Unknown,"Microsoft.Security securityContacts should have a phone number defined<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.security/securitycontacts?tabs=json)",,,[]
232,43f6e60c-9cdb-4e77-864d-a66595d26518,Storage Logging For Read Write And Delete Requests Disabled,AzureResourceManager,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/storage_logging_for_read_write_delete_requests_disabled,Unknown,"Storage Logging should be enabled for read, write and delete methods<br>
[Documentation](https://docs.microsoft.com/pt-pt/azure/azure-monitor/essentials/resource-manager-diagnostic-settings#diagnostic-setting-for-azure-storage)",,,[]
233,488847ff-6031-487c-bf42-98fd6ac5c9a0,Website Not Forcing HTTPS,AzureResourceManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/website_not_forcing_https,Unknown,"'Microsoft.Web/sites' should force the use of HTTPS<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object)",,,[]
234,4d2cf896-c053-4be5-9c95-8b4771112f29,Hardcoded SecureString Parameter Default Value,AzureResourceManager,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/hardcoded_securestring_parameter_default_value,Unknown,"Secure parameters should not have hardcoded default value<br>
[Documentation](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-test-cases#secure-parameters-cant-have-hardcoded-default)",,,[]
235,4d522e7b-f938-4d51-a3b1-974ada528bd3,Log Profile Incorrect Category,AzureResourceManager,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/log_profile_incorrect_category,Unknown,"Log Profile Categories should be set to 'Write', 'Delete', and/or 'Action'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.insights/2016-03-01/logprofiles?tabs=json#logprofileproperties-object)",,,[]
236,564b70f8-41cd-4690-aff8-bb53add86bc9,Unrecommended Network Watcher Flow Log Retention Policy,AzureResourceManager,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/unrecommended_network_watcher_flow_log_retention_policy,Unknown,"Network Watcher Flow Log Retention Policy should be enabled and the recommended number of days for the retention should be higher than 90<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.network/2019-11-01/networkwatchers/flowlogs?tabs=json#retentionpolicyparameters-object)",,,[]
237,574e8d82-1db2-4b9c-b526-e320ede9a9ff,SQL Server Database With Alerts Disabled,AzureResourceManager,Medium,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/sql_server_database_with_alerts_disabled,Unknown,"All Alerts should be enabled in SQL Database Server SecurityAlerts Policy Properties<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/securityalertpolicies?tabs=json)",,,[]
238,59cb3da7-f206-4ae6-b827-7abf0a9cab9d,Network Security Group With Unrestricted Access To RDP,AzureResourceManager,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/network_security_group_with_unrestricted_access_to_rdp,Unknown,"Port 3389 (Remote Desktop) is exposed to the Internet<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.network/2020-07-01/networksecuritygroups?tabs=json#securityrulepropertiesformat-object)",,,[]
239,6797f581-0433-4768-ae3e-7ceb2f8b138e,Azure Instance Using Basic Authentication,AzureResourceManager,Medium,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/azure_instance_using_basic_authentication,Unknown,"Azure Instances should use SSH Key instead of basic authentication<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachines?tabs=json#linuxconfiguration-object)",,,[]
240,6a3201a5-1630-494b-b294-3129d06b0eca,SQL Database Server Firewall Allows All IPS,AzureResourceManager,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/sql_database_server_firewall_allows_all_ips,Unknown,"SQL Database Server Firewall endIpAddress should not be '255.255.255.255' when startIpAddress is '0.0.0.0' since this allows all IPS<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2014-04-01/servers/firewallrules?tabs=json)",,,[]
241,70111098-7f85-48f0-b1b4-e4261cf5f61b,Website with 'Http20Enabled' Disabled,AzureResourceManager,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/757.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/website_with_http20enabled_disabled,Unknown,"'Microsoft.Web/sites' should have 'Http20Enabled' enabled<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object)",,,[]
242,79c2c2c0-eb00-47c0-ac16-f8b0e2c81c92,Email Notifications Disabled,AzureResourceManager,Info,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/email_notifications_set_off,Unknown,"Email notifications about new security alerts, should be set to 'On', and be sent to persons with specific RBAC roles on the subscription<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.security/securitycontacts)",,,[]
243,7c25f361-7c66-44bf-9b69-022acd5eb4bd,Key Vault Not Recoverable,AzureResourceManager,High,Backup,https://cwe.mitre.org/data/definitions/530.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/key_vault_not_recoverable,Unknown,"Key Vault should have 'enableSoftDelete' and 'enablePurgeProtection' set to true<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.keyvault/2019-09-01/vaults?tabs=json#vaultproperties-object)",,,[]
244,83130a07-235b-4a80-918b-a370e53f0bd9,App Service Authentication Is Not Set,AzureResourceManager,Medium,Access Control,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/app_service_authentication_not_set,Unknown,"Azure App Service should have App Service Authentication set<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-web?tabs=json)",,,[]
245,89b79fe5-49bd-4d39-84ce-55f5fc6f7764,SQL Alert Policy Without Emails,AzureResourceManager,Info,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/sql_alert_policy_without_emails,Unknown,"SQL Database Server should contain emails to be notified in the event of a Security Alert<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/securityalertpolicies?tabs=json)",,,[]
246,8fa9ceea-881f-4ef0-b0b8-728f589699a7,Role Definitions Allow Custom Subscription Role Creation,AzureResourceManager,High,Access Control,https://cwe.mitre.org/data/definitions/266.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/role_definitions_allow_custom_subscription_role_creation,Unknown,"Role Definitions should not allow custom subscription role creation (actions set to '*' or 'Microsoft.Authorization/roleDefinitions/write')<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.authorization/roledefinitions?tabs=json#permission-object)",,,[]
247,90120147-f2e7-4fda-bb21-6fa9109afd63,MySQL Server SSL Enforcement Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/mysql_server_ssl_enforcement_disabled,Unknown,"'Microsoft.DBforMySQL/servers' should enforce SSL<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers?tabs=json#serverpropertiesforcreate-object)",,,[]
248,9073f073-5d60-4b46-b569-0d6baa80ed95,Storage Account Allows Default Network Access,AzureResourceManager,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/storage_account_allows_network_default_access,Unknown,"'Microsoft.Storage/storageAccounts' should force the use of HTTPS<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#storageaccountpropertiescreateparameters-object)",,,[]
249,92302b47-b0cc-46cb-a28f-5610ecda140b,Website with Client Certificate Auth Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/website_with_client_certificate_auth_disabled,Unknown,"'Microsoft.Web/sites' should have client certificate authentication enabled<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object)",,,[]
250,9307a2ed-35c2-413d-94de-a1a0682c2158,AKS Cluster RBAC Disabled,AzureResourceManager,High,Access Control,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/aks_cluster_rbac_disabled,Unknown,"Microsoft.ContainerService/managedClusters should have enableRBAC set to true<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json)",,,[]
251,9b09dee1-f09b-4013-91d2-158fa4695f4b,AKS Logging To Azure Monitoring Is Disabled,AzureResourceManager,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/aks_logging_azure_monitoring_disabled,Unknown,"Azure Kubernetes Service should have logging to Azure Monitoring enabled.<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusteraddonprofile)",,,[]
252,a0ab985d-660b-41f7-ac81-70957ee8e627,Storage Blob Service Container With Public Access,AzureResourceManager,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/storage_blob_service_container_with_public_access,Unknown,"The Storage Blob Service Container should not be publicly accessible<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts/blobservices/containers?tabs=json#containerproperties-object)",,,[]
253,a6d774b6-d9ea-4bf4-8433-217bf15d2fb8,PostgreSQL Database Server Connection Throttling Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/postgresql_database_server_connection_throttling_disabled,Unknown,"Microsoft.DBforPostgreSQL/servers/configurations should have 'connection_throttling' property set to 'on'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers/configurations?tabs=json)",,,[]
254,a8852cc0-fd4b-4fc7-9372-1e43fad0732e,Account Admins Not Notified By Email,AzureResourceManager,Info,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/account_admins_not_notified_by_email,Unknown,"Account admins should be notified by email in the event of security alerts<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/securityalertpolicies?tabs=json)",,,[]
255,b5c851d5-00f1-43dc-a8de-3218fd6f71be,Web App Not Using TLS Last Version,AzureResourceManager,Medium,Encryption,https://cwe.mitre.org/data/definitions/327.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/web_app_not_using_tls_last_version,Unknown,"Resources of type 'Microsoft.Web/sites' should define 'properties.siteConfig.minTlsVersion' with '1.3'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteconfig-object)",,,[]
256,bf500309-da53-4dd3-bcf7-95f7974545a5,PostgreSQL Database Server SSL Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/postgresql_server_ssl_disabled,Unknown,"Microsoft.DBforPostgreSQL/servers sslEnforcement property should be set to 'Enabled'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/2017-12-01/servers?tabs=json)",,,[]
257,c09cdac2-7670-458a-bf6c-efad6880973a,SQL Server Database With Unrecommended Retention Days,AzureResourceManager,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/sql_server_database_with_low_retention_days,Unknown,"SQL Server Database Auditing Settings should keep the audit logs in the storage account for at least 90 days<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/auditingsettings?tabs=json)",,,[]
258,c62d3b92-9a11-4ffd-b7b7-6faaae83faed,AKS Dashboard Is Enabled,AzureResourceManager,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/aks_dashboard_enabled,Unknown,"Azure Kubernetes Service should have the Kubernetes dashboard disabled.<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusteraddonprofile)",,,[]
259,cff9c3f7-e8f0-455f-9fb4-5f72326da96e,Secret Without Expiration Date,AzureResourceManager,Medium,Best Practices,https://cwe.mitre.org/data/definitions/1390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/secret_without_expiration_date,Unknown,"All Secrets must have an expiration date defined<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.keyvault/vaults/secrets?tabs=json#SecretAttributes)",,,[]
260,d855ced8-6157-448f-9f1d-f05a41d046f7,Default Azure Storage Account Network Access Is Too Permissive,AzureResourceManager,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/default_azure_storage_account_network_access_is_too_permissive,Unknown,"Make sure that your Azure Storage Account access is limited to those who require it.<br>
[Documentation](https://learn.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts)",,,[]
261,e055285c-bc01-48b4-8aa5-8a54acdd29df,SQL Server Database Without Auditing,AzureResourceManager,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/sql_server_database_without_auditing,Unknown,"Every 'Microsoft.Sql/servers/databases' resource should have Auditing Enabled<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/auditingsettings)",,,[]
262,e25b56cd-a4d6-498f-ab92-e6296a082097,Trusted Microsoft Services Not Enabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/trusted_microsoft_services_not_enabled,Unknown,"Trusted Microsoft Services should be enabled for Storage Account access<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#networkruleset)",,,[]
263,e69bda39-e1e2-47ca-b9ee-b6531b23aedd,PostgreSQL Database Server Log Connections Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/postgresql_server_log_connections_disabled,Unknown,"Microsoft.DBforPostgreSQL/servers/configurations should have 'log_connections' property set to 'on'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers/configurations?tabs=json#configurationproperties-object)",,,[]
264,e9c133e5-c2dd-4b7b-8fff-40f2de367b56,Website Azure Active Directory Disabled,AzureResourceManager,Low,Access Control,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/website_azure_active_directory_disabled,Unknown,"WebApp should have Azure Active Directory enabled with 'identity.type' set to 'SystemAssigned' or 'userAssignedIdentities' set to 'true'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.web/2019-08-01/sites?tabs=json#ManagedServiceIdentity)",,,[]
265,f9112910-c7bb-4864-9f5e-2059ba413bb7,PostgreSQL Database Server Log Checkpoints Disabled,AzureResourceManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/azureResourceManager/postgresql_server_log_checkpoint_disabled,Unknown,"Microsoft.DBforPostgreSQL/servers/configurations should have 'log_checkpoint' property set to 'on'<br>
[Documentation](https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/2017-12-01/servers/configurations?tabs=json)",,,[]
266,a1bc27c6-7115-48d8-bf9d-5a7e836845ba,Run Using apt,Buildah,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/buildah/run_using_apt,buildah-queries,"apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache<br>
[Documentation](https://github.com/containers/buildah/blob/main/docs/buildah-run.1.md)",,,[]
267,20f14e1a-a899-4e79-9f09-b6a84cd4649b,Run Block Injection,CICD,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/94.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cicd/github/run_block_injection,cicd-queries,"GitHub Actions workflows can be triggered by a variety of events. Every workflow trigger is provided with a GitHub context that contains information about the triggering event, such as which user triggered it, the branch name, and other event context details. Some of this event data, like the base repository name, hash value of a changeset, or pull request number, is unlikely to be controlled or used for injection by the user that triggered the event.<br>
[Documentation](https://securitylab.github.com/research/github-actions-untrusted-input/)","name: check-go-coverage

on:
  pull_request_target:
    branches: [master]

jobs:
  coverage:
    name: Check Go coverage
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Source
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name: Set up Go 1.22.x
        uses: actions/setup-go@v5
        with:
          go-version: 1.22.x
      - name: Run test metrics script
        id: testcov
        run: |
          make test-coverage-report | tee test-results
          echo ""coverage=$(cat test-results | grep ""Total coverage: "" test-results | cut -d "":"" -f 2 | bc)"" >> $GITHUB_ENV
      - name: Checks if Go coverage is at least 80%
        if: env.coverage < 80
        run: |
          echo ""Go coverage is lower than 80%: ${{ env.coverage }}%""
          exit 1

name: Issue Workflow

on:
  issues:
    types:
      - opened

jobs:
  process_issue:
    runs-on: ubuntu-latest
    steps:
      - name: Greet the New Issue
        run: |
          # Echo a simple sentence
          echo ""Hello, a new issue has been opened!""

name: Discussion Workflow

on:
  discussion:
    types:
      - created

jobs:
  process_discussion:
    runs-on: ubuntu-latest
    steps:
      - name: Greet the New Discussion
        run: |
          echo ""Hello, a new discussion has been created!""","name: Web Page To Markdown
on:
  issues:
    types: [opened]
jobs:
  WebPageToMarkdown:
    runs-on: ubuntu-latest
    steps:
      - name: Does the issue need to be converted to markdown
        run: |
          if [ ""${{ github.event.issue.body }}"" ]; then
            if [[ ""${{ github.event.issue.title }}"" =~ ^\[Auto\]* ]]; then
              :
            else
              echo ""This issue does not need to generate a markdown file."" 1>&2
              exit 1;
            fi;
          else
            echo ""The description of the issue is empty."" 1>&2
            exit 1;
          fi;
        shell: bash
      - name: Checkout
        uses: actions/checkout@v4
        with:
          ref: ${{ github.head_ref }}
      - name: Crawl pages and generate Markdown files
        uses: freeCodeCamp-China/article-webpage-to-markdown-action@v0.1.8
        with:
          newsLink: '${{ github.event.issue.Body }}'
          markDownFilePath: './chinese/articles/'
          githubToken: ${{ github.token }}
      - name: Git Auto Commit
        uses: stefanzweifel/git-auto-commit-action@v4.9.2
        with:
          commit_message: '${{ github.event.issue.title }}'
          file_pattern: chinese/articles/*.md
          commit_user_name: PageToMarkdown Bot
          commit_user_email: PageToMarkdown-bot@freeCodeCamp.org

name: Pull Request Workflow

on:
  pull_request_target:
    types:
      - opened

jobs:
  process_pull_request:
    runs-on: ubuntu-latest
    steps:
      - name: Echo Pull Request Body
        run: |
          echo ""Pull Request Body: ${{ github.event.pull_request.body }}""

name: Issue Comment Workflow

on:
  issue_comment:
    types:
      - created

jobs:
  process_issue_comment:
    runs-on: ubuntu-latest
    steps:
      - name: Echo Issue Comment Body
        run: |
          echo ""Issue Comment Body: ${{ github.event.comment.body }}""","[[10], [13], [13]]"
268,555ab8f9-2001-455e-a077-f2d0f41e2fb9,Unpinned Actions Full Length Commit SHA,CICD,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cicd/github/unpinned_actions_full_length_commit_sha,cicd-queries,"Pinning an action to a full length commit SHA is currently the only way to use an action as an immutable release. Pinning to a particular SHA helps mitigate the risk of a bad actor adding a backdoor to the action's repository, as they would need to generate a SHA-1 collision for a valid Git object payload. When selecting a SHA, you should verify it is from the action's repository and not a repository fork.<br>
[Documentation](https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions#using-third-party-actions)","name: test-positive
on:
  pull_request:
    types: [opened, synchronize, edited, reopened]
    branches: 
      - master
jobs:
  test-positive:
    runs-on: ubuntu-latest
    steps:
    - name: PR comment
      uses: thollander/actions-comment-pull-request@b07c7f86be67002023e6cb13f57df3f21cdd3411
      with:
        comment_tag: title_check
        mode: recreate
        create_if_not_exists: true

name: test-positive
on:
  pull_request:
    types: [opened, synchronize, edited, reopened]
    branches:
      - master
jobs:
  test-positive:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout Code
      uses: actions/checkout@v4
      with:
        persist-credentials: false

name: test-negative3
on:
  pull_request:
    types: [opened, synchronize, edited, reopened]
    branches:
      - master
jobs:
  test-negative3:
    runs-on: ubuntu-latest
    steps:
    - name: Local action
      uses: ./test.yml","name: test-positive
on:
  pull_request:
    types: [opened, synchronize, edited, reopened]
    branches: 
      - master
jobs:
  test-positive:
    runs-on: ubuntu-latest
    steps:
    - name: PR comment
      uses: thollander/actions-comment-pull-request@v2
      with:
        comment_tag: title_check
        mode: recreate
        create_if_not_exists: true",[[12]]
269,60fd272d-15f4-4d8f-afe4-77d9c6cc0453,Unsecured Commands,CICD,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/78.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cicd/github/unsecured_commands,cicd-queries,"There are deprecated set-env and add-path commands that can be explicitly enabled by a user via setting the ACTIONS_ALLOW_UNSECURE_COMMANDS environment variable as true. Depending on the use of the environment variable, this could enable an attacker to, at worst, modify the system path to run a different command than intended, resulting in arbitrary code execution.<br>
[Documentation](https://0xn3va.gitbook.io/cheat-sheets/ci-cd/github/actions#misuse-of-the-events-related-to-incoming-prs)","name: test-positive
on:
  pull_request:
    types: [opened, synchronize, edited, reopened]
    branches: 
      - master
jobs:
  test-positive:
    runs-on: ubuntu-latest
    steps:
    - name: PR comment
      uses: thollander/actions-comment-pull-request@b07c7f86be67002023e6cb13f57df3f21cdd3411
      with:
        comment_tag: title_check
        mode: recreate
        create_if_not_exists: true","name: Vulnerable workflow

on:
  pull_request_target

env:
  # 1. Enable unsecure commands
  ACTIONS_ALLOW_UNSECURE_COMMANDS: true
  ENVIRONMENT_NAME: prod

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # 2. Print github context
      - run: |
          print(""""""${{ toJSON(github) }}"""""")
        shell: python
      - name: Create new PR deployment
        uses: actions/github-script@v5
        with:
          # 3. Create deployment
          script: |
            return await github.rest.repos.createDeployment({
                ...context.repo,
                ref: context.payload.pull_request.head.sha,
                auto_merge: false,
                required_contexts: [],
                environment: ""${{ env.ENVIRONMENT_NAME }}"",
                transient_environment: false,
                production_environment: false,
            });
          github-token: ${{ secrets.GITHUB_TOKEN }}

name: Vulnerable workflow

on:
  pull_request_target


jobs:
  deploy:
    runs-on: ubuntu-latest
    env:
      ACTIONS_ALLOW_UNSECURE_COMMANDS: true
    steps:
      # 2. Print github context
      - run: |
          print(""""""${{ toJSON(github) }}"""""")
        shell: python
      - name: Create new PR deployment
        uses: actions/github-script@v5
        with:
          # 3. Create deployment
          script: |
            return await github.rest.repos.createDeployment({
                ...context.repo,
                ref: context.payload.pull_request.head.sha,
                auto_merge: false,
                required_contexts: [],
                environment: ""${{ env.ENVIRONMENT_NAME }}"",
                transient_environment: false,
                production_environment: false,
            });
          github-token: ${{ secrets.GITHUB_TOKEN }}

name: Vulnerable workflow

on:
  pull_request_target

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # 2. Print github context
      - run: |
          print(""""""${{ toJSON(github) }}"""""")
        shell: python
      - name: Create new PR deployment
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: true
        uses: actions/github-script@v5
        with:
          # 3. Create deployment
          script: |
            return await github.rest.repos.createDeployment({
                ...context.repo,
                ref: context.payload.pull_request.head.sha,
                auto_merge: false,
                required_contexts: [],
                environment: ""${{ env.ENVIRONMENT_NAME }}"",
                transient_environment: false,
                production_environment: false,
            });
          github-token: ${{ secrets.GITHUB_TOKEN }}","[[8], [11], [16]]"
270,62ff6823-927a-427f-acf9-f1ea2932d616,Script Block Injection,CICD,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/94.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cicd/github/script_block_injection,cicd-queries,"GitHub Actions workflows can be triggered by a variety of events. Every workflow trigger is provided with a GitHub context that contains information about the triggering event, such as which user triggered it, the branch name, and other event context details. Some of this event data, like the base repository name, hash value of a changeset, or pull request number, is unlikely to be controlled or used for injection by the user that triggered the event.<br>
[Documentation](https://securitylab.github.com/research/github-actions-untrusted-input/)","name: test-script-run

on:
  issues:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;

name: test-script-run

on:
  pull_request_target:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;

name: test-script-run

on:
  issue_comment:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;","name: test-script-run

on:
  issues:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            const fs = require('fs');
            const body = fs.readFileSync('/tmp/${{ github.event.issue.title }}.txt', {encoding: 'utf8'});

            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;

name: test-script-run

on:
  pull_request_target:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            const fs = require('fs');
            const body = fs.readFileSync('/tmp/${{ github.event.pull_request.title }}.txt', {encoding: 'utf8'});

            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;

name: test-script-run

on:
  issue_comment:
    types: [opened]

jobs:
  script-run:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Run script
        uses: actions/github-script@latest
        with:
          script: |
            const fs = require('fs');
            const body = fs.readFileSync('/tmp/${{ github.event.issue.title }}.txt', {encoding: 'utf8'});

            await github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'Thanks for reporting!'
            })

            return true;","[[17], [17], [17]]"
271,0104165b-02d5-426f-abc9-91fb48189899,DB Security Group Open To Large Scope,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/db_security_group_open_to_large_scope,Unknown,"The IP address in a DB Security Group must not have more than 256 hosts.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","#this code is a correct code for which the query should not find any result
Resources:
  DBinstance:
    Type: AWS::RDS::DBInstance
    Properties:
      DBSecurityGroups:
        -
          Ref: ""DbSecurityByEC2SecurityGroup""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurityByEC2SecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      DBSecurityGroupIngress:
        CIDRIP: 1.2.3.4/28","Resources:
  DBinstance1:
    Type: AWS::RDS::DBInstance
    Properties:
      DBSecurityGroups:
        -
          Ref: ""DbSecurity""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurity:
    Type: AWS::RDS::DBSecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      DBSecurityGroupIngress:
        CIDRIP: 1.2.3.4/23

Resources:
  DBinstance2:
    Type: AWS::RDS::DBInstance
    Properties:
      DBSecurityGroups:
        -
          Ref: ""DbSecurityByEC2SecurityGroup1""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurityByEC2SecurityGroup1:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      SecurityGroupIngress:
        CidrIp: 1.2.3.4/23

Resources:
  DBinstance3:
    Type: AWS::RDS::DBInstance
    Properties:
      DBSecurityGroups:
        -
          Ref: ""DbSecurityByEC2SecurityGroup2""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurityByEC2SecurityGroup2:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      SecurityGroupIngress:
        CidrIpv6: 2001:db8:a::123/64","[[18], [18], [18]]"
272,01986452-bdd8-4aaa-b5df-d6bf61d616ff,ECS Service Admin Role Is Present,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_service_admin_role_is_present,Unknown,"ECS Services must not have Admin roles, which means the attribute 'role' must not be an admin role<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  AppName:
    Type: String
    Description: Name of app requiring ELB exposure
    Default: simple-app
  AppContainerPort:
    Type: Number
    Description: Container port of app requiring ELB exposure
    Default: '80'
  AppHostPort:
    Type: Number
    Description: Host port of app requiring ELB exposure
    Default: '80'
  ServiceName:
    Type: String
  LoadBalancerName:
    Type: String
  HealthCheckGracePeriodSeconds:
    Type: String
Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DeploymentConfiguration:
        MaximumPercent: 200
        MinimumHealthyPercent: 100
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: Role
  elb:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      LoadBalancerName: !Ref LoadBalancerName
      Listeners:
        - InstancePort: !Ref AppHostPort
          LoadBalancerPort: '80'
          Protocol: HTTP
      Subnets:
        - !Ref Subnet1
    DependsOn: GatewayAttachment
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/24
  Subnet1:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.0.0.0/25
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  GatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref VPC
Outputs:
  Cluster:
    Value: !Ref cluster","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  AppName:
    Type: String
    Description: Name of app requiring ELB exposure
    Default: simple-app
  AppContainerPort:
    Type: Number
    Description: Container port of app requiring ELB exposure
    Default: '80'
  AppHostPort:
    Type: Number
    Description: Host port of app requiring ELB exposure
    Default: '80'
  ServiceName:
    Type: String
  LoadBalancerName:
    Type: String
  HealthCheckGracePeriodSeconds:
    Type: String
Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DeploymentConfiguration:
        MaximumPercent: 200
        MinimumHealthyPercent: 100
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: AdminRole
  elb:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      LoadBalancerName: !Ref LoadBalancerName
      Listeners:
        - InstancePort: !Ref AppHostPort
          LoadBalancerPort: '80'
          Protocol: HTTP
      Subnets:
        - !Ref Subnet1
    DependsOn: GatewayAttachment
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/24
  Subnet1:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.0.0.0/25
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  GatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref VPC
Outputs:
  Cluster:
    Value: !Ref cluster",[[87]]
273,01d5a458-a6c4-452a-ac50-054d59275b7c,ELB With Security Group Without Outbound Rules,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_with_security_group_without_outbound_rules,Unknown,"An AWS Elastic Load Balancer (ELB) shouldn't have security groups without outbound rules<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html#cfn-ec2-securitygroup-securitygroupegress)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    sgwithegress:
        Type: AWS::EC2::SecurityGroup
        Properties:
            GroupDescription: Limits security group egress traffic
            SecurityGroupEgress:
            -   IpProtocol: tcp
                FromPort: 80
                ToPort: 80
                CidrIp: 0.0.0.0/0
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
            SecurityGroups:
            -   sgwithegress","AWSTemplateFormatVersion: 2010-09-09
Resources:
    sgwithoutegress:
        Type: AWS::EC2::SecurityGroup
        Properties:
            GroupDescription: Limits security group egress traffic
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
            SecurityGroups:
            -   sgwithoutegress",[[5]]
274,0264093f-6791-4475-af34-4b8102dcbcd0,EC2 Instance Monitoring Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_instance_monitoring_disabled,Unknown,"EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-monitoring)","Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-12345678
      InstanceType: t2.micro
      Monitoring: true

Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-12345678
      InstanceType: t2.micro
      Monitoring: ""true""","Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-12345678
      InstanceType: t2.micro
      Monitoring: false

Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-12345678
      InstanceType: t2.micro

Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-12345678
      InstanceType: t2.micro
      Monitoring: ""false""","[[7], [4], [7]]"
275,027a4b7a-8a59-4938-a04f-ed532512cf45,ECS Task Definition Network Mode Not Recommended,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_task_definition_network_mode_not_recommended,Unknown,"Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html#cfn-ecs-taskdefinition-networkmode)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      NetworkMode: awsvpc
      ContainerDefinitions:
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          HealthCheck:
            Command:
              - CMD-SHELL
              - curl -f http://localhost:8080/ || exit 1
            Interval: 30
            Retries: 3
            StartPeriod: 1
            Timeout: 5
          Memory: 512
          Essential: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      NetworkMode: none
      ContainerDefinitions:
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          Memory: 512
          Essential: true",[[7]]
276,03879981-efa2-47a0-a818-c843e1441b88,EC2 Permissive Network ACL Protocols,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_permissive_network_acl_protocols,Unknown,"To avoid opening all ports for Allow rules, EC2 NetworkACL Entry Protocol should be either 6 (for TCP), 17 (for UDP), 1 (for ICMP), or 58 (for ICMPv6, which must include an IPv6 CIDR block, ICMP type, and code).<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-network-acl-entry.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: -1
       Egress: true
       RuleAction: allow
       CidrBlock: 0.0.0.0/0",[[17]]
277,03b38885-8f4e-480c-a0e4-12c1affd15db,Amplify App OAuth Token Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amplify_app_oauth_token_exposed,Unknown,"Amplify App OAuth Token must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-amplify-app-basicauthconfig.html)","Resources:
     NewAmpApp-2:
        Type: AWS::Amplify::App
        Properties:
          BuildSpec: String
          CustomHeaders: String
          Description: String
          EnableBranchAutoDeletion: true
          IAMServiceRole: String
          Name: NewAmpApp
          Repository: String
          OauthToken: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
     MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
  ParentUsername:
    Description: 'Username'
    Type: String
Resources:
  NewAmpApp-1:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      Repository: String
      OauthToken: !Ref ParentPassword

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: """"
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp-4:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      Repository: String
      OauthToken: !Ref ParentPassword","Resources:
  NewAmpApp-1:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      Repository: String
      OauthToken: 'CqGZthigPO55H3fi1_6wrP9jmdivueS7lYd7Lg2styBfjsK5eQ5C2qg_gONQgzyvvVojXY0JyMkRdm71y3nTFl1ZYOgJSNLshvWnm9QoEJrInp_xr-o-9RgZHhrGp5X9dCZVYsYF1WHqj5p75O37IKc8Rv6yO9kGw1flCbT4xbeLTDItX71jRzuAHYNKGPKkxrhIuQ-w9MyKYZ0a3pYT4lWZzWVFoMu9G-smC4qrww5grWCUevE9LuNEZgSijFgRK9QPo8PxMt427lGyK-FkoB8x4qllQ1aCG9_mz2t6A1nRxXY7-Jq9ONkmNoUHiTenEUUaPQcz4RFzrkTE-GaUNP_yK2tNR2i5-TQ4tcI8hQW0aaAsWBPoxd_ZXNty9AhRpshU9WUy32yIHj47jMYCpA'

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: 'CqGZthigPO55H3fi1_6wrP9jmdivueS7lYd7Lg2styBfjsK5eQ5C2qg_gONQgzyvvVojXY0JyMkRdm71y3nTFl1ZYOgJSNLshvWnm9QoEJrInp_xr-o-9RgZHhrGp5X9dCZVYsYF1WHqj5p75O37IKc8Rv6yO9kGw1flCbT4xbeLTDItX71jRzuAHYNKGPKkxrhIuQ-w9MyKYZ0a3pYT4lWZzWVFoMu9G-smC4qrww5grWCUevE9LuNEZgSijFgRK9QPo8PxMt427lGyK-FkoB8x4qllQ1aCG9_mz2t6A1nRxXY7-Jq9ONkmNoUHiTenEUUaPQcz4RFzrkTE-GaUNP_yK2tNR2i5-TQ4tcI8hQW0aaAsWBPoxd_ZXNty9AhRpshU9WUy32yIHj47jMYCpA'
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp-4:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: !Ref ParentPassword
      Repository: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername","[[4], [5]]"
278,045ddb54-cfc5-4abb-9e05-e427b2bc96fe,EC2 Network ACL Duplicate Rule,CloudFormation,Info,Networking and Firewall,https://cwe.mitre.org/data/definitions/358.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_network_acl_duplicate_rule,Unknown,"A Network ACL's rule numbers cannot be repeated unless one is egress and the other is ingress<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-network-acl-entry.html#cfn-ec2-networkaclentry-rulenumber)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: -1
       Egress: true
       RuleAction: allow
       CidrBlock: 0.0.0.0/0","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       Egress: true
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: -1
       Egress: true
       RuleAction: allow
       CidrBlock: 0.0.0.0/0
  MyNACL2:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccdd
  InboundRule2:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL2
       RuleNumber: ""112""
       Protocol: 6
       Ingress: true
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22
  OutboundRule2:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL2
       RuleNumber: ""112""
       Protocol: -1
       Ingress: true
       RuleAction: allow
       CidrBlock: 0.0.0.0/0","[[25, 12, 52, 39]]"
279,050a9ba8-d1cb-4c61-a5e8-8805a70d3b85,CloudTrail Log Files Not Encrypted With KMS,CloudFormation,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_log_files_not_encrypted_with_kms,Unknown,"Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-kmskeyid)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      KMSKeyId: arn:aws:kms:us-east-2:123456789012:key/12345678-1234-1234-1234-123456789012
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true",[[62]]
280,058ac855-989f-4378-ba4d-52d004020da7,CloudTrail Multi Region Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_multi_region_disabled,Unknown,"CloudTrail multi region should be enabled, which means attribute 'IsMultiRegionTrail' should be set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-ismultiregiontrail)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: false
  myTrail2:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: ""false""","[[76, 70], [70]]"
281,06933df4-0ea7-461c-b9b5-104d27390e0e,IAM User With No Group,CloudFormation,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_user_with_no_group,Unknown,"A IAM user should belong to a group<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-iam.html#scenario-iam-policy)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  addUserToGroup2:
    Type: AWS::IAM::User
    Properties:
      Groups:
        - QAGroup
      LoginProfile:
          Password: myP@ssW0rd
      Path: ""/""
      Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
      Tags:
        - QAUser
      UserName: TestUser","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    MyUser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
        Tags:
          - QAUser
        UserName: TestUser

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    emptyGroup:
      Type: AWS::IAM::User
      Properties:
        Groups: []
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
        Tags:
          - QAUser
        UserName: TestUser","[[6], [7]]"
282,06adef8c-c284-4de7-aad2-af43b07a8ca1,IAM User LoginProfile Password Is In Plaintext,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_user_login_profile_password_is_in_plaintext,Unknown,"IAM User LoginProfile Password must not be a plaintext string<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-user.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myTopuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password:
         - !Ref NoEcho
         PasswordResetRequired: false
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myNewuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password:
         - !Ref secretsmanager
         PasswordResetRequired: false
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password: myP@ssW0rd
         PasswordResetRequired: false
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn",[[9]]
283,06b9f52a-8cd5-459b-bdc6-21a22521e1be,Directory Service Microsoft AD Password Set to Plaintext or Default Ref,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/directory_service_microsoft_ad_password_set_to_plaintext_or_default_ref,Unknown,"Directory Service Microsoft AD password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-directoryservice-microsoftad.html)","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp-1:
      Type: AWS::DirectoryService::MicrosoftAD
      Properties:
          CreateAlias: true
          Edition: String
          EnableSso: true
          Name: String
          Password: !Ref ParentMasterPassword
          ShortName: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username'
Resources:
  NewAmpApp-1:
    Type: AWS::DirectoryService::MicrosoftAD
    Properties:
      CreateAlias: true
      Edition: String
      EnableSso: true
      Name: String
      Password: !Ref ParentMasterPassword
      ShortName: String

Resources:
    NewAmpApp-2:
        Type: AWS::DirectoryService::MicrosoftAD
        Properties:
            CreateAlias: true
            Edition: String
            EnableSso: true
            Name: String
            Password:  !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
            ShortName: String
    MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'","Parameters:
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp-2:
      Type: AWS::DirectoryService::MicrosoftAD
      Properties:
          CreateAlias: true
          Edition: String
          EnableSso: true
          Name: String
          Password: 'asDjskjs73!!'
          ShortName: String

Resources:
  NewAmpApp:
      Type: AWS::DirectoryService::MicrosoftAD
      Properties:
          CreateAlias: true
          Edition: String
          EnableSso: true
          Name: String
          Password: 'asDjskjs73!!'
          ShortName: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: 'asDjskjs73!'
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp-1:
      Type: AWS::DirectoryService::MicrosoftAD
      Properties:
          CreateAlias: true
          EnableSso: true
          Edition: String
          Name: String
          Password: !Ref ParentMasterPassword
          ShortName: String","[[14], [9], [5]]"
284,06ec63e3-9f72-4fe2-a218-2eb9200b8db5,API Gateway Deployment Without Access Log Setting,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_deployment_without_access_log_setting,Unknown,"API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-deployment.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""ApiGateway""
Resources:
  GreetingApiProdStage:
    DependsOn:
    - ApiGatewayAccount
    Type: AWS::ApiGateway::Stage
    Properties:
      DeploymentId:
        Ref: ApiDeployment
      MethodSettings:
      - DataTraceEnabled: true
        HttpMethod: ""*""
        LoggingLevel: INFO
        ResourcePath: ""/*""
      RestApiId:
        Ref: GreetingApi
      StageName: prod
      Variables:
        LambdaAlias: PROD
  ApiDeployment:
    Type: AWS::ApiGateway::Deployment
    DependsOn:
    - GreetingRequest
    Properties:
      RestApiId:
        Ref: GreetingApi
      StageName: DummyStage
      StageDescription:
        AccessLogSetting:
          DestinationArn: ""dest""
          Format: ""format""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""ApiGateway""
Resources:
  GreetingApiProdStage:
    DependsOn:
    - ApiGatewayAccount
    Type: AWS::ApiGateway::Stage
    Properties:
      DeploymentId:
        Ref: ApiDeployment
      MethodSettings:
      - DataTraceEnabled: true
        HttpMethod: ""*""
        LoggingLevel: INFO
        ResourcePath: ""/*""
      RestApiId:
        Ref: GreetingApi
      StageName: prod
      Variables:
        LambdaAlias: PROD
  ApiDeployment:
    Type: AWS::ApiGateway::Deployment
    DependsOn:
    - GreetingRequest
    Properties:
      RestApiId:
        Ref: GreetingApi
      StageName: DummyStage
      StageDescription:
        CacheClusterEnabled: false

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""ApiGateway""
Resources:
  GreetingApiProdStage1:
    DependsOn:
    - ApiGatewayAccount
    Type: AWS::ApiGateway::Stage
    Properties:
      DeploymentId:
        Ref: ApiDeployment
      MethodSettings:
      - DataTraceEnabled: true
        HttpMethod: ""*""
        LoggingLevel: INFO
        ResourcePath: ""/*""
      RestApiId:
        Ref: GreetingApi
      StageName: prod
      Variables:
        LambdaAlias: PROD
  ApiDeployment1:
    Type: AWS::ApiGateway::Deployment
    DependsOn:
    - GreetingRequest
    Properties:
      RestApiId:
        Ref: GreetingApi
      StageName: DummyStage

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""ApiGateway""
Resources:
  GreetingApiProdStage2:
    DependsOn:
    - ApiGatewayAccount
    Type: AWS::ApiGateway::Stage
    Properties:
      DeploymentId:
        Ref: ApiDeployment
      MethodSettings:
      - DataTraceEnabled: true
        HttpMethod: ""*""
        LoggingLevel: INFO
        ResourcePath: ""/*""
      RestApiId:
        Ref: GreetingApi
      StageName: prod
      Variables:
        LambdaAlias: PROD
  ApiDeployment2:
    Type: AWS::ApiGateway::Deployment
    DependsOn:
    - GreetingRequest
    Properties:
      RestApiId:
        Ref: GreetingApi
      StageName: DummyStage","[[29], [21], [21]]"
285,07dda8de-d90d-469e-9b37-1aca53526ced,S3 Bucket ACL Allows Read Or Write to All Users,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_acl_allows_read_or_write_to_all_users,Unknown,"S3 Buckets should not be readable and writable to all users<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts03:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: BucketOwnerFullControl
      BucketName: jenkins-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts04:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: Private
      BucketName: jenkins-secret-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ''

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts05:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      BucketName: jenkins-secret-artifacts2
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicReadWrite
      BucketName: jenkins-artifacts
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  StaticPage01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicReadWrite
      BucketName: public-read-static-page01
      WebsiteConfiguration:
        ErrorDocument: 404.html
        IndexDocument: index.html
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts02:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicReadWrite
      BucketName: jenkins-artifacts-block-public
      PublicAccessBlockConfiguration:
        BlockPublicPolicy: false
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD","[[7], [7], [7]]"
286,086ea2eb-14a6-4fd4-914b-38e0bc8703e8,ElasticSearch Without Slow Logs,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_without_slow_logs,Unknown,"Ensure that AWS Elasticsearch enables support for slow logs<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-logpublishingoptions)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      LogPublishingOptions:
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs
          Enabled: ""true""
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs
          Enabled: ""true""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

Resources:
  ProductionElasticsearch:
    Type: AWS::Elasticsearch::Domain
    Properties:
      EBSOptions:
        EBSEnabled: true
        VolumeSize: 70
        VolumeType: gp2
      ElasticsearchClusterConfig:
        DedicatedMasterCount: 3
        DedicatedMasterEnabled: true
        DedicatedMasterType: omitted
        InstanceCount: 3
        InstanceType: omitted
        ZoneAwarenessConfig:
          AvailabilityZoneCount: 3
        ZoneAwarenessEnabled: true
      ElasticsearchVersion: omitted
      LogPublishingOptions:
        ""INDEX_SLOW_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchIndexSlowLogs.Arn
          Enabled: true
        ""SEARCH_SLOW_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchSearchSlowLogs.Arn
          Enabled: true
        ""ES_APPLICATION_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchApplicationLogs.Arn
          Enabled: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      LogPublishingOptions:
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs
          Enabled: ""false""
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs
          Enabled: ""true""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      LogPublishingOptions:
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs
          Enabled: ""true""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","[[34], [30], [6]]"
287,08b81bb3-0985-4023-8602-b606ad81d279,EC2 Instance Using Default Security Group,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_instance_using_default_security_group,Unknown,"EC2 instances should not use default security group(s)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-securitygroups)","Resources:
  MyEC2Instancee: 
      Type: AWS::EC2::Instance
      Properties: 
        ImageId: ""ami-79fd7eee""
        KeyName: ""testkey""
        SecurityGroups: 
          - !Ref my_sg
        BlockDeviceMappings: 
        - DeviceName: ""/dev/sdm""
          Ebs: 
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}","Resources:
  MyEC2Instance: 
      Type: AWS::EC2::Instance
      Properties: 
        ImageId: ""ami-79fd7eee""
        KeyName: ""testkey""
        SecurityGroups: 
          - !Ref default
        BlockDeviceMappings: 
        - DeviceName: ""/dev/sdm""
          Ebs: 
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}",[[8]]
288,08e39832-5e42-4304-98a0-aa5b43393162,EFS Without Tags,CloudFormation,Low,Build Process,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/efs_without_tags,Unknown,"Amazon Elastic Filesystem should have filesystem tags associated<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html)","AWSTemplateFormatVersion: '2010-09-09'
Description: Create Elastic File System
Parameters:
  Owner:
    Type: String
    Default: FirstName LastName
  Project:
    Type: String
    Default: EFS Mount
  VPC:
    Type: AWS::EC2::VPC::Id
  Subnet1:
    Type: AWS::EC2::Subnet::Id
Resources:
  FileSystem:
    Type: AWS::EFS::FileSystem
    Properties:
      FileSystemTags:
      - Key: Name
        Value: !Ref AWS::StackName
      - Key: Owner
        Value: !Ref Owner
      - Key: Project
        Value: !Ref Project
  MountTarget1:
    Type: AWS::EFS::MountTarget
    Properties:
      FileSystemId: !Ref FileSystem
      SubnetId: !Ref Subnet1
      SecurityGroups:
      - !Ref EfsSecurityGroup
  EfsSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Instance to EFS Mount Access
      VpcId: !Ref VPC
      Tags:
      - Key: Name
        Value: !Ref AWS::StackName
      - Key: Owner
        Value: !Ref Owner
      - Key: Project
        Value: !Ref Project","AWSTemplateFormatVersion: '2010-09-09'
Description: Create Elastic File System
Parameters:
  Owner:
    Type: String
    Default: FirstName LastName
  Project:
    Type: String
    Default: EFS Mount
  VPC:
    Type: AWS::EC2::VPC::Id
  Subnet1:
    Type: AWS::EC2::Subnet::Id
Resources:
  FileSystem:
    Type: AWS::EFS::FileSystem
    Properties:
      Encrypted: true
      PerformanceMode: generalPurpose
  MountTarget1:
    Type: AWS::EFS::MountTarget
    Properties:
      FileSystemId: !Ref FileSystem
      SubnetId: !Ref Subnet1
      SecurityGroups:
      - !Ref EfsSecurityGroup
  EfsSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Instance to EFS Mount Access
      VpcId: !Ref VPC
      Tags:
      - Key: Name
        Value: !Ref AWS::StackName
      - Key: Owner
        Value: !Ref Owner
      - Key: Project
        Value: !Ref Project",[[15]]
289,0a994e04-c6dc-471d-817e-d37451d18a3b,Serverless API Access Logging Setting Undefined,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_api_access_logging_setting_undefined,Unknown,"AWS Serverless API/AWS Serverless HTTP API should have Access Logging Setting(s) defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-apigateway-stage-accesslogsetting.html)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  HttpApi2:
      Type: AWS::Serverless::HttpApi
      Properties:
        StageName: !Ref StageName
        Tags:
          Tag: Value
        AccessLogSettings:
          DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
          Format: >-
            {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
            ""caller"":""$context.identity.caller"",
            ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
            ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
            ""status"":""$context.status"",""connectionId"":""$context.connectionId""}","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  HttpApi:
      Type: AWS::Serverless::HttpApi
      Properties:
        StageName: !Ref StageName
        Tags:
          Tag: Value","[[7], [7]]"
290,0b0556ea-9cd9-476f-862e-20679dda752b,BOM - AWS EBS,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/ebs,Unknown,"A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2).<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume""
Resources:
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      Encrypted: true
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: MyTag
          Value: TagValue
    DeletionPolicy: Snapshot

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume""
Resources:
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      Encrypted: false
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: Name
          Value: NewVolume
    DeletionPolicy: Snapshot","[[4], [4]]"
291,0ce1ba20-8ba8-4364-836f-40c24b8cb0ab,MSK Broker Is Publicly Accessible,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/msk_broker_is_publicly_accessible,Unknown,"Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-msk-cluster-publicaccess.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster0:
    Type: ""AWS::MSK::Cluster""
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3","AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster:
    Type: ""AWS::MSK::Cluster""
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3
        ConnectivityInfo:
          PublicAccess:
            Type: SERVICE_PROVIDED_EIPS",[[18]]
292,0e5872b4-19a0-4165-8b2f-56d9e14b909f,IAM Managed Policy Applied to a User,CloudFormation,Medium,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_managed_policy_applied_to_a_user,Unknown,"Make sure that any managed IAM policies are implemented in a group and not in a user.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-managedpolicy.html#cfn-iam-managedpolicy-groups)","Resources:
  CreateTestDBPolicy:
    Type: 'AWS::IAM::ManagedPolicy'
    Properties:
      Description: Policy for creating a test database
      Path: /
      PolicyDocument:
        Version: 2012-10-17
        Statement: []
      Groups:
        - TestGroup","Resources:
  CreateTestDBPolicy:
    Type: 'AWS::IAM::ManagedPolicy'
    Properties:
      Description: Policy for creating a test database
      Path: /
      PolicyDocument:
        Version: 2012-10-17
        Statement: []
      Users:
        - TestUser",[[10]]
293,0f04217d-488f-4e7a-bec8-f16159686cd6,DynamoDB Table Point In Time Recovery Disabled,CloudFormation,Medium,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dynamodb_table_point_in_time_recovery_disabled,Unknown,"It's considered a best practice to have point in time recovery enabled for DynamoDB Table<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dynamodb-table-pointintimerecoveryspecification.html)","Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      PointInTimeRecoverySpecification: 
        PointInTimeRecoveryEnabled: true

Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      PointInTimeRecoverySpecification: 
        PointInTimeRecoveryEnabled: ""true""","Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      PointInTimeRecoverySpecification: 
        PointInTimeRecoveryEnabled: false

Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: my-table","[[6], [4]]"
294,0f0fb06b-0f2f-4374-8588-f2c7c348c7a0,CloudWatch Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudwatch_logging_disabled,Unknown,"Check if CloudWatch logging is disabled for Route53 hosted zones<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-route53-hostedzone.html#cfn-route53-hostedzone-queryloggingconfig)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""
      QueryLoggingConfig:
        CloudWatchLogsLogGroupArn: ""SomeCloudWatchLogGroupArn""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  HostedZone3:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""",[[6]]
295,0f139403-303f-467c-96bd-e717e6cfd62d,CloudFront Without WAF,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudfront_without_waf,Unknown,"All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cloudfront-distribution-distributionconfig.html#cfn-cloudfront-distribution-distributionconfig-webaclid)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
        WebACLId: string-value
      Tags:
        - Key: string-value
          Value: string-value","AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
      Tags:
        - Key: string-value
          Value: string-value

AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
        WebACLId: """"
      Tags:
        - Key: string-value
          Value: string-value","[[6], [21]]"
296,1056dfbb-5802-4762-bf2b-8b9b9684b1b0,API Gateway With Open Access,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_with_open_access,Unknown,"API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-method.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  MockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: OPTIONS
      AuthorizationType: NONE
      Integration:
        Type: MOCK","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  MockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        Type: MOCK",[[6]]
297,105ba098-1e34-48cd-b0f2-a8a43a51bf9b,ALB Is Not Integrated With WAF,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/alb_is_not_integrated_with_waf,Unknown,"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-wafregional-webaclassociation.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyLoadBalancer9:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          Scheme: internet-facing
    MyWebACLAssociation:
      Type: ""AWS::WAFRegional::WebACLAssociation""
      Properties:
        ResourceArn:
          Ref: MyLoadBalancer9
        WebACLId:
          Ref: MyWebACL","AWSTemplateFormatVersion: 2010-09-09
Resources:
  MyLoadBalancer22:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      AvailabilityZones:
        - ""us-east-2a""
      CrossZone: true
      Listeners:
        - InstancePort: ""80""
          InstanceProtocol: HTTP
          LoadBalancerPort: ""443""
          Protocol: HTTPS
          PolicyNames:
            - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
      Scheme: internet-facing

AWSTemplateFormatVersion: 2010-09-09
Resources:
  MyLoadBalancerV2:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: myloadbalancerv2
      Scheme: internet-facing","[[3], [3]]"
298,124b173b-e06d-48a6-8acd-f889443d97a4,BOM - AWS Cassandra,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/cassandra,Unknown,"A list of Cassandra resources found. Amazon Cassandra is an open-source NoSQL database designed to store data for applications that require fast read and write performance<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: 2010-09-09
Resources:
  myNewTable1:
    Type: 'AWS::Cassandra::Table'
    Properties:
      KeyspaceName: my_keyspace
      TableName: my_table
      PartitionKeyColumns:
        - ColumnName: Message
          ColumnType: ASCII

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myNewTable2:
    Type: AWS::Cassandra::Table
    Properties:
      KeyspaceName: my_keyspace
      TableName: my_table
      EncryptionSpecification:
        EncryptionType: CUSTOMER_MANAGED_KMS_KEY
        KmsKeyIdentifier: arn:aws:kms:eu-west-1:5555555555555:key/11111111-1111-111-1111-111111111111
      PointInTimeRecoveryEnabled: true","[[3], [3]]"
299,12726829-93ed-4d51-9cbe-13423f4299e1,SQS With SSE Disabled,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sqs_with_sse_disabled,Unknown,"Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queues.html#aws-sqs-queue-kmsmasterkeyid)","Resources:
  MyQueue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: ""SampleQueue""
      KmsMasterKeyId: wewewewewewe
  MyQueue2:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: ""SampleQueue""
      SqsManagedSseEnabled: true","Resources:
  MyQueue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: ""SampleQueue""
  MyQueue2:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: ""SampleQueue""
      SqsManagedSseEnabled: false","[[8, 4]]"
300,1819ac03-542b-4026-976b-f37addd59f3b,EBS Volume Not Attached To Instances,CloudFormation,Low,Availability,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ebs_volume_not_attached_to_instances,Unknown,"EBS Volumes that are unattached to instances may contain sensitive data<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volumeattachment.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    NewVolume:
        Type: AWS::EC2::Volume
        Properties:
            Size: 100
            AvailabilityZone: us-west-1
    MountPoint:
        Type: AWS::EC2::VolumeAttachment
        Properties:
            InstanceId: !Ref Ec2Instance
            VolumeId: !Ref NewVolume
            Device: /dev/sdh","AWSTemplateFormatVersion: 2010-09-09
Resources:
    NewVolume:
        Type: AWS::EC2::Volume
        Properties:
            Size: 100
            AvailabilityZone: us-west-1",[[3]]
301,1a427b25-2e9e-4298-9530-0499a55e736b,Security Group Ingress With All Protocols,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_ingress_with_all_protocols,Unknown,"AWS Security Group Ingress should not specify all protocols to prevent allow traffic on all ports<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: -1
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: -1
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[9, 35]]"
302,1b6322d9-c755-4f8c-b804-32c19250f2d9,Config Rule For Encrypted Volumes Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/config_rule_for_encryption_volumes_disabled,Unknown,"Check if AWS config rules do not identify Encrypted Volumes as a source.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-source)","Resources:
  ConfigRule:
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: access-keys-rotated
      InputParameters:
        maxAccessKeyAge: 90
      Source:
        Owner: AWS
        SourceIdentifier: ENCRYPTED_VOLUMES
      MaximumExecutionFrequency: TwentyFour_Hours","Resources:
  ConfigRule:
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: access-keys-rotated
      InputParameters:
        maxAccessKeyAge: 100
      Source:
        Owner: AWS
        SourceIdentifier: ACCESS_KEYS_ROTATED
      MaximumExecutionFrequency: TwentyFour_Hours",[[2]]
303,1bf3b3d4-f373-4d7c-afbb-7d85948a67a5,DocDB Logging Is Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/docdb_logging_disabled,Unknown,"DocDB logging should be enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html#cfn-docdb-dbcluster-enablecloudwatchlogsexports)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  MyDocDBCluster:
    Type: AWS::DocDB::DBCluster
    Properties:
      AvailabilityZones:
        - us-east-1a
        - us-east-1b
      BackupRetentionPeriod: 30
      CopyTagsToSnapshot: true
      DBClusterIdentifier: my-docdb-cluster
      DBClusterParameterGroupName: default.docdb3.6
      DBSubnetGroupName: my-docdb-subnet-group
      DeletionProtection: false
      EnableCloudwatchLogsExports:
        - error
        - general
        - profiler
        - audit
      EngineVersion: ""3.6.0""
      KmsKeyId: ""arn:aws:kms:us-east-1:123456789012:key/1234abcd-12ab-34cd-56ef-1234567890ab""
      MasterUsername: mydocdbuser
      MasterUserPassword: mysecretpassword123
      Port: 27017
      PreferredBackupWindow: ""07:00-09:00""
      PreferredMaintenanceWindow: ""sun:05:00-sun:06:00""
      StorageEncrypted: true
      Tags:
        - Key: Name
          Value: MyDocDBCluster
      UseLatestRestorableTime: true
      VpcSecurityGroupIds:
        - sg-0123456789abcdef0
        - sg-abcdef01234567890","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  MyDocDBCluster:
    Type: AWS::DocDB::DBCluster
    Properties:
      AvailabilityZones:
        - us-east-1a
        - us-east-1b
      BackupRetentionPeriod: 30
      CopyTagsToSnapshot: true
      DBClusterIdentifier: my-docdb-cluster
      DBClusterParameterGroupName: default.docdb3.6
      DBSubnetGroupName: my-docdb-subnet-group
      DeletionProtection: false
      EnableCloudwatchLogsExports: []
      EngineVersion: ""3.6.0""
      KmsKeyId: ""arn:aws:kms:us-east-1:123456789012:key/1234abcd-12ab-34cd-56ef-1234567890ab""
      MasterUsername: mydocdbuser
      MasterUserPassword: mysecretpassword123
      Port: 27017
      PreferredBackupWindow: ""07:00-09:00""
      PreferredMaintenanceWindow: ""sun:05:00-sun:06:00""
      StorageEncrypted: true
      Tags:
        - Key: Name
          Value: MyDocDBCluster
      UseLatestRestorableTime: true
      VpcSecurityGroupIds:
        - sg-0123456789abcdef0
        - sg-abcdef01234567890

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  MyDocDBCluster:
    Type: AWS::DocDB::DBCluster
    Properties:
      AvailabilityZones:
        - us-east-1a
        - us-east-1b
      BackupRetentionPeriod: 30
      CopyTagsToSnapshot: true
      DBClusterIdentifier: my-docdb-cluster
      DBClusterParameterGroupName: default.docdb3.6
      DBSubnetGroupName: my-docdb-subnet-group
      DeletionProtection: false
      EnableCloudwatchLogsExports:
        - error
        - general
        - profiler
      EngineVersion: ""3.6.0""
      KmsKeyId: ""arn:aws:kms:us-east-1:123456789012:key/1234abcd-12ab-34cd-56ef-1234567890ab""
      MasterUsername: mydocdbuser
      MasterUserPassword: mysecretpassword123
      Port: 27017
      PreferredBackupWindow: ""07:00-09:00""
      PreferredMaintenanceWindow: ""sun:05:00-sun:06:00""
      StorageEncrypted: true
      Tags:
        - Key: Name
          Value: MyDocDBCluster
      UseLatestRestorableTime: true
      VpcSecurityGroupIds:
        - sg-0123456789abcdef0
        - sg-abcdef01234567890","[[15], [15]]"
304,1c07bfaf-663c-4f6f-b22b-8e2d481e4df5,CMK Rotation Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cmk_rotation_disabled,Unknown,"Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'EnableKeyRotation' must be set to 'true' when the key is enabled.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kms-key.html)","#this code is a correct code for which the query should not find any result
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: true
      EnableKeyRotation: true
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String

#this code is a correct code for which the query should not find any result
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: ""true""
      EnableKeyRotation: ""true""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String","#this is a problematic code where the query should report a result(s)
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: true
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
  myKey2:
    Type: AWS::KMS::Key
    Properties:
      Enabled: true
      EnableKeyRotation: false
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String

#this is a problematic code where the query should report a result(s)
Resources:
  myKey2:
    Type: AWS::KMS::Key
    Properties:
      Enabled: ""true""
      EnableKeyRotation: ""false""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String","[[5, 31], [7]]"
305,1cc2fbd7-816c-4fbf-ad6d-38a4afa4312a,Security Group Egress CIDR Open To World,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_egress_cidr_open_to_world,Unknown,"AWS Security Group Egress CIDR should not be open to the world<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-security-group-egress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIpv6: 2001:0DB8:1234::/48
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIpv6: 2001:0DB8:1234::/48
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIpv6: ::/0
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIpv6: ::/0
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[27, 4]]"
306,1d6e16f1-5d8a-4379-bfb3-2dadd38ed5a7,Lambda Permission Principal Is Wildcard,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_permission_principal_is_wildcard,Unknown,"Lambda Permission Principal should not contain a wildcard.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-permission.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  s3Permission:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:InvokeFunction
      Principal: s3.amazonaws.com
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: !GetAtt bucket.Arn","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  s3Permission:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:InvokeFunction
      Principal: '*'
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: !GetAtt bucket.Arn",[[9]]
307,1fe9d958-ddce-4228-a124-05265a959a8b,RDS Using Default Port,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_using_default_port,Unknown,"RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-port)","Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    Port: 1522
  DeletionPolicy: Snapshot

Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: mysql
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    Port: 3307
  DeletionPolicy: Snapshot","Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    Port: 1521
  DeletionPolicy: Snapshot

Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: mysql
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    Port: 3306
  DeletionPolicy: Snapshot","[[15], [15]]"
308,209189f3-c879-48a7-9703-fbcfa96d0cef,BOM - AWS MQ,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/mq,Unknown,"A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: true
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""true""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""","[[4], [4]]"
309,219f4c95-aa50-44e0-97de-cf71f4641170,S3 Bucket ACL Allows Read to All Users,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_acl_allows_read_to_all_users,Unknown,"S3 Buckets should not be readable to all users<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts03:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: BucketOwnerFullControl
      BucketName: jenkins-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts04:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: Private
      BucketName: jenkins-secret-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts05:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicReadWrite
      BucketName: jenkins-secret-artifacts2
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      BucketName: jenkins-artifacts
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  StaticPage01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      BucketName: public-read-static-page01
      WebsiteConfiguration:
        ErrorDocument: 404.html
        IndexDocument: index.html
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts02:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      BucketName: jenkins-artifacts-block-public
      PublicAccessBlockConfiguration:
        BlockPublicPolicy: false
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD","[[7], [7], [7]]"
310,235ca980-eb71-48f4-9030-df0c371029eb,KMS Key Rotation Disabled,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/kms_enable_key_rotation_disabled,Unknown,"EnableKeyRotation should not be false or undefined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kms-key.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      EnableKeyRotation: ""True""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      EnableKeyRotation: True
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      EnableKeyRotation: false
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'
  myKey2:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      EnableKeyRotation: ""false""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'
  myKey2:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'","[[8, 51], [8, 51]]"
311,24d932e1-91f0-46ea-836f-fdbd81694151,Route53 Record Undefined,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/route53_record_undefined,Unknown,"Route53 HostedZone must have the Record Set defined.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-route53-hostedzone.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""
  RecordSet:
    Type: AWS::Route53::RecordSet
    Properties:
      HostedZoneId: !Ref HostedZoneId
      Name: !Join ['', [!Ref DomainName, '.', !Ref HostedZoneName, '.']]
      Type: CNAME
      TTL: '900'
      ResourceRecords:
      - !Ref DnsEndpoint","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""",[[4]]
312,2564172f-c92b-4261-9acd-464aed511696,Hardcoded AWS Access Key In Lambda,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/hardcoded_aws_access_key_in_lambda,Unknown,"Lambda access/secret keys should not be hardcoded<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html#cfn-lambda-function-environment)","AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  LambdaFunction:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Environment:
        Variables:
          foo: ""test""
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036","AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  LambdaFunction3:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Environment:
        Variables:
          foo: ""1234567890123456789012345678901234567890$""
          databaseName: lambdadb
          databaseUser: admin
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036

AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  LambdaFunction4:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Environment:
        Variables:
          foo: ""12345678901234567890123456789012345678901234567890123456789012345678901234567890$""
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036","[[10], [10]]"
313,2623d682-dccb-44cd-99d0-54d9fd62f8f2,EC2 Network ACL Ineffective Denied Traffic,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_network_acl_ineffective_denied_traffic,Unknown,"Ineffective deny rules. A deny rule should be applied to all IP addresses.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-network-acl-entry.html)","Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: -1
       Egress: true
       RuleAction: allow
       CidrBlock: 0.0.0.0/0","Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: deny
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: -1
       Egress: true
       RuleAction: deny
       CidrBlock: 0.0.0.0/0",[[17]]
314,2730c169-51d7-4ae7-99b5-584379eff1bb,BOM - AWS MSK,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/msk,Unknown,"A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","Description: MSK Cluster with all properties
Resources:
  TestCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      EncryptionInfo:
        EncryptionAtRest:
          DataVolumeKMSKeyId: ReplaceWithKmsKeyArn
        EncryptionInTransit:
          ClientBroker: TLS
          InCluster: true
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3
        ConnectivityInfo:
          PublicAccess:
            Type: SERVICE_PROVIDED_EIPS",[[3]]
315,275a3217-ca37-40c1-a6cf-bb57d245ab32,ALB Listening on HTTP,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/alb_listening_on_http,Unknown,"AWS Application Load Balancer (alb) should not listen on HTTP<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb-listener.html#cfn-ec2-elb-listener-protocol)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTPS
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          Scheme: internal","AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTPS
            LoadBalancerPort: '443'
            Protocol: HTTP
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          Scheme: internal
    HTTPlistener:
        Type: ""AWS::ElasticLoadBalancingV2::Listener""
        Properties:
            DefaultActions:
            - Type: redirect
            LoadBalancerArn: !Ref myLoadBalancer
            Port: 80
            Protocol: HTTP

Resources:
  HTTPlistener:
   Type: ""AWS::ElasticLoadBalancingV2::Listener""
   Properties:
     DefaultActions:
       - Type: ""redirect""
         RedirectConfig:
           Protocol: ""HTTPS""
           Port: ""443""
           Host: ""#{host}""
           Path: ""/#{path}""
           Query: ""#{query}""
           StatusCode: ""HTTP_301""
     LoadBalancerArn: !Ref myLoadBalancer
     Port: 80
     Protocol: ""HTTP""","[[25, 13], [16]]"
316,2844c749-bd78-4cd1-90e8-b179df827602,CMK Is Unusable,CloudFormation,Medium,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cmk_is_unusable,Unknown,"AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'Enabled' set to true and the attribute 'PendingWindowInDays' must be undefined.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kms-key.html)","Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: true
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String

Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: ""true""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String","Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: false
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
  myKey2:
    Type: AWS::KMS::Key
    Properties:
      Enabled: true
      PendingWindowInDays: 7
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String

Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Enabled: ""false""
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS:
              Fn::Join:
              - ''
              - - 'arn:aws:iam::'
                - Ref: AWS::AccountId
                - :root
          Action: kms:*
          Resource: '*'
      Tags:
      - Key:
          Ref: Key
        Value:
          Ref: Value
Parameters:
  Key:
    Type: String
  Value:
    Type: String","[[5, 30], [5]]"
317,2a3560fe-52ca-4443-b34f-bf0ed5eb74c8,CloudTrail Log File Validation Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_log_file_validation_disabled,Unknown,"CloudTrail log file validation should be enabled to determine whether a log file has not been tampered<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-enablelogfilevalidation)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: true
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: ""true""
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
  myTrail2:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: false
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
  myTrail2:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: false
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: ""true""","[[77, 62], [77, 62]]"
318,2b1d4935-9acf-48a7-8466-10d18bf51a69,RDS Multi-AZ Deployment Disabled,CloudFormation,Medium,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_multi_az_deployment_disabled,Unknown,"AWS RDS Instance should have a multi-az deployment<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: ""AWS CloudFormation Sample Template RDS_MySQL_With_Read_Replica:
  Sample template showing how to create a highly-available, RDS DBInstance with
  a read replica. **WARNING** This template creates an Amazon Relational
  Database Service database instance and Amazon CloudWatch alarms. You will be
  billed for the AWS resources used if you create a stack from this template.""
Parameters:
  DBName:
    Default: MyDatabase
    Description: The database name
    Type: String
    MinLength: ""1""
    MaxLength: ""64""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBUser:
    NoEcho: ""true""
    Description: The database admin account username
    Type: String
    MinLength: ""1""
    MaxLength: ""16""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: ""true""
    Description: The database admin account password
    Type: String
    MinLength: ""1""
    MaxLength: ""41""
    AllowedPattern: ""[a-zA-Z0-9]+""
    ConstraintDescription: must contain only alphanumeric characters.
  DBAllocatedStorage:
    Default: ""5""
    Description: The size of the database (Gb)
    Type: Number
    MinValue: ""5""
    MaxValue: ""1024""
    ConstraintDescription: must be between 5 and 1024Gb.
  DBInstanceClass:
    Description: The database instance type
    Type: String
    Default: db.t2.small
    AllowedValues:
      - db.t1.micro
      - db.m1.small
      - db.m1.medium
      - db.m1.large
      - db.m1.xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.m3.medium
      - db.m3.large
      - db.m3.xlarge
      - db.m3.2xlarge
      - db.m4.large
      - db.m4.xlarge
      - db.m4.2xlarge
      - db.m4.4xlarge
      - db.m4.10xlarge
      - db.r3.large
      - db.r3.xlarge
      - db.r3.2xlarge
      - db.r3.4xlarge
      - db.r3.8xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.cr1.8xlarge
      - db.t2.micro
      - db.t2.small
      - db.t2.medium
      - db.t2.large
    ConstraintDescription: must select a valid database instance type.
  EC2SecurityGroup:
    Description: The EC2 security group that contains instances that need access to
      the database
    Default: default
    Type: String
    AllowedPattern: ""[a-zA-Z0-9\\-]+""
    ConstraintDescription: must be a valid security group name.
Conditions:
  Is-EC2-VPC:
    Fn::Or:
      - Fn::Equals:
          - Ref: AWS::Region
          - eu-central-1
      - Fn::Equals:
          - Ref: AWS::Region
          - cn-north-1
  Is-EC2-Classic:
    Fn::Not:
      - Condition: Is-EC2-VPC
Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Condition: Is-EC2-VPC
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3306
          ToPort: 3306
          SourceSecurityGroupName:
            Ref: EC2SecurityGroup
  DBSecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Condition: Is-EC2-Classic
    Properties:
      DBSecurityGroupIngress:
        - EC2SecurityGroupName:
            Ref: EC2SecurityGroup
      GroupDescription: database access
  MasterDB:
    Type: AWS::RDS::DBInstance
    Properties:
      DBName:
        Ref: DBName
      AllocatedStorage:
        Ref: DBAllocatedStorage
      DBInstanceClass:
        Ref: DBInstanceClass
      Engine: MySQL
      MasterUsername:
        Ref: DBUser
      MasterUserPassword:
        Ref: DBPassword
      MultiAZ: true
      Tags:
        - Key: Name
          Value: Master Database
      VPCSecurityGroups:
        Fn::If:
          - Is-EC2-VPC
          - - Fn::GetAtt:
                - DBEC2SecurityGroup
                - GroupId
          - Ref: AWS::NoValue
      DBSecurityGroups:
        Fn::If:
          - Is-EC2-Classic
          - - Ref: DBSecurityGroup
          - Ref: AWS::NoValue
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
  ReplicaDB:
    Type: AWS::RDS::DBInstance
    Properties:
      SourceDBInstanceIdentifier:
        Ref: MasterDB
      DBInstanceClass:
        Ref: DBInstanceClass
      MultiAZ: true
      Tags:
        - Key: Name
          Value: Read Replica Database
Outputs:
  EC2Platform:
    Description: Platform in which this stack is deployed
    Value:
      Fn::If:
        - Is-EC2-VPC
        - EC2-VPC
        - EC2-Classic
  MasterJDBCConnectionString:
    Description: JDBC connection string for the master database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Port
          - /
          - Ref: DBName
  ReplicaJDBCConnectionString:
    Description: JDBC connection string for the replica database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Port
          - /
          - Ref: DBName

AWSTemplateFormatVersion: 2010-09-09
Description: ""AWS CloudFormation Sample Template RDS_MySQL_With_Read_Replica:
  Sample template showing how to create a highly-available, RDS DBInstance with
  a read replica. **WARNING** This template creates an Amazon Relational
  Database Service database instance and Amazon CloudWatch alarms. You will be
  billed for the AWS resources used if you create a stack from this template.""
Parameters:
  DBName:
    Default: MyDatabase
    Description: The database name
    Type: String
    MinLength: ""1""
    MaxLength: ""64""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBUser:
    NoEcho: ""true""
    Description: The database admin account username
    Type: String
    MinLength: ""1""
    MaxLength: ""16""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: ""true""
    Description: The database admin account password
    Type: String
    MinLength: ""1""
    MaxLength: ""41""
    AllowedPattern: ""[a-zA-Z0-9]+""
    ConstraintDescription: must contain only alphanumeric characters.
  DBAllocatedStorage:
    Default: ""5""
    Description: The size of the database (Gb)
    Type: Number
    MinValue: ""5""
    MaxValue: ""1024""
    ConstraintDescription: must be between 5 and 1024Gb.
  DBInstanceClass:
    Description: The database instance type
    Type: String
    Default: db.t2.small
    AllowedValues:
      - db.t1.micro
      - db.m1.small
      - db.m1.medium
      - db.m1.large
      - db.m1.xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.m3.medium
      - db.m3.large
      - db.m3.xlarge
      - db.m3.2xlarge
      - db.m4.large
      - db.m4.xlarge
      - db.m4.2xlarge
      - db.m4.4xlarge
      - db.m4.10xlarge
      - db.r3.large
      - db.r3.xlarge
      - db.r3.2xlarge
      - db.r3.4xlarge
      - db.r3.8xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.cr1.8xlarge
      - db.t2.micro
      - db.t2.small
      - db.t2.medium
      - db.t2.large
    ConstraintDescription: must select a valid database instance type.
  EC2SecurityGroup:
    Description: The EC2 security group that contains instances that need access to
      the database
    Default: default
    Type: String
    AllowedPattern: ""[a-zA-Z0-9\\-]+""
    ConstraintDescription: must be a valid security group name.
Conditions:
  Is-EC2-VPC:
    Fn::Or:
      - Fn::Equals:
          - Ref: AWS::Region
          - eu-central-1
      - Fn::Equals:
          - Ref: AWS::Region
          - cn-north-1
  Is-EC2-Classic:
    Fn::Not:
      - Condition: Is-EC2-VPC
Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Condition: Is-EC2-VPC
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3306
          ToPort: 3306
          SourceSecurityGroupName:
            Ref: EC2SecurityGroup
  DBSecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Condition: Is-EC2-Classic
    Properties:
      DBSecurityGroupIngress:
        - EC2SecurityGroupName:
            Ref: EC2SecurityGroup
      GroupDescription: database access
  MasterDB:
    Type: AWS::RDS::DBInstance
    Properties:
      DBName:
        Ref: DBName
      AllocatedStorage:
        Ref: DBAllocatedStorage
      DBInstanceClass:
        Ref: DBInstanceClass
      Engine: MySQL
      MasterUsername:
        Ref: DBUser
      MasterUserPassword:
        Ref: DBPassword
      MultiAZ: ""true""
      Tags:
        - Key: Name
          Value: Master Database
      VPCSecurityGroups:
        Fn::If:
          - Is-EC2-VPC
          - - Fn::GetAtt:
                - DBEC2SecurityGroup
                - GroupId
          - Ref: AWS::NoValue
      DBSecurityGroups:
        Fn::If:
          - Is-EC2-Classic
          - - Ref: DBSecurityGroup
          - Ref: AWS::NoValue
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
  ReplicaDB:
    Type: AWS::RDS::DBInstance
    Properties:
      SourceDBInstanceIdentifier:
        Ref: MasterDB
      DBInstanceClass:
        Ref: DBInstanceClass
      MultiAZ: ""true""
      Tags:
        - Key: Name
          Value: Read Replica Database
Outputs:
  EC2Platform:
    Description: Platform in which this stack is deployed
    Value:
      Fn::If:
        - Is-EC2-VPC
        - EC2-VPC
        - EC2-Classic
  MasterJDBCConnectionString:
    Description: JDBC connection string for the master database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Port
          - /
          - Ref: DBName
  ReplicaJDBCConnectionString:
    Description: JDBC connection string for the replica database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Port
          - /
          - Ref: DBName","AWSTemplateFormatVersion: 2010-09-09
Description: ""AWS CloudFormation Sample Template RDS_MySQL_With_Read_Replica:
  Sample template showing how to create a highly-available, RDS DBInstance with
  a read replica. **WARNING** This template creates an Amazon Relational
  Database Service database instance and Amazon CloudWatch alarms. You will be
  billed for the AWS resources used if you create a stack from this template.""
Parameters:
  DBName:
    Default: MyDatabase
    Description: The database name
    Type: String
    MinLength: ""1""
    MaxLength: ""64""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBUser:
    NoEcho: ""true""
    Description: The database admin account username
    Type: String
    MinLength: ""1""
    MaxLength: ""16""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: ""true""
    Description: The database admin account password
    Type: String
    MinLength: ""1""
    MaxLength: ""41""
    AllowedPattern: ""[a-zA-Z0-9]+""
    ConstraintDescription: must contain only alphanumeric characters.
  DBAllocatedStorage:
    Default: ""5""
    Description: The size of the database (Gb)
    Type: Number
    MinValue: ""5""
    MaxValue: ""1024""
    ConstraintDescription: must be between 5 and 1024Gb.
  DBInstanceClass:
    Description: The database instance type
    Type: String
    Default: db.t2.small
    AllowedValues:
      - db.t1.micro
      - db.m1.small
      - db.m1.medium
      - db.m1.large
      - db.m1.xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.m3.medium
      - db.m3.large
      - db.m3.xlarge
      - db.m3.2xlarge
      - db.m4.large
      - db.m4.xlarge
      - db.m4.2xlarge
      - db.m4.4xlarge
      - db.m4.10xlarge
      - db.r3.large
      - db.r3.xlarge
      - db.r3.2xlarge
      - db.r3.4xlarge
      - db.r3.8xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.cr1.8xlarge
      - db.t2.micro
      - db.t2.small
      - db.t2.medium
      - db.t2.large
    ConstraintDescription: must select a valid database instance type.
  EC2SecurityGroup:
    Description: The EC2 security group that contains instances that need access to
      the database
    Default: default
    Type: String
    AllowedPattern: ""[a-zA-Z0-9\\-]+""
    ConstraintDescription: must be a valid security group name.
Conditions:
  Is-EC2-VPC:
    Fn::Or:
      - Fn::Equals:
          - Ref: AWS::Region
          - eu-central-1
      - Fn::Equals:
          - Ref: AWS::Region
          - cn-north-1
  Is-EC2-Classic:
    Fn::Not:
      - Condition: Is-EC2-VPC
Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Condition: Is-EC2-VPC
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3306
          ToPort: 3306
          SourceSecurityGroupName:
            Ref: EC2SecurityGroup
  DBSecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Condition: Is-EC2-Classic
    Properties:
      DBSecurityGroupIngress:
        - EC2SecurityGroupName:
            Ref: EC2SecurityGroup
      GroupDescription: database access
  MasterDB:
    Type: AWS::RDS::DBInstance
    Properties:
      DBName:
        Ref: DBName
      AllocatedStorage:
        Ref: DBAllocatedStorage
      DBInstanceClass:
        Ref: DBInstanceClass
      Engine: MySQL
      MasterUsername:
        Ref: DBUser
      MasterUserPassword:
        Ref: DBPassword
      MultiAZ: false
      Tags:
        - Key: Name
          Value: Master Database
      VPCSecurityGroups:
        Fn::If:
          - Is-EC2-VPC
          - - Fn::GetAtt:
                - DBEC2SecurityGroup
                - GroupId
          - Ref: AWS::NoValue
      DBSecurityGroups:
        Fn::If:
          - Is-EC2-Classic
          - - Ref: DBSecurityGroup
          - Ref: AWS::NoValue
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
  ReplicaDB:
    Type: AWS::RDS::DBInstance
    Properties:
      SourceDBInstanceIdentifier:
        Ref: MasterDB
      DBInstanceClass:
        Ref: DBInstanceClass
      Tags:
        - Key: Name
          Value: Read Replica Database
Outputs:
  EC2Platform:
    Description: Platform in which this stack is deployed
    Value:
      Fn::If:
        - Is-EC2-VPC
        - EC2-VPC
        - EC2-Classic
  MasterJDBCConnectionString:
    Description: JDBC connection string for the master database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Port
          - /
          - Ref: DBName
  ReplicaJDBCConnectionString:
    Description: JDBC connection string for the replica database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Port
          - /
          - Ref: DBName

AWSTemplateFormatVersion: 2010-09-09
Description: ""AWS CloudFormation Sample Template RDS_MySQL_With_Read_Replica:
  Sample template showing how to create a highly-available, RDS DBInstance with
  a read replica. **WARNING** This template creates an Amazon Relational
  Database Service database instance and Amazon CloudWatch alarms. You will be
  billed for the AWS resources used if you create a stack from this template.""
Parameters:
  DBName:
    Default: MyDatabase
    Description: The database name
    Type: String
    MinLength: ""1""
    MaxLength: ""64""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBUser:
    NoEcho: ""true""
    Description: The database admin account username
    Type: String
    MinLength: ""1""
    MaxLength: ""16""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: ""true""
    Description: The database admin account password
    Type: String
    MinLength: ""1""
    MaxLength: ""41""
    AllowedPattern: ""[a-zA-Z0-9]+""
    ConstraintDescription: must contain only alphanumeric characters.
  DBAllocatedStorage:
    Default: ""5""
    Description: The size of the database (Gb)
    Type: Number
    MinValue: ""5""
    MaxValue: ""1024""
    ConstraintDescription: must be between 5 and 1024Gb.
  DBInstanceClass:
    Description: The database instance type
    Type: String
    Default: db.t2.small
    AllowedValues:
      - db.t1.micro
      - db.m1.small
      - db.m1.medium
      - db.m1.large
      - db.m1.xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.m3.medium
      - db.m3.large
      - db.m3.xlarge
      - db.m3.2xlarge
      - db.m4.large
      - db.m4.xlarge
      - db.m4.2xlarge
      - db.m4.4xlarge
      - db.m4.10xlarge
      - db.r3.large
      - db.r3.xlarge
      - db.r3.2xlarge
      - db.r3.4xlarge
      - db.r3.8xlarge
      - db.m2.xlarge
      - db.m2.2xlarge
      - db.m2.4xlarge
      - db.cr1.8xlarge
      - db.t2.micro
      - db.t2.small
      - db.t2.medium
      - db.t2.large
    ConstraintDescription: must select a valid database instance type.
  EC2SecurityGroup:
    Description: The EC2 security group that contains instances that need access to
      the database
    Default: default
    Type: String
    AllowedPattern: ""[a-zA-Z0-9\\-]+""
    ConstraintDescription: must be a valid security group name.
Conditions:
  Is-EC2-VPC:
    Fn::Or:
      - Fn::Equals:
          - Ref: AWS::Region
          - eu-central-1
      - Fn::Equals:
          - Ref: AWS::Region
          - cn-north-1
  Is-EC2-Classic:
    Fn::Not:
      - Condition: Is-EC2-VPC
Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Condition: Is-EC2-VPC
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3306
          ToPort: 3306
          SourceSecurityGroupName:
            Ref: EC2SecurityGroup
  DBSecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Condition: Is-EC2-Classic
    Properties:
      DBSecurityGroupIngress:
        - EC2SecurityGroupName:
            Ref: EC2SecurityGroup
      GroupDescription: database access
  MasterDB:
    Type: AWS::RDS::DBInstance
    Properties:
      DBName:
        Ref: DBName
      AllocatedStorage:
        Ref: DBAllocatedStorage
      DBInstanceClass:
        Ref: DBInstanceClass
      Engine: MySQL
      MasterUsername:
        Ref: DBUser
      MasterUserPassword:
        Ref: DBPassword
      MultiAZ: ""false""
      Tags:
        - Key: Name
          Value: Master Database
      VPCSecurityGroups:
        Fn::If:
          - Is-EC2-VPC
          - - Fn::GetAtt:
                - DBEC2SecurityGroup
                - GroupId
          - Ref: AWS::NoValue
      DBSecurityGroups:
        Fn::If:
          - Is-EC2-Classic
          - - Ref: DBSecurityGroup
          - Ref: AWS::NoValue
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
Outputs:
  EC2Platform:
    Description: Platform in which this stack is deployed
    Value:
      Fn::If:
        - Is-EC2-VPC
        - EC2-VPC
        - EC2-Classic
  MasterJDBCConnectionString:
    Description: JDBC connection string for the master database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - MasterDB
              - Endpoint.Port
          - /
          - Ref: DBName
  ReplicaJDBCConnectionString:
    Description: JDBC connection string for the replica database
    Value:
      Fn::Join:
        - """"
        - - jdbc:mysql://
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Address
          - "":""
          - Fn::GetAtt:
              - ReplicaDB
              - Endpoint.Port
          - /
          - Ref: DBName","[[128, 148], [128]]"
319,2c161e58-cb52-454f-abea-6470c37b5e6e,RDS DB Instance With Deletion Protection Disabled,CloudFormation,Low,Backup,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_db_instance_with_deletion_protection_disabled,Unknown,"RDS DBInstance should have deletion protection set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-deletionprotection)","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: true
      KmsKeyId: !Ref MyKey
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: ""true""
      KmsKeyId: !Ref MyKey
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: false
      KmsKeyId: !Ref MyKey
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey1:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall1:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall1","[[34], [30]]"
320,2ff8e83c-90e1-4d68-a300-6d652112e622,EFS Not Encrypted,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/efs_not_encrypted,Unknown,"Elastic File System (EFS) must be encrypted<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: true
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: ""true""
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: false
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: ""false""
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4","[[49], [49]]"
321,316278b3-87ac-444c-8f8f-a733a28da60f,AmazonMQ Broker Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amazon_mq_broker_encryption_disabled,Unknown,"AmazonMQ Broker should have Encryption Options defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amazonmq-broker.html#cfn-amazonmq-broker-encryptionoptions)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""true""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""true""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""",[[6]]
322,31733ee2-fef0-4e87-9778-65da22a8ecf1,Cloudfront Viewer Protocol Policy Allows HTTP,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudfront_viewer_protocol_policy_allows_http,Unknown,"Checks if the connection between CloudFront and the viewer is encrypted<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudfront-distribution.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution_1:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          ViewerProtocolPolicy: https-only
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example

#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution_1:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          ViewerProtocolPolicy: redirect-to-https
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution_1:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          ViewerProtocolPolicy: allow-all
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
  cloudfrontdistribution_2:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - ViewerProtocolPolicy: allow-all
            LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
        Tags:
        - Key: name
          Value: example","[[13, 30]]"
323,323db967-c68e-44e6-916c-a777f95af34b,ElastiCache Using Default Port,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticache_using_default_port,Unknown,"ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html#cfn-elasticache-replicationgroup-port)","Resources:
  BasicReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      AutomaticFailoverEnabled: true    
      CacheNodeType: cache.r3.large
      CacheSubnetGroupName: !Ref CacheSubnetGroup
      Engine: redis
      EngineVersion: '3.2'
      NumNodeGroups: '2'
      ReplicasPerNodeGroup: '3'
      Port: 6380
      PreferredMaintenanceWindow: 'sun:05:00-sun:09:00'
      ReplicationGroupDescription: A sample replication group
      SecurityGroupIds:
        - !Ref ReplicationGroupSG
      SnapshotRetentionLimit: 5
      SnapshotWindow: '10:00-12:00'

Resources:
  BasicReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      AutomaticFailoverEnabled: true    
      CacheNodeType: cache.r3.large
      CacheSubnetGroupName: !Ref CacheSubnetGroup
      Engine: memcached
      EngineVersion: '3.2'
      NumNodeGroups: '2'
      ReplicasPerNodeGroup: '3'
      Port: 11212
      PreferredMaintenanceWindow: 'sun:05:00-sun:09:00'
      ReplicationGroupDescription: A sample replication group
      SecurityGroupIds:
        - !Ref ReplicationGroupSG
      SnapshotRetentionLimit: 5
      SnapshotWindow: '10:00-12:00'","Resources:
  BasicReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      AutomaticFailoverEnabled: true    
      CacheNodeType: cache.r3.large
      CacheSubnetGroupName: !Ref CacheSubnetGroup
      Engine: redis
      EngineVersion: '3.2'
      NumNodeGroups: '2'
      ReplicasPerNodeGroup: '3'
      Port: 6379
      PreferredMaintenanceWindow: 'sun:05:00-sun:09:00'
      ReplicationGroupDescription: A sample replication group
      SecurityGroupIds:
        - !Ref ReplicationGroupSG
      SnapshotRetentionLimit: 5
      SnapshotWindow: '10:00-12:00'

Resources:
  BasicReplicationGroup:
    Type: 'AWS::ElastiCache::ReplicationGroup'
    Properties:
      AutomaticFailoverEnabled: true    
      CacheNodeType: cache.r3.large
      CacheSubnetGroupName: !Ref CacheSubnetGroup
      Engine: memcached
      EngineVersion: '3.2'
      NumNodeGroups: '2'
      ReplicasPerNodeGroup: '3'
      Port: 11211
      PreferredMaintenanceWindow: 'sun:05:00-sun:09:00'
      ReplicationGroupDescription: A sample replication group
      SecurityGroupIds:
        - !Ref ReplicationGroupSG
      SnapshotRetentionLimit: 5
      SnapshotWindow: '10:00-12:00'","[[12], [12]]"
324,33f41d31-86b1-46a4-81f7-9c9a671f59ac,ECR Image Tag Not Immutable,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecr_image_tag_not_immutable,Unknown,"ECR should have an image tag be immutable. This prevents image tags from being overwritten.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html)","Resources:
  MyRepository:
    Type: AWS::ECR::Repository
    Properties:
      ImageTagMutability: ""IMMUTABLE""
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal:
              AWS:
                - ""arn:aws:iam::123456789012:user/Bob""
                - ""arn:aws:iam::123456789012:user/Alice""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""","Resources:
  MyRepository3:
    Type: AWS::ECR::Repository
    Properties:
      ImageTagMutability: ""MUTABLE""
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal:
              AWS:
                - ""arn:aws:iam::123456789012:user/Bob""
                - ""arn:aws:iam::123456789012:user/Alice""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""
  MyRepository4:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal:
              AWS:
                - ""arn:aws:iam::123456789012:user/Bob""
                - ""arn:aws:iam::123456789012:user/Alice""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""","[[27, 5]]"
325,350cd468-0e2c-44ef-9d22-cfb73a62523c,S3 Bucket Without Restriction Of Public Bucket,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_without_restriction_of_public_bucket,Unknown,"S3 bucket without restriction of public bucket<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html)","Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : true
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true

Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : ""true""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""","Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : true
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy     : true
        IgnorePublicAcls      : false
        RestrictPublicBuckets : false

Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : ""true""
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: ""false""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""false""
        RestrictPublicBuckets : ""false""","[[10, 4, 21], [10, 4, 21]]"
326,3609d27c-3698-483a-9402-13af6ae80583,S3 Bucket With Unsecured CORS Rule,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_with_unsecured_cors_rule,Unknown,"If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-cors.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: PublicRead
      CorsConfiguration:
        CorsRules:
          - AllowedMethods:
              - GET
            AllowedOrigins:
              - 'https://s3-website-test.hashicorp.com'
            ExposedHeaders:
              - Date
            Id: myCORSRuleId1
            MaxAge: 3600
          - AllowedMethods:
              - DELETE
            AllowedOrigins:
              - 'http://www.example.com'
              - 'http://www.example.net'
            ExposedHeaders:
              - Connection
              - Server
              - Date
            Id: myCORSRuleId2
            MaxAge: 1800","AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: PublicRead
      CorsConfiguration:
        CorsRules:
          - AllowedHeaders:
              - '*'
            AllowedMethods:
              - GET
            AllowedOrigins:
              - '*'
            ExposedHeaders:
              - Date
            Id: myCORSRuleId1
            MaxAge: 3600
          - AllowedMethods:
              - DELETE
            AllowedOrigins:
              - 'http://www.example.com'
              - 'http://www.example.net'
            ExposedHeaders:
              - Connection
              - Server
              - Date
            Id: myCORSRuleId2
            MaxAge: 1800",[[8]]
327,3641d5b4-d339-4bc2-bfb9-208fe8d3477f,API Gateway Method Does Not Contains An API Key,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_method_does_not_contains_an_api_key,Unknown,"An API Key should be required on a method request.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-method.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ApiGateway
Resources:
  MockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ApiKeyRequired: true
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: """"
      AuthorizationType: NONE
      Integration:
        Type: MOCK
      MethodResponses:
        - StatusCode : ""200""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ApiGateway
Resources:
  MockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ApiKeyRequired: ""true""
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: """"
      AuthorizationType: NONE
      Integration:
        Type: MOCK
      MethodResponses:
        - StatusCode : ""200""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ApiGateway
Resources:
  MockMethod:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      ApiKeyRequired: false
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        Type: MOCK
      MethodResponses:
        - StatusCode : ""200""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ApiGateway
Resources:
  MockMethod1:
    Type: 'AWS::ApiGateway::Method'
    Properties:
      RestApiId: !Ref MyApi
      ResourceId: !GetAtt
        - MyApi
        - RootResourceId
      HttpMethod: GET
      AuthorizationType: NONE
      Integration:
        Type: MOCK
      MethodResponses:
        - StatusCode : ""200""","[[7], [6]]"
328,37cca703-b74c-48ba-ac81-595b53398e9b,API Gateway Cache Encrypted Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/316.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_cache_encrypted_disabled,Unknown,"'API::Gateway::Deployment' should have 'CacheDataEncrypted' enabled when 'CachingEnabled' is set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-apigateway-deployment-stagedescription.html)","Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyApi
      Description: My deployment
      StageName: DummyStage
      StageDescription:
        CacheDataEncrypted: true
        CachingEnabled: true

Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyApi
      Description: My deployment
      StageName: DummyStage
      StageDescription:
        CacheDataEncrypted: ""true""
        CachingEnabled: ""true""","Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyApi
      Description: My deployment
      StageName: DummyStage
      StageDescription:
        CachingEnabled: true

Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyApi
      Description: My deployment
      StageName: DummyStage
      StageDescription:
        CacheDataEncrypted: false
        CachingEnabled: true","[[8], [9]]"
329,37fa8188-738b-42c8-bf82-6334ea567738,S3 Bucket Should Have Bucket Policy,CloudFormation,Low,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_should_have_bucket_policy,Unknown,"Checks if S3 Bucket has the same name as a Bucket Policy, if it has, S3 Bucket has a Bucket Policy associated<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      BucketName: docexamplebucket
  SampleBucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: docexamplebucket
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  S3Bucket9:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      BucketName: docexamplebucket
  SampleBucketPolicy10:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref docexamplebucket
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  MyS3Bucket22:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: PublicRead
      MetricsConfigurations:
        - Id: EntireBucket
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
        RoutingRules:
          - RoutingRuleCondition:
              HttpErrorCodeReturnedEquals: '404'
              KeyPrefixEquals: out1/
            RedirectRule:
              HostName: ec2-11-22-333-44.compute-1.amazonaws.com
              ReplaceKeyPrefixWith: report-404/
  SampleBucketPolicy2:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref MyS3Bucket22
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  S3Bucket3:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      BucketName: docexamplebucket1
  SampleBucketPolicy5:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket:
        Ref: docexamplebucketfail
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket1
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties: {}
  SampleBucketPolicy2:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: docexamplebucket2
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  S3Bucket7:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      BucketName: docexamplebucket5
  SampleBucketPolicy8:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref docexamplebucketfail2
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: docexamplebucket1
                  - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  MyS3Bucket2:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: PublicRead
      MetricsConfigurations:
        - Id: EntireBucket
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
        RoutingRules:
          - RoutingRuleCondition:
              HttpErrorCodeReturnedEquals: '404'
              KeyPrefixEquals: out1/
            RedirectRule:
              HostName: ec2-11-22-333-44.compute-1.amazonaws.com
              ReplaceKeyPrefixWith: report-404/","[[56, 4, 31], [4]]"
330,38c64e76-c71e-4d92-a337-60174d1de1c9,S3 Bucket Without SSL In Write Actions,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_without_ssl_in_write_actions,Unknown,"S3 Buckets should enforce encryption of data transfers using Secure Sockets Layer (SSL)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: S3Bucket
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
    DeletionPolicy: Retain
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      PolicyDocument:
        Id: MyPolicy
        Version: 2012-10-17
        Statement:
          - Sid: PublicReadForGetBucketObjects
            Effect: Allow
            Principal: '*'
            Action: 's3:GetObject'
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket
                - /*
          - Sid: EnsureSSL
            Effect: Deny
            Principal: '*'
            Action: 's3:PutObject'
            Condition:
              Bool:
                'aws:SecureTransport': false
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket
                - /*
      Bucket: !Ref S3Bucket
Outputs:
  WebsiteURL:
    Value: !GetAtt
      - S3Bucket
      - WebsiteURL
    Description: URL for website hosted on S3
  S3BucketSecureURL:
    Value: !Join
      - ''
      - - 'https://'
        - !GetAtt
          - S3Bucket
          - DomainName
    Description: Name of S3 bucket to hold website content

AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket2:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: S3Bucket2
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
    DeletionPolicy: Retain
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      PolicyDocument:
        Id: MyPolicy
        Version: 2012-10-17
        Statement:
          - Sid: EnsureSSL
            Effect: Deny
            Principal: '*'
            Action: 's3:*'
            Condition:
              Bool:
                'aws:SecureTransport': false
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket2
                - /*
      Bucket: !Ref S3Bucket2
  S3Bucket3:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
    DeletionPolicy: Retain
  BucketPolicy2:
    Type: AWS::S3::BucketPolicy
    Properties:
      PolicyDocument:
        Id: MyPolicy2
        Version: 2012-10-17
        Statement:
          - Sid: EnsureSSL
            Effect: Deny
            Principal: '*'
            Action: 's3:*'
            Condition:
              Bool:
                'aws:SecureTransport': false
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket3
                - /*
      Bucket: !Ref S3Bucket3
Outputs:
  WebsiteURL:
    Value: !GetAtt
      - S3Bucket2
      - WebsiteURL
    Description: URL for website hosted on S3
  S3BucketSecureURL:
    Value: !Join
      - ''
      - - 'https://'
        - !GetAtt
          - S3Bucket2
          - DomainName
    Description: Name of S3 bucket to hold website content","AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: S3Bucket
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
    DeletionPolicy: Retain
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      PolicyDocument:
        Id: MyPolicy
        Version: 2012-10-17
        Statement:
          - Sid: PublicReadForGetBucketObjects
            Effect: Allow
            Principal: '*'
            Action: 's3:GetObject'
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket
                - /*
      Bucket: !Ref S3Bucket
Outputs:
  WebsiteURL:
    Value: !GetAtt
      - S3Bucket
      - WebsiteURL
    Description: URL for website hosted on S3
  S3BucketSecureURL:
    Value: !Join
      - ''
      - - 'https://'
        - !GetAtt
          - S3Bucket
          - DomainName
    Description: Name of S3 bucket to hold website content

AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket2:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: S3Bucket2
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html
    DeletionPolicy: Retain
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      PolicyDocument:
        Id: MyPolicy
        Version: 2012-10-17
        Statement:
          - Sid: EnsureSSL
            Effect: Deny
            Principal: '*'
            Action: 's3:PutObject'
            Condition:
              Bool:
                'aws:SecureTransport': true
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref S3Bucket2
                - /*
      Bucket: !Ref S3Bucket2
Outputs:
  WebsiteURL:
    Value: !GetAtt
      - S3Bucket2
      - WebsiteURL
    Description: URL for website hosted on S3
  S3BucketSecureURL:
    Value: !Join
      - ''
      - - 'https://'
        - !GetAtt
          - S3Bucket2
          - DomainName
    Description: Name of S3 bucket to hold website content","[[3], [3]]"
331,39423ce4-9011-46cd-b6b1-009edcd9385d,DocDB Cluster Master Password In Plaintext,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/docdb_cluster_master_password_in_plaintext,Unknown,"DocDB DB Cluster master user password must not be in a plain text string or referenced in a parameter as a default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html)","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
Resources:
  NewAmpApp1:
    Type: AWS::DocDB::DBCluster
    Properties:
      BackupRetentionPeriod: 8
      DBClusterIdentifier: ""sample-cluster""
      DBClusterParameterGroupName: ""default.docdb3.6""
      DBSubnetGroupName: ""default""
      DeletionProtection: true
      KmsKeyId: ""your-kms-key-id""
      MasterUsername: ""your-master-username""
      MasterUserPassword: !Ref ParentMasterPassword
      Port: 27017
      PreferredBackupWindow: ""07:34-08:04""
      PreferredMaintenanceWindow: ""sat:04:51-sat:05:21""
      SnapshotIdentifier: ""sample-cluster-snapshot-id""
      StorageEncrypted: true

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
Resources:
  NewAmpApp1:
    Type: AWS::DocDB::DBCluster
    Properties:
      BackupRetentionPeriod: 8
      DBClusterIdentifier: ""sample-cluster""
      DBClusterParameterGroupName: ""default.docdb3.6""
      DBSubnetGroupName: ""default""
      DeletionProtection: true
      KmsKeyId: ""your-kms-key-id""
      MasterUsername: ""your-master-username""
      MasterUserPassword: !Ref ParentMasterPassword
      Port: 27017
      PreferredBackupWindow: ""07:34-08:04""
      PreferredMaintenanceWindow: ""sat:04:51-sat:05:21""
      SnapshotIdentifier: ""sample-cluster-snapshot-id""
      StorageEncrypted: true","Resources:
  NewAmpApp:
    Type:  AWS::DocDB::DBCluster
    Properties:
      BackupRetentionPeriod: 8
      DBClusterIdentifier: ""sample-cluster""
      DBClusterParameterGroupName: ""default.docdb3.6""
      DBSubnetGroupName: ""default""
      DeletionProtection: true
      KmsKeyId: ""your-kms-key-id""
      MasterUsername: ""your-master-username""
      MasterUserPassword: 'asDjskjs73!!'
      Port: 27017
      PreferredBackupWindow: ""07:34-08:04""
      PreferredMaintenanceWindow: ""sat:04:51-sat:05:21""
      SnapshotIdentifier: ""sample-cluster-snapshot-id""
      StorageEncrypted: true

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: 'asDjskjs73!'
Resources:
  NewAmpApp1:
    Type: AWS::DocDB::DBCluster
    Properties:
      BackupRetentionPeriod: 8
      DBClusterIdentifier: ""sample-cluster""
      DBClusterParameterGroupName: ""default.docdb3.6""
      DBSubnetGroupName: ""default""
      DeletionProtection: true
      KmsKeyId: ""your-kms-key-id""
      MasterUsername: ""your-master-username""
      MasterUserPassword: !Ref ParentMasterPassword
      Port: 27017
      PreferredBackupWindow: ""07:34-08:04""
      PreferredMaintenanceWindow: ""sat:04:51-sat:05:21""
      SnapshotIdentifier: ""sample-cluster-snapshot-id""
      StorageEncrypted: true

Resources:
  NewAmpApp03:
    Type:  AWS::DocDB::DBCluster
    Properties:
      BackupRetentionPeriod: 8
      DBClusterIdentifier: ""sample-cluster""
      DBClusterParameterGroupName: ""default.docdb3.6""
      DBSubnetGroupName: ""default""
      DeletionProtection: true
      KmsKeyId: ""your-kms-key-id""
      MasterUsername: ""your-master-username""
      MasterUserPassword: 'asDjskjs73!!'
      Port: 27017
      PreferredBackupWindow: ""07:34-08:04""
      PreferredMaintenanceWindow: ""sat:04:51-sat:05:21""
      SnapshotIdentifier: ""sample-cluster-snapshot-id""
      StorageEncrypted: true","[[12], [5], [12]]"
332,3ae83918-7ec7-4cb8-80db-b91ef0f94002,Security Group Unrestricted Access To RDP,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_unrestricted_access_to_rdp,Unknown,"Security Groups does not allow 0.0.0.0/0 for rdp (port:3389)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/33","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3389
          ToPort: 3389
          CidrIp: 0.0.0.0/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0",[[15]]
333,3b02569b-fc6f-4153-b3a3-ba91022fed68,ElastiCache With Disabled Transit Encryption,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticache_with_disabled_transit_encryption,Unknown,"Ensure AWS ElastiCache Redis clusters have encryption for data at transit enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html)","Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: true
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: true
    UpdatePolicy:
      UseOnlineResharding: true

Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: ""true""
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, ""true"", ""false""]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: ""true""
    UpdatePolicy:
      UseOnlineResharding: ""true""","Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: true
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
    UpdatePolicy:
      UseOnlineResharding: true

Resources:
  MyReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      AtRestEncryptionEnabled: true
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: false
    UpdatePolicy:
      UseOnlineResharding: true","[[6], [26]]"
334,3b316b05-564c-44a7-9c3f-405bb95e211e,Redshift Not Encrypted,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/redshift_not_encrypted,Unknown,"AWS Redshift Cluster should be encrypted. Check if 'Encrypted' field is false or undefined (default is false)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html)","AWSTemplateFormatVersion: 2010-09-11
Description: Redshift Stack2
Resources:
  RedshiftCluster2:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
      Encrypted: true
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}

AWSTemplateFormatVersion: 2010-09-11
Description: Redshift Stack2
Resources:
  RedshiftCluster2:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: ""true""
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
      Encrypted: ""true""
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}","AWSTemplateFormatVersion: 2010-09-09
Description: Redshift Stack
Resources:
  RedshiftCluster:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}

AWSTemplateFormatVersion: 2010-09-11
Description: Redshift Stack2
Resources:
  RedshiftCluster2:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
      Encrypted: false
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}","[[6], [21]]"
335,3b3b4411-ad1f-40e7-b257-a78a6bb9673a,VPC Without Attached Subnet,CloudFormation,Low,Resource Management,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/vpc_without_attached_subnet,Unknown,"VPCs without attached subnets may indicate that they are not being used<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC_2:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated
    mySubnet:
      Type: AWS::EC2::Subnet
      Properties:
        VpcId:
            Ref: myVPC_2
        CidrBlock: 10.0.0.0/24
        AvailabilityZone: ""us-east-1a""","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC_1:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated",[[3]]
336,3c3b7a58-b018-4d07-9444-d9ee7156e111,Alexa Skill Plaintext Client Secret Exposed,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/alexa_skill_plaintext_client_secret_exposed,Unknown,"Alexa skills' client secrets should not be defined as a plaintext string. It should either use 'AWS Systems Manager Parameter Store' or 'AWS Secrets Manager' to retrieve sensitive information<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ask-skill.html#cfn-ask-skill-authenticationconfiguration)","Resources:
  MySkill:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""{{resolve:secretsmanager:123456}}""
        RefreshToken: ""Atzr|1234""
      VendorId: ""1234""
  MySkill2:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""{{resolve:ssm-secure:123456}}""
        RefreshToken: ""Atzr|1234""
      VendorId: ""1234""
      # trigger validation","Resources:
  MySkill:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: arn:aws:lambda:us-east-1:377024778620:function:aws-node-alexa-skill
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""1234""
        RefreshToken: ""Atzr|1234""
      VendorId: ""1234""",[[17]]
337,3de2d4ff-fe53-4fc9-95d3-2f8a69bf90d6,Redshift Cluster Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/redshift_cluster_logging_disabled,Unknown,"Make sure Logging is enabled for Redshift Cluster<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html#cfn-redshift-cluster-loggingproperties)","AWSTemplateFormatVersion: 2010-09-09
Description: Redshift Stack
Resources:
  RedshiftCluster:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
      KmsKeyId: wewewewewefsa
      LoggingProperties:
        BucketName: ""Some bucket name""","AWSTemplateFormatVersion: 2010-09-09
Description: Redshift Stack
Resources:
  RedshiftCluster3:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45",[[6]]
338,3e09413f-471e-40f3-8626-990c79ae63f3,CloudTrail SNS Topic Name Undefined,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_sns_topic_name_undefined,Unknown,"Check if SNS topic name is set for CloudTrail<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-snstopicname)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: true
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail3:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      IsLogging: false
      IsMultiRegionTrail: true
  myTrail4:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: false
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName: """"
      IsLogging: false
      IsMultiRegionTrail: true","[[12, 22]]"
339,3e293410-d5b8-411f-85fd-7d26294f20c9,VPC Without Network Firewall,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/vpc_without_network_firewall,Unknown,"VPC should have a Network Firewall associated<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-networkfirewall-firewall.html#cfn-networkfirewall-firewall-vpcid)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC1:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated
    SampleFirewall:
      Type: AWS::NetworkFirewall::Firewall
      Properties:
        FirewallName: SampleFirewallName
        FirewallPolicyArn: !Ref SampleFirewallPolicy
        VpcId: !Ref myVPC1
        SubnetMappings:
          - SubnetId: !Ref SampleSubnet1
          - SubnetId: !Ref SampleSubnet2
        Description: Firewall description goes here","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC11:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated
    SampleFirewall:
      Type: AWS::NetworkFirewall::Firewall
      Properties:
        FirewallName: SampleFirewallName
        FirewallPolicyArn: !Ref SampleFirewallPolicy
        VpcId: !Ref myVPC
        SubnetMappings:
          - SubnetId: !Ref SampleSubnet1
          - SubnetId: !Ref SampleSubnet2
        Description: Firewall description goes here",[[3]]
340,42e7dca3-8cce-4325-8df0-108888259136,BOM - AWS SNS,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/sns,Unknown,"A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: '2010-09-09'
Description: ''
Resources:
  SnsTopic:
    Type: 'AWS::SNS::Topic'
    Properties:
      Subscription:
        - Endpoint: email@example.com
          Protocol: email
      TopicName: alarm-action
      KmsMasterKeyId: ididididid
  StartedTopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - !Ref SnsTopic
      PolicyDocument:
        Statement:
          - Effect: Allow
            Principal:
              Service: events.amazonaws.com
            Action:
              - sns:Publish
            Resource: ""*""",[[4]]
341,43356255-495d-4148-ad8d-f6af5eac09dd,GameLift Fleet EC2 InboundPermissions With Port Range,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/gamelift_fleet_ec2_inbound_permissions_with_port_range,Unknown,"AWS GameLift Fleet EC2InboundPermissions should have a single port<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-gamelift-fleet.html)","Resources:
  FleetResource2:
    Type: AWS::GameLift::Fleet
    Properties:
      BuildId: !Ref BuildResource
      CertificateConfiguration:
        CertificateType: DISABLED
      Description: Description of my Game Fleet
      DesiredEc2Instances: 1
      EC2InboundPermissions:
        - FromPort: '1234'
          ToPort: '1234'
          IpRange: 0.0.0.0/24
          Protocol: TCP
        - FromPort: '1356'
          ToPort: '1356'
          IpRange: 192.168.0.0/24
          Protocol: UDP","Resources:
  FleetResource1:
    Type: AWS::GameLift::Fleet
    Properties:
      BuildId: !Ref BuildResource
      CertificateConfiguration:
        CertificateType: DISABLED
      Description: Description of my Game Fleet1
      DesiredEc2Instances: 1
      EC2InboundPermissions:
        - FromPort: '1234'
          ToPort: '134'
          IpRange: 0.0.0.0/24
          Protocol: TCP
        - FromPort: 1356
          ToPort: 1578
          IpRange: 192.168.0.0/24
          Protocol: UDP
  FleetResource3:
    Type: AWS::GameLift::Fleet
    Properties:
      BuildId: !Ref BuildResource
      CertificateConfiguration:
        CertificateType: DISABLED
      Description: Description of my Game Fleet3
      DesiredEc2Instances: 1
      EC2InboundPermissions:
        - FromPort: 1234
          ToPort: '134'
          IpRange: 0.0.0.0/24
          Protocol: TCP
        - FromPort: '1356'
          ToPort: 1578
          IpRange: 192.168.0.0/24
          Protocol: UDP","[[10, 27]]"
342,44034eda-1c3f-486a-831d-e09a7dd94354,SageMaker EndPoint Config Should Specify KmsKeyId Attribute,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sagemaker_endpoint_config_should_specify_kms_key_id_attribute,Unknown,"KmsKeyId attribute should be defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-endpointconfig.html)","Description: ""Basic Hosting entities test.  We need models to create endpoint configs.""
Mappings:
  RegionMap:
    ""us-west-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-west-2.amazonaws.com/mymodel:latest""
    ""us-east-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-east-2.amazonaws.com/mymodel:latest""
    ""us-east-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-east-1.amazonaws.com/mymodel:latest""
    ""eu-west-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.eu-west-1.amazonaws.com/mymodel:latest""
    ""ap-northeast-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-northeast-1.amazonaws.com/mymodel:latest""
    ""ap-northeast-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/mymodel:latest""
    ""ap-southeast-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-southeast-2.amazonaws.com/mymodel:latest""
    ""eu-central-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.eu-central-1.amazonaws.com/mymodel:latest""
Resources:
  Endpoint:
    Type: ""AWS::SageMaker::Endpoint""
    Properties:
      EndpointConfigName:
        !GetAtt EndpointConfig.EndpointConfigName
  EndpointConfig:
    Type: ""AWS::SageMaker::EndpointConfig""
    Properties:
      DataCaptureConfig: DataCaptureConfig
      EndpointConfigName: String
      KmsKeyId: String
      ProductionVariants:
        - InitialInstanceCount: 1
          InitialVariantWeight: 1.0
          InstanceType: ml.t2.large
          ModelName: !GetAtt Model.ModelName
          VariantName: !GetAtt Model.ModelName
  Model:
    Type: ""AWS::SageMaker::Model""
    Properties:
      PrimaryContainer:
        Image: !FindInMap [RegionMap, !Ref ""AWS::Region"", ""NullTransformer""]
      ExecutionRoleArn: !GetAtt ExecutionRole.Arn

  ExecutionRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              Service:
                - ""sagemaker.amazonaws.com""
            Action:
              - ""sts:AssumeRole""
      Path: ""/""
      Policies:
        -
          PolicyName: ""root""
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              -
                Effect: ""Allow""
                Action: ""*""
                Resource: ""*""
Outputs:
  EndpointId:
    Value: !Ref Endpoint
  EndpointName:
    Value: !GetAtt Endpoint.EndpointName","Description: ""Basic Hosting entities test.  We need models to create endpoint configs.""
Mappings:
  RegionMap:
    ""us-west-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-west-2.amazonaws.com/mymodel:latest""
    ""us-east-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-east-2.amazonaws.com/mymodel:latest""
    ""us-east-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.us-east-1.amazonaws.com/mymodel:latest""
    ""eu-west-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.eu-west-1.amazonaws.com/mymodel:latest""
    ""ap-northeast-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-northeast-1.amazonaws.com/mymodel:latest""
    ""ap-northeast-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/mymodel:latest""
    ""ap-southeast-2"":
      ""NullTransformer"": ""123456789012.dkr.ecr.ap-southeast-2.amazonaws.com/mymodel:latest""
    ""eu-central-1"":
      ""NullTransformer"": ""123456789012.dkr.ecr.eu-central-1.amazonaws.com/mymodel:latest""
Resources:
  Endpoint:
    Type: ""AWS::SageMaker::Endpoint""
    Properties:
      EndpointConfigName:
        !GetAtt EndpointConfig.EndpointConfigName
  EndpointConfig:
    Type: ""AWS::SageMaker::EndpointConfig""
    Properties:
      ProductionVariants:
        - InitialInstanceCount: 1
          InitialVariantWeight: 1.0
          InstanceType: ml.t2.large
          ModelName: !GetAtt Model.ModelName
          VariantName: !GetAtt Model.ModelName
  Model:
    Type: ""AWS::SageMaker::Model""
    Properties:
      PrimaryContainer:
        Image: !FindInMap [RegionMap, !Ref ""AWS::Region"", ""NullTransformer""]
      ExecutionRoleArn: !GetAtt ExecutionRole.Arn

  ExecutionRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              Service:
                - ""sagemaker.amazonaws.com""
            Action:
              - ""sts:AssumeRole""
      Path: ""/""
      Policies:
        -
          PolicyName: ""root""
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              -
                Effect: ""Allow""
                Action: ""*""
                Resource: ""*""
Outputs:
  EndpointId:
    Value: !Ref Endpoint
  EndpointName:
    Value: !GetAtt Endpoint.EndpointName",[[28]]
343,4552b71f-0a2a-4bc4-92dd-ed7ec1b4674c,S3 Bucket Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_logging_disabled,Unknown,"Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html#cfn-s3-bucket-loggingconfig)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  RecordServiceS3Bucket:
    Type: ""AWS::S3::Bucket""
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          ""Fn::GetAtt"":
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - ""Fn::Join"":
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: """"
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled
      LoggingConfiguration:
        DestinationBucketName: !Ref LoggingBucket
        LogFilePrefix: loga/
  WorkItemBucketBackupRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action:
              - ""sts:AssumeRole""
            Effect: Allow
            Principal:
              Service:
                - s3.amazonaws.com
  BucketBackupPolicy:
    Type: ""AWS::IAM::Policy""
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ""s3:GetReplicationConfiguration""
              - ""s3:ListBucket""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - Ref: RecordServiceS3Bucket
          - Action:
              - ""s3:GetObjectVersion""
              - ""s3:GetObjectVersionAcl""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - Ref: RecordServiceS3Bucket
                    - /*
          - Action:
              - ""s3:ReplicateObject""
              - ""s3:ReplicateDelete""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - ""Fn::Join"":
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
                    - /*
      PolicyName: BucketBackupPolicy
      Roles:
        - Ref: WorkItemBucketBackupRole","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mybucket:
    Type: ""AWS::S3::Bucket""
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          ""Fn::GetAtt"":
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - ""Fn::Join"":
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: """"
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled
  WorkItemBucketBackupRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action:
              - ""sts:AssumeRole""
            Effect: Allow
            Principal:
              Service:
                - s3.amazonaws.com
  BucketBackupPolicy:
    Type: ""AWS::IAM::Policy""
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - ""s3:GetReplicationConfiguration""
              - ""s3:ListBucket""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - Ref: RecordServiceS3Bucket
          - Action:
              - ""s3:GetObjectVersion""
              - ""s3:GetObjectVersionAcl""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - Ref: RecordServiceS3Bucket
                    - /*
          - Action:
              - ""s3:ReplicateObject""
              - ""s3:ReplicateDelete""
            Effect: Allow
            Resource:
              - ""Fn::Join"":
                  - """"
                  - - ""arn:aws:s3:::""
                    - ""Fn::Join"":
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
                    - /*
      PolicyName: BucketBackupPolicy
      Roles:
        - Ref: WorkItemBucketBackupRole",[[7]]
344,456b00a3-1072-4149-9740-6b8bb60251b0,S3 Bucket Allows Restore Actions From All Principals,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_restore_actions_from_all_principals,Unknown,"S3 Buckets must not allow Restore Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Restore, for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:RestoreObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""RestoreObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  SampleBucketPolicy4:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - ""RestoreObject""
              - ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","[[22, 7]]"
345,48677914-6fdf-40ec-80c4-2b0e94079f54,IAM User Has Too Many Access Keys,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_user_too_many_access_keys,Unknown,"Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-accesskey.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
    firstKey:
      Type: AWS::IAM::AccessKey
      Properties:
        UserName:
          Ref: myuser","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
    firstKey:
      Type: AWS::IAM::AccessKey
      Properties:
        UserName: !Ref myuser
    secondKey:
      Type: AWS::IAM::AccessKey
      Properties:
        UserName: !Ref myuser","[[10, 14]]"
346,48af92a5-c89b-4936-bc62-1086fe2bab23,EMR Cluster Without Security Configuration,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/emr_cluster_without_security_configuration,Unknown,"EMR Cluster should have security configuration defined.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticmapreduce-cluster.html#cfn-elasticmapreduce-cluster-securityconfiguration)","AWSTemplateFormatVersion: 2010-09-09
Parameters:
  CrossRealmTrustPrincipalPassword:
    Type: String
  KdcAdminPassword:
    Type: String
  Realm:
    Type: String
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
Resources:
  cluster:
    Type: 'AWS::EMR::Cluster'
    Properties:
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnMaster
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnCore
        Ec2SubnetId: !Ref SubnetId
      Name: CFNtest2
      JobFlowRole: !Ref emrEc2InstanceProfile
      KerberosAttributes:
        CrossRealmTrustPrincipalPassword: CfnIntegrationTest-1
        KdcAdminPassword: CfnIntegrationTest-1
        Realm: EC2.INTERNAL
      ServiceRole: !Ref emrRole
      ReleaseLabel: !Ref ReleaseLabel
      SecurityConfiguration: !Ref securityConfiguration
      VisibleToAllUsers: true
      Tags:
        - Key: key1
          Value: value1
  key:
    Type: 'AWS::KMS::Key'
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !GetAtt
                - emrEc2Role
                - Arn
            Action: 'kms:*'
            Resource: '*'
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - ''
                - - 'arn:aws:iam::'
                  - !Ref 'AWS::AccountId'
                  - ':root'
            Action: 'kms:*'
            Resource: '*'
  securityConfiguration:
    Type: 'AWS::EMR::SecurityConfiguration'
    Properties:
      SecurityConfiguration:
        AuthenticationConfiguration:
          KerberosConfiguration:
            Provider: ClusterDedicatedKdc
            ClusterDedicatedKdcConfiguration:
              TicketLifetimeInHours: 24
              CrossRealmTrustConfiguration:
                Realm: AD.DOMAIN.COM
                Domain: ad.domain.com
                AdminServer: ad.domain.com
                KdcServer: ad.domain.com
  emrRole:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: elasticmapreduce.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole'
  emrEc2Role:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ec2.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceforEC2Role'
  emrEc2InstanceProfile:
    Type: 'AWS::IAM::InstanceProfile'
    Properties:
      Path: /
      Roles:
        - !Ref emrEc2Role
Outputs:
  keyArn:
    Value: !GetAtt
      - key
      - Arn","AWSTemplateFormatVersion: 2010-09-09
Parameters:
  CrossRealmTrustPrincipalPassword:
    Type: String
  KdcAdminPassword:
    Type: String
  Realm:
    Type: String
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
Resources:
  cluster:
    Type: 'AWS::EMR::Cluster'
    Properties:
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnMaster
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnCore
        Ec2SubnetId: !Ref SubnetId
      Name: CFNtest2
      JobFlowRole: !Ref emrEc2InstanceProfile
      KerberosAttributes:
        CrossRealmTrustPrincipalPassword: CfnIntegrationTest-1
        KdcAdminPassword: CfnIntegrationTest-1
        Realm: EC2.INTERNAL
      ServiceRole: !Ref emrRole
      ReleaseLabel: !Ref ReleaseLabel
      SecurityConfiguration: !Ref securityConfiguration1
      VisibleToAllUsers: true
      Tags:
        - Key: key1
          Value: value1
  key:
    Type: 'AWS::KMS::Key'
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !GetAtt
                - emrEc2Role
                - Arn
            Action: 'kms:*'
            Resource: '*'
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - ''
                - - 'arn:aws:iam::'
                  - !Ref 'AWS::AccountId'
                  - ':root'
            Action: 'kms:*'
            Resource: '*'
  securityConfiguration:
    Type: 'AWS::EMR::SecurityConfiguration'
    Properties:
      SecurityConfiguration:
        AuthenticationConfiguration:
          KerberosConfiguration:
            Provider: ClusterDedicatedKdc
            ClusterDedicatedKdcConfiguration:
              TicketLifetimeInHours: 24
              CrossRealmTrustConfiguration:
                Realm: AD.DOMAIN.COM
                Domain: ad.domain.com
                AdminServer: ad.domain.com
                KdcServer: ad.domain.com
  emrRole:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: elasticmapreduce.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole'
  emrEc2Role:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ec2.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceforEC2Role'
  emrEc2InstanceProfile:
    Type: 'AWS::IAM::InstanceProfile'
    Properties:
      Path: /
      Roles:
        - !Ref emrEc2Role
Outputs:
  keyArn:
    Value: !GetAtt
      - key
      - Arn

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  CrossRealmTrustPrincipalPassword:
    Type: String
  KdcAdminPassword:
    Type: String
  Realm:
    Type: String
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
Resources:
  cluster1:
    Type: 'AWS::EMR::Cluster'
    Properties:
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnMaster
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnCore
        Ec2SubnetId: !Ref SubnetId
      Name: CFNtest2
      JobFlowRole: !Ref emrEc2InstanceProfile
      KerberosAttributes:
        CrossRealmTrustPrincipalPassword: CfnIntegrationTest-1
        KdcAdminPassword: CfnIntegrationTest-1
        Realm: EC2.INTERNAL
      ServiceRole: !Ref emrRole
      ReleaseLabel: !Ref ReleaseLabel
      VisibleToAllUsers: true
      Tags:
        - Key: key1
          Value: value1
  key:
    Type: 'AWS::KMS::Key'
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !GetAtt
                - emrEc2Role
                - Arn
            Action: 'kms:*'
            Resource: '*'
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - ''
                - - 'arn:aws:iam::'
                  - !Ref 'AWS::AccountId'
                  - ':root'
            Action: 'kms:*'
            Resource: '*'
  emrRole1:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: elasticmapreduce.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole'
  emrEc2Role1:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ec2.amazonaws.com
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceforEC2Role'
  emrEc2InstanceProfile1:
    Type: 'AWS::IAM::InstanceProfile'
    Properties:
      Path: /
      Roles:
        - !Ref emrEc2Role
Outputs:
  keyArn:
    Value: !GetAtt
      - key
      - Arn","[[18], [18]]"
347,48f100d9-f499-4c6d-b2b8-deafe47ffb26,S3 Bucket Allows Public ACL,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_public_acl,Unknown,"S3 bucket allows public ACL<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html)","Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : true
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true

Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : ""true""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""","Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true

Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: ""false""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""","[[10, 4, 20], [10, 4, 20]]"
348,493d9591-6249-47bf-8dc0-5c10161cc558,Security Groups Without VPC Attached,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_without_vpc_attached,Unknown,"Security Groups must have a VPC.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupName: My Group Name
      GroupDescription: Enable SSH access via port 22
      VpcId:
        Ref: myVPC
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupName: My Group Name
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0",[[16]]
349,494b03d3-bf40-4464-8524-7c56ad0700ed,EC2 Sensitive Port Is Publicly Exposed,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_sensitive_port_is_publicly_exposed,Unknown,"The EC2 instance has a sensitive port connection exposed to the entire network<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","AWSTemplateFormatVersion: 2010-09-09T00:00:00Z
Resources:
  SafeSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/32
      GroupDescription: Allow http and ssh
      VpcId: my-vpc
      SecurityGroupIngress:
        - FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
          IpProtocol: tcp
        - ToPort: 77
          CidrIp: 127.0.0.1/32
          IpProtocol: all
          FromPort: 77
  MyNegativeEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      SecurityGroups:
        - SafeSecGroup
      KeyName: my-new-rsa-key
      ImageId: ami-79fd7eee
      InstanceType: t3.medium","AWSTemplateFormatVersion: 2010-09-09T00:00:00Z
Resources:
  UnsafeSecGroup01:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http and redis
      VpcId: my-vpc
      SecurityGroupIngress:
        - FromPort: 8080
          ToPort: 8080
          CidrIp: 127.0.0.1/32
          IpProtocol: tcp
        - IpProtocol: tcp
          FromPort: 6379
          ToPort: 6379
          CidrIp: 10.0.0.1/0
      SecurityGroupEgress:
        - FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
          IpProtocol: tcp
  EC2Instance01:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-79fd7eee
      InstanceType: t3.medium
      SecurityGroups:
        - UnsafeSecGroup01
      KeyName: my-new-rsa-key

AWSTemplateFormatVersion: 2010-09-09T00:00:00Z
Resources:
  UnsafeSecGroup02:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http and mysql
      VpcId: my-vpc
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        - ToPort: 1434
          CidrIp: 10.0.0.1/0
          IpProtocol: tcp
          FromPort: 1433
        - IpProtocol: tcp
          FromPort: 150
          ToPort: 180
          CidrIp: 10.0.0.1/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  EC2Instance02:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.medium
      SecurityGroups:
        - UnsafeSecGroup02
      KeyName: my-new-rsa-key
      ImageId: ami-79fd7eee

AWSTemplateFormatVersion: 2010-09-09T00:00:00Z
Resources:
  UnsafeSecGroup03:
    Type: AWS::EC2::SecurityGroup
    Properties:
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
      GroupDescription: Allow http and hadoop
      VpcId: my-vpc
      SecurityGroupIngress:
        - ToPort: 80
          CidrIp: 0.0.0.0/0
          IpProtocol: tcp
          FromPort: 80
        - ToPort: 9000
          CidrIp: 10.0.0.1/0
          IpProtocol: tcp
          FromPort: 9000
  EC2Instance03:
    Type: AWS::EC2::Instance
    Properties:
      SecurityGroups:
        - UnsafeSecGroup03
      KeyName: my-new-rsa-key
      ImageId: ami-79fd7eee
      InstanceType: t3.medium","[[8], [8], [13]]"
350,4a1e6b34-1008-4e61-a5f2-1f7c276f8d14,Unrestricted Security Group Ingress,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/unrestricted_security_group_ingress,Unknown,"AWS Security Group Ingress CIDR should not be open to the world<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIp: 192.0.2.0/24
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIpv6: 2001:0DB8:1234::/48
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIp: 0.0.0.0/0
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIpv6: ::/0
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[43, 13]]"
351,4a8daf95-709d-4a36-9132-d3e19878fa34,API Gateway Endpoint Config is Not Private,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_endpoint_config_is_not_private,Unknown,"The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-apigateway-restapi-endpointconfiguration.html#cfn-apigateway-restapi-endpointconfiguration-types)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyRestApi:
        Type: AWS::ApiGateway::RestApi
        Properties:
          EndpointConfiguration:
            Types:
              - PRIVATE
          Name: myRestApi","AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyRestApi:
        Type: AWS::ApiGateway::RestApi
        Properties:
          Name: myRestApi
    MyRestApi2:
        Type: AWS::ApiGateway::RestApi
        Properties:
          EndpointConfiguration:
            Types:
              - EDGE
          Name: myRestApi2","[[11, 5]]"
352,4ab10c48-bedb-4deb-8f3b-ff12783b61de,API Gateway X-Ray Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_xray_disabled,Unknown,"API Gateway should have X-Ray Tracing enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-stage.html#cfn-apigateway-stage-tracingenabled)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdNeg1:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: true
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdPos3:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: false
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdPos4:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'","[[13], [6]]"
353,4ae8af91-5108-42cb-9471-3bdbe596eac9,S3 Bucket With All Permissions,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_with_all_permissions,Unknown,"S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""*""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'",[[7]]
354,4ba74f01-aba5-4be2-83bc-be79ff1a3b92,Serverless Function Without Unique IAM Role,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_function_without_unique_iam_role,Unknown,"AWS Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-role)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function3:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: arn:aws:iam::123456789012:role/lambda-role

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: !Ref Role2
  Function2:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: !Ref Role4","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: arn:aws:iam::123456789012:role/lambda-role
  Function2:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: arn:aws:iam::123456789012:role/lambda-role

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: !Ref Role
  Function2:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Role: !Ref Role","[[34, 19], [34, 19]]"
355,4bd21e68-38c1-4d58-acdc-6a14b203237f,DynamoDB Table Not Encrypted,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dynamodb_table_not_encrypted,Unknown,"AWS DynamoDB Tables should have server-side encryption<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dynamodb-table-ssespecification.html)","Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: my-table
      AttributeDefinitions:
        - AttributeName: id
          AttributeType: N
        - AttributeName: name
          AttributeType: S
      KeySchema:
        - AttributeName: id
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5
      SSESpecification:
        SSEEnabled: true","Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: my-table
      AttributeDefinitions:
        - AttributeName: id
          AttributeType: N
        - AttributeName: name
          AttributeType: S
      KeySchema:
        - AttributeName: id
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5
      SSESpecification:
        SSEEnabled: false

Resources:
  MyDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: my-table
      AttributeDefinitions:
        - AttributeName: id
          AttributeType: N
        - AttributeName: name
          AttributeType: S
      KeySchema:
        - AttributeName: id
          KeyType: HASH
      ProvisionedThroughput:
        ReadCapacityUnits: 5
        WriteCapacityUnits: 5
      SSESpecification:
        SSEType: KMS

AWSTemplateFormatVersion: 2010-09-09
Resources:
  OrdersTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: AuthorsTable_prod
      SSESpecification:
        SSEEnabled: ""false""
      AttributeDefinitions:
        - AttributeName: ""AuthorName""
          AttributeType: ""S""
        - AttributeName: ""BookTitle""
          AttributeType: ""S""
      KeySchema:
        - AttributeName: ""AuthorName""
          KeyType: ""HASH""
        - AttributeName: ""BookTitle""
          KeyType: ""RANGE""
      TimeToLiveSpecification:
        AttributeName: ""ExpirationTime""
        Enabled: true
      ProvisionedThroughput:
        ReadCapacityUnits: ""10""
        WriteCapacityUnits: ""5""
    DependsOn:
      - DynamoDBQueryPolicy

  DynamoDBQueryPolicy:
    Type: ""AWS::IAM::Policy""
    Properties:
      PolicyName: DynamoDBQueryPolicy
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Effect: ""Allow""
            Action: ""dynamodb:Query""
            Resource: ""*""
      Roles:
        - Ref: ""OrdersTableQueryRole""

  OrdersTableQueryRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Effect: ""Allow""
            Principal:
              Service:
                - ""dynamodb.amazonaws.com""
            Action:
              - ""sts:AssumeRole""
      Path: ""/""","[[18], [17], [8]]"
356,4c137350-7307-4803-8c04-17c09a7a9fcf,Root Account Has Active Access Keys,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/root_account_has_active_access_keys,Unknown,"The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-accesskey.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CFNKeys:
    Type: AWS::IAM::AccessKey
    Properties:
      UserName: MyUser","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CFNKeys:
    Type: AWS::IAM::AccessKey
    Properties:
      UserName: Root",[[6]]
357,4cdc88e6-c0c8-4081-a639-bb3a557cbedf,Elasticsearch with HTTPS disabled,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_with_https_disabled,Unknown,"Amazon Elasticsearch does not have encryption for its domains enabled. To prevent such a scenario, update the attribute 'EnforceHTTPS' to true.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticsearch-domain-domainendpointoptions.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: description
Resources:
  OpenSearchDomain:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: my-opensearch-domain
      ElasticsearchVersion: ""7.9""
      ElasticsearchClusterConfig:
        InstanceType: m5.large.search
        InstanceCount: 1
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""
      DomainEndpointOptions:
        EnforceHTTPS: true
        TLSSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""

AWSTemplateFormatVersion: ""2010-09-09""
Description: description
Resources:
  OpenSearchDomain:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: my-opensearch-domain
      ElasticsearchVersion: ""7.9""
      ElasticsearchClusterConfig:
        InstanceType: m5.large.search
        InstanceCount: 1
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""
      DomainEndpointOptions:
        EnforceHTTPS: ""true""
        TLSSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""","AWSTemplateFormatVersion: ""2010-09-09""
Description: description
Resources:
  OpenSearchDomain:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: my-opensearch-domain
      ElasticsearchVersion: ""7.9""
      ElasticsearchClusterConfig:
        InstanceType: m5.large.search
        InstanceCount: 1
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""
      DomainEndpointOptions:
        EnforceHTTPS: false
        TLSSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""

AWSTemplateFormatVersion: ""2010-09-09""
Description: description
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: my-elasticsearch-domain
      ElasticsearchVersion: ""7.9""
      ElasticsearchClusterConfig:
        InstanceType: m5.large.elasticsearch
        InstanceCount: 1
      EBSOptions:
        EBSEnabled: true
        VolumeType: gp2
        VolumeSize: 10
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Allow
            Principal:
              AWS: ""*""
            Action: es:*
            Resource: arn:aws:es:REGION:ACCOUNT_ID:domain/my-elasticsearch-domain/*
      DomainEndpointOptions:
        TLSSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""

AWSTemplateFormatVersion: ""2010-09-09""
Description: description
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: my-elasticsearch-domain
      ElasticsearchVersion: ""7.9""
      ElasticsearchClusterConfig:
        InstanceType: m5.large.elasticsearch
        InstanceCount: 1
      EBSOptions:
        EBSEnabled: true
        VolumeType: gp2
        VolumeSize: 10
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Allow
            Principal:
              AWS: ""*""
            Action: es:*
            Resource: arn:aws:es:REGION:ACCOUNT_ID:domain/my-elasticsearch-domain/*","[[15], [24], [6]]"
358,4d32780f-43a4-424a-a06d-943c543576a5,IoT Policy Allows Action as Wildcard,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iot_policy_allows_action_as_wildcard,Unknown,"IoT Policy should not allow Action to be set as *<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iot-policy.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    IoTPolicy:
      Type: AWS::IoT::Policy
      Properties:
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - iot:Connect
            Resource:
            - arn:aws:iot:us-east-1:123456789012:client/client1
        PolicyName: PolicyName","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    IoTPolicy:
      Type: AWS::IoT::Policy
      Properties:
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action: ""*""
            Resource:
            - arn:aws:iot:us-east-1:123456789012:client/client
          - Effect: Deny
            Action:
            - sqs:*
            NotResource: my-hardcoded-arn
        PolicyName: PolicyName",[[7]]
359,4e67c0ae-38a0-47f4-a50c-f0c9b75826df,BOM - AWS DynamoDB,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/dynamo,Unknown,"A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  DynamoDBEndpoint:
    Type: ""AWS::EC2::VPCEndpoint""
    Properties:
      RouteTableIds:
        - !Ref PublicRouteTable
        - !Ref Private0RouteTable
        - !Ref Private1RouteTable
        - !Ref Private2RouteTable
      ServiceName:
        !Sub ""com.amazonaws.${AWS::Region}.dynamodb""
      VpcId: !Ref VPC
      PolicyDocument: {
        ""Id"": ""Policy"",
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Sid"": ""Statement"",
            ""Action"": ""dynamodb:*"",
            ""Effect"": ""Allow"",
            ""Resource"": ""arn:aws:dynamodb:ap-southeast-2:123412341234:table/test"",
            ""Principal"": ""*""
          }
        ]
      }
  DynamoDBOnDemandTable2:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: test
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: false
        SSEType: ""KMS""

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  DynamoDBEndpoint:
    Type: ""AWS::EC2::VPCEndpoint""
    Properties:
      RouteTableIds:
        - !Ref PublicRouteTable
        - !Ref Private0RouteTable
        - !Ref Private1RouteTable
        - !Ref Private2RouteTable
      ServiceName:
        !Sub ""com.amazonaws.${AWS::Region}.dynamodb""
      VpcId: !Ref VPC
      PolicyDocument: {
        ""Id"": ""Policy"",
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Sid"": ""Statement"",
            ""Action"": ""dynamodb:*"",
            ""Effect"": ""Allow"",
            ""Resource"": ""*"",
            ""Principal"": ""*""
          }
        ]
      }
  DynamoDBOnDemandTable2:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: test2
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: false
        SSEType: ""KMS""

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  DynamoDBEndpoint:
    Type: ""AWS::EC2::VPCEndpoint""
    Properties:
      RouteTableIds:
        - !Ref PublicRouteTable
        - !Ref Private0RouteTable
        - !Ref Private1RouteTable
        - !Ref Private2RouteTable
      ServiceName:
        !Sub ""com.amazonaws.${AWS::Region}.dynamodb""
      VpcId: !Ref VPC
      PolicyDocument: {
        ""Id"": ""Policy"",
        ""Version"": ""2012-10-17"",
        ""Statement"": [
          {
            ""Sid"": ""Statement"",
            ""Action"": ""dynamodb:*"",
            ""Effect"": ""Allow"",
            ""Resource"": ""arn:aws:dynamodb:ap-southeast-2:123412341234:table/other"",
            ""Principal"": ""*""
          }
        ]
      }
  DynamoDBOnDemandTable2:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: test3
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: false
        SSEType: ""KMS""","[[27], [27], [27]]"
360,4e88adee-a8eb-4605-a78d-9fb1096e3091,RDS Associated with Public Subnet,CloudFormation,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_associated_with_public_subnet,Unknown,"RDS should not run in public subnet<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-dbsubnetgroupname)","Resources:
 Negative1:
  Type: AWS::RDS::DBInstance
  Properties:
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    DBSubnetGroupName:
       Ref: myDBSubnetGroup0
  DeletionPolicy: Snapshot
 myDBSubnetGroup0: 
    Properties: 
      DBSubnetGroupDescription: description
      SubnetIds: 
        - Ref: mySubnet10
      Tags: 
        - 
          Key: String
          Value: String
    Type: ""AWS::RDS::DBSubnetGroup""
 mySubnet10:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId:
        Ref: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: stack
        Value: production","Resources:
 Positive1:
  Type: AWS::RDS::DBInstance
  Properties:
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
    DBSubnetGroupName:
       Ref: myDBSubnetGroup
  DeletionPolicy: Snapshot
 myDBSubnetGroup: 
    Properties: 
      DBSubnetGroupDescription: description
      SubnetIds: 
        - Ref: mySubnet1
        - Ref: mySubnet2
      Tags: 
        - 
          Key: String
          Value: String
    Type: ""AWS::RDS::DBSubnetGroup""
 mySubnet1:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId:
        Ref: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: stack
        Value: production
 mySubnet2:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId:
        Ref: myVPC
      CidrBlock: 0.0.0.0/0
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: stack
        Value: production",[[12]]
361,4f0908b9-eb66-433f-9145-134274e1e944,RouterTable with Default Routing,CloudFormation,Low,Insecure Defaults,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/routertable_with_default_routing,Unknown,"NAT gateways are recommended, and not the default route which permits all traffic, in Route Tables.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-route-table.html)","Resources:
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.1.0.0/16
      EnableDnsSupport: true
      EnableDnsHostnames: true
      Tags:
          - Key: Name
            Value:  !Join ['', [!Ref ""AWS::StackName"", ""-VPC"" ]]
  InternetGateway:
    Type: AWS::EC2::InternetGateway
    DependsOn: VPC
  AttachGateway:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: !Ref VPC
      InternetGatewayId: !Ref InternetGateway
  PublicSubnetA:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId:
       Fn::FindInMap:
             - ""RegionMap""
             - Ref: ""AWS::Region""
             - ""AMI""
      KeyName:
       Ref: ""KeyName""
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
          DeviceIndex: ""0""
          SubnetId: !Ref PublicSubnetA
  PublicRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref VPC
      Tags:
      - Key: Name
        Value: Public
  PublicRoute1:
    Type: AWS::EC2::Route
    DependsOn: AttachGateway
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationCidrBlock: 172.16.0.0/24
      NatGatewayId: !Ref InternetGateway","Resources:
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.1.0.0/16
      EnableDnsSupport: true
      EnableDnsHostnames: true
      Tags:
          - Key: Name
            Value:  !Join ['', [!Ref ""AWS::StackName"", ""-VPC"" ]]
  InternetGateway:
    Type: AWS::EC2::InternetGateway
    DependsOn: VPC
  AttachGateway:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: !Ref VPC
      InternetGatewayId: !Ref InternetGateway
  PublicSubnetA:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId:
       Fn::FindInMap:
            - ""RegionMap""
            - Ref: ""AWS::Region""
            - ""AMI""
      KeyName:
       Ref: ""KeyName""
      NetworkInterfaces:
        -   AssociatePublicIpAddress: true
            DeviceIndex: ""0""
            SubnetId: !Ref PublicSubnetA
  PublicRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref VPC
      Tags:
      - Key: Name
        Value: Public
  PublicRoute1:
    Type: AWS::EC2::Route
    DependsOn: AttachGateway
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationCidrBlock: 0.0.0.0/0
      NatGatewayId: id
  PublicRoute2:
    Type: AWS::EC2::Route
    DependsOn: AttachGateway
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationIpv6CidrBlock: ::/0
      NatGatewayId: id
  PublicRoute3:
    Type: AWS::EC2::Route
    DependsOn: AttachGateway
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationCidrBlock: 10.1.10.0/24","[[66, 61, 54]]"
362,52790cad-d60d-41d5-8483-146f9f21208d,API Gateway Cache Cluster Disabled,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_cache_cluster_disabled,Unknown,"AWS API Gateway should have cache clustering enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-stage.html#cfn-apigateway-stage-cacheclusterenabled)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdNeg1:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: true
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
      CacheClusterEnabled: true

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdNeg1:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: true
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
      CacheClusterEnabled: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdPos1:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: true
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  ProdPos2:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      TracingEnabled: true
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
      CacheClusterEnabled: false","[[6], [31]]"
363,568cc372-ca64-420d-9015-ee347d00d288,User Data Contains Encoded Private Key,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/user_data_contains_encoded_private_key,Unknown,"User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-as-launchconfig.html)","---
Resources:
  myLaunchConfig2:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ImageId: ""ami-02354e95b39ca8dec""
      SecurityGroups:
        - Ref: ""myEC2SecurityGroup""
        - myExistingEC2SecurityGroup
      InstanceType: ""m1.large""
      KeyName:
        Ref: ""KeyName""
      UserData: ""some-gibberish""","---
Resources:
  myLaunchConfig4:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ImageId: ""ami-02354e95b39ca8dec""
      SecurityGroups:
        - Ref: ""myEC2SecurityGroup""
        - myExistingEC2SecurityGroup
      InstanceType: ""m1.large""
      KeyName:
        Ref: ""KeyName""
      UserData: ""LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpzb21lS2V5""",[[13]]
364,57b12981-3816-4c31-b190-a1e614361dd2,Public Lambda via API Gateway,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/public_lambda_via_api_gateway,Unknown,"Allowing to run lambda function using public API Gateway<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-permission.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  s3Permission3:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:InvokeFunction
      Principal: s3.amazonaws.com
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: arn:aws:s3:eu-central-1:123456789012:bucketname","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  s3Permission3:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:InvokeFunction
      Principal: apigateway.amazonaws.com
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: arn:aws:s3:eu-central-1:123456789012/*/*",[[11]]
365,5864fb39-d719-4182-80e2-89dbe627be63,Amazon DMS Replication Instance Is Publicly Accessible,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amazon_dms_replication_instance_is_publicly_accessible,Unknown,"Amazon DMS is publicly accessible, therefore exposing possible sensitive information. To prevent such a scenario, update the attribute 'PubliclyAccessible' to false.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dms-replicationinstance.html)","Resources:
  ReplicationInstance:
    Type: ""AWS::DMS::ReplicationInstance""
    Properties:
      ReplicationInstanceIdentifier: my-replication-instance
      ReplicationInstanceClass: dms.r5.large
      AllocatedStorage: 100
      EngineVersion: ""3.4.3""
      PubliclyAccessible: false","Resources:
  ReplicationInstance:
    Type: ""AWS::DMS::ReplicationInstance""
    Properties:
      ReplicationInstanceIdentifier: my-replication-instance
      ReplicationInstanceClass: dms.r5.large
      AllocatedStorage: 100
      EngineVersion: ""3.4.3""
      PubliclyAccessible: true

Resources:
  ReplicationInstance:
    Type: ""AWS::DMS::ReplicationInstance""
    Properties:
      ReplicationInstanceIdentifier: my-replication-instance
      ReplicationInstanceClass: dms.r5.large
      AllocatedStorage: 100
      EngineVersion: ""3.4.3""

Resources:
  ReplicationInstance:
    Type: ""AWS::DMS::ReplicationInstance""
    Properties:
      ReplicationInstanceIdentifier: my-replication-instance
      ReplicationInstanceClass: dms.r5.large
      AllocatedStorage: 100
      EngineVersion: ""3.4.3""
      PubliclyAccessible: ""true""","[[9], [4], [9]]"
366,5906092d-5f74-490d-9a03-78febe0f65e1,GitHub Repository Set To Public,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/github_repository_set_to_public,Unknown,"Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private')<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codestar-githubrepository.html)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  MyRepo1:
    Type: AWS::CodeStar::GitHubRepository
    Properties:
      Code:
        S3:
          Bucket: ""my-bucket""
          Key: ""sourcecode.zip""
          ObjectVersion: ""1""
      EnableIssues: ""true""
      IsPrivate: ""true""
      RepositoryAccessToken: '{{resolve:secretsmanager:your-secret-manager-name:SecretString:your-secret-manager-key}}'
      RepositoryDescription: a description
      RepositoryName: my-github-repo
      RepositoryOwner: my-github-account

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  MyRepo1:
    Type: AWS::CodeStar::GitHubRepository
    Properties:
      Code:
        S3:
          Bucket: ""my-bucket""
          Key: ""sourcecode.zip""
          ObjectVersion: ""1""
      EnableIssues: true
      IsPrivate: true
      RepositoryAccessToken: '{{resolve:secretsmanager:your-secret-manager-name:SecretString:your-secret-manager-key}}'
      RepositoryDescription: a description
      RepositoryName: my-github-repo
      RepositoryOwner: my-github-account","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  MyRepo3:
    Type: AWS::CodeStar::GitHubRepository
    Properties:
      Code:
        S3:
          Bucket: ""my-bucket""
          Key: ""sourcecode.zip""
          ObjectVersion: ""1""
      EnableIssues: true
      IsPrivate: false
      RepositoryAccessToken: '{{resolve:secretsmanager:your-secret-manager-name:SecretString:your-secret-manager-key}}'
      RepositoryDescription: a description
      RepositoryName: my-github-repo
      RepositoryOwner: my-github-account

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  MyRepo4:
    Type: AWS::CodeStar::GitHubRepository
    Properties:
      Code:
        S3:
          Bucket: ""my-bucket""
          Key: ""sourcecode.zip""
          ObjectVersion: ""1""
      EnableIssues: true
      RepositoryAccessToken: '{{resolve:secretsmanager:your-secret-manager-name:SecretString:your-secret-manager-key}}'
      RepositoryDescription: a description
      RepositoryName: my-github-repo
      RepositoryOwner: my-github-account","[[12], [5]]"
367,59a849c2-1127-4023-85a5-ef906dcd458c,BOM - AWS SQS,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/sqs,Unknown,"A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","Resources:
  MyQueue:
    Type: AWS::SQS::Queue
    Properties:
      QueueName: ""SampleQueue""
      KmsMasterKeyId: wewewewewewe
  SampleSQSPolicy: 
    Type: AWS::SQS::QueuePolicy
    Properties: 
      Queues: 
        - !Ref MyQueue
      PolicyDocument: 
        Statement: 
          - 
            Action: 
              - ""SQS:SendMessage"" 
              - ""SQS:ReceiveMessage""
            Effect: ""Allow""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:  
              AWS: 
                - ""111122223333""",[[2]]
368,5b033ec8-f079-4323-b5c8-99d4620433a9,EMR Security Configuration Encryption Disabled,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/emr_security_configuration_encryptions_enabled,Unknown,"EMR SecurityConfiguration should enable and properly configure encryption at rest and in transit.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-emr-securityconfiguration.html)","#this code is a correct code for which the query should not find any result
#this is a problematic code where the query should report a result(s)
Resources:
  EMRSecurityConfiguration:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           EnableInTransitEncryption: true
           EnableAtRestEncryption: true
           AtRestEncryptionConfiguration:
             LocalDiskEncryptionConfiguration:
                 EnableEbsEncryption: true
                 EncryptionKeyProviderType: AwsKms
                 AwsKmsKey: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

Resources:
  EMRSecurityConfiguration01:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           AtRestEncryptionConfiguration:
             LocalDiskEncryptionConfiguration:
                 EnableEbsEncryption: true
                 EncryptionKeyProviderType: AwsKms
                 AwsKmsKey: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

Resources:
  EMRSecurityConfiguration02:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           EnableInTransitEncryption: true
           EnableAtRestEncryption: true","Resources:
  EMRSecurityConfiguration:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           EnableInTransitEncryption: false
           EnableAtRestEncryption: false
           AtRestEncryptionConfiguration:
             LocalDiskEncryptionConfiguration:
                 EnableEbsEncryption: true
                 EncryptionKeyProviderType: AwsKms
                 AwsKmsKey: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

Resources:
  EMRSecurityConfiguration01:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           AtRestEncryptionConfiguration:
             LocalDiskEncryptionConfiguration:
                 EnableEbsEncryption: false

Resources:
  EMRSecurityConfiguration03:
    Type: AWS::EMR::SecurityConfiguration
    Properties:
       Name: String
       SecurityConfiguration:
         EncryptionConfiguration:
           EnableInTransitEncryption: false
           EnableAtRestEncryption: false","[[8, 9], [9, 10], [8, 9]]"
369,5b48c507-0d1f-41b0-a630-76817c6b4189,RefreshToken Is Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/refresh_token_is_exposed,Unknown,"Alexa ASK Skill AuthenticationConfiguration RefreshToken should not be a plaintext string<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ask-skill.html#cfn-ask-skill-authenticationconfiguration)","Resources:
  MySkill:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: !GetAtt S3BucketReadRole.Arn
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: !GetAtt SkillFunction.Arn
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""1234""
        RefreshToken: ""{{resolve:secretsmanager:Atzr|IQEBLzAtAhRPpMJxdwVz2Nn6f2y-tpJX2DeX}}""
      VendorId: ""1234""
  MySkill2:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: !GetAtt S3BucketReadRole.Arn
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: !GetAtt SkillFunction.Arn
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""1234""
        RefreshToken: ""{{resolve:ssm-secure:Atzr|IQEBLzAtAhRPpMJxdwVz2Nn6f2y-tpJX2DeX}}""
      VendorId: ""1234""","Resources:
  MySkill:
    Type: ""Alexa::ASK::Skill""
    Properties:
      SkillPackage:
        S3Bucket: ""my-skill-packages""
        S3Key: ""skillpackage.zip""
        S3BucketRole: !GetAtt S3BucketReadRole.Arn
        Overrides:
          Manifest:
            apis:
              custom:
                endpoint:
                  uri: !GetAtt SkillFunction.Arn
      AuthenticationConfiguration:
        ClientId: ""amzn1.application-oa2-client.1234""
        ClientSecret: ""1234""
        RefreshToken: ""Atzr|1234""
      VendorId: ""1234""",[[18]]
370,5beacce3-4020-4a3d-9e1d-a36f953df630,RDS Storage Not Encrypted,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_storage_not_encrypted,Unknown,"RDS Storage should be encrypted, which means the attribute 'StorageEncrypted' should be set to 'true'<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      StorageEncrypted: ""true""","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      StorageEncrypted: false

AWSTemplateFormatVersion: 2010-09-11
Description: RDS Storage Encrypted2
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey2:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall2:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey","[[35], [30]]"
371,5c0b06d5-b7a4-484c-aeb0-75a836269ff0,CloudTrail Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_logging_disabled,Unknown,"Checks if logging is enabled for CloudTrail.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-islogging)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: true
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: ""true""
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: ""true""
      IsMultiRegionTrail: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail3:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: false
      IsMultiRegionTrail: true
  myTrail4:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: false
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: false
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      EnableLogFileValidation: false
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: false
      IsMultiRegionTrail: ""true""","[[34, 19], [20]]"
372,5c666ed9-b586-49ab-9873-c495a833b705,Elasticsearch Without IAM Authentication,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_without_iam_authentication,Unknown,"AWS Elasticsearch should ensure IAM Authentication<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-accesspolicies)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates ES
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchVersion: ""7.10""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: true
        InstanceCount: ""2""
        ZoneAwarenessEnabled: true
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EBSOptions:
        EBSEnabled: true
        Iops: ""0""
        VolumeSize: ""20""
        VolumeType: ""gp2""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      LogPublishingOptions:
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-application-logs""
          Enabled: true
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs""
          Enabled: true
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs""
          Enabled: true
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates ES
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchVersion: ""7.10""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: true
        InstanceCount: ""2""
        ZoneAwarenessEnabled: true
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EBSOptions:
        EBSEnabled: true
        Iops: ""0""
        VolumeSize: ""20""
        VolumeType: ""gp2""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: ""Allow""
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      LogPublishingOptions:
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-application-logs""
          Enabled: true
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs""
          Enabled: true
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs""
          Enabled: true
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: true",[[24]]
373,5d3c1807-acb3-4bb0-be4e-0440230feeaf,CloudWatch Metrics Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudwatch_metrics_disabled,Unknown,"Checks if CloudWatch Metrics is Enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cw-alarm.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating TestDeployment
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'","AWSTemplateFormatVersion: 2010-09-09
Description: Creating TestDeployment
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'false'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'

AWSTemplateFormatVersion: 2010-09-09
Description: Creating TestDeployment
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod","[[18, 20], [6]]"
374,5e6c9c68-8a82-408e-8749-ddad78cbb9c5,Security Group Rule Without Description,CloudFormation,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_rule_without_description,Unknown,"It's considered a best practice for AWS Security Group to have a description<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[33, 4, 7, 12, 19]]"
375,5e7acff5-095b-40ac-9073-ac2e4ad8a512,IAM Policies Without Groups,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policies_without_groups,Unknown,"IAM policy should not apply directly to users, should be with a group<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-iam.html#scenario-iam-policy)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::Policy
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
          Groups:
            - myexistinggroup1","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::Policy
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
          Users:
            - existinguser1
            - existinguser2",[[25]]
376,5f700072-b7ce-4e84-b3f3-497bf1c24a4d,DMS Endpoint Password Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dms_endpoint_password_exposed,Unknown,"DMS Endpoint password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dms-endpoint.html)","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  DMSEndpoint1:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
        MongoDbSettings
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username'
Resources:
  DMSEndpoint2:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
        MongoDbSettings
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Resources:
    DMSEndpoint3:
      Type: AWS::DMS::Endpoint
      Properties:
        CertificateArn: String
        DatabaseName: String
        EndpointIdentifier: String
        EndpointType: String
        EngineName: String
        ExtraConnectionAttributes: String
        KafkaSettings:
          KafkaSettings
        KinesisSettings:
          KinesisSettings
        KmsKeyId: String
        MongoDbSettings:
          MongoDbSettings
        NeptuneSettings:
          NeptuneSettings
        Password: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
        Port: 80
        S3Settings:
          S3Settings
        ServerName: String
        SslMode: String
        Tags:
          - Tag
        Username: String
    MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'","Resources:
  DMSEndpoint4:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
        MongoDbSettings
      NeptuneSettings:
        NeptuneSettings
      Password: 'asDjskjs73!!'
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: 'asDjskjs73!'
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  DMSEndpoint5:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
        MongoDbSettings
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Parameters:
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  DMSEndpoint6:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
        MongoDbSettings
      NeptuneSettings:
        NeptuneSettings
      Password: 'asDjskjs73!!'
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String","[[20], [5], [25]]"
377,60a05ede-0a68-4d0d-a58f-f538cf55ff79,Serverless API Cache Cluster Disabled,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_api_cache_cluster_disabled,Unknown,"AWS Serverless API should have cache clustering enabled<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-api.html#sam-api-cacheclusterenabled)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: ""true""","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: false

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: ""false""","[[7], [10], [10]]"
378,61a94903-3cd3-4780-88ec-fc918819b9c8,ELB Using Insecure Protocols,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_using_insecure_protocols,Unknown,"ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Protocols that coincide with any of a predefined list of insecure protocols.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html)","#this code is a correct code for which the query should not find any result
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","#this is a problematic code where the query should report a result(s)
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Protocol-SSLv2
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
          - PolicyName: My-SSLNegotiation-Policy2
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Protocol-TLSv1
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","[[34, 27]]"
379,65844ba3-03a1-40a8-b3dd-919f122e8c95,RDS Storage Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_storage_encryption_disabled,Unknown,"RDS DBCluster should have storage encrypted set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html#cfn-rds-dbcluster-storageencrypted)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  RDSCluster:
    Properties:
      DBClusterParameterGroupName:
        Ref: RDSDBClusterParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      MasterUserPassword: password
      MasterUsername: username
      StorageEncrypted: true
    Type: ""AWS::RDS::DBCluster""
  RDSDBClusterParameterGroup:
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: aurora5.6
      Parameters:
        time_zone: US/Eastern
    Type: ""AWS::RDS::DBClusterParameterGroup""
  RDSDBInstance1:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBInstance2:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBParameterGroup:
    Type: 'AWS::RDS::DBParameterGroup'
    Properties:
      Description: CloudFormation Sample Aurora Parameter Group
      Family: aurora5.6
      Parameters:
        sql_mode: IGNORE_SPACE
        max_allowed_packet: 1024
        innodb_buffer_pool_size: '{DBInstanceClassMemory*3/4}'

AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  RDSCluster:
    Properties:
      DBClusterParameterGroupName:
        Ref: RDSDBClusterParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      MasterUserPassword: password
      MasterUsername: username
      StorageEncrypted: ""true""
    Type: ""AWS::RDS::DBCluster""
  RDSDBClusterParameterGroup:
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: aurora5.6
      Parameters:
        time_zone: US/Eastern
    Type: ""AWS::RDS::DBClusterParameterGroup""
  RDSDBInstance1:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBInstance2:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBParameterGroup:
    Type: 'AWS::RDS::DBParameterGroup'
    Properties:
      Description: CloudFormation Sample Aurora Parameter Group
      Family: aurora5.6
      Parameters:
        sql_mode: IGNORE_SPACE
        max_allowed_packet: 1024
        innodb_buffer_pool_size: '{DBInstanceClassMemory*3/4}'","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  RDSCluster:
    Properties:
      DBClusterParameterGroupName:
        Ref: RDSDBClusterParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      MasterUserPassword: password
      MasterUsername: username
      StorageEncrypted: false
    Type: ""AWS::RDS::DBCluster""
  RDSDBClusterParameterGroup:
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: aurora5.6
      Parameters:
        time_zone: US/Eastern
    Type: ""AWS::RDS::DBClusterParameterGroup""
  RDSDBInstance1:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBInstance2:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBParameterGroup:
    Type: 'AWS::RDS::DBParameterGroup'
    Properties:
      Description: CloudFormation Sample Aurora Parameter Group
      Family: aurora5.6
      Parameters:
        sql_mode: IGNORE_SPACE
        max_allowed_packet: 1024
        innodb_buffer_pool_size: '{DBInstanceClassMemory*3/4}'

AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  RDSCluster1:
    Properties:
      DBClusterParameterGroupName:
        Ref: RDSDBClusterParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      MasterUserPassword: password
      MasterUsername: username
    Type: ""AWS::RDS::DBCluster""
  RDSDBClusterParameterGroup:
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: aurora5.6
      Parameters:
        time_zone: US/Eastern
    Type: ""AWS::RDS::DBClusterParameterGroup""
  RDSDBInstance1:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBInstance2:
    Properties:
      AvailabilityZone: eu-west-1b
      DBClusterIdentifier:
        Ref: RDSCluster
      DBInstanceClass: db.r3.xlarge
      DBParameterGroupName:
        Ref: RDSDBParameterGroup
      DBSubnetGroupName: DBSubnetGroup
      Engine: aurora
      PubliclyAccessible: ""true""
    Type: ""AWS::RDS::DBInstance""
  RDSDBParameterGroup:
    Type: 'AWS::RDS::DBParameterGroup'
    Properties:
      Description: CloudFormation Sample Aurora Parameter Group
      Family: aurora5.6
      Parameters:
        sql_mode: IGNORE_SPACE
        max_allowed_packet: 1024
        innodb_buffer_pool_size: '{DBInstanceClassMemory*3/4}'","[[12], [5]]"
380,65d07da5-9af5-44df-8983-52d2e6f24c44,CloudTrail Not Integrated With CloudWatch,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudtrail_not_integrated_with_cloudwatch,Unknown,"CloudTrail should be integrated with CloudWatch<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html)","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-west-2:920172477660:log-group:CloudTrail/DefaultLogGroup:*""
      CloudWatchLogsRoleArn:
        ""Fn::GetAtt"":
          - IamRoleForCwLogs
          - Arn
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
  IamRoleForCwLogs:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: """"
            Effect: Allow
            Principal:
              Service: cloudtrail.amazonaws.com
            Action: ""sts:AssumeRole""
      Policies:
        - PolicyName: allow-access-to-cw-logs
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              - Effect: Allow
                Action:
                  - ""logs:CreateLogStream""
                  - ""logs:PutLogEvents""
                Resource: ""*""","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail2:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      CloudWatchLogsRoleArn:
        ""Fn::GetAtt"":
          - IamRoleForCwLogs
          - Arn
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
  IamRoleForCwLogs:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: """"
            Effect: Allow
            Principal:
              Service: cloudtrail.amazonaws.com
            Action: ""sts:AssumeRole""
      Policies:
        - PolicyName: allow-access-to-cw-logs
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              - Effect: Allow
                Action:
                  - ""logs:CreateLogStream""
                  - ""logs:PutLogEvents""
                Resource: ""*""

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  S3Bucket:
    DeletionPolicy: Retain
    Type: AWS::S3::Bucket
    Properties: {}
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket:
        Ref: S3Bucket
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: ""AWSCloudTrailAclCheck""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:GetBucketAcl""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}
          - Sid: ""AWSCloudTrailWrite""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Action: ""s3:PutObject""
            Resource: !Sub |-
              arn:aws:s3:::${S3Bucket}/AWSLogs/${AWS::AccountId}/*
            Condition:
              StringEquals:
                s3:x-amz-acl: ""bucket-owner-full-control""
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Ref: OperatorEmail
          Protocol: email
  TopicPolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      Topics:
        - Ref: ""Topic""
      PolicyDocument:
        Version: ""2008-10-17""
        Statement:
          - Sid: ""AWSCloudTrailSNSPolicy""
            Effect: ""Allow""
            Principal:
              Service: ""cloudtrail.amazonaws.com""
            Resource: ""*""
            Action: ""SNS:Publish""
  myTrail3:
    DependsOn:
      - BucketPolicy
      - TopicPolicy
    Type: AWS::CloudTrail::Trail
    Properties:
      CloudWatchLogsLogGroupArn: ""arn:aws:logs:us-west-2:920172477660:log-group:CloudTrail/DefaultLogGroup:*""
      S3BucketName:
        Ref: S3Bucket
      SnsTopicName:
        Fn::GetAtt:
          - Topic
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
  IamRoleForCwLogs:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Sid: """"
            Effect: Allow
            Principal:
              Service: cloudtrail.amazonaws.com
            Action: ""sts:AssumeRole""
      Policies:
        - PolicyName: allow-access-to-cw-logs
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              - Effect: Allow
                Action:
                  - ""logs:CreateLogStream""
                  - ""logs:PutLogEvents""
                Resource: ""*""","[[62], [62], [62]]"
381,6685d912-d81f-4cfa-95ad-e316ea31c989,Directory Service Simple AD Password Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/directory_service_simple_ad_password_exposed,Unknown,"DirectoryService SimpleAD password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-directoryservice-simplead.html)","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp1:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
        CreateAlias: true
        Description: String
        EnableSso: true
        Name: String
        Password: !Ref ParentMasterPassword
        ShortName: String
        Size: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username'
Resources:
  NewAmpApp2:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
      CreateAlias: true
      Description: String
      EnableSso: true
      Name: String
      Password: !Ref ParentMasterPassword
      ShortName: String
      Size: String

Resources:
  NewAmpApp3:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
        CreateAlias: true
        Description: String
        EnableSso: true
        Name: String
        Password:  !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
        ShortName: String
        Size: String
  MyAmpAppSecretManagerRotater:
    Type: AWS::SecretsManager::Secret
    Properties:
      Description: 'This is my amp app instance secret'
      GenerateSecretString:
        SecretStringTemplate: '{""username"": ""admin""}'
        GenerateStringKey: 'password'
        PasswordLength: 16
        ExcludeCharacters: '""@/\'","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp4:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
        CreateAlias: true
        Description: String
        EnableSso: true
        Name: String
        Password:  'asDjskjs73!!'
        ShortName: String
        Size: String

Resources:
  NewAmpApp5:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
      CreateAlias: true
      Description: String
      EnableSso: true
      Name: String
      Password: 'asDjskjs73!!'
      ShortName: String
      Size: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: 'asDjskjs73!'
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
Resources:
  NewAmpApp6:
    Type: AWS::DirectoryService::SimpleAD
    Properties:
      CreateAlias: true
      Description: String
      EnableSso: true
      Name: String
      Password: !Ref ParentMasterPassword
      ShortName: String
      Size: String","[[18], [9], [5]]"
382,66f2d8f9-a911-4ced-ae27-34f09690bb2c,Security Groups Allows Unrestricted Outbound Traffic,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_allows_unrestricted_outbound_traffic,Unknown,"No security group should allow unrestricted egress access<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: ALL
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0",[[16]]
383,68b6a789-82f8-4cfd-85de-e95332fe6a61,MQ Broker Is Publicly Accessible,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/mq_broker_is_publicly_accessible,Unknown,"Check if any MQ Broker is not publicly accessible<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amazonmq-broker.html#cfn-amazonmq-broker-publiclyaccessible)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: ""true""
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: true
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: ""true""
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""true""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""","[[15], [15]]"
384,6b5b0313-771b-4319-ad7a-122ee78700ef,Serverless API Endpoint Config Not Private,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_api_endpoint_config_not_private,Unknown,"AWS Serverless API should set API Endpoint Config type to 'PRIVATE'. This way, it's not exposed to the public internet<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-api.html#sam-api-endpointconfiguration)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi4:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      EndpointConfiguration:
        Types:
          - PRIVATE","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      EndpointConfiguration:
        VpcEndpointIds:
          - !Ref ApiGatewayVPCEndpoint

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      EndpointConfiguration:
        Types:
          - EDGE","[[7], [11], [12]]"
385,6c131358-c54d-419b-9dd6-1f7dd41d180c,ECS Cluster Not Encrypted At Rest,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_cluster_not_encrypted_at_rest,Unknown,"Ensure that AWS ECS clusters are encrypted. Data encryption at rest, prevents unauthorized users from accessing sensitive data on your AWS ECS clusters and associated cache storage systems.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  AppName:
    Type: String
    Description: Name of app requiring ELB exposure
    Default: simple-app
  AppContainerPort:
    Type: Number
    Description: Container port of app requiring ELB exposure
    Default: '80'
  AppHostPort:
    Type: Number
    Description: Host port of app requiring ELB exposure
    Default: '80'
  ServiceName:
    Type: String
  LoadBalancerName:
    Type: String
  HealthCheckGracePeriodSeconds:
    Type: String
Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
          EFSVolumeConfiguration:
               TransitEncryption: ENABLED
               TransitEncryptionPort: 8080

  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DeploymentConfiguration:
        MaximumPercent: 200
        MinimumHealthyPercent: 100
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: !Ref Role
  Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ecs.amazonaws.com
            Action: 'sts:AssumeRole'
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceRole'
Outputs:
  Cluster:
    Value: !Ref cluster","Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
          EFSVolumeConfiguration:
               TransitEncryption: DISABLED
               TransitEncryptionPort: 8080
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DeploymentConfiguration:
        MaximumPercent: 200
        MinimumHealthyPercent: 100
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: !Ref Role
  Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ecs.amazonaws.com
            Action: 'sts:AssumeRole'
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceRole'",[[6]]
386,6c8d51af-218d-4bfb-94a9-94eabaa0703a,S3 Bucket Without Ignore Public ACL,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_without_ignore_public_acl,Unknown,"S3 bucket without ignore public ACL<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html)","Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : true
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true

Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : ""true""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""","Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : true
        RestrictPublicBuckets : true
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy     : true
        IgnorePublicAcls      : false
        RestrictPublicBuckets : true

Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicPolicy     : ""true""
        RestrictPublicBuckets : ""true""
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: ""false""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""false""
        RestrictPublicBuckets : ""true""","[[10, 4, 21], [10, 4, 21]]"
387,6d087495-2a42-4735-abf7-02ef5660a7e6,EFS Without KMS,CloudFormation,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/efs_without_kms,Unknown,"Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSKMSKey:
      Type: AWS::KMS::Key
      Properties:
        Description: ""An example CMK with KMS""
        KeyPolicy:
          Version: ""2012-10-17""
          Id: ""efs-default-key1""
          Statement:
          -   Sid: ""Allow administration of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:Create*""
                - ""kms:Describe*""
                - ""kms:Enable*""
                - ""kms:List*""
                - ""kms:Put*""
                - ""kms:Update*""
                - ""kms:Revoke*""
                - ""kms:Disable*""
                - ""kms:Get*""
                - ""kms:Delete*""
                - ""kms:ScheduleKeyDeletion""
                - ""kms:CancelKeyDeletion""
              Resource: ""*""
          -   Sid: ""Allow use of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:DescribeKey""
                - ""kms:Encrypt""
                - ""kms:Decrypt""
                - ""kms:ReEncrypt*""
                - ""kms:GenerateDataKey""
                - ""kms:GenerateDataKeyWithoutPlaintext""
              Resource: ""*""
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: false
            KmsKeyId: !Ref EFSKMSKey
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSKMSKey:
      Type: AWS::KMS::Key
      Properties:
        Description: ""An example CMK with KMS""
        KeyPolicy:
          Version: ""2012-10-17""
          Id: ""efs-default-key1""
          Statement:
          -   Sid: ""Allow administration of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:Create*""
                - ""kms:Describe*""
                - ""kms:Enable*""
                - ""kms:List*""
                - ""kms:Put*""
                - ""kms:Update*""
                - ""kms:Revoke*""
                - ""kms:Disable*""
                - ""kms:Get*""
                - ""kms:Delete*""
                - ""kms:ScheduleKeyDeletion""
                - ""kms:CancelKeyDeletion""
              Resource: ""*""
          -   Sid: ""Allow use of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:DescribeKey""
                - ""kms:Encrypt""
                - ""kms:Decrypt""
                - ""kms:ReEncrypt*""
                - ""kms:GenerateDataKey""
                - ""kms:GenerateDataKeyWithoutPlaintext""
              Resource: ""*""
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: ""false""
            KmsKeyId: !Ref EFSKMSKey
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSKMSKey:
      Type: AWS::KMS::Key
      Properties:
        Description: ""An example CMK with KMS""
        KeyPolicy:
          Version: ""2012-10-17""
          Id: ""efs-default-key1""
          Statement:
          -   Sid: ""Allow administration of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:Create*""
                - ""kms:Describe*""
                - ""kms:Enable*""
                - ""kms:List*""
                - ""kms:Put*""
                - ""kms:Update*""
                - ""kms:Revoke*""
                - ""kms:Disable*""
                - ""kms:Get*""
                - ""kms:Delete*""
                - ""kms:ScheduleKeyDeletion""
                - ""kms:CancelKeyDeletion""
              Resource: ""*""
          -   Sid: ""Allow use of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:DescribeKey""
                - ""kms:Encrypt""
                - ""kms:Decrypt""
                - ""kms:ReEncrypt*""
                - ""kms:GenerateDataKey""
                - ""kms:GenerateDataKeyWithoutPlaintext""
              Resource: ""*""
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: false
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Parameters:
    VPC:
        Type: String
        Description: The VPC identity
        Default: vpc-ID
    SubnetID1:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID2:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
    SubnetID3:
        Type: String
        Description: The subnet where to launch the service
        Default: subnet-ID
    SubnetID4:
        Type: String
        Description: the subnet where to Launch the service
        Default: subnet-ID
Resources:
    EFSKMSKey:
      Type: AWS::KMS::Key
      Properties:
        Description: ""An example CMK with KMS""
        KeyPolicy:
          Version: ""2012-10-17""
          Id: ""efs-default-key1""
          Statement:
          -   Sid: ""Allow administration of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:Create*""
                - ""kms:Describe*""
                - ""kms:Enable*""
                - ""kms:List*""
                - ""kms:Put*""
                - ""kms:Update*""
                - ""kms:Revoke*""
                - ""kms:Disable*""
                - ""kms:Get*""
                - ""kms:Delete*""
                - ""kms:ScheduleKeyDeletion""
                - ""kms:CancelKeyDeletion""
              Resource: ""*""
          -   Sid: ""Allow use of the key""
              Effect: ""Allow""
              Principal:
                AWS: ""arn:aws:iam::999999999999:user/roger""
              Action:
                - ""kms:DescribeKey""
                - ""kms:Encrypt""
                - ""kms:Decrypt""
                - ""kms:ReEncrypt*""
                - ""kms:GenerateDataKey""
                - ""kms:GenerateDataKeyWithoutPlaintext""
              Resource: ""*""
    EFSSecurityGroup:
        Type: ""AWS::EC2::SecurityGroup""
        Properties:
            GroupDescription: ""security group for the prod EFS""
            GroupName: ""test-EFS-SG""
            VpcId: !Ref VPC
            SecurityGroupIngress:
              - SourceSecurityGroupId: sg-ID
                Description: ""servers to connect to efs""
                FromPort: 2049
                IpProtocol: ""tcp""
                ToPort: 2049
            Tags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS-SG
              - Key: Project
                Value: ITEngineering
    EFSFileSystem01:
        Type: AWS::EFS::FileSystem
        Properties:
            BackupPolicy:
              Status: ENABLED
            Encrypted: ""false""
            LifecyclePolicies:
              - TransitionToIA: AFTER_60_DAYS
            PerformanceMode: generalPurpose
            ThroughputMode: bursting
            FileSystemTags:
              - Key: Environment
                Value: prod
              - Key: Name
                Value: test-VPC-EFS
              - Key: Project
                Value: ITEngineering
    MountTarget1:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID1
    MountTarget2:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID2
    MountTarget3:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID3
    MountTarget4:
        Type: AWS::EFS::MountTarget
        Properties:
            FileSystemId: !Ref EFSFileSystem01
            IpAddress: ""*.*.*.*""
            SecurityGroups:
              - !Ref EFSSecurityGroup
            SubnetId: !Ref SubnetID4
Outputs:
  EFS:
    Description: The created EFS
    Value: !Ref EFSFileSystem01
  EFSMountTarget1:
    Description: The EFS MountTarget1
    Value: !Ref MountTarget1
  EFSMountTarget2:
    Description: The EFS MountTarget2
    Value: !Ref MountTarget2
  EFSMountTarget3:
    Description: The EFS MountTarget3
    Value: !Ref MountTarget3
  EFSMountTarget4:
    Description: The EFS MountTarget4
    Value: !Ref MountTarget4","[[82], [82]]"
388,6d64f311-3da6-45f3-80f1-14db9771ea40,Permissive Web ACL Default Action,CloudFormation,High,Insecure Defaults,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/webacl_allow_defaultaction,Unknown,"WebAcl DefaultAction should not be ALLOW<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-waf-webacl.html)","#this code is a correct code for which the query should not find any result
Resources:
  MyWebACL:
    Type: ""AWS::WAF::WebACL""
    Properties:
      Name: ""WebACL to with one rule""
      DefaultAction:
        Type: ""BLOCK""
      MetricName: ""MyWebACL""
      Rules:
        -
          Action:
            Type: ""ALLOW""
          Priority: 1
          RuleId:
            Ref: ""MyRule""","#this is a problematic code where the query should report a result(s)
Resources:
  MyWebACL:
    Type: ""AWS::WAF::WebACL""
    Properties:
      Name: ""WebACL to with three rules""
      DefaultAction:
        Type: ""ALLOW""
      MetricName: ""MyWebACL""
      Rules:
        -
          Action:
            Type: ""BLOCK""
          Priority: 1
          RuleId:
            Ref: ""MyRule""
        -
          Action:
            Type: ""BLOCK""
          Priority: 2
          RuleId:
            Ref: ""BadReferersRule""
        -
          Action:
            Type: ""BLOCK""
          Priority: 3
          RuleId:
            Ref: ""SqlInjRule""",[[8]]
389,6e856af2-62d7-4ba2-adc1-73b62cef9cc1,Security Group With Unrestricted Access To SSH,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_with_unrestricted_access_to_ssh,Unknown,"'SSH' (TCP:22) should not be public in AWS Security Group<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/33","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0",[[15]]
390,6ea57c8b-f9c0-4ec7-bae3-bd75a9dee27d,SDB Domain Declared As A Resource,CloudFormation,Low,Resource Management,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sdb_domain_declared_as_a_resource,Unknown,"SimpleDB Domain resource should not be declared<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-simpledb.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""SDB Domain declared""
Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""SDB Domain declared""
Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""
  SBDDomain:
    Type: AWS::SDB::Domain
    Properties:
      Description: ""Some information""",[[8]]
391,6ef03ff6-a2bd-483c-851f-631f248bc0ea,BOM - AWS RDS,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/rds,Unknown,"A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true",,[]
392,709e6da6-fa1f-44cc-8f17-7f25f96dadbe,SageMaker Data Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sagemaker_data_encryption_disabled,Unknown,"Amazon SageMaker's Notebook Instance must have its Data Encryption enabled, which means the attribute 'KmsKeyId' must be defined not empty or null.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-notebookinstance.html)","#this code is a correct code for which the query should not find any result
Description: ""Basic NotebookInstance test update to a different instance type""
Resources:
  BasicNotebookInstance:
    Type: ""AWS::SageMaker::NotebookInstance""
    Properties:
      InstanceType: ""ml.t2.large""
      RoleArn: !GetAtt ExecutionRole.Arn
      KmsKeyId: ""Key""
  ExecutionRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              Service:
                - ""sagemaker.amazonaws.com""
            Action:
              - ""sts:AssumeRole""
      Path: ""/""
      Policies:
        -
          PolicyName: ""root""
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              -
                Effect: ""Allow""
                Action: ""*""
                Resource: ""*""
Outputs:
  BasicNotebookInstanceId:
    Value: !Ref BasicNotebookInstance","#this is a problematic code where the query should report a result(s)
Description: ""Basic NotebookInstance test update to a different instance type""
Resources:
  BasicNotebookInstance:
    Type: ""AWS::SageMaker::NotebookInstance""
    Properties:
      InstanceType: ""ml.t2.large""
      RoleArn: !GetAtt ExecutionRole.Arn
  BasicNotebookInstance2:
    Type: ""AWS::SageMaker::NotebookInstance""
    Properties:
      InstanceType: ""ml.t2.large""
      RoleArn: !GetAtt ExecutionRole.Arn
      KmsKeyId: 'some-kms-key'
  BasicNotebookInstance3:
    Type: ""AWS::SageMaker::NotebookInstance""
    Properties:
      InstanceType: ""ml.t2.large""
      RoleArn: !GetAtt ExecutionRole.Arn
      KmsKeyId : """"
  ExecutionRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              Service:
                - ""sagemaker.amazonaws.com""
            Action:
              - ""sts:AssumeRole""
      Path: ""/""
      Policies:
        -
          PolicyName: ""root""
          PolicyDocument:
            Version: ""2012-10-17""
            Statement:
              -
                Effect: ""Allow""
                Action: ""*""
                Resource: ""*""
Outputs:
  BasicNotebookInstanceId:
    Value: !Ref BasicNotebookInstance","[[20, 6]]"
393,71493c8b-3014-404c-9802-078b74496fb7,Amplify App Basic Auth Config Password Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amplify_app_basic_auth_config_password_exposed,Unknown,"Amplify App BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-amplify-app-basicauthconfig.html)","Resources:
     NewAmpApp-2:
        Type: AWS::Amplify::App
        Properties:
          BuildSpec: String
          CustomHeaders: String
          Description: String
          EnableBranchAutoDeletion: true
          IAMServiceRole: String
          Name: NewAmpApp
          OauthToken: String
          Repository: String
          BasicAuthConfig :
            EnableBasicAuth: true
            Password: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
            Username: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::username}}'
     MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
  ParentUsername:
    Description: 'Username'
    Type: String
Resources:
  NewAmpApp-1:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: """"
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp-4:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername","AWSTemplateFormatVersion: 2010-09-09
Resources:
  NewAmpApp-1:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: ""@skdsjdk0234!AB""
        Username: admin

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: ""@skdsjdk0234!AB""
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp-4:
    Type: AWS::Amplify::App
    Properties:
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername","[[16], [6]]"
394,73980e43-f399-4fcc-a373-658228f7adf7,Amplify App Access Token Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amplify_app_access_token_exposed,Unknown,"Amplify App Access Token must not be in a plain text string or referenced in a parameter as a default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amplify-app.html)","Resources:
     NewAmpApp:
        Type: AWS::Amplify::App
        Properties:
          AccessToken: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
          BuildSpec: String
          CustomHeaders: String
          Description: String
          EnableBranchAutoDeletion: true
          IAMServiceRole: String
          Name: NewAmpApp
          OauthToken: String
          Repository: String
     MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'

Parameters:
  ParentAccessToken:
    Description: 'Access Token'
    Type: String
Resources:
  NewAmp:
    Type: AWS::Amplify::App
    Properties:
      AccessToken: !Ref ParentAccessToken
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String

Parameters:
  ParentAccessToken:
    Description: 'Access Token'
    Type: String
    Default: """"
Resources:
  AmpApp:
    Type: AWS::Amplify::App
    Properties:
      AccessToken: !Ref ParentAccessToken
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String","AWSTemplateFormatVersion: 2010-09-09
Resources:
  NewAmpApp:
    Type: AWS::Amplify::App
    Properties:
      AccessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTYyMzkwMjJ9.tbDepxpstvGdW8TC3G8zg4B6rUYAOvfzdceoH48wgRQ
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: True
      IAMServiceRole: String
      Name: String
      OauthToken: String
      Repository: String

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  ParentAccessToken:
    Description: 'Access Token'
    Type: String
    Default: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTYyMzkwMjJ9.tbDepxpstvGdW8TC3G8zg4B6rUYAOvfzdceoH48wgRQ'
Resources:
  AmpApp:
    Type: AWS::Amplify::App
    Properties:
      AccessToken: !Ref ParentAccessToken
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  ParentUserToken:
    Description: 'UserToken'
    Type: String
Resources:
  NewApp:
    Type: AWS::Amplify::App
    Properties:
      AccessToken: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTYyMzkwMjJ9.tbDepxpstvGdW8TC3G8zg4B6rUYAOvfzdceoH48wgRQ
      BuildSpec: String
      CustomHeaders: String
      Description: String
      EnableBranchAutoDeletion: true
      IAMServiceRole: String
      Name: NewAmpApp
      OauthToken: String
      Repository: String","[[6], [6], [10]]"
395,73d59e76-a12c-4b74-a3d8-d3e1e19c25b3,EKS node group remote access,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/eks_node_group_remote_access,Unknown,"Ensure Amazon EKS Node group has implict SSH access<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-eks-nodegroup.html)","Resources:
  SSHAccessToNodeSG:
    Type: AWS::EC2::SecurityGroup
    Properties:
      VpcId: !Ref VpcId
      GroupName: !Sub ""${Project}-${Environment}-${EKSClusterName}-ssh-access-to-workers-source-sg""
      GroupDescription: attach this sg to an instance to let it access via ssh to the eks node
      Tags:
      - Key: Environment
        Value: !Ref Environment
      - Key: Project
        Value: !Ref Project
  EKSNodegroup:
    Type: 'AWS::EKS::Nodegroup'
    Properties:
      ClusterName: prod
      NodeRole: 'arn:aws:iam::012345678910:role/eksInstanceRole'
      ScalingConfig:
        MinSize: 3
        DesiredSize: 5
        MaxSize: 7
      Labels:
        Key1: Value1
        Key2: Value2
      Subnets:
        - subnet-6782e71e
        - subnet-e7e761ac
      RemoteAccess:
        Ec2SshKey: ED25519
        SourceSecurityGroups: 
          - !Ref SSHAccessToNodeSG","Resources:
  EKSNodegroup:
    Type: 'AWS::EKS::Nodegroup'
    Properties:
      ClusterName: prod
      NodeRole: 'arn:aws:iam::012345678910:role/eksInstanceRole'
      ScalingConfig:
        MinSize: 3
        DesiredSize: 5
        MaxSize: 7
      Labels:
        Key1: Value1
        Key2: Value2
      Subnets:
        - subnet-6782e71e
        - subnet-e7e761ac
      RemoteAccess:
        Ec2SshKey: ED25519",[[17]]
396,74a18d1a-cf02-4a31-8791-ed0967ad7fdc,Cognito UserPool Without MFA,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cognito_userpool_without_mfa,Unknown,"AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cognito-userpool.html)","Resources:
  UserPool:
    Type: ""AWS::Cognito::UserPool""
    Properties:
      UserPoolName: !Sub ${AuthName}-user-pool
      AutoVerifiedAttributes:
        - phone_number
      MfaConfiguration: ""ON""
      SmsConfiguration:
        ExternalId: !Sub ${AuthName}-external
        SnsCallerArn: !GetAtt SNSRole.Arn
  UserPool2:
    Type: ""AWS::Cognito::UserPool""
    Properties:
      UserPoolName: !Sub ${AuthName}-user-pool
      AutoVerifiedAttributes:
        - phone_number
      MfaConfiguration: ""OPTIONAL""
      SmsConfiguration:
        ExternalId: !Sub ${AuthName}-external
        SnsCallerArn: !GetAtt SNSRole.Arn","Resources:
  UserPool2:
    Type: ""AWS::Cognito::UserPool""
    Properties:
      UserPoolName: !Sub ${AuthName}-user-pool
      AutoVerifiedAttributes:
        - phone_number
      MfaConfiguration: ""OFF""
      SmsConfiguration:
        ExternalId: !Sub ${AuthName}-external
        SnsCallerArn: !GetAtt SNSRole.Arn
  UserPool4:
    Type: ""AWS::Cognito::UserPool""
    Properties:
      UserPoolName: !Sub ${AuthName}-user-pool
      AutoVerifiedAttributes:
        - phone_number
      SmsConfiguration:
        ExternalId: !Sub ${AuthName}-external
        SnsCallerArn: !GetAtt SNSRole.Arn","[[8, 14]]"
397,75be209d-1948-41f6-a8c8-e22dd0121134,ECR Repository Is Publicly Accessible,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecr_repository_is_publicly_accessible,Unknown,"Amazon ECR image repositories shouldn't have public access<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html)","Resources:
  MyRepository1:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal:
              AWS:
                - ""arn:aws:iam::123456789012:user/Bob""
                - ""arn:aws:iam::123456789012:user/Alice""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""","Resources:
  MyRepository3:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal: ""*""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""",[[6]]
398,76ddf32c-85b1-4808-8935-7eef8030ab36,Batch Job Definition With Privileged Container Properties,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/batch_job_definition_with_privileged_container_properties,Unknown,"Batch Job Definition should not have Privileged Container Properties<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-batch-jobdefinition.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  JobDefinition:
    Type: AWS::Batch::JobDefinition
    Properties:
      Type: container
      JobDefinitionName: nvidia-smi
      ContainerProperties:
        MountPoints:
          - ReadOnly: false
            SourceVolume: nvidia
            ContainerPath: /usr/local/nvidia
        Volumes:
          - Host:
              SourcePath: /var/lib/nvidia-docker/volumes/nvidia_driver/latest
            Name: nvidia
        Command:
          - nvidia-smi
        Memory: 2000
        Privileged: false
        JobRoleArn: String
        ReadonlyRootFilesystem: true
        Vcpus: 2
        Image: nvidia/cuda

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  JobDefinition1:
    Type: AWS::Batch::JobDefinition
    Properties:
      Type: container
      JobDefinitionName: nvidia-smi
      ContainerProperties:
        MountPoints:
          - ReadOnly: false
            SourceVolume: nvidia
            ContainerPath: /usr/local/nvidia
        Volumes:
          - Host:
              SourcePath: /var/lib/nvidia-docker/volumes/nvidia_driver/latest
            Name: nvidia
        Command:
          - nvidia-smi
        Memory: 2000
        JobRoleArn: String
        ReadonlyRootFilesystem: true
        Vcpus: 2
        Image: nvidia/cuda","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  JobDefinition:
    Type: AWS::Batch::JobDefinition
    Properties:
      Type: container
      JobDefinitionName: nvidia-smi
      ContainerProperties:
        MountPoints:
          - ReadOnly: false
            SourceVolume: nvidia
            ContainerPath: /usr/local/nvidia
        Volumes:
          - Host:
              SourcePath: /var/lib/nvidia-docker/volumes/nvidia_driver/latest
            Name: nvidia
        Command:
          - nvidia-smi
        Memory: 2000
        Privileged: true
        JobRoleArn: String
        ReadonlyRootFilesystem: true
        Vcpus: 2
        Image: nvidia/cuda

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  JobDefinition:
    Type: AWS::Batch::JobDefinition
    Properties:
      Type: container
      JobDefinitionName: nvidia-smi
      ContainerProperties:
        MountPoints:
          - ReadOnly: false
            SourceVolume: nvidia
            ContainerPath: /usr/local/nvidia
        Volumes:
          - Host:
              SourcePath: /var/lib/nvidia-docker/volumes/nvidia_driver/latest
            Name: nvidia
        Command:
          - nvidia-smi
        Memory: 2000
        Privileged: ""true""
        JobRoleArn: String
        ReadonlyRootFilesystem: true
        Vcpus: 2
        Image: nvidia/cuda","[[21], [21]]"
399,7772bb8c-c0f3-42d4-8e4e-f1b8939ad085,S3 Bucket Access to Any Principal,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_access_to_any_principal,Unknown,"The S3 Bucket should not be associated with a policy statement that grants access to any principal<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","Resources:
  Bucket:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy: false
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref Bucket
      PolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            AWS:
            - arn:aws:iam::111122223333:user/Alice
            - arn:aws:iam::111122223333:user/foo
          Action: s3:GetObject
          Resource: arn:aws:s3:::DOC-EXAMPLE-BUCKET/*
          Condition:
            StringLike:
              'aws:Referer':
                - 'http://www.example.com/*'
                - 'http://example.net/*'

Resources:

  SWBS3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: Private
      BucketName: !Ref S3BucketName
      LifecycleConfiguration:
        Rules:
          - Id: Rule to delete object versions in S3 bucket after 1 day
            Status: Enabled
            NoncurrentVersionExpirationInDays: 1
      VersioningConfiguration:
        Status: Enabled
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              KMSMasterKeyID:
                Fn::ImportValue: !Sub ""${CoreSWBStackName}-kms-key-arn""
              SSEAlgorithm: 'aws:kms'

  S3BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref SWBS3Bucket
      PolicyDocument:
        Statement:
        - !If
          - IsGLZReplicationEnabled
          - Effect: Allow
            Principal:
              AWS: !Sub ""arn:aws:iam::${DestinationS3BucketAccountId}:root""
            Action:
              - 's3:ReplicateDelete'
              - 's3:ReplicateObject'
              - 's3:ObjectOwnerOverrideToBucketOwner'
            Resource:
              - !Join [ '',[ 'arn:aws:s3:::', !Ref S3BucketName, '/*' ] ]
          - !Ref 'AWS::NoValue'
        - !If
          - IsGLZReplicationEnabled
          - Effect: Allow
            Principal:
              AWS: !Sub ""arn:aws:iam::${DestinationS3BucketAccountId}:root""
            Action:
              - 's3:List*'
              - 's3:GetBucketVersioning'
              - 's3:PutBucketVersioning'
            Resource:
              - !Join [ '',[ 'arn:aws:s3:::', !Ref S3BucketName ] ]
          - !Ref 'AWS::NoValue'
        - Effect: Deny
          Principal: '*'
          Action: 's3:*'
          Resource:
            - !GetAtt 'SWBS3Bucket.Arn'
            - !Sub '${SWBS3Bucket.Arn}/*'
          Condition:
            Bool:
              'aws:SecureTransport': false
        - Effect: Deny
          Principal: '*'
          Action: 's3:*'
          Resource:
            - !GetAtt 'SWBS3Bucket.Arn'
            - !Sub '${SWBS3Bucket.Arn}/*'
          Condition:
            NumericLessThan:
              's3:TlsVersion': '1.2'","Resources:
  Bucket:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy: false
        IgnorePublicAcls: true
        RestrictPublicBuckets: false
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref Bucket
      PolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            AWS:
            - ""*""
          Action: s3:GetObject
          Resource: arn:aws:s3:::DOC-EXAMPLE-BUCKET/*
          Condition:
            StringLike:
              'aws:Referer':
                - 'http://www.example.com/*'
                - 'http://example.net/*'
  Bucket2:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy: false
        IgnorePublicAcls: false
        RestrictPublicBuckets: true
  BucketPolicy2:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref Bucket2
      PolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            AWS:
            - ""*""
          Action: s3:GetObject
          Resource: arn:aws:s3:::DOC-EXAMPLE-BUCKET/*
          Condition:
            StringLike:
              'aws:Referer':
                - 'http://www.example.com/*'
                - 'http://example.net/*'

Resources:

  SWBS3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      AccessControl: Private
      BucketName: !Ref S3BucketName
      LifecycleConfiguration:
        Rules:
          - Id: Rule to delete object versions in S3 bucket after 1 day
            Status: Enabled
            NoncurrentVersionExpirationInDays: 1
      VersioningConfiguration:
        Status: Enabled
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              KMSMasterKeyID:
                Fn::ImportValue: !Sub ""${CoreSWBStackName}-kms-key-arn""
              SSEAlgorithm: 'aws:kms'

  S3BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref SWBS3Bucket
      PolicyDocument:
        Statement:
        - !If
          - IsGLZReplicationEnabled
          - Effect: Allow
            Principal:
              AWS: !Sub ""arn:aws:iam::${DestinationS3BucketAccountId}:root""
            Action:
              - 's3:ReplicateDelete'
              - 's3:ReplicateObject'
              - 's3:ObjectOwnerOverrideToBucketOwner'
            Resource:
              - !Join [ '',[ 'arn:aws:s3:::', !Ref S3BucketName, '/*' ] ]
          - !Ref 'AWS::NoValue'
        - !If
          - IsGLZReplicationEnabled
          - Effect: Allow
            Principal: '*'
            Action:
              - 's3:List*'
              - 's3:GetBucketVersioning'
              - 's3:PutBucketVersioning'
            Resource:
              - !Join [ '',[ 'arn:aws:s3:::', !Ref S3BucketName ] ]
          - !Ref 'AWS::NoValue'
        - Effect: Deny
          Principal: '*'
          Action: 's3:*'
          Resource:
            - !GetAtt 'SWBS3Bucket.Arn'
            - !Sub '${SWBS3Bucket.Arn}/*'
          Condition:
            Bool:
              'aws:SecureTransport': false
        - Effect: Deny
          Principal: '*'
          Action: 's3:*'
          Resource:
            - !GetAtt 'SWBS3Bucket.Arn'
            - !Sub '${SWBS3Bucket.Arn}/*'
          Condition:
            NumericLessThan:
              's3:TlsVersion': '1.2'","[[2, 27], [3]]"
400,77b6f1e2-bde4-4a6a-ae7e-a40659ff1576,EC2 Network ACL Overlapping Ports,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/385.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_network_acl_overlapping_ports,Unknown,"NetworkACL Entries are reusing or overlapping ports which may create ineffective rules<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-networkaclentry-portrange.html)","Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 13
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 173.20.0.0/24
       PortRange:
         From: 24
         To: 25","Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 13
         To: 22
  OutboundRule:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 173.20.0.0/24
       PortRange:
         From: 12
         To: 20
  OutboundTests:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 175.20.0.0/24
       PortRange:
         From: 20
         To: 25
  InboundTests:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 151.20.0.0/24
       PortRange:
         From: 6
         To: 13
  Default:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 150.20.0.0/24
       PortRange:
         From: 1
         To: 2
  Match:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 121.20.0.0/24
       PortRange:
         From: 3
         To: 5
  EqualMatch:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 120.20.0.0/24
       PortRange:
         From: 3
         To: 5","[[42, 78, 18, 54, 90, 30]]"
401,78055456-f670-4d2e-94d5-392d1cf4f5e4,ELB Sensitive Port Is Exposed To Entire Network,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_sensitive_port_is_exposed_to_entire_network,Unknown,"The load balancer of the application with a sensitive port connection is exposed to the entire internet.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  MyLoadBalancer:
      Type: AWS::ElasticLoadBalancing::LoadBalancer
      Properties:
        AvailabilityZones:
        - ""us-east-2a""
        CrossZone: true
        Scheme: internet-facing
        Listeners:
        - InstancePort: '80'
          InstanceProtocol: HTTP
          LoadBalancerPort: '443'
          Protocol: HTTPS
          PolicyNames:
          - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
        HealthCheck:
          Target: HTTP:80/
          HealthyThreshold: '2'
          UnhealthyThreshold: '3'
          Interval: '10'
          Timeout: '5'
        SecurityGroups:
          [ !Ref LBNegativeSecGroup01 ]
        Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
          - Name: Reference-Security-Policy
            Value: ELBSecurityPolicy-TLS-1-2-2017-01
  LBNegativeSecGroup01:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/32
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/32
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  MySubnets:
    Description: ""My subnet""
    Type: List<String>
Resources:
  ApplicationLoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: ip-target-alb
      Subnets: !Ref MySubnets
      SecurityGroups:
        - !Ref ALBNegativeSecGroup
      Tags:
        - Key: Name
          Value: ip-target-alb
  ALBNegativeSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/32
        - IpProtocol: tcp
          FromPort: 77
          ToPort: 77
          CidrIp: 127.0.0.1/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  HTTPALBListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      LoadBalancerArn: !Ref ApplicationLoadBalancer
      Port: 80
      Protocol: HTTP
      DefaultActions:
          - Type: forward
            TargetGroupArn: !Ref IPTargetGroup
  IPTargetGroup:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
        VpcId: my-vpc
        Port: 80
        Protocol: HTTP
        TargetType: ip
        Matcher:
            HttpCode: '200'
        HealthCheckIntervalSeconds: 10
        HealthCheckPath: /health/check
        HealthCheckProtocol: HTTP
        HealthCheckTimeoutSeconds: 5
        HealthyThresholdCount: 2
        UnhealthyThresholdCount: 2
  TestListenerRule1:
    Type: ""AWS::ElasticLoadBalancingV2::ListenerRule""
    Properties:
        Priority: 1
        ListenerArn: !Ref HTTPALBListener
        Conditions:
          - Field: ""host-header""
            Values:
              - ""test1.checkmarx.com""
        Actions:
          - Type: ""forward""
            TargetGroupArn: !Ref IPTargetGroup
            Order: 1
            ForwardConfig:
                TargetGroups:
                  - TargetGroupArn: !Ref IPTargetGroup
                    Weight: 1
                TargetGroupStickinessConfig:
                    Enabled: false

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  MySubnet:
    Description: ""My subnet""
    Type: List<String>
Resources:
  NetworkLoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: t10-networkloadbalancer
      Scheme: internet-facing
      Subnets: !Ref MySubnet
      Type: network
      Tags:
        - Key: Name
          Value: t10-networklb
  InstancesNegativeSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/32
        - IpProtocol: tcp
          FromPort: 77
          ToPort: 77
          CidrIp: 127.0.0.1/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  EC2Instance01:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.2xlarge
      SecurityGroups: [!Ref 'InstancesNegativeSecGroup']
      KeyName: my-rsa-key
      ImageId: ami-79fd7eee
  EC2Instance02:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.2xlarge
      SecurityGroups: [!Ref 'InstancesNegativeSecGroup']
      KeyName: my-rsa-key
      ImageId: ami-79fd7eee
  NetworkLoadBalancerTargetGroup:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
      Name: t10-networklb-target
      Port: 443
      Protocol: TCP
      VpcId: t10-vpc-id
      TargetGroupAttributes:
        - Key: deregistration_delay.timeout_seconds
          Value: 60
      Targets:
      - Id: !Ref EC2Instance01
        Port: 443
      - Id: !Ref EC2Instance02
        Port: 443
      Tags:
        - Key: Name
          Value: t10-networklb-target
  NetworkLoadBalancerListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      DefaultActions:
      - Type: forward
        TargetGroupArn: !Ref NetworkLoadBalancerTargetGroup
      LoadBalancerArn: !Ref NetworkLoadBalancer
      Port: 443
      Protocol: TCP
  NetworkLoadBalancerListenerCert:
    Type: AWS::ElasticLoadBalancingV2::ListenerCertificate
    Properties:
      Certificates:
        - CertificateArn: arn:aws:acm:eu-west-1:xxxaccountxxx:certificate/123456....
      ListenerArn: !Ref NetworkLoadBalancerListener","AWSTemplateFormatVersion: 2010-09-09
Resources:
  MyLoadBalancer:
      Type: AWS::ElasticLoadBalancing::LoadBalancer
      Properties:
        AvailabilityZones:
        - ""us-east-2a""
        CrossZone: true
        Scheme: internet-facing
        Listeners:
        - InstancePort: '80'
          InstanceProtocol: HTTP
          LoadBalancerPort: '443'
          Protocol: HTTPS
          PolicyNames:
          - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
        HealthCheck:
          Target: HTTP:80/
          HealthyThreshold: '2'
          UnhealthyThreshold: '3'
          Interval: '10'
          Timeout: '5'
        SecurityGroups:
          - !Ref LBSecGroup
        Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
          - Name: Reference-Security-Policy
            Value: ELBSecurityPolicy-TLS-1-2-2017-01
  LBSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 50
          ToPort: 80
          CidrIp: 127.0.0.1/0
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 127.0.0.1/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  MySubnets:
    Description: ""My subnet""
    Type: List<String>
Resources:
  ApplicationLoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: ip-target-alb
      Subnets: !Ref MySubnets
      SecurityGroups:
        - !Ref ALBSecGroup
      Tags:
        - Key: Name
          Value: ip-target-alb
  ALBSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        - IpProtocol: tcp
          FromPort: 6379
          ToPort: 6379
          CidrIp: 127.0.0.1/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  HTTPALBListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      LoadBalancerArn: !Ref ApplicationLoadBalancer
      Port: 80
      Protocol: HTTP
      DefaultActions:
          - Type: forward
            TargetGroupArn: !Ref IPTargetGroup
  IPTargetGroup:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
        VpcId: my-vpc
        Port: 80
        Protocol: HTTP
        TargetType: ip
        Matcher:
            HttpCode: '200'
        HealthCheckIntervalSeconds: 10
        HealthCheckPath: /health/check
        HealthCheckProtocol: HTTP
        HealthCheckTimeoutSeconds: 5
        HealthyThresholdCount: 2
        UnhealthyThresholdCount: 2
  TestListenerRule1:
    Type: ""AWS::ElasticLoadBalancingV2::ListenerRule""
    Properties:
        Priority: 1
        ListenerArn: !Ref HTTPALBListener
        Conditions:
          - Field: ""host-header""
            Values:
              - ""test1.checkmarx.com""
        Actions:
          - Type: ""forward""
            TargetGroupArn: !Ref IPTargetGroup
            Order: 1
            ForwardConfig:
                TargetGroups:
                  - TargetGroupArn: !Ref IPTargetGroup
                    Weight: 1
                TargetGroupStickinessConfig:
                    Enabled: false

AWSTemplateFormatVersion: 2010-09-09
Parameters:
  MySubnet:
    Description: ""My subnet""
    Type: List<String>
Resources:
  GatewayLoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: my-gateway-load-balancer
      Scheme: internet-facing
      Type: gateway
      Subnets: !Ref MySubnet
  InstancesSecGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http and ssh
        VpcId: my-vpc
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        - IpProtocol: tcp
          FromPort: 636
          ToPort: 636
          CidrIp: 127.0.0.1/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 0.0.0.0/0
  EC2Instance01:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.2xlarge
      SecurityGroups:
      - !Ref 'InstancesSecGroup'
      KeyName: my-rsa-key
      ImageId: ami-79fd7eee
  EC2Instance02:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.2xlarge
      SecurityGroups:
      - !Ref 'InstancesSecGroup'
      KeyName: my-rsa-key
      ImageId: ami-79fd7eee
  GatewayLoadBalancerTargetGroup:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
      Name: t10-networklb-target
      Port: 443
      Protocol: TCP
      VpcId: t10-vpc-id
      TargetGroupAttributes:
        - Key: deregistration_delay.timeout_seconds
          Value: '60'
      Targets:
      - Id: !Ref EC2Instance01
        Port: 443
      - Id: !Ref EC2Instance02
        Port: 443
      Tags:
        - Key: Name
          Value: t10-networklb-target
  GatewayLoadBalancerListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      DefaultActions:
      - Type: forward
        TargetGroupArn: !Ref GatewayLoadBalancerTargetGroup
      LoadBalancerArn: !Ref GatewayLoadBalancer
      Port: 443
      Protocol: TCP
  GatewayLoadBalancerListenerCert:
    Type: AWS::ElasticLoadBalancingV2::ListenerCertificate
    Properties:
      Certificates:
        - CertificateArn: arn:aws:acm:eu-west-1:xxxaccountxxx:certificate/123456....
      ListenerArn: !Ref GatewayLoadBalancerListener","[[37], [22], [19]]"
402,783860a3-6dca-4c8b-81d0-7b62769ccbca,API Gateway Deployment Without API Gateway UsagePlan Associated,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_deployment_without_api_gateway_usage_plan_associated,Unknown,"API Gateway Deployment should have API Gateway UsagePlan defined and associated.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-deployment.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyRestApi
      Description: My deployment
      StageName: Prod
  usagePlan:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Deployment:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyRestApi
      Description: My deployment
      StageName: Prod

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Deployment1:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyRestApi
      Description: My deployment
      StageName: Prod
  usagePlan1:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod1
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Deployment2:
    Type: 'AWS::ApiGateway::Deployment'
    Properties:
      RestApiId: !Ref MyRestApi
      Description: My deployment
      StageName: Prod1
  usagePlan2:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC","[[4], [4], [4]]"
403,79d745f0-d5f3-46db-9504-bef73e9fd528,ECS Service Without Running Tasks,CloudFormation,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_service_without_running_tasks,Unknown,"ECS Service should have at least 1 task running<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html#cfn-ecs-service-deploymentconfiguration)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  AppName:
    Type: String
    Description: Name of app requiring ELB exposure
    Default: simple-app
  AppContainerPort:
    Type: Number
    Description: Container port of app requiring ELB exposure
    Default: '80'
  AppHostPort:
    Type: Number
    Description: Host port of app requiring ELB exposure
    Default: '80'
  ServiceName:
    Type: String
  LoadBalancerName:
    Type: String
  HealthCheckGracePeriodSeconds:
    Type: String
Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DeploymentConfiguration:
        MaximumPercent: 200
        MinimumHealthyPercent: 100
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: !Ref Role
  elb:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      LoadBalancerName: !Ref LoadBalancerName
      Listeners:
        - InstancePort: !Ref AppHostPort
          LoadBalancerPort: '80'
          Protocol: HTTP
      Subnets:
        - !Ref Subnet1
    DependsOn: GatewayAttachment
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/24
  Subnet1:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.0.0.0/25
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  GatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref VPC
  Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ecs.amazonaws.com
            Action: 'sts:AssumeRole'
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceRole'
Outputs:
  Cluster:
    Value: !Ref cluster","AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  AppName:
    Type: String
    Description: Name of app requiring ELB exposure
    Default: simple-app
  AppContainerPort:
    Type: Number
    Description: Container port of app requiring ELB exposure
    Default: '80'
  AppHostPort:
    Type: Number
    Description: Host port of app requiring ELB exposure
    Default: '80'
  ServiceName:
    Type: String
  LoadBalancerName:
    Type: String
  HealthCheckGracePeriodSeconds:
    Type: String
Resources:
  cluster:
    Type: AWS::ECS::Cluster
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name: !Ref AppName
          MountPoints:
            - SourceVolume: my-vol
              ContainerPath: /var/www/my-vol
          Image: amazon/amazon-ecs-sample
          Cpu: '10'
          PortMappings:
            - ContainerPort: !Ref AppContainerPort
              HostPort: !Ref AppHostPort
          EntryPoint:
            - /usr/sbin/apache2
            - '-D'
            - FOREGROUND
          Memory: '500'
          Essential: true
        - Name: busybox
          Image: busybox
          Cpu: '10'
          EntryPoint:
            - sh
            - '-c'
          Memory: '500'
          Command:
            - >-
              /bin/sh -c ""while true; do /bin/date > /var/www/my-vol/date; sleep
              1; done""
          Essential: false
          VolumesFrom:
            - SourceContainer: !Ref AppName
      Volumes:
        - Host:
            SourcePath: /var/lib/docker/vfs/dir/
          Name: my-vol
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref cluster
      DesiredCount: 0
      HealthCheckGracePeriodSeconds: !Ref HealthCheckGracePeriodSeconds
      LoadBalancers:
        - ContainerName: !Ref AppName
          ContainerPort: !Ref AppContainerPort
          LoadBalancerName: !Ref elb
      PlacementStrategies:
        - Type: binpack
          Field: memory
        - Type: spread
          Field: host
      PlacementConstraints:
        - Type: memberOf
          Expression: 'attribute:ecs.availability-zone != us-east-1d'
        - Type: distinctInstance
      TaskDefinition: !Ref taskdefinition
      ServiceName: !Ref ServiceName
      Role: !Ref Role
  elb:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      LoadBalancerName: !Ref LoadBalancerName
      Listeners:
        - InstancePort: !Ref AppHostPort
          LoadBalancerPort: '80'
          Protocol: HTTP
      Subnets:
        - !Ref Subnet1
    DependsOn: GatewayAttachment
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/24
  Subnet1:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.0.0.0/25
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  GatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref VPC
  Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: ecs.amazonaws.com
            Action: 'sts:AssumeRole'
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonEC2ContainerServiceRole'
Outputs:
  Cluster:
    Value: !Ref cluster",[[64]]
404,7f384a5f-b5a2-4d84-8ca3-ee0a5247becb,Empty Roles For ECS Cluster Task Definitions,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/empty_roles_for_ecs_cluster_task_definitions,Unknown,"Check if any ECS cluster has not defined proper roles for services' task definitions.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html)","Resources:
  ECSService:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  ECSTaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: !Ref 'ServiceName'
      Cpu: !Ref 'ContainerCpu'
      Memory: !Ref 'ContainerMemory'
      NetworkMode: awsvpc
      RequiresCompatibilities:
        - FARGATE
      ExecutionRoleArn:
        Fn::ImportValue:
          !Join [':', [!Ref 'StackName', 'ECSTaskExecutionRole']]
      TaskRoleArn:
        Fn::If:
          - 'HasCustomRole'
          - !Ref 'Role'
          - !Ref ""AWS::NoValue""
      ContainerDefinitions:
        - Name: !Ref 'ServiceName'
          Cpu: !Ref 'ContainerCpu'
          Memory: !Ref 'ContainerMemory'
          Image: !Ref 'ImageUrl'
          PortMappings:
            - ContainerPort: !Ref 'ContainerPort'","Resources:
  NoTaskDefinition:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      DesiredCount: 1
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  InvalidTaskDefinition:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: MissingTaskDefinition
      DesiredCount: 1
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  TaskNoRole:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  ECSTaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: !Ref 'ServiceName'
      Cpu: !Ref 'ContainerCpu'
      Memory: !Ref 'ContainerMemory'
      NetworkMode: awsvpc
      RequiresCompatibilities:
        - FARGATE
      ExecutionRoleArn:
        Fn::ImportValue:
          !Join [':', [!Ref 'StackName', 'ECSTaskExecutionRole']]
      ContainerDefinitions:
        - Name: !Ref 'ServiceName'
          Cpu: !Ref 'ContainerCpu'
          Memory: !Ref 'ContainerMemory'
          Image: !Ref 'ImageUrl'
          PortMappings:
            - ContainerPort: !Ref 'ContainerPort'","[[24, 41, 6]]"
405,7f65be75-90ab-4036-8c2a-410aef7bb650,Kinesis SSE Not Configured,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/kinesis_sse_not_configured,Unknown,"AWS Kinesis Stream should have SSE (Server Side Encryption) defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kinesis-stream.html)","Resources:
  EventStream:
    Type: AWS::Kinesis::Stream
    Properties:
      Name: EventStream
      RetentionPeriodHours: 24
      ShardCount: 1
      StreamEncryption:
            EncryptionType: KMS
            KeyId: !Ref myKey
      Tags:
        - Key: Name
          Value: !Sub ${EnvironmentName}-EventStream-${AWS::Region}","Resources:
  EventStream1:
    Type: AWS::Kinesis::Stream
    Properties:
      Name: EventStream
      RetentionPeriodHours: 24
      ShardCount: 1
      StreamEncryption:
            EncryptionType: KMS
      Tags:
        - Key: Name
          Value: !Sub ${EnvironmentName}-EventStream-${AWS::Region}
  EventStream2:
    Type: AWS::Kinesis::Stream
    Properties:
      Name: EventStream
      RetentionPeriodHours: 24
      ShardCount: 1
      StreamEncryption:
            KeyId: !Ref myKey
      Tags:
        - Key: Name
          Value: !Sub ${EnvironmentName}-EventStream-${AWS::Region}
  EventStream3:
    Type: AWS::Kinesis::Stream
    Properties:
      Name: EventStream
      RetentionPeriodHours: 24
      ShardCount: 1
      Tags:
        - Key: Name
          Value: !Sub ${EnvironmentName}-EventStream-${AWS::Region}","[[8, 26, 19]]"
406,7f8843f0-9ea5-42b4-a02b-753055113195,Geo Restriction Disabled,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/geo_restriction_disabled,Unknown,"Geo Restriction feature should be enabled, to restrict or allow users in specific locations accessing web application content<br>
[Documentation](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/georestrictions.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Logging:
          IncludeCookies: 'false'
          Bucket: mylogs.s3.amazonaws.com
          Prefix: myprefix
        Restrictions:
          GeoRestriction:
            RestrictionType: whitelist
            Locations:
            - AQ
            - CV
        ViewerCertificate:
          CloudFrontDefaultCertificate: 'true'","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Logging:
          IncludeCookies: 'false'
          Bucket: mylogs.s3.amazonaws.com
          Prefix: myprefix
        Restrictions:
          GeoRestriction:
            RestrictionType: none
        ViewerCertificate:
          CloudFrontDefaultCertificate: 'true'",[[13]]
407,7f8f1b60-43df-4c28-aa21-fb836dbd8071,API Gateway Stage Without API Gateway UsagePlan Associated,CloudFormation,Low,Resource Management,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_stage_without_api_gateway_usage_plan_associated,Unknown,"API Gateway Stage should have API Gateway UsagePlan defined and associated.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-stage.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
  usagePlan:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Prod1:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
  usagePlan1:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod1
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  Prod2:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi1
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
  usagePlan2:
    Type: 'AWS::ApiGateway::UsagePlan'
    Properties:
      ApiStages:
        - ApiId: !Ref MyRestApi
          Stage: !Ref Prod
      Description: Customer ABC's usage plan
      Quota:
        Limit: 5000
        Period: MONTH
      Throttle:
        BurstLimit: 200
        RateLimit: 100
      UsagePlanName: Plan_ABC","[[4], [4], [4]]"
408,7fd0d461-5b8c-4815-898c-f2b4b117eb28,API Gateway Without Configured Authorizer,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_without_configured_authorizer,Unknown,"API Gateway REST API should have an API Gateway Authorizer<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-authorizer.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  DevWebSocket2:
    Type: 'AWS::ApiGatewayV2::Api'
    Properties:
      Name: TL-Dev-WebSocket-API
      ProtocolType: WEBSOCKET
      RouteSelectionExpression: $request.body.action
  DevAuthorizerLambda:
    Type: 'AWS::Serverless::Function'
    Properties:
      CodeUri: WebSockets/Authorizer
      Role: 'arn:aws:iam::************:role/LambdaDynamoDB'
      Environment:
        Variables:
          STAGE: Dev
  DevAuthorizerLambdaPermission:
    Type: 'AWS::Lambda::Permission'
    Properties:
      Action: 'lambda:invokeFunction'
      Principal: apigateway.amazonaws.com
      FunctionName:
        Ref: DevAuthorizerLambda
      SourceArn:
        'Fn::Sub':
          - >-
            arn:aws:execute-api:${AWS::Region}:${AWS::AccountId}:${__ApiId__}/${__Stage__}/$connect
          - __Stage__: '*'
            __ApiId__:
              Ref: DevWebSocket
  DevWebSocketAuthorizer:
    Type: 'AWS::ApiGatewayV2::Authorizer'
    Properties:
      Name: DevAuthorizer
      ApiId:
        Ref: DevWebSocket2
      AuthorizerType: REQUEST
      AuthorizerUri:
        'Fn::Sub': >-
          arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${DevAuthorizerLambda.Arn}/invocations
      IdentitySource:
        - route.request.querystring.token

AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyRestApi2:
        Type: AWS::ApiGateway::RestApi
        Properties:
          EndpointConfiguration:
            Types:
              - PRIVATE
          Name: myRestApi
    Authorizer:
        Type: 'AWS::ApiGateway::Authorizer'
        Properties:
          RestApiId: !Ref MyRestApi2","AWSTemplateFormatVersion: 2010-09-09
Resources:
  DevWebSocket:
    Type: 'AWS::ApiGatewayV2::Api'
    Properties:
      Name: TL-Dev-WebSocket-API
      ProtocolType: WEBSOCKET
      RouteSelectionExpression: $request.body.action

AWSTemplateFormatVersion: 2010-09-09
Resources:
  DevWebSocket5:
    Type: 'AWS::ApiGatewayV2::Api'
    Properties:
      Name: TL-Dev-WebSocket-API
      ProtocolType: WEBSOCKET
      RouteSelectionExpression: $request.body.action
  DevAuthorizerLambda5:
    Type: 'AWS::Serverless::Function'
    Properties:
      CodeUri: WebSockets/Authorizer
      Role: 'arn:aws:iam::************:role/LambdaDynamoDB'
      Environment:
        Variables:
          STAGE: Dev
  DevAuthorizerLambdaPermission5:
    Type: 'AWS::Lambda::Permission'
    Properties:
      Action: 'lambda:invokeFunction'
      Principal: apigateway.amazonaws.com
      FunctionName:
        Ref: DevAuthorizerLambda
      SourceArn:
        'Fn::Sub':
          - >-
            arn:aws:execute-api:${AWS::Region}:${AWS::AccountId}:${__ApiId__}/${__Stage__}/$connect
          - __Stage__: '*'
            __ApiId__:
              Ref: DevWebSocket
  DevWebSocketAuthorizer5:
    Type: 'AWS::ApiGatewayV2::Authorizer'
    Properties:
      Name: DevAuthorizer
      ApiId:
        Ref: DevWebSocket222222
      AuthorizerType: REQUEST
      AuthorizerUri:
        'Fn::Sub': >-
          arn:aws:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${DevAuthorizerLambda.Arn}/invocations
      IdentitySource:
        - route.request.querystring.token

AWSTemplateFormatVersion: 2010-09-09
Resources:
    MyRestApi6:
        Type: AWS::ApiGateway::RestApi
        Properties:
          EndpointConfiguration:
            Types:
              - PRIVATE
          Name: myRestApi","[[3], [3], [3]]"
409,800fa019-49dd-421b-9042-7331fdd83fa2,High Access Key Rotation Period,CloudFormation,Medium,Secret Management,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/access_key_not_rotated_within_90_days,Unknown,"ConfigRule should enforce access keys to be rotated within 90 days.<br>
[Documentation](https://docs.aws.amazon.com/en_us/config/latest/developerguide/access-keys-rotated.html)","Resources:
  ConfigRule:
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: access-keys-rotated
      InputParameters:
        maxAccessKeyAge: 90
      Source:
        Owner: AWS
        SourceIdentifier: ACCESS_KEYS_ROTATED
      MaximumExecutionFrequency: TwentyFour_Hours","Resources:
  ConfigRule:
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: access-keys-rotated
      InputParameters:
        maxAccessKeyAge: 100
      Source:
        Owner: AWS
        SourceIdentifier: ACCESS_KEYS_ROTATED
      MaximumExecutionFrequency: TwentyFour_Hours",[[7]]
410,80908a75-586b-4c61-ab04-490f4f4525b8,ELB Without Secure Protocol,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_without_secure_protocol,Unknown,"Check if the ELB is setup with SSL or HTTPS for secure communication<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html)","#this code is a correct code for which the query should not find any result
Resources:
    MyLoadBalancer1:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTPS
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01

#this code is a correct code for which the query should not find any result
Resources:
    MyLoadBalancer2:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '9443'
            InstanceProtocol: SSL
            LoadBalancerPort: '443'
            Protocol: SSL
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","#this is a problematic code where the query should report a result(s)
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTP
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","[[11, 13]]"
411,809f77f8-d10e-4842-a84f-3be7b6ff1190,ELB Using Weak Ciphers,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_using_weak_ciphers,Unknown,"ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the ELB Listeners must not have Policies that posses Ciphers that coincide with any of a predefined list of weak ciphers.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html)","#this code is a correct code for which the query should not find any result
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","#this is a problematic code where the query should report a result(s)
Resources:
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
          AvailabilityZones:
          - ""us-east-2a""
          CrossZone: true
          Listeners:
          - InstancePort: '80'
            InstanceProtocol: HTTP
            LoadBalancerPort: '443'
            Protocol: HTTPS
            PolicyNames:
            - My-SSLNegotiation-Policy
            SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
          HealthCheck:
            Target: HTTP:80/
            HealthyThreshold: '2'
            UnhealthyThreshold: '3'
            Interval: '10'
            Timeout: '5'
          Policies:
          - PolicyName: My-SSLNegotiation-Policy
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: TLS_RSA_NULL_SHA1
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
            - Name: DHE-DSS-DES-CBC3-SHA
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
          - PolicyName: My-SSLNegotiation-Policy2
            PolicyType: SSLNegotiationPolicyType
            Attributes:
            - Name: TLS_DHE_PSK_WITH_NULL_SHA256
              Value: ELBSecurityPolicy-TLS-1-2-2017-01","[[34, 27, 29]]"
412,80b7ac3f-d2b7-4577-9b10-df7913497162,EBS Volume Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ebs_volume_encryption_disabled,Unknown,"EBS volumes should be encrypted<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume""
Resources:
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      Encrypted: true
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: MyTag
          Value: TagValue
    DeletionPolicy: Snapshot

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume""
Resources:
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      Encrypted: ""true""
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: MyTag
          Value: TagValue
    DeletionPolicy: Snapshot","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume""
Resources:
  NewVolume:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      Encrypted: false
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: MyTag
          Value: TagValue
    DeletionPolicy: Snapshot

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Volume 02""
Resources:
  NewVolume02:
    Type: AWS::EC2::Volume
    Properties:
      Size: 100
      AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
      Tags:
        - Key: MyTag
          Value: TagValue
    DeletionPolicy: Snapshot","[[8], [6]]"
413,80d45af4-4920-4236-a56e-b7ef419d1941,API Gateway V2 Stage Access Logging Settings Not Defined,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_access_logging_disabled,Unknown,"API Gateway Stage should have Access Logging Settings defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigatewayv2-stage.html#cfn-apigatewayv2-stage-accesslogsettings)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Resources:
  MyStage:
    Type: 'AWS::ApiGatewayV2::Stage'
    Properties:
      StageName: Prod
      Description: Prod Stage
      DeploymentId: !Ref MyDeployment
      ApiId: !Ref CFNWebSocket
      DefaultRouteSettings:
        DetailedMetricsEnabled: true
        LoggingLevel: INFO
        DataTraceEnabled: false
        ThrottlingBurstLimit: 10
        ThrottlingRateLimit: 10
      AccessLogSettings:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}","Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      AccessLogSetting: 
        DestinationArn: ""dest""
        Format: ""format""
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: """"
      ClientCertificateId: """"
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: false
          DataTraceEnabled: false
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: false
          DataTraceEnabled: false
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: true
          DataTraceEnabled: false

Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      AccessLogSetting: 
        DestinationArn: ""dest""
        Format: ""format""
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: """"
      MethodSettings:","[[16], [4, 13]]"
414,818f38ed-8446-4132-9c03-474d49e10195,SNS Topic Publicity Has Allow and NotAction Simultaneously,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sns_topic_publicity_has_allow_and_not_action_simultaneously,Unknown,"SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-iam.html#scenario-sns-policy)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  mysnspolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      PolicyDocument:
        Id: MyTopicPolicy
        Version: '2012-10-17'
        Statement:
        - Sid: Mystatementid
          Effect: Allow
          Principal:
            AWS: !GetAtt myuser.Arn
          Action: sns:Publish
          Resource: ""*""
      Topics:
      - !Ref mytopic","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  mysnspolicy:
    Type: AWS::SNS::TopicPolicy
    Properties:
      PolicyDocument:
        Id: MyTopicPolicy
        Version: '2012-10-17'
        Statement:
        - Sid: MyStatementId
          Effect: Allow
          NotAction: ""s3:DeleteBucket""
          Resource: ""arn:aws:s3:::*""
        - Sid: MyStatementId2
          Effect: Allow
          NotAction: ""iam:*""
          Resource: ""*""
      Topics:
      - !Ref mytopic",[[7]]
415,8275fab0-68ec-4705-bbf4-86975edb170e,API Gateway Without Security Policy,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_without_security_policy,Unknown,"API Gateway should have a Security Policy defined and use TLS 1.2.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-domainname.html#cfn-apigateway-domainname-securitypolicy)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Parameters:
  cfnDomainName:
    Type: String
  certificateArn:
    Type: String
  type:
    Type: String
Resources:
  myDomainName:
    Type: AWS::ApiGateway::DomainName
    Properties:
      CertificateArn: !Ref certificateArn
      DomainName: !Ref cfnDomainName
      EndpointConfiguration:
        Types:
          - !Ref type
      RegionalCertificateArn: !Ref certificateArn
      SecurityPolicy: ""TLS_1_2""
Outputs:
  DomainName:
    Value: !Ref myDomainName","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Parameters:
  cfnDomainName:
    Type: String
  certificateArn:
    Type: String
  type:
    Type: String
Resources:
  myDomainName:
    Type: AWS::ApiGateway::DomainName
    Properties:
      CertificateArn: !Ref certificateArn
      DomainName: !Ref cfnDomainName
      EndpointConfiguration:
        Types:
          - !Ref type
      RegionalCertificateArn: !Ref certificateArn
      SecurityPolicy: ""TLS_1_0""
Outputs:
  DomainName:
    Value: !Ref myDomainName

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Router53""
Parameters:
  cfnDomainName:
    Type: String
  certificateArn:
    Type: String
  type:
    Type: String
Resources:
  myDomainName1:
    Type: AWS::ApiGateway::DomainName
    Properties:
      CertificateArn: !Ref certificateArn
      DomainName: !Ref cfnDomainName
      EndpointConfiguration:
        Types:
          - !Ref type
      RegionalCertificateArn: !Ref certificateArn
Outputs:
  DomainName:
    Value: !Ref myDomainName","[[20], [13]]"
416,829ce3b8-065c-41a3-ad57-e0accfea82d2,Unknown Port Exposed To Internet,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/unknown_port_exposed_to_internet,Unknown,"AWS Security Group should not have an unknown port exposed to the entire Internet<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Expose known ports to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 20
          ToPort: 23
          CidrIp: 0.0.0.0/0","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Expose unknown port to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 23
          ToPort: 25
          CidrIp: 0.0.0.0/0",[[9]]
417,835d5497-a526-4aea-a23f-98a9afd1635f,S3 Bucket ACL Allows Read to Any Authenticated User,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_acl_allows_read_to_any_authenticated_user,Unknown,"S3 Buckets should not be readable to any authenticated user<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts03:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: BucketOwnerFullControl
      BucketName: jenkins-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts04:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: Private
      BucketName: jenkins-secret-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ''

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts05:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicReadWrite
      BucketName: jenkins-secret-artifacts2
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: AuthenticatedRead
      BucketName: jenkins-artifacts
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  StaticPage01:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: AuthenticatedRead
      BucketName: public-read-static-page01
      WebsiteConfiguration:
        ErrorDocument: 404.html
        IndexDocument: index.html
      Tags:
        - Key: CostCenter
          Value: ITEngineering

AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  JenkinsArtifacts02:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: AuthenticatedRead
      BucketName: jenkins-artifacts-block-public
      PublicAccessBlockConfiguration:
        BlockPublicPolicy: false
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD","[[7], [7], [7]]"
418,837e033c-4717-40bd-807e-6abaa30161b7,Stack Notifications Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/stack_notifications_disabled,Unknown,"AWS CloudFormation should have stack notifications enabled to be notified when an event occurs<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-stack.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myStackWithParams:
    Type: AWS::CloudFormation::Stack
    Properties:
      NotificationARNs:
        - ""String""
      TemplateURL: https://s3.amazonaws.com/cloudformation-templates-us-east-2/EC2ChooseAMI.template
      Parameters:
        InstanceType: t1.micro
        KeyName: mykey","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myStackWithParams:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: https://s3.amazonaws.com/cloudformation-templates-us-east-2/EC2ChooseAMI.template
      Parameters:
        InstanceType: t1.micro
        KeyName: mykey",[[5]]
419,85138beb-ce7c-4ca3-a09f-e8fbcc57ddd7,Cross-Account IAM Assume Role Policy Without ExternalId or MFA,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cross_account_iam_assume_role_policy_without_external_id_or_mfa,Unknown,"Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-role.html#cfn-iam-role-assumerolepolicydocument)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
            ""Version"": ""2012-10-17"",
            ""Statement"": [
              {
                ""Action"": ""sts:AssumeRole"",
                ""Principal"": {
                  ""AWS"": ""arn:aws:iam::987654321145:root""
                },
                ""Effect"": ""Allow"",
                ""Resource"": ""*"",
                ""Sid"": """",
                ""Condition"": {
                  ""StringEquals"": {
                    ""sts:ExternalId"": ""98765""
                  }
                }
              }
            ]
        }

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
            ""Version"": ""2012-10-17"",
            ""Statement"": [
              {
                ""Action"": ""sts:AssumeRole"",
                ""Principal"": {
                  ""AWS"": ""arn:aws:iam::987654321145:root""
                },
                ""Effect"": ""Allow"",
                ""Resource"": ""*"",
                ""Sid"": """",
                ""Condition"": { 
                  ""Bool"": { 
                      ""aws:MultiFactorAuthPresent"": ""true"" 
                    }
                }
              }
            ]
        }","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
          ""Version"": ""2012-10-17"",
          ""Statement"": [
            {
              ""Action"": ""sts:AssumeRole"",
              ""Principal"": {
                ""AWS"": ""arn:aws:iam::987654321145:root""
              },
              ""Effect"": ""Allow"",
              ""Resource"": ""*"",
              ""Sid"": """"
            }
          ]
        }

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
          ""Version"": ""2012-10-17"",
          ""Statement"": {
                ""Action"": ""sts:AssumeRole"",
                ""Principal"": {
                  ""AWS"": ""arn:aws:iam::987654321145:root""
                },
                ""Effect"": ""Allow"",
                ""Resource"": ""*"",
                ""Sid"": """",
                ""Condition"": { 
                  ""Bool"": { 
                      ""aws:MultiFactorAuthPresent"": ""false"" 
                    }
                }
          }
        }","[[6], [6]]"
420,860ba89b-b8de-4e72-af54-d6aee4138a69,S3 Bucket Allows Public Policy,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_with_public_policy,Unknown,"S3 bucket allows public policy<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html)","Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : ""true""
        BlockPublicPolicy     : ""true""
        IgnorePublicAcls      : ""true""
        RestrictPublicBuckets : ""true""

Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : true
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true","Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        RestrictPublicBuckets : true
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false
        BlockPublicPolicy     : false
        IgnorePublicAcls      : false
        RestrictPublicBuckets : true

Resources:
  Bucket11:
    Type: AWS::S3::Bucket
    Properties:
---
Resources:
  Bucket12:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        RestrictPublicBuckets : ""true""
---
Resources:
  Bucket13:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls: ""false""
        BlockPublicPolicy     : ""false""
        IgnorePublicAcls      : ""false""
        RestrictPublicBuckets : ""true""","[[10, 19, 4], [10, 19, 4]]"
421,86a248ab-0e01-4564-a82a-878303e253bb,ElasticSearch Not Encrypted At Rest,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_not_encrypted_at_rest,Unknown,"Check if ElasticSearch encryption is disabled at Rest<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-encryptionatrestoptions)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EncryptionAtRestOptions:
        Enabled: ""true""
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EncryptionAtRestOptions:
        Enabled: true
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EncryptionAtRestOptions:
        Enabled: false
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain1:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","[[16], [6]]"
422,87482183-a8e7-4e42-a566-7a23ec231c16,Security Group Ingress With Port Range,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_ingress_with_port_range,Unknown,"AWS Security Group Ingress should have a single port<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 87
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 87
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[8, 37]]"
423,88d55d94-315d-4564-beee-d2d725feab11,SageMaker Enabling Internet Access,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sagemaker_enabling_internet_access,Unknown,"SageMaker must have disabled internet access and root access for Creating Notebook Instances.<br>
[Documentation](https://docs.aws.amazon.com/sagemaker/latest/dg/security_iam_id-based-policy-examples.html#sagemaker-condition-nbi-lockdown)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Internet access and root access for Creating Notebook Instances""
Resources:
  Notebook:
    Type: AWS::SageMaker::NotebookInstance
    Properties:
      DirectInternetAccess: ""Disabled""
      InstanceType: ""ml.c4.2xlarge""
      RoleArn: ""role""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Internet access and root access for Creating Notebook Instances""
Resources:
  Notebook:
    Type: AWS::SageMaker::NotebookInstance
    Properties:
      DirectInternetAccess: ""Enabled""
      InstanceType: ""ml.c4.2xlarge""
      RoleArn: ""role""",[[7]]
424,89827c57-5a8a-49eb-9731-976a606d70db,Workspace Without Encryption,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/workspace_without_encryption,Unknown,"Workspaces should have encryption enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-workspaces-workspace.html)","Resources:
  MyWorkSpace:
    Type: AWS::WorkSpaces::Workspace
    Properties:
      BundleId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - BundleId
      DirectoryId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - DirectoryId
      UserName: !Ref 'UserName'
      UserVolumeEncryptionEnabled: true

Resources:
  MyWorkSpace2:
    Type: AWS::WorkSpaces::Workspace
    Properties:
      BundleId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - BundleId
      DirectoryId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - DirectoryId
      UserName: !Ref 'UserName'
      UserVolumeEncryptionEnabled: 'true'","Resources:
  MyWorkSpace:
    Type: AWS::WorkSpaces::Workspace
    Properties:
      BundleId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - BundleId
      DirectoryId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - DirectoryId
      UserName: !Ref 'UserName'

Resources:
  MyWorkSpace2:
    Type: AWS::WorkSpaces::Workspace
    Properties:
      BundleId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - BundleId
      DirectoryId: !FindInMap
        - WSTypeMap
        - !Ref 'WorkstationType'
        - DirectoryId
      UserName: !Ref 'UserName'
      UserVolumeEncryptionEnabled: false","[[4], [14]]"
425,8a6d36cd-0bc6-42b7-92c4-67acc8576861,Instance With No VPC,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/instance_with_no_vpc,Unknown,"EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations.<br>
[Documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-vpc.html)","Resources:
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.1.0.0/16
      EnableDnsSupport: true
      EnableDnsHostnames: true
      Tags:
          - Key: Name
            Value:  !Join ['', [!Ref ""AWS::StackName"", ""-VPC"" ]]
  InternetGateway:
    Type: AWS::EC2::InternetGateway
    DependsOn: VPC
  AttachGateway:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: !Ref VPC
      InternetGatewayId: !Ref InternetGateway
  PublicSubnetA:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: 'some-ec2-image'
      Fn::FindInMap:
            - ""RegionMap""
            - Ref: ""AWS::Region""
            - ""AMI""
      KeyName: 'some-rsa-key'
      Ref: ""KeyName""
      NetworkInterfaces:
        -   AssociatePublicIpAddress: ""true""
            DeviceIndex: 0
            SubnetId: !Ref PublicSubnetA","Resources:
  VPC:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.1.0.0/16
      EnableDnsSupport: true
      EnableDnsHostnames: true
      Tags:
          - Key: Name
            Value:  !Join ['', [!Ref ""AWS::StackName"", ""-VPC"" ]]
  InternetGateway:
    Type: AWS::EC2::InternetGateway
    DependsOn: VPC
  AttachGateway:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: !Ref VPC
      InternetGatewayId: !Ref InternetGateway
  PublicSubnetA:
    Type: AWS::EC2::Subnet
    Properties:
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A
  Ec2Instance-01:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ""some-ec2-image""
      Fn::FindInMap:
            - ""RegionMap""
            - Ref: ""AWS::Region""
            - ""AMI""
      KeyName: ""some-rsa-key""
      Ref: ""KeyName""
      NetworkInterfaces:
        -   AssociatePublicIpAddress: ""true""
            DeviceIndex: 0
            SubnetId: !Ref PublicSubnetA

Resources:
  Ec2Instance-02:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ""some-ec2-image""
      Fn::FindInMap:
            - ""RegionMap""
            - Ref: ""AWS::Region""
            - ""AMI""
      KeyName: ""some-rsa-key""
      Ref: ""KeyName""","[[21], [4]]"
426,8c415f6f-7b90-4a27-a44a-51047e1506f9,RDS With Backup Disabled,CloudFormation,Medium,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_with_backup_disabled,Unknown,"Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 7
  DeletionPolicy: Snapshot","Resources:
 MyDB:
  Type: AWS::RDS::DBInstance
  Properties:
    DBSecurityGroups:
    - Ref: MyDbSecurityByEC2SecurityGroup
    - Ref: MyDbSecurityByCIDRIPGroup
    AllocatedStorage: '5'
    DBInstanceClass: db.t2.small
    Engine: oracle-ee
    LicenseModel: bring-your-own-license
    MasterUsername: master
    MasterUserPassword: SecretPassword01
    BackupRetentionPeriod: 0
  DeletionPolicy: Snapshot",[[14]]
427,8d29754a-2a18-460d-a1ba-9509f8d359da,IAM Access Analyzer Not Enabled,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_access_analyzer_not_enabled,Unknown,"IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions<br>
[Documentation](https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-resource-accessanalyzer-analyzer.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  Analyzer:
    Type: ""AWS::AccessAnalyzer::Analyzer""
    Properties:
      AnalyzerName: MyAccountAnalyzer
      Type: ACCOUNT
      Tags:
        - Key: Kind
          Value: Dev
      ArchiveRules:
        - # Archive findings for a trusted AWS account
          RuleName: ArchiveTrustedAccountAccess
          Filter:
            - Property: ""principal.AWS""
              Eq:
                - ""123456789012""
        - # Archive findings for known public S3 buckets
          RuleName: ArchivePublicS3BucketsAccess
          Filter:
            - Property: ""resource""
              Contains:
                - ""arn:aws:s3:::docs-bucket""
                - ""arn:aws:s3:::clients-bucket""","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template 2
Resources:
  myuseeer:
    Type: AWS::IAM::Group
    Properties:
      Path: ""/""
      LoginProfile:
        Password: myP@ssW0rd",[[3]]
428,8dd0ff1f-0da4-48df-9bb3-7f338ae36a40,EC2 Not EBS Optimized,CloudFormation,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_not_ebs_optimized,Unknown,"It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-ebsoptimized)","Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      BlockDeviceMappings:
        - DeviceName: ""/dev/sdm""
          Ebs:
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}
      EbsOptimized: true

Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t3.nano
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      BlockDeviceMappings:
        - DeviceName: ""/dev/sdm""
          Ebs:
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}","Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      BlockDeviceMappings:
        - DeviceName: ""/dev/sdm""
          Ebs:
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}

Resources:
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      BlockDeviceMappings:
        - DeviceName: ""/dev/sdm""
          Ebs:
            VolumeType: ""io1""
            Iops: ""200""
            DeleteOnTermination: ""false""
            VolumeSize: ""20""
        - DeviceName: ""/dev/sdk""
          NoDevice: {}
      EbsOptimized: false","[[4], [16]]"
429,8df8e857-bd59-44fa-9f4c-d77594b95b46,Lambda Function Without Tags,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_function_without_tags,Unknown,"AWS Lambda Functions must have associated tags.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html)","AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  Function:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036
      Tags:
        - Key: Description
          Value: VPC Function
        - Key: Type
          Value: AWS Lambda Function","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  ExistingSecurityGroups:
    Type: List<AWS::EC2::SecurityGroup::Id>
  ExistingVPC:
    Type: AWS::EC2::VPC::Id
    Description: The VPC ID that includes the security groups in the ExistingSecurityGroups
      parameter.
  InstanceType:
    Type: String
    Default: t2.micro
    AllowedValues:
    - t2.micro
    - m1.small
Mappings:
  AWSInstanceType2Arch:
    t2.micro:
      Arch: HVM64
    m1.small:
      Arch: HVM64
  AWSRegionArch2AMI:
    us-east-1:
      HVM64: ami-0ff8a91507f77f867
      HVMG2: ami-0a584ac55a7631c0c
Resources:
  SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow HTTP traffic to the host
      VpcId:
        Ref: ExistingVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
  AllSecurityGroups:
    Type: Custom::Split
    Properties:
      ServiceToken: !GetAtt AppendItemToListFunction.Arn
      List:
        Ref: ExistingSecurityGroups
      AppendedItem:
        Ref: SecurityGroup
  AppendItemToListFunction:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: !GetAtt LambdaExecutionRole.Arn
      Code:
        ZipFile: !Sub |
          var response = require('cfn-response');
          exports.handler = function(event, context) {
             var responseData = {Value: event.ResourceProperties.List};
             responseData.Value.push(event.ResourceProperties.AppendedItem);
             response.send(event, context, response.SUCCESS, responseData);
          };
      Runtime: nodejs8.10
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId:
        Fn::FindInMap:
        - AWSRegionArch2AMI
        - Ref: AWS::Region
        - Fn::FindInMap:
          - AWSInstanceType2Arch
          - Ref: InstanceType
          - Arch
      SecurityGroupIds: !GetAtt AllSecurityGroups.Value
      InstanceType:
        Ref: InstanceType
  LambdaExecutionRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - lambda.amazonaws.com
          Action:
          - sts:AssumeRole
      Path: ""/""
      Policies:
      - PolicyName: root
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - logs:*
            Resource: arn:aws:logs:*:*:*
Outputs:
  AllSecurityGroups:
    Description: Security Groups that are associated with the EC2 instance
    Value:
      Fn::Join:
      - "", ""
      - Fn::GetAtt:
        - AllSecurityGroups
        - Value",[[52]]
430,8f957abd-9703-413d-87d3-c578950a753c,IAM Group Without Users,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_group_without_users,Unknown,"IAM Group should have at least one user associated<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-group.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::Group
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
    IamUserAdminSample:
      Type: AWS::IAM::User
      Condition: IsSampleIamUser
      Properties:
        UserName: sample-iam-user-admin
        Groups:
        - !Ref 'myuser'","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template 2
Resources:
    myuseeer:
      Type: AWS::IAM::Group
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn
    IamUserAdminSample22:
      Type: AWS::IAM::User
      Condition: IsSampleIamUser
      Properties:
        UserName: sample-iam-user-admin
        Groups:
        - !Ref 'myu2ser'",[[4]]
431,9025b2b3-e554-4842-ba87-db7aeec36d35,Unscanned ECR Image,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/unscanned_ecr_image,Unknown,"Checks if the ECR Image has been scanned<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html#cfn-ecr-repository-imagescanningconfiguration)","AWSTemplateFormatVersion: ""2010-09-11""
Resources:
  MyRepository:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      ImageScanningConfiguration:
        ScanOnPush: ""true""","AWSTemplateFormatVersion: ""2010-09-11""
Resources:
  MyRepository3:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      RepositoryPolicyText:
        Version: ""2012-10-17""
        Statement:
          -
            Sid: AllowPushPull
            Effect: Allow
            Principal:
              AWS:
                - ""arn:aws:iam::123456789012:user/Bob""
                - ""arn:aws:iam::123456789012:user/Alice""
            Action:
              - ""ecr:GetDownloadUrlForLayer""
              - ""ecr:BatchGetImage""
              - ""ecr:BatchCheckLayerAvailability""
              - ""ecr:PutImage""
              - ""ecr:InitiateLayerUpload""
              - ""ecr:UploadLayerPart""
              - ""ecr:CompleteLayerUpload""

AWSTemplateFormatVersion: ""2010-09-11""
Resources:
  MyRepository4:
    Type: AWS::ECR::Repository
    Properties:
      RepositoryName: ""test-repository""
      ImageScanningConfiguration:
        ScanOnPush: ""false""","[[5], [8]]"
432,90501b1b-cded-4cc1-9e8b-206b85cda317,S3 Static Website Host Enabled,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_static_website_host_enabled,Unknown,"Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-websiteconfiguration.html)","Resources:
  Bucket1:
    Type: AWS::S3::Bucket
    Properties:
      PublicAccessBlockConfiguration:
        BlockPublicAcls       : true
        BlockPublicPolicy     : true
        IgnorePublicAcls      : true
        RestrictPublicBuckets : true","Resources:
  Bucket2:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: PublicRead
      WebsiteConfiguration:
        IndexDocument: index.html
        ErrorDocument: error.html",[[6]]
433,9488c451-074e-4cd3-aee3-7db6104f542c,Lambda Functions Without X-Ray Tracing,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_functions_without_x-ray_tracing,Unknown,"AWS Lambda functions should have TracingConfig enabled. For this, property 'tracingConfig.mode' should have the value 'Active'<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-lambda-function-tracingconfig.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: '2010-09-09'
Description: Lambda function with cfn-response.
Resources:
  primer:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: nodejs12.x
      Role: arn:aws:iam::123456789012:role/lambda-role
      Handler: index.handler
      Code:
        ZipFile: |
          var aws = require('aws-sdk')
          var response = require('cfn-response')
          exports.handler = function(event, context) {
              console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
              // For Delete requests, immediately send a SUCCESS response.
              if (event.RequestType == ""Delete"") {
                  response.send(event, context, ""SUCCESS"")
                  return
              }
              var responseStatus = ""FAILED""
              var responseData = {}
              var functionName = event.ResourceProperties.FunctionName
              var lambda = new aws.Lambda()
              lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                  if (err) {
                      responseData = {Error: ""Invoke call failed""}
                      console.log(responseData.Error + "":\n"", err)
                  }
                  else responseStatus = ""SUCCESS""
                  response.send(event, context, responseStatus, responseData)
              })
          }
      Description: Invoke a function during stack creation.
      TracingConfig:
        Mode: Active","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: '2010-09-09'
Description: Lambda function with cfn-response.
Resources:
  primer:
    Type: AWS::Lambda::Function
    Properties:
      Runtime: nodejs12.x
      Role: arn:aws:iam::123456789012:role/lambda-role
      Handler: index.handler
      Code:
        ZipFile: |
          var aws = require('aws-sdk')
          var response = require('cfn-response')
          exports.handler = function(event, context) {
              console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
              // For Delete requests, immediately send a SUCCESS response.
              if (event.RequestType == ""Delete"") {
                  response.send(event, context, ""SUCCESS"")
                  return
              }
              var responseStatus = ""FAILED""
              var responseData = {}
              var functionName = event.ResourceProperties.FunctionName
              var lambda = new aws.Lambda()
              lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                  if (err) {
                      responseData = {Error: ""Invoke call failed""}
                      console.log(responseData.Error + "":\n"", err)
                  }
                  else responseStatus = ""SUCCESS""
                  response.send(event, context, responseStatus, responseData)
              })
          }
      Description: Invoke a function during stack creation.
      TracingConfig:
        Mode: PassThrough

Resources:
  Function:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036","[[37], [4]]"
434,953b3cdb-ce13-428a-aa12-318726506661,IAM Policies With Full Privileges,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policies_with_full_privileges,Unknown,"IAM policies shouldn't allow full administrative privileges (for all resources)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Effect: Allow
            Action:
              - s3:GetObject
              - s3:PutObject
              - s3:PutObjectAcl
            Resource: arn:aws:s3:::myAWSBucket/*
      Groups:
        - myexistinggroup1
        - !Ref mygroup","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mypolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: ""*""
      Groups:
      - myexistinggroup1
      - !Ref mygroup
  mypolicy2:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: ""*""
          Resource: ""*""
      Groups:
      - myexistinggroup1
      - !Ref mygroup","[[8, 21]]"
435,9564406d-e761-4e61-b8d7-5926e3ab8e79,DB Security Group With Public Scope,CloudFormation,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/db_security_group_with_public_scope,Unknown,"The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","#this code is a correct code for which the query should not find any result
Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 1.2.3.4/24
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIpv6: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  DBInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      PubliclyAccessible: true
      DBName:
        Ref: DBName
      Engine: MySQL
      MultiAZ:
        Ref: MultiAZDatabase
      MasterUsername:
        Ref: DBUser
      DBInstanceClass:
        Ref: DBClass
      AllocatedStorage:
        Ref: DBAllocatedStorage
      MasterUserPassword:
        Ref: DBPassword
      VPCSecurityGroups:
      - !GetAtt DBEC2SecurityGroup.GroupId

Resources:
  DBinstance:
    Type: AWS::RDS::DBInstance
    Properties:
      PubliclyAccessible: true
      DBSecurityGroups:
        -
          Ref: ""DbSecurityByEC2SecurityGroup""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurityByEC2SecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      DBSecurityGroupIngress:
        -
          CIDRIP: 1.2.3.4/24","Resources:
  DBEC2SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  DBInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      PubliclyAccessible: true
      DBName:
        Ref: DBName
      Engine: MySQL
      MultiAZ:
        Ref: MultiAZDatabase
      MasterUsername:
        Ref: DBUser
      DBInstanceClass:
        Ref: DBClass
      AllocatedStorage:
        Ref: DBAllocatedStorage
      MasterUserPassword:
        Ref: DBPassword
      VPCSecurityGroups:
      - !GetAtt DBEC2SecurityGroup.GroupId

Resources:
  DBinstance2:
    Type: AWS::RDS::DBInstance
    Properties:
      PubliclyAccessible: true
      DBSecurityGroups:
        -
          Ref: ""DbSecurityByEC2SecurityGroup""
      AllocatedStorage: ""5""
      DBInstanceClass: ""db.t3.small""
      Engine: ""MySQL""
      MasterUsername: ""YourName""
      MasterUserPassword: ""YourPassword""
    DeletionPolicy: ""Snapshot""
  DbSecurityByEC2SecurityGroup:
    Type: AWS::RDS::DBSecurityGroup
    Properties:
      GroupDescription: ""Ingress for Amazon EC2 security group""
      DBSecurityGroupIngress:
        -
          CIDRIP: 0.0.0.0/0

Resources:
  DBEC2SecurityGroup2:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Open database for access
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIpv6: ::/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  DBInstance3:
    Type: AWS::RDS::DBInstance
    Properties:
      PubliclyAccessible: true
      DBName:
        Ref: DBName
      Engine: MySQL
      MultiAZ:
        Ref: MultiAZDatabase
      MasterUsername:
        Ref: DBUser
      DBInstanceClass:
        Ref: DBClass
      AllocatedStorage:
        Ref: DBAllocatedStorage
      MasterUserPassword:
        Ref: DBPassword
      VPCSecurityGroups:
      - !GetAtt DBEC2SecurityGroup2.GroupId","[[6], [19], [6]]"
436,97e94d17-e2c7-4109-a53b-6536ac1bb64e,VPC Attached With Too Many Gateways,CloudFormation,Low,Availability,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/vpc_attached_with_too_many_gateways,Unknown,"The number of gateways attached should not approach or go beyond the limit of 3, in a particular VPC<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-vpc-gateway-attachment.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC_2:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated
    AttachVpnGateway:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC_2
        VpnGatewayId:
           Ref: myVPNGateway
    AttachVpnGateway2:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC_2
        VpnGatewayId:
           Ref: myVPNGateway2
    AttachVpnGateway3:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC_2
        VpnGatewayId:
           Ref: myVPNGateway3","AWSTemplateFormatVersion: '2010-09-09'
Resources:
    myVPC:
      Type: AWS::EC2::VPC
      Properties:
        CidrBlock: 10.0.0.0/16
        EnableDnsSupport: 'false'
        EnableDnsHostnames: 'false'
        InstanceTenancy: dedicated
    AttachVpnGateway:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC
        VpnGatewayId:
           Ref: myVPNGateway
    AttachVpnGateway2:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC
        VpnGatewayId:
           Ref: myVPNGateway2
    AttachVpnGateway3:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC
        VpnGatewayId:
           Ref: myVPNGateway3
    AttachVpnGateway4:
      Type: AWS::EC2::VPCGatewayAttachment
      Properties:
        VpcId:
           Ref: myVPC
        VpnGatewayId:
           Ref: myVPNGateway4",[[3]]
437,9b6a3f5b-5fd6-40ee-9bc0-ed604911212d,SQS Policy With Public Access,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sqs_policy_with_public_access,Unknown,"Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-policy.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleSQSPolicy:
    Type: AWS::SQS::QueuePolicy
    Properties:
      Queues:
        - ""https://sqs:us-east-2.amazonaws.com/444455556666/queue2""
      PolicyDocument:
        Statement:
          -
            Action:
              - ""SQS:SendMessage""
              - ""SQS:ReceiveMessage""
            Effect: ""Allow""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:
              AWS:
                - ""111122223333""
                - ""*""

Resources:
  SampleSQSPolicy2:
    Type: AWS::SQS::QueuePolicy
    Properties:
      Queues:
        - ""https://sqs:us-east-2.amazonaws.com/444455556666/queue2""
      PolicyDocument:
        Statement:
          -
            Action:
              - ""SQS:SendMessage""
              - ""SQS:CreateQueue""
            Effect: ""Allow""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:
              AWS:
                - ""111122223333""

Resources:
  SampleSQSPolicy3:
    Type: AWS::SQS::QueuePolicy
    Properties:
      Queues:
        - ""https://sqs:us-east-2.amazonaws.com/444455556666/queue2""
      PolicyDocument:
        Statement:
          -
            Action:
              - ""SQS:SendMessage""
              - ""SQS:CreateQueue""
            Effect: ""Deny""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:
              AWS:
                - ""111122223333""
                - ""*""","Resources:
  SampleSQSPolicy:
    Type: AWS::SQS::QueuePolicy
    Properties:
      Queues:
        - ""https://sqs:us-east-2.amazonaws.com/444455556666/queue2""
      PolicyDocument:
        Statement:
          -
            Action:
              - ""SQS:SendMessage""
              - ""SQS:CreateQueue""
            Effect: ""Allow""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:
              AWS:
                - ""111122223333""
                - ""*""

Resources:
  SampleSQSPolicy:
    Type: AWS::SQS::QueuePolicy
    Properties:
      Queues:
        - ""https://sqs:us-east-2.amazonaws.com/444455556666/queue2""
      PolicyDocument:
        Statement:
          -
            Action:
              - ""SQS:SendMessage""
              - ""SQS:AddPermission""
            Effect: ""Allow""
            Resource: ""arn:aws:sqs:us-east-2:444455556666:queue2""
            Principal:
              AWS:
                - ""111122223333""
                - ""arn:aws:iam::437628376:*""","[[7], [7]]"
438,9b83114b-b2a1-4534-990d-06da015e47aa,Lambda Permission Misconfigured,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_permission_misconfigured,Unknown,"Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction'<br>
[Documentation](https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-permission.html)","Resources:
  s3Permission:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:InvokeFunction
      Principal: s3.amazonaws.com
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: !GetAtt bucket.Arn","Resources:
  s3Permission:
    Type: AWS::Lambda::Permission
    Properties:
      FunctionName: !GetAtt function.Arn
      Action: lambda:GetFunction
      Principal: s3.amazonaws.com
      SourceAccount: !Ref 'AWS::AccountId'
      SourceArn: !GetAtt bucket.Arn",[[6]]
439,9c7028d9-04c2-45be-b8b2-1188ccaefb36,SageMaker Notebook Not Placed In VPC,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sagemaker_notebook_not_placed_in_vpc,Unknown,"SageMaker Notebook must be placed in a VPC<br>
[Documentation](https://docs.aws.amazon.com/sagemaker/latest/dg/security_iam_id-based-policy-examples.html#sagemaker-condition-nbi-lockdown)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""NotebookInstance""
Resources:
  NotebookInstance:
    Type: ""AWS::SageMaker::NotebookInstance""
    DependsOn: [ MountTarget1, MountTarget2, MountTarget3, VpcS3Endpoint ]
    Properties:
      NotebookInstanceName: !Ref NotebookInstanceName
      InstanceType: !Ref NotebookInstanceType
      RoleArn: !GetAtt ExecutionRole.Arn
      RootAccess: Enabled
      SecurityGroupIds:
        - !GetAtt VpcSecurityGroup.GroupId
      SubnetId: !Ref PrivateSubnet1
      DirectInternetAccess: Disabled
      AdditionalCodeRepositories: !If
        - CreateCodeRepo
        - [!GetAtt CodeRepo.CodeRepositoryName]
        - !Ref 'AWS::NoValue'
      LifecycleConfigName: !GetAtt NotebookStartConfig.NotebookInstanceLifecycleConfigName
      VolumeSizeInGB: !Ref EbsVolumeSize
      Tags:
        - Key: Name
          Value: !Ref 'AWS::StackName'
  Vpc:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: !Ref VpcCIDR
      EnableDnsSupport: 'true'
      EnableDnsHostnames: 'true'
      Tags:
        - Key: Name
          Value: !Ref 'AWS::StackName'","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""NotebookInstance""
Resources:
  NotebookInstance:
    Type: ""AWS::SageMaker::NotebookInstance""
    DependsOn: [ MountTarget1, MountTarget2, MountTarget3, VpcS3Endpoint ]
    Properties:
      NotebookInstanceName: !Ref NotebookInstanceName
      InstanceType: !Ref NotebookInstanceType
      RoleArn: !GetAtt ExecutionRole.Arn
      RootAccess: Enabled
      SecurityGroupIds:
        - !GetAtt VpcSecurityGroup.GroupId
      DirectInternetAccess: Disabled
      AdditionalCodeRepositories: !If
        - CreateCodeRepo
        - [!GetAtt CodeRepo.CodeRepositoryName]
        - !Ref 'AWS::NoValue'
      LifecycleConfigName: !GetAtt NotebookStartConfig.NotebookInstanceLifecycleConfigName
      VolumeSizeInGB: !Ref EbsVolumeSize
      Tags:
        - Key: Name
          Value: !Ref 'AWS::StackName'
  Vpc:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: !Ref VpcCIDR
      EnableDnsSupport: 'true'
      EnableDnsHostnames: 'true'
      Tags:
        - Key: Name
          Value: !Ref 'AWS::StackName'",[[7]]
440,9d13b150-a2ab-42a1-b6f4-142e41f81e52,SNS Topic Without KmsMasterKeyId,CloudFormation,Low,Secret Management,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sns_topic_without_kms_master_key_id,Unknown,"KmsMasterKeyId attribute should not be undefined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  MySNSTopic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Fn::GetAtt:
              - ""MyQueue1""
              - ""Arn""
          Protocol: ""sqs""
        - Endpoint:
            Fn::GetAtt:
              - ""MyQueue2""
              - ""Arn""
          Protocol: ""sqs""
      TopicName: ""SampleTopic""
      KmsMasterKeyId: ""kmsMasterKeyId""","AWSTemplateFormatVersion: 2010-09-09
Resources:
  MySNSTopic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
        - Endpoint:
            Fn::GetAtt:
              - ""MyQueue1""
              - ""Arn""
          Protocol: ""sqs""
        - Endpoint:
            Fn::GetAtt:
              - ""MyQueue2""
              - ""Arn""
          Protocol: ""sqs""
      TopicName: ""SampleTopic""",[[5]]
441,9e8c89b3-7997-4d15-93e4-7911b9db99fd,Inline Policies Are Attached To ECS Service,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/inline_policies_are_attached_to_ecs_service,Unknown,"Check if any ECS service has inline policies attached, which are embedded directly into an entity (user, group,...), instead of the equivalent recommended managed policies.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html)","Resources:
  InlinePolicy:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  IAMPolicy:
    Type: 'AWS::IAM::Policy'
    Properties:
      PolicyName: root
      PolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Action: '*'
            Resource: '*'","Resources:
  InlinePolicy:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: IAMPolicy
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
  IAMPolicy:
    Type: 'AWS::IAM::Policy'
    Properties:
      PolicyName: root
      PolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Action: '*'
            Resource: '*'",[[7]]
442,9ecb6b21-18bc-4aa7-bd07-db20f1c746db,CloudFormation Specifying Credentials Not Safe,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudformation_specifying_credentials_not_safe,Unknown,"Specifying credentials in the template itself is probably not safe to do.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-authentication.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  WebServer:
    Type: AWS::EC2::Instance
    Metadata:
      AWS::CloudFormation::Init:
        config:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              source:
                Fn::Join:
                  - """"
                  -
                    - ""http://s3.amazonaws.com/""
                    - Ref: ""BucketName""
                    - ""/index.html""
              mode: ""000400""
              owner: ""apache""
              group: ""apache""
              authentication: ""S3AccessCreds""
          services:
            sysvinit:
              httpd:
                enabled: ""true""
                ensureRunning: ""true""","AWSTemplateFormatVersion: 2010-09-09
Resources:
  WebServer:
    Type: AWS::EC2::Instance
    DependsOn: ""BucketPolicy""
    Metadata:
      AWS::CloudFormation::Init:
        config:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              source:
                Fn::Join:
                  - """"
                  -
                    - ""http://s3.amazonaws.com/""
                    - Ref: ""BucketName""
                    - ""/index.html""
              mode: ""000400""
              owner: ""apache""
              group: ""apache""
              authentication: ""S3AccessCreds""
          services:
            sysvinit:
              httpd:
                enabled: ""true""
                ensureRunning: ""true""
      AWS::CloudFormation::Authentication:
        S3AccessCreds:
          type: ""S3""
          accessKeyId:
            Ref: ""CfnKeys""
          secretKey:
            Fn::GetAtt:
              - ""CfnKeys""
              - ""SecretAccessKey""
  WebServer2:
    Type: AWS::EC2::Instance
    DependsOn: ""BucketPolicy""
    Metadata:
      AWS::CloudFormation::Init:
        config:
          packages:
            yum:
              httpd: []
          files:
            /var/www/html/index.html:
              source:
                Fn::Join:
                  - """"
                  -
                    - ""http://s3.amazonaws.com/""
                    - Ref: ""BucketName""
                    - ""/index.html""
              mode: ""000400""
              owner: ""apache""
              group: ""apache""
              authentication: ""S3AccessCreds""
          services:
            sysvinit:
              httpd:
                enabled: ""true""
                ensureRunning: ""true""
      AWS::CloudFormation::Authentication:
        BasicAccessCreds:
          type: ""basic""
          username:
            Ref: ""UserName""
          password:
            Ref: ""Password""
          uris:
            - ""example.com/test""
Properties:
  EC2 Resource Properties ...","[[33, 35, 71]]"
443,9f3cf08e-72a2-4eb1-8007-e3b1b0e10d4d,Configuration Aggregator to All Regions Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/config_configuration_aggregator_to_all_regions_disabled,Unknown,"AWS Config Configuration Aggregator All Regions must be set to True<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configurationaggregator.html)","Resources:
  ConfigurationAggregator9:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      AccountAggregationSources:
        - AccountIds:
            - '123456789012'
            - '987654321012'
          AwsRegions:
            - us-west-2
            - us-east-1
          AllAwsRegions: true
      ConfigurationAggregatorName: MyConfigurationAggregator
  ConfigurationAggregator10:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      OrganizationAggregationSource:
        RoleArn: >-
          arn:aws:iam::012345678912:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations
        AwsRegions:
          - us-west-2
          - us-east-1
        AllAwsRegions: true
      ConfigurationAggregatorName: MyConfigurationAggregator

Resources:
  ConfigurationAggregator9:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      AccountAggregationSources:
        - AccountIds:
            - '123456789012'
            - '987654321012'
          AwsRegions:
            - us-west-2
            - us-east-1
          AllAwsRegions: ""true""
      ConfigurationAggregatorName: MyConfigurationAggregator
  ConfigurationAggregator10:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      OrganizationAggregationSource:
        RoleArn: >-
          arn:aws:iam::012345678912:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations
        AwsRegions:
          - us-west-2
          - us-east-1
        AllAwsRegions: ""true""
      ConfigurationAggregatorName: MyConfigurationAggregator","AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  ConfigurationAggregator1:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      AccountAggregationSources:
        - AccountIds:
            - '123456789012'
            - '987654321012'
          AwsRegions:
            - us-west-2
            - us-east-1
    ConfigurationAggregatorName: MyConfigurationAggregator
  ConfigurationAggregator2:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      AccountAggregationSources:
        - AccountIds:
            - '123456789012'
            - '987654321012'
          AwsRegions:
            - us-west-2
            - us-east-1
          AllAwsRegions: false
    ConfigurationAggregatorName: MyConfigurationAggregator
  ConfigurationAggregator3:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      OrganizationAggregationSource:
        RoleArn: >-
          arn:aws:iam::012345678912:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations
        AwsRegions:
          - us-west-2
          - us-east-1
      ConfigurationAggregatorName: MyConfigurationAggregator
  ConfigurationAggregator4:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      OrganizationAggregationSource:
        RoleArn: >-
          arn:aws:iam::012345678912:role/aws-service-role/organizations.amazonaws.com/AWSServiceRoleForOrganizations
        AwsRegions:
          - us-west-2
          - us-east-1
        AllAwsRegions: false
      ConfigurationAggregatorName: MyConfigurationAggregator

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  OperatorEmail:
    Description: ""Email address to notify when new logs are published.""
    Type: String
Resources:
  ConfigurationAggregator2:
    Type: 'AWS::Config::ConfigurationAggregator'
    Properties:
      AccountAggregationSources:
        - AccountIds:
            - '123456789012'
            - '987654321012'
          AwsRegions:
            - us-west-2
            - us-east-1
          AllAwsRegions: ""false""
    ConfigurationAggregatorName: MyConfigurationAggregator","[[33, 10, 21, 49], [10]]"
444,9fcd0a0a-9b6f-4670-a215-d94e6bf3f184,IAM Database Auth Not Enabled,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_database_auth_not_enabled,Unknown,"IAM Database Auth Enabled should be configured to true when using compatible engine and version<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-enableiamdatabaseauthentication)","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: false
      KmsKeyId: !Ref MyKey
      EnableIAMDatabaseAuthentication: true

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: db.t2.small
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: false
      KmsKeyId: !Ref MyKey
      EnableIAMDatabaseAuthentication: false
      Engine: aurora","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: db.r3.xlarge
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: false
      KmsKeyId: !Ref MyKey
      EnableIAMDatabaseAuthentication: false
      Engine: aurora

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: db.r3.xlarge
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      DeletionProtection: false
      KmsKeyId: !Ref MyKey
      Engine: mysql","[[19], [13]]"
445,a0ae0a4e-712b-4115-8112-51b9eeed9d69,Lambda Functions With Full Privileges,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_functions_with_full_privileges,Unknown,"AWS Lambda Functions should not have roles with policies granting full administrative privileges.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html)","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  ExistingSecurityGroups:
    Type: List<AWS::EC2::SecurityGroup::Id>
  ExistingVPC:
    Type: AWS::EC2::VPC::Id
    Description: The VPC ID that includes the security groups in the ExistingSecurityGroups
      parameter.
  InstanceType:
    Type: String
    Default: t2.micro
    AllowedValues:
    - t2.micro
    - m1.small
Resources:
  SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow HTTP traffic to the host
      VpcId:
        Ref: ExistingVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
  AllSecurityGroups:
    Type: Custom::Split
    Properties:
      ServiceToken: !GetAtt AppendItemToListFunction.Arn
      List:
        Ref: ExistingSecurityGroups
      AppendedItem:
        Ref: SecurityGroup
  AppendItemToListFunction:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: !GetAtt LambdaExecutionRole.Arn
      Code:
        ZipFile: |
          var response = require('cfn-response');
          exports.handler = function(event, context) {
             var responseData = {Value: event.ResourceProperties.List};
             responseData.Value.push(event.ResourceProperties.AppendedItem);
             response.send(event, context, response.SUCCESS, responseData);
          };
      Runtime: nodejs8.10
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-0ff8a91507f77f867
      SecurityGroupIds: !GetAtt AllSecurityGroups.Value
      InstanceType:
        Ref: InstanceType
  LambdaExecutionRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - lambda.amazonaws.com
          Action:
          - sts:AssumeRole
      Path: ""/""
      Policies:
      - PolicyName: root
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - iam:ChangePassword
            Resource: arn:aws:iam::account-ID-without-hyphens:user/Bob","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  ExistingSecurityGroups:
    Type: List<AWS::EC2::SecurityGroup::Id>
  ExistingVPC:
    Type: AWS::EC2::VPC::Id
    Description: The VPC ID that includes the security groups in the ExistingSecurityGroups
      parameter.
  InstanceType:
    Type: String
    Default: t2.micro
    AllowedValues:
    - t2.micro
    - m1.small
Resources:
  SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow HTTP traffic to the host
      VpcId:
        Ref: ExistingVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: '80'
        ToPort: '80'
        CidrIp: 0.0.0.0/0
  AllSecurityGroups:
    Type: Custom::Split
    Properties:
      ServiceToken: !GetAtt AppendItemToListFunction.Arn
      List:
        Ref: ExistingSecurityGroups
      AppendedItem:
        Ref: SecurityGroup
  AppendItemToListFunction:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: !GetAtt LambdaExecutionRole.Arn
      Code:
        ZipFile: |
          var response = require('cfn-response');
          exports.handler = function(event, context) {
             var responseData = {Value: event.ResourceProperties.List};
             responseData.Value.push(event.ResourceProperties.AppendedItem);
             response.send(event, context, response.SUCCESS, responseData);
          };
      Runtime: nodejs8.10
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-0ff8a91507f77f867
      SecurityGroupIds: !GetAtt AllSecurityGroups.Value
      InstanceType:
        Ref: InstanceType
  LambdaExecutionRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - lambda.amazonaws.com
          Action:
          - sts:AssumeRole
      Path: ""/""
      Policies:
      - PolicyName: root
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - ""*""
            Resource: arn:aws:logs:*:*:*",[[76]]
446,a227ec01-f97a-4084-91a4-47b350c1db54,S3 Bucket Without Versioning,CloudFormation,Medium,Backup,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_without_versioning,Unknown,"S3 bucket should have versioning enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","Resources:
  RecordServiceS3Bucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          'Fn::GetAtt':
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                'Fn::Join':
                  - ''
                  - - 'arn:aws:s3:::'
                    - 'Fn::Join':
                        - '-'
                        - - Ref: 'AWS::Region'
                          - Ref: 'AWS::StackName'
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: ''
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled","Resources:
  RecordServiceS3Bucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          'Fn::GetAtt':
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                'Fn::Join':
                  - ''
                  - - 'arn:aws:s3:::'
                    - 'Fn::Join':
                        - '-'
                        - - Ref: 'AWS::Region'
                          - Ref: 'AWS::StackName'
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: ''
            Status: Enabled

Resources:
  RecordServiceS3Bucket2:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          'Fn::GetAtt':
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                'Fn::Join':
                  - ''
                  - - 'arn:aws:s3:::'
                    - 'Fn::Join':
                        - '-'
                        - - Ref: 'AWS::Region'
                          - Ref: 'AWS::StackName'
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: ''
            Status: Enabled
      VersioningConfiguration:
        Status: Suspended","[[5], [27]]"
447,a25cd877-375c-4121-a640-730929936fac,GuardDuty Detector Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/guardduty_detector_disabled,Unknown,"Make sure that Amazon GuardDuty is Enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-guardduty-detector.html)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
    mydetector:
      Type: AWS::GuardDuty::Detector
      Properties:
          Enable: True
          FindingPublishingFrequency: FIFTEEN_MINUTES

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
    mydetector:
      Type: AWS::GuardDuty::Detector
      Properties:
          Enable: ""True""
          FindingPublishingFrequency: FIFTEEN_MINUTES","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  mydetector3:
    Type: AWS::GuardDuty::Detector
    Properties:
        Enable: False
        FindingPublishingFrequency: FIFTEEN_MINUTES

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  mydetector3:
    Type: AWS::GuardDuty::Detector
    Properties:
        Enable: ""False""
        FindingPublishingFrequency: FIFTEEN_MINUTES","[[6], [6]]"
448,a2f2800e-614b-4bc8-89e6-fec8afd24800,Serverless API Without Content Encoding,CloudFormation,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_api_without_content_encoding,Unknown,"AWS Serverless API should enable Content Encoding through the attribute 'MinimumCompressionSize'. This value should be greater than -1 and smaller than 10485760<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-api.html#sam-api-minimumcompressionsize)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi4:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}
      MinimumCompressionSize: 114","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}
      MinimumCompressionSize: -1

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true
      CacheClusterEnabled: true
      AccessLogSetting:
        DestinationArn: 'arn:aws:logs:us-east-1:123456789:log-group:my-log-group'
        Format: >-
          {""requestId"":""$context.requestId"", ""ip"": ""$context.identity.sourceIp"",
          ""caller"":""$context.identity.caller"",
          ""user"":""$context.identity.user"",""requestTime"":""$context.requestTime"",
          ""eventType"":""$context.eventType"",""routeKey"":""$context.routeKey"",
          ""status"":""$context.status"",""connectionId"":""$context.connectionId""}
      MinimumCompressionSize: 11485759","[[7], [19], [19]]"
449,a3aa0087-8228-4e7e-b202-dc9036972d02,Neptune Cluster With IAM Database Authentication Disabled,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/neptune_cluster_with_iam_database_authentication_disabled,Unknown,"Neptune Cluster should have IAM Database Authentication enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-neptune-dbcluster.html#cfn-neptune-dbcluster-iamauthenabled)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster3:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: true
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster3:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: ""true""
      StorageEncrypted: ""true""","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: false
      StorageEncrypted: true
  NeptuneDBCluster2:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: false
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: ""false""
      StorageEncrypted: ""true""
  NeptuneDBCluster2:
    Type: AWS::Neptune::DBCluster
    Properties:
      IamAuthEnabled: ""false""
      StorageEncrypted: ""true""","[[12, 7], [12, 7]]"
450,a3e4e39a-e5fc-4ee9-8cf5-700febfa86dd,Security Group Ingress Has CIDR Not Recommended,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_ingress_has_cidr_not_recommended,Unknown,"AWS Security Group Ingress CIDR should not be /32 in case of IPV4 or /128 in case of IPV6<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIp: 192.0.2.0/24
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      CidrIpv6: 2001:0DB8:1234::/48
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 122.24.0.0/32
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 192.0.2.0/24
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIp: 192.0.2.0/24
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      CidrIpv6: ::/128
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[43, 13]]"
451,a478af30-8c3a-404d-aa64-0b673cee509a,Redshift Using Default Port,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/redshift_using_default_port,Unknown,"Redshift should not use the default port (5439) because an attacker can easily guess the port<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html#cfn-redshift-cluster-port)","Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: false
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar
      Port: 1150","Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: false
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar
  myCluster2:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: false
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar
      Port: 5439","[[4, 28]]"
452,a5366a50-932f-4085-896b-41402714a388,Connection Between CloudFront Origin Not Encrypted,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/connection_between_cloudfront_origin_not_encrypted,Unknown,"Checks if the connection between the CloudFront and the origin server is encrypted<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudfront-distribution.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution_1:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          ViewerProtocolPolicy: allow-all
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
  cloudfrontdistribution_2:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          ViewerProtocolPolicy: allow-all
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
        Tags:
        - Key: name
          Value: example","[[13, 30]]"
453,a58d1a2d-4078-4b80-855b-84cc3f7f4540,IAM Group Inline Policies,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_groups_inline_policies,Unknown,"IAM Groups should not use inline policies and instead use managed policies. If a group is deleted, the inline policy is also deleted<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-group.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::Group","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::Group
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn",[[10]]
454,a71ecabe-03b6-456a-b3bc-d1a39aa20c98,Serverless Function Without Tags,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_function_without_tags,Unknown,"AWS Serverless Function should have associated tags<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-tags)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""",[[7]]
455,a7f8ac28-eed1-483d-87c8-4c325f022572,Serverless Function Environment Variables Not Encrypted,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/526.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_function_environment_variables_not_encrypted,Unknown,"AWS Serverless Function should encrypt environment variables<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-kmskeyarn)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      DeadLetterConfig:
        TargetArn: arn:aws:sqs:us-east-1:2324243535:aaa
        Type: SQS
      Environment:
        Variables:
          key: value
      KmsKeyArn: arn:aws:kms:us-west-1:123456789123:key/12345678-12cc-45bb-98aa-9876543210cc","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      DeadLetterConfig:
        TargetArn: arn:aws:sqs:us-east-1:2324243535:aaa
        Type: SQS
      Environment:
        Variables:
          key: value",[[7]]
456,a964d6e3-8e1e-4d93-8120-61fa640dd55a,IAM User Without Password Reset,CloudFormation,Medium,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/user_iam_missing_password_reset_required,Unknown,"IAM User Login Profile should exist and have PasswordResetRequired property set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-user-loginprofile.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password: myP@ssW0rd
         PasswordResetRequired: ""true""
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password: myP@ssW0rd
         PasswordResetRequired: true
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password: myP@ssW0rd
         PasswordResetRequired: false
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
   newuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
         Password: myP@ssW0rd
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    topuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn","[[10], [8], [6]]"
457,a976d63f-af0e-46e8-b714-8c1a9c4bf768,MSK Cluster Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/msk_cluster_encryption_disabled,Unknown,"Ensure MSK Cluster encryption in rest and transit is enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-msk-cluster.html)","Description: MSK Cluster with all properties
Resources:
  TestCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      EncryptionInfo:
        EncryptionAtRest:
          DataVolumeKMSKeyId: ReplaceWithKmsKeyArn
        EncryptionInTransit:
          ClientBroker: TLS
          InCluster: true
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

Description: MSK Cluster with all properties
Resources:
  TestCluster2:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      EncryptionInfo:
        EncryptionAtRest:
          DataVolumeKMSKeyId: ReplaceWithKmsKeyArn
        EncryptionInTransit:
          ClientBroker: TLS
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3","Description: MSK Cluster with all properties
Resources:
  TestCluster5:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

Description: MSK Cluster with all properties
Resources:
  TestCluster6:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      EncryptionInfo:
        EncryptionAtRest:
          DataVolumeKMSKeyId: ReplaceWithKmsKeyArn
        EncryptionInTransit:
          ClientBroker: PLAINTEXT
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

Description: MSK Cluster with all properties
Resources:
  TestCluster7:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithAllProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      EnhancedMonitoring: PER_BROKER
      EncryptionInfo:
        EncryptionAtRest:
          DataVolumeKMSKeyId: ReplaceWithKmsKeyArn
        EncryptionInTransit:
          InCluster: false
      OpenMonitoring:
        Prometheus:
          JmxExporter:
            EnabledInBroker: ""true""
          NodeExporter:
            EnabledInBroker: ""true""
      ConfigurationInfo:
        Arn: ReplaceWithConfigurationArn
        Revision: 1
      ClientAuthentication:
        Tls:
          CertificateAuthorityArnList:
            - ReplaceWithCAArn
      Tags:
        Environment: Test
        Owner: QATeam
      BrokerNodeGroupInfo:
        BrokerAZDistribution: DEFAULT
        InstanceType: kafka.m5.large
        SecurityGroups:
          - ReplaceWithSecurityGroupId
        StorageInfo:
          EBSStorageInfo:
            VolumeSize: 100
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3","[[5], [14], [14]]"
458,ab759fde-e1e8-4b0e-ad73-ba856e490ed8,ECS Cluster with Container Insights Disabled,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_cluster_container_insights_disabled,Unknown,"ECS Cluster should enable container insights<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-cluster.html#cfn-ecs-cluster-clustersettings)","Resources:
  ECSCluster:
    Type: 'AWS::ECS::Cluster'
    Properties:
      ClusterName: MyCluster
      ClusterSettings:
        - Name: containerInsights
          Value: enabled
      Tags:
        - Key: environment
          Value: production","Resources:
  ECSCluster:
    Type: 'AWS::ECS::Cluster'
    Properties:
      ClusterName: MyCluster
      Tags:
        - Key: environment
          Value: production",[[4]]
459,acc78859-765e-4011-a229-a65ea57db252,S3 Bucket Allows Delete Action From All Principals,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_delete_actions_from_all_principals,Unknown,"S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:DeleteObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""DeleteObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  SampleBucketPolicy4:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - ""DeleteObject""
              - ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","[[22, 7]]"
460,ad21e616-5026-4b9d-990d-5b007bfe679c,Auto Scaling Group With No Associated ELB,CloudFormation,Medium,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/auto_scaling_group_with_no_associated_elb,Unknown,"AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'LoadBalancerNames' must be defined and not empty.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-as-group.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myLaunchTemplate:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      LaunchTemplateName: !Sub ${AWS::StackName}-launch-template
      LaunchTemplateData:
        BlockDeviceMappings:
          - Ebs:
              VolumeSize: 22
              VolumeType: gp2
              DeleteOnTermination: true
              Encrypted: true
            DeviceName: /dev/xvdcz
        CreditSpecification:
          CpuCredits: Unlimited
        ImageId: ami-02354e95b39ca8dec
        InstanceType: t2.micro
        KeyName: my-key-pair-useast1
        Monitoring:
          Enabled: true
        SecurityGroupIds:
          - sg-7c227019
          - sg-903004f8
  myASG:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      AutoScalingGroupName: myASG
      MinSize: ""1""
      MaxSize: ""6""
      DesiredCapacity: ""2""
      HealthCheckGracePeriod: 300
      LoadBalancerNames:
        - elb_1
        - elb_2
      LaunchTemplate:
        LaunchTemplateId: !Ref myLaunchTemplate
        Version: !GetAtt myLaunchTemplate.LatestVersionNumber
      VPCZoneIdentifier:
        - !Ref myPublicSubnet1
        - !Ref myPublicSubnet2
      MetricsCollection:
        - Granularity: ""1Minute""
          Metrics:
            - ""GroupMinSize""
            - ""GroupMaxSize""
      Tags:
        - Key: Environment
          Value: Production
          PropagateAtLaunch: ""true""
        - Key: Purpose
          Value: WebServerGroup
          PropagateAtLaunch: ""false""","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myLaunchTemplate:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      LaunchTemplateName: !Sub ${AWS::StackName}-launch-template
      LaunchTemplateData:
        BlockDeviceMappings:
          - Ebs:
              VolumeSize: 22
              VolumeType: gp2
              DeleteOnTermination: true
              Encrypted: true
            DeviceName: /dev/xvdcz
        CreditSpecification:
          CpuCredits: Unlimited
        ImageId: ami-02354e95b39ca8dec
        InstanceType: t2.micro
        KeyName: my-key-pair-useast1
        Monitoring:
          Enabled: true
        SecurityGroupIds:
          - sg-7c227019
          - sg-903004f8
  myASG:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      AutoScalingGroupName: myASG
      MinSize: ""1""
      MaxSize: ""6""
      DesiredCapacity: ""2""
      HealthCheckGracePeriod: 300
      LaunchTemplate:
        LaunchTemplateId: !Ref myLaunchTemplate
        Version: !GetAtt myLaunchTemplate.LatestVersionNumber
      VPCZoneIdentifier:
        - !Ref myPublicSubnet1
        - !Ref myPublicSubnet2
      MetricsCollection:
        - Granularity: ""1Minute""
          Metrics:
            - ""GroupMinSize""
            - ""GroupMaxSize""
      Tags:
        - Key: Environment
          Value: Production
          PropagateAtLaunch: ""true""
        - Key: Purpose
          Value: WebServerGroup
          PropagateAtLaunch: ""false""
  myASG2:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      AutoScalingGroupName: myASG2
      MinSize: ""1""
      MaxSize: ""6""
      DesiredCapacity: ""2""
      HealthCheckGracePeriod: 300
      LoadBalancerNames: []
      LaunchTemplate:
        LaunchTemplateId: !Ref myLaunchTemplate
        Version: !GetAtt myLaunchTemplate.LatestVersionNumber
      VPCZoneIdentifier:
        - !Ref myPublicSubnet1
        - !Ref myPublicSubnet2
      MetricsCollection:
        - Granularity: ""1Minute""
          Metrics:
            - ""GroupMinSize""
            - ""GroupMaxSize""
      Tags:
        - Key: Environment
          Value: Production
          PropagateAtLaunch: ""true""
        - Key: Purpose
          Value: WebServerGroup
          PropagateAtLaunch: ""false""
  myASG3:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      AutoScalingGroupName: myASG
      MinSize: ""1""
      MaxSize: ""6""
      DesiredCapacity: ""2""
      HealthCheckGracePeriod: 300
      LoadBalancerNames: []
      LaunchTemplate:
        LaunchTemplateId: !Ref myLaunchTemplate
        Version: !GetAtt myLaunchTemplate.LatestVersionNumber
      VPCZoneIdentifier:
        - !Ref myPublicSubnet1
        - !Ref myPublicSubnet2
      MetricsCollection:
        - Granularity: ""1Minute""
          Metrics:
            - ""GroupMinSize""
            - ""GroupMaxSize""
      Tags:
        - Key: Environment
          Value: Production
          PropagateAtLaunch: ""true""
        - Key: Purpose
          Value: WebServerGroup
          PropagateAtLaunch: ""false""","[[28, 60, 87]]"
461,ad7444cf-817a-4765-a79e-2145f7981faf,Shield Advanced Not In Use,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/shield_advanced_not_in_use,Unknown,"AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-fms-policy.html)","Resources:
  MyEIP:
    Type: AWS::EC2::EIP
    Properties:
      InstanceId: !Ref Logical name of an AWS::EC2::Instance resource
  Policy2:
    Type: AWS::FMS::Policy
    Properties:
      ExcludeResourceTags: true
      ResourceTags:
        - Key: resourceTag1
          Value: value
        - Key: resourceTag2
          Value: value
      IncludeMap:
        ACCOUNT:
          - !Ref AWS::AccountId
      PolicyName: TaggedPolicy
      RemediationEnabled: false
      ResourceType: ResourceTypeList
      ResourceTypeList:
        - AWS::EC2::EIP
      SecurityServicePolicyData:
        Type: SHIELD_ADVANCED
      DeleteAllPolicyResources: false
      Tags:
        - Key: tag1
          Value: value
        - Key: tag2
          Value: value","Resources:
  HostedZone:
    Type: AWS::Route53::HostedZone
    Properties:
      Name: ""HostedZone""
      QueryLoggingConfig:
        CloudWatchLogsLogGroupArn: ""SomeCloudWatchLogGroupArn""
  Policy:
    Type: AWS::FMS::Policy
    Properties:
      ExcludeResourceTags: true
      ResourceTags:
        - Key: resourceTag1
          Value: value
        - Key: resourceTag2
          Value: value
      IncludeMap:
        ACCOUNT:
          - !Ref AWS::AccountId
      PolicyName: TaggedPolicy
      RemediationEnabled: false
      ResourceType: ResourceTypeList
      ResourceTypeList:
        - AWS::GlobalAccelerator::Accelerator
      SecurityServicePolicyData:
        Type: SHIELD_ADVANCED
      DeleteAllPolicyResources: false
      Tags:
        - Key: tag1
          Value: value
        - Key: tag2
          Value: value",[[2]]
462,adcd0082-e90b-4b63-862b-21899f6e6a48,Security Groups With Meta IP,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_with_meta_ip,Unknown,"Security Groups allows 0.0.0.0/0 for all ports and protocols.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/33","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 0
          ToPort: 65535
          CidrIp: 0.0.0.0/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0",[[19]]
463,ae03f542-1423-402f-9cef-c834e7ee9583,Lambda Functions Without Unique IAM Roles,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_functions_without_unique_iam_roles,Unknown,"AWS Lambda Functions should not share IAM roles to ensure they will have the minimum privileges needed to perform the required tasks<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html)","AWSTemplateFormatVersion: '2010-09-09'
Description: Lambda function with cfn-response.
Resources:
    Primer01:
        Type: AWS::Lambda::Function
        Properties:
          Runtime: nodejs12.x
          Role: arn:aws:iam::123456789012:role/lambda-role
          Handler: index.handler
          Code:
              ZipFile: |
                var aws = require('aws-sdk')
                var response = require('cfn-response')
                exports.handler = function(event, context) {
                    console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
                    // For Delete requests, immediately send a SUCCESS response.
                    if (event.RequestType == ""Delete"") {
                        response.send(event, context, ""SUCCESS"")
                        return
                    }
                    var responseStatus = ""FAILED""
                    var responseData = {}
                    var functionName = event.ResourceProperties.FunctionName
                    var lambda = new aws.Lambda()
                    lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                        if (err) {
                            responseData = {Error: ""Invoke call failed""}
                            console.log(responseData.Error + "":\n"", err)
                        }
                        else responseStatus = ""SUCCESS""
                        response.send(event, context, responseStatus, responseData)
                    })
                }
          Description: Invoke a function during stack creation.
          TracingConfig:
              Mode: Active
    Primer02:
        Type: AWS::Lambda::Function
        Properties:
          Runtime: nodejs12.x
          Role: arn:aws:iam::123456789012:role/lambda-ex
          Handler: index.handler
          Code:
              ZipFile: |
                var aws = require('aws-sdk')
                var response = require('cfn-response')
                exports.handler = function(event, context) {
                    console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
                    // For Delete requests, immediately send a SUCCESS response.
                    if (event.RequestType == ""Delete"") {
                        response.send(event, context, ""SUCCESS"")
                        return
                    }
                    var responseStatus = ""FAILED""
                    var responseData = {}
                    var functionName = event.ResourceProperties.FunctionName
                    var lambda = new aws.Lambda()
                    lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                        if (err) {
                            responseData = {Error: ""Invoke call failed""}
                            console.log(responseData.Error + "":\n"", err)
                        }
                        else responseStatus = ""SUCCESS""
                        response.send(event, context, responseStatus, responseData)
                    })
                }
          Description: Invoke a function during stack creation.
          TracingConfig:
              Mode: Active","AWSTemplateFormatVersion: '2010-09-09'
Description: Lambda function with cfn-response.
Resources:
    Primer01:
        Type: AWS::Lambda::Function
        Properties:
          Runtime: nodejs12.x
          Role: arn:aws:iam::123456789012:role/lambda-role
          Handler: index.handler
          Code:
              ZipFile: |
                var aws = require('aws-sdk')
                var response = require('cfn-response')
                exports.handler = function(event, context) {
                    console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
                    // For Delete requests, immediately send a SUCCESS response.
                    if (event.RequestType == ""Delete"") {
                        response.send(event, context, ""SUCCESS"")
                        return
                    }
                    var responseStatus = ""FAILED""
                    var responseData = {}
                    var functionName = event.ResourceProperties.FunctionName
                    var lambda = new aws.Lambda()
                    lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                        if (err) {
                            responseData = {Error: ""Invoke call failed""}
                            console.log(responseData.Error + "":\n"", err)
                        }
                        else responseStatus = ""SUCCESS""
                        response.send(event, context, responseStatus, responseData)
                    })
                }
          Description: Invoke a function during stack creation.
          TracingConfig:
              Mode: Active
    Primer02:
        Type: AWS::Lambda::Function
        Properties:
          Runtime: nodejs12.x
          Role: arn:aws:iam::123456789012:role/lambda-role
          Handler: index.handler
          Code:
              ZipFile: |
                var aws = require('aws-sdk')
                var response = require('cfn-response')
                exports.handler = function(event, context) {
                    console.log(""REQUEST RECEIVED:\n"" + JSON.stringify(event))
                    // For Delete requests, immediately send a SUCCESS response.
                    if (event.RequestType == ""Delete"") {
                        response.send(event, context, ""SUCCESS"")
                        return
                    }
                    var responseStatus = ""FAILED""
                    var responseData = {}
                    var functionName = event.ResourceProperties.FunctionName
                    var lambda = new aws.Lambda()
                    lambda.invoke({ FunctionName: functionName }, function(err, invokeResult) {
                        if (err) {
                            responseData = {Error: ""Invoke call failed""}
                            console.log(responseData.Error + "":\n"", err)
                        }
                        else responseStatus = ""SUCCESS""
                        response.send(event, context, responseStatus, responseData)
                    })
                }
          Description: Invoke a function during stack creation.
          TracingConfig:
              Mode: Active","[[8, 41]]"
464,ae53ce91-42b5-46bf-a84f-9a13366a4f13,SNS Topic is Publicly Accessible,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/sns_topic_is_publicly_accessible,Unknown,"SNS Topic Policy should not allow any principal to access<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-policy.html)","AWSTemplateFormatVersion: '2010-09-09'
Description: ''
Resources:
  snsPolicy:
      Type: AWS::SNS::TopicPolicy
      Properties:
        PolicyDocument:
          Statement: [
            {
              ""Sid"": ""MyTopicPolicy"",
              ""Effect"": ""Allow"",
              ""Principal"": ""otherPrincipal"",
              ""Action"": [""sns:Publish""],
              ""Resource"": ""arn:aws:sns:MyTopic""
            }]","AWSTemplateFormatVersion: '2010-09-09'
Description: ''
Resources:
  snsPolicy:
      Type: AWS::SNS::TopicPolicy
      Properties:
        PolicyDocument:
          Statement: [
            {
              ""Sid"": ""MyTopicPolicy"",
              ""Effect"": ""Allow"",
              ""Principal"": ""*"",
              ""Action"": [""sns:Publish""],
              ""Resource"": ""arn:aws:sns:MyTopic""
            }]",[[7]]
465,b1b20ae3-8fa7-4af5-a74d-a2145920fcb1,IAM Password Without Minimum Length,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_password_without_minimum_length,Unknown,"IAM password should have the required minimum length<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/quickref-iam.html#scenario-iam-user)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  myuser:
    Type: AWS::IAM::User
    Properties:
      Path: ""/""
      LoginProfile:
        Password: myP@ssW0rd123asw
      Policies:
      - PolicyName: giveaccesstoqueueonly
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - sqs:*
            Resource:
            - !GetAtt myqueue.Arn
          - Effect: Deny
            Action:
            - sqs:*
            NotResource:
            - !GetAtt myqueue.Arn
      - PolicyName: giveaccesstotopiconly
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - sns:*
            Resource:
            - !Ref mytopic
          - Effect: Deny
            Action:
            - sns:*
            NotResource:
            - !Ref mytopic","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  myuser:
    Type: AWS::IAM::User
    Properties:
      Path: ""/""
      LoginProfile:
        Password: myP@ssW0rd
      Policies:
      - PolicyName: giveaccesstoqueueonly
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - sqs:*
            Resource:
            - !GetAtt myqueue.Arn
          - Effect: Deny
            Action:
            - sqs:*
            NotResource:
            - !GetAtt myqueue.Arn
      - PolicyName: giveaccesstotopiconly
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - sns:*
            Resource:
            - !Ref mytopic
          - Effect: Deny
            Action:
            - sns:*
            NotResource:
            - !Ref mytopic",[[9]]
466,b2e8752c-3497-4255-98d2-e4ae5b46bbf5,S3 Bucket Without Server-side-encryption,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_without_server_side_encryption,Unknown,"S3 Buckets should have server-side encryption at rest enabled to protect sensitive data<br>
[Documentation](https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: '2010-09-09'
Description: S3 bucket with default encryption
Resources:
  EncryptedS3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName:
        'Fn::Sub': 'encryptedbucket-${AWS::Region}-${AWS::AccountId}'
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: 'aws:kms'
              KMSMasterKeyID: KMS-KEY-ARN
    DeletionPolicy: Delete","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: '2010-09-09'
Description: S3 bucket without default encryption
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName:
        'Fn::Sub': 'bucket-${AWS::Region}-${AWS::AccountId}'
    DeletionPolicy: Delete",[[7]]
467,b3de4e4c-14be-4159-b99d-9ad194365e4c,EC2 Instance Subnet Has Public IP Mapping On Launch,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_instance_subnet_has_public_ip_mapping_on_launch,Unknown,"EC2 Instance Subnet should not have MapPublicIpOnLaunch set to true<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html#cfn-ec2-subnet-mappubliciponlaunch)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
   mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      MapPublicIpOnLaunch: false
      VpcId: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: foo
        Value: bar

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
   mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      MapPublicIpOnLaunch: ""false""
      VpcId: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: foo
        Value: bar","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
   mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      MapPublicIpOnLaunch: true
      VpcId: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: foo
        Value: bar

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
   mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      MapPublicIpOnLaunch: ""true""
      VpcId: myVPC
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
      Tags:
      - Key: foo
        Value: bar","[[7], [7]]"
468,b4d9c12b-bfba-4aeb-9cb8-2358546d8041,Vulnerable Default SSL Certificate,CloudFormation,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/vulnerable_default_ssl_certificate,Unknown,"CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudfront-distribution.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
      DistributionConfig:
        ViewerCertificate:
          AcmCertificateArn: arn:aws:autoscaling:us-west-2:123456789012:autoScalingGroup:a1b2c3d4-5678-90ab-cdef-EXAMPLE11111
          MinimumProtocolVersion: TLS1.2_2019
          SslSupportMethod: sni_only

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: 2010-09-09
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        ViewerCertificate:
          AcmCertificateArn: arn:aws:autoscaling:us-west-2:123456789012:autoScalingGroup:a1b2c3d4-5678-90ab-cdef-EXAMPLE11111

AWSTemplateFormatVersion: 2010-09-09
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        ViewerCertificate:
          CloudfrontDefaultCertificate: true","[[7], [8]]"
469,b5d6a2e0-8f15-4664-bd5b-68ec5c9bab83,BOM - AWS S3 Buckets,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/s3_bucket,Unknown,"A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: 2010-09-09
Description: Creating S3 bucket
Resources:
  MyBucket:
    Type: AWS::S3::Bucket
    Properties:
      AccessControl: BucketOwnerFullControl
      BucketName: jenkins-artifacts
      VersioningConfiguration:
        Status: Enabled
      Tags:
        - Key: CostCenter
          Value: ITEngineering
        - Key: Type
          Value: CICD
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: 'aws:kms'
              KMSMasterKeyID: KMS-KEY-ARN
  SampleBucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: !Ref MyBucket
      PolicyDocument:
        Version: 2012-10-17
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource: !Join
              - ''
              - - 'arn:aws:s3:::'
                - !Ref DOC-EXAMPLE-BUCKET
                - /*
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'",[[4]]
470,b7063015-6c31-4658-a8e7-14f98f37fd42,EBS Volume Without KmsKeyId,CloudFormation,Low,Secret Management,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ebs_volume_without_kms_key_id,Unknown,"EBS Volume should specify a KmsKeyId value<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  NewVolume:
      Type: AWS::EC2::Volume
      Properties:
        Size: 100
        Encrypted: true
        AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
        Tags:
          - Key: MyTag
            Value: TagValue
        KmsKeyId: !Ref MyKey
      DeletionPolicy: Snapshot","AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Resources:
  NewVolume:
      Type: AWS::EC2::Volume
      Properties:
        Size: 100
        Encrypted: true
        AvailabilityZone: !GetAtt Ec2Instance.AvailabilityZone
        Tags:
          - Key: MyTag
            Value: TagValue
      DeletionPolicy: Snapshot",[[6]]
471,ba766c53-fe71-4bbb-be35-b6803f2ef13e,ElastiCache Without VPC,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticache_without_vpc,Unknown,"ElastiCache should be launched in a Virtual Private Cloud (VPC)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticache-cache-cluster.html#cfn-elasticache-cachecluster-cachesubnetgroupname)","Resources:
  ElasticacheCluster:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:    
      Engine: memcached
      CacheNodeType: cache.t2.micro
      NumCacheNodes: '1'
      CacheSubnetGroupName: default","Resources:
  ElasticacheCluster:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:    
      Engine: memcached
      CacheNodeType: cache.t2.micro
      NumCacheNodes: '1'",[[4]]
472,bdf8dcb4-75df-4370-92c4-606e4ae6c4d3,Redshift Publicly Accessible,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/redshift_publicly_accessible,Unknown,"AWS Redshift Clusters must not be publicly accessible, which means the attribute 'PubliclyAccessible' must be set to false<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html)","#this code is a correct code for which the query should not find any result
Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: false
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar

#this code is a correct code for which the query should not find any result
Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: ""false""
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar","Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar
  myCluster2:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: true
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar

Resources:
  myCluster:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar
  myCluster2:
    Type: ""AWS::Redshift::Cluster""
    Properties:
      PubliclyAccessible: ""true""
      DBName: ""mydb""
      MasterUsername: ""master""
      MasterUserPassword:
        Ref: ""MasterUserPassword""
      NodeType: ""ds2.xlarge""
      ClusterType: ""single-node""
      Tags:
        - Key: foo
          Value: bar","[[17, 4], [17, 4]]"
473,be5b230d-4371-4a28-a441-85dc760e2aa3,IoT Policy Allows Wildcard Resource,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iot_policy_allows_wildcard_resource,Unknown,"IoT Policy should not allow Resource to be set as *<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iot-policy.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    IoTPolicy:
      Type: AWS::IoT::Policy
      Properties:
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - iot:Connect
            Resource:
            - arn:aws:iot:us-east-1:123456789012:client/client1
        PolicyName: PolicyName","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    IoTPolicy:
      Type: AWS::IoT::Policy
      Properties:
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - iot:Connect
            Resource: ""*""
          - Effect: Deny
            Action:
            - sqs:*
            NotResource: my-hardcoded-arn
        PolicyName: PolicyName",[[7]]
474,be96849c-3df6-49c2-bc16-778a7be2519c,Secure Ciphers Disabled,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/secure_ciphers_disabled,Unknown,"Check if secure ciphers aren't used in CloudFront<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cloudfront-distribution-viewercertificate.html)","#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
      ViewerCertificate:
        CloudFrontDefaultCertificate: true

#this code is a correct code for which the query should not find any result
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: ""true""
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
      ViewerCertificate:
        CloudFrontDefaultCertificate: ""true""","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: true
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
      ViewerCertificate:
        CloudFrontDefaultCertificate: false
        MinimumProtocolVersion: SSLv3

#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: viewer-request
                LambdaFunctionARN: examp
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: viewer-request
              LambdaFunctionARN: examp
        IPV6Enabled: ""true""
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: 60
              OriginReadTimeout: 30
      Tags:
        - Key: name
          Value: example
      ViewerCertificate:
        CloudFrontDefaultCertificate: ""false""
        MinimumProtocolVersion: SSLv3","[[26], [26]]"
475,bf4473f1-c8a2-4b1b-8134-bd32efabab93,Neptune Database Cluster Encryption Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/neptune_database_cluster_encryption_disabled,Unknown,"Neptune database cluster storage should have encryption enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-neptune-dbcluster.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      AssociatedRoles:
        - DBClusterRole
      AvailabilityZones:
        - String
      DBClusterIdentifier: String
      DBClusterParameterGroupName: String
      DBSubnetGroupName: String
      DeletionProtection: true
      EnableCloudwatchLogsExports:
        - String
      EngineVersion: String
      IamAuthEnabled: true
      KmsKeyId: String
      Port: 8182
      PreferredBackupWindow: String
      PreferredMaintenanceWindow: String
      RestoreToTime: String
      RestoreType: String
      SnapshotIdentifier: String
      SourceDBClusterIdentifier: String
      StorageEncrypted: true
      Tags:
        - Tag
      UseLatestRestorableTime: true
      VpcSecurityGroupIds:
        - String

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      AssociatedRoles:
        - DBClusterRole
      AvailabilityZones:
        - String
      DBClusterIdentifier: String
      DBClusterParameterGroupName: String
      DBSubnetGroupName: String
      DeletionProtection: ""true""
      EnableCloudwatchLogsExports:
        - String
      EngineVersion: String
      IamAuthEnabled: ""true""
      KmsKeyId: String
      Port: 8182
      PreferredBackupWindow: String
      PreferredMaintenanceWindow: String
      RestoreToTime: String
      RestoreType: String
      SnapshotIdentifier: String
      SourceDBClusterIdentifier: String
      StorageEncrypted: ""true""
      Tags:
        - Tag
      UseLatestRestorableTime: ""true""
      VpcSecurityGroupIds:
        - String","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      AssociatedRoles:
        - DBClusterRole
      AvailabilityZones:
        - String
      DBClusterIdentifier: String
      DBClusterParameterGroupName: String
      DBSubnetGroupName: String
      DeletionProtection: true
      EnableCloudwatchLogsExports:
        - String
      EngineVersion: String
      IamAuthEnabled: true
      KmsKeyId: String
      Port: 8182
      PreferredBackupWindow: String
      PreferredMaintenanceWindow: String
      RestoreToTime: String
      RestoreType: String
      SnapshotIdentifier: String
      SourceDBClusterIdentifier: String
      StorageEncrypted: false
      Tags:
        - Tag
      UseLatestRestorableTime: true
      VpcSecurityGroupIds:
        - String

AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  NeptuneDBCluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      AssociatedRoles:
        - DBClusterRole
      AvailabilityZones:
        - String
      DBClusterIdentifier: String
      DBClusterParameterGroupName: String
      DBSubnetGroupName: String
      DeletionProtection: ""true""
      EnableCloudwatchLogsExports:
        - String
      EngineVersion: String
      IamAuthEnabled: ""true""
      KmsKeyId: String
      Port: 8182
      PreferredBackupWindow: String
      PreferredMaintenanceWindow: String
      RestoreToTime: String
      RestoreType: String
      SnapshotIdentifier: String
      SourceDBClusterIdentifier: String
      StorageEncrypted: ""false""
      Tags:
        - Tag
      UseLatestRestorableTime: ""true""
      VpcSecurityGroupIds:
        - String","[[27], [27]]"
476,bf89373a-be40-4c04-99f5-746742dfd7f3,EMR Without VPC,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/emr_wihout_vpc,Unknown,"Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticmapreduce-cluster-jobflowinstancesconfig.html#cfn-elasticmapreduce-cluster-jobflowinstancesconfig-ec2subnetid)","AWSTemplateFormatVersion: 2010-09-09
Parameters:
  CustomAmiId:
    Type: String
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
  TerminationProtected:
    Type: String
    Default: 'false'
  ElasticMapReducePrincipal:
    Type: String
  Ec2Principal:
    Type: String
Resources:
  cluster:
    Type: AWS::EMR::Cluster
    Properties:
      CustomAmiId: !Ref CustomAmiId
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnMaster
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnCore
        TerminationProtected: !Ref TerminationProtected
        Ec2SubnetId: !Ref SubnetId
      Name: CFNtest
      JobFlowRole: !Ref emrEc2InstanceProfile
      ServiceRole: !Ref emrRole
      ReleaseLabel: !Ref ReleaseLabel
      VisibleToAllUsers: true
      Tags:
        - Key: key1
          Value: value1
  emrRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: !Ref ElasticMapReducePrincipal
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole'
  emrEc2Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: !Ref Ec2Principal
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceforEC2Role'
  emrEc2InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles:
        - !Ref emrEc2Role","AWSTemplateFormatVersion: 2010-09-09
Parameters:
  CustomAmiId:
    Type: String
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
  TerminationProtected:
    Type: String
    Default: 'false'
  ElasticMapReducePrincipal:
    Type: String
  Ec2Principal:
    Type: String
Resources:
  cluster:
    Type: AWS::EMR::Cluster
    Properties:
      CustomAmiId: !Ref CustomAmiId
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnMaster
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType: !Ref InstanceType
          Market: ON_DEMAND
          Name: cfnCore
        TerminationProtected: !Ref TerminationProtected
      Name: CFNtest
      JobFlowRole: !Ref emrEc2InstanceProfile
      ServiceRole: !Ref emrRole
      ReleaseLabel: !Ref ReleaseLabel
      VisibleToAllUsers: true
      Tags:
        - Key: key1
          Value: value1
  emrRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: !Ref ElasticMapReducePrincipal
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole'
  emrEc2Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2008-10-17
        Statement:
          - Sid: ''
            Effect: Allow
            Principal:
              Service: !Ref Ec2Principal
            Action: 'sts:AssumeRole'
      Path: /
      ManagedPolicyArns:
        - 'arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceforEC2Role'
  emrEc2InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles:
        - !Ref emrEc2Role",[[23]]
477,c1282e03-b285-4637-aee7-eefe3a7bb658,EFS Volume With Disabled Transit Encryption,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/efs_volume_with_disabled_transit_encryption,Unknown,"Amazon EFS volume does not have encryption for data at transit enabled. To prevent such a scenario, enable the attribute 'TransitEncryption'<br>
[Documentation](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/efs-volumes.html)",,,[]
478,c2eae442-d3ba-4cb1-84ca-1db4f80eae3d,Lambda Function Without Dead Letter Queue,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/lambda_function_without_dead_letter_queue,Unknown,"AWS Lambda Function should be configured for a Dead Letter Queue(DLQ)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-function.html#cfn-lambda-function-deadletterconfig)","AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  Function3:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036
      Tags:
        - Key: Description
          Value: VPC Function
        - Key: Type
          Value: AWS Lambda Function
      DeadLetterConfig:
        TargetArn: arn:aws:sqs:us-east-1:2324243535:aaa","AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  Function:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036
      Tags:
        - Key: Description
          Value: VPC Function
        - Key: Type
          Value: AWS Lambda Function

AWSTemplateFormatVersion: '2010-09-09'
Description: VPC function.
Resources:
  Function2:
    Type: AWS::Lambda::Function
    Properties:
      Handler: index.handler
      Role: arn:aws:iam::123456789012:role/lambda-role
      Code:
        S3Bucket: my-bucket
        S3Key: function.zip
      Runtime: nodejs12.x
      Timeout: 5
      TracingConfig:
        Mode: Active
      VpcConfig:
        SecurityGroupIds:
          - sg-085912345678492fb
        SubnetIds:
          - subnet-071f712345678e7c8
          - subnet-07fd123456788a036
      Tags:
        - Key: Description
          Value: VPC Function
        - Key: Type
          Value: AWS Lambda Function
      DeadLetterConfig:","[[6], [27, 6]]"
479,c333e906-8d8b-4275-b999-78b6318f8dc6,DynamoDB With Not Recommended Table Billing Mode,CloudFormation,Low,Build Process,https://cwe.mitre.org/data/definitions/913.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dynamodb_with_table_billing_mode_not_recommended,Unknown,"Checks if DynamoDB Table Billing Mode is set to either PAY_PER_REQUEST or PROVISIONED<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html#cfn-dynamodb-table-attributedef)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  myDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      AttributeDefinitions:
        -
          AttributeName: ""Album""
          AttributeType: ""S""
        -
          AttributeName: ""Artist""
          AttributeType: ""S""
      KeySchema:
        -
          AttributeName: ""Album""
          KeyType: ""HASH""
        -
          AttributeName: ""Artist""
          KeyType: ""RANGE""
      ProvisionedThroughput:
        ReadCapacityUnits: ""5""
        WriteCapacityUnits: ""5""
      TableName: ""myTableName""
  myDynamoDBTable2:
    Type: AWS::DynamoDB::Table
    Properties:
      AttributeDefinitions:
        -
          AttributeName: ""Album""
          AttributeType: ""S""
        -
          AttributeName: ""Artist""
          AttributeType: ""S""
      BillingMode: ""PAY_PER_REQUEST""
      KeySchema:
        -
          AttributeName: ""Album""
          KeyType: ""HASH""
        -
          AttributeName: ""Artist""
          KeyType: ""RANGE""
      TableName: ""myTableName""
  myDynamoDBTable3:
    Type: AWS::DynamoDB::Table
    Properties:
      AttributeDefinitions:
        -
          AttributeName: ""Album""
          AttributeType: ""S""
        -
          AttributeName: ""Artist""
          AttributeType: ""S""
      BillingMode: ""PROVISIONED""
      KeySchema:
        -
          AttributeName: ""Album""
          KeyType: ""HASH""
        -
          AttributeName: ""Artist""
          KeyType: ""RANGE""
      ProvisionedThroughput:
        ReadCapacityUnits: ""5""
        WriteCapacityUnits: ""5""
      TableName: ""myTableName""","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  myDynamoDBTable:
    Type: AWS::DynamoDB::Table
    Properties:
      AttributeDefinitions:
        -
          AttributeName: ""Album""
          AttributeType: ""S""
        -
          AttributeName: ""Artist""
          AttributeType: ""S""
      BillingMode: ""PayPal""
      KeySchema:
        -
          AttributeName: ""Album""
          KeyType: ""HASH""
        -
          AttributeName: ""Artist""
          KeyType: ""RANGE""
      TableName: ""myTableName""",[[13]]
480,c3ce69fd-e3df-49c6-be78-1db3f802261c,S3 Bucket CloudTrail Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_cloudtrail_logging_disabled,Unknown,"Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable when the Service used is CloudTrail<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html#cfn-s3-bucket-loggingconfig)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mybucket:
    Type: ""AWS::S3::Bucket""
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          Fn::GetAtt:
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                Fn::Join:
                  - """"
                  - - ""arn:aws:s3:::""
                    - ""Fn::Join"":
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: """"
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled
      LoggingConfiguration:
        DestinationBucketName: LoggingBucket
        LogFilePrefix: loga/
  WorkItemBucketBackupRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action:
              - ""sts:AssumeRole""
            Effect: Allow
            Principal:
              Service:
                - s3.amazonaws.com
  SampleBucketPolicy:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket:
        Ref: mybucket
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              'Fn::Join':
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: DOC-EXAMPLE-BUCKET
                  - /*
            Principal:
              Service: 'cloudtrail.amazonaws.com'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mybucketVulnerable:
    Type: ""AWS::S3::Bucket""
    DeletionPolicy: Retain
    Properties:
      ReplicationConfiguration:
        Role:
          Fn::GetAtt:
            - WorkItemBucketBackupRole
            - Arn
        Rules:
          - Destination:
              Bucket:
                Fn::Join:
                  - """"
                  - - ""arn:aws:s3:::""
                    - Fn::Join:
                        - ""-""
                        - - Ref: ""AWS::Region""
                          - Ref: ""AWS::StackName""
                          - replicationbucket
              StorageClass: STANDARD
            Id: Backup
            Prefix: """"
            Status: Enabled
      VersioningConfiguration:
        Status: Enabled
  WorkItemBucketBackupRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action:
              - ""sts:AssumeRole""
            Effect: Allow
            Principal:
              Service:
                - s3.amazonaws.com
  sampleBucketPolicy:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket:
        Ref: mybucketVulnerable
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Allow
            Resource:
              Fn::Join:
                - ''
                - - 'arn:aws:s3:::'
                  - Ref: DOC-EXAMPLE-BUCKET
                  - /*
            Principal:
              Service: 'cloudtrail.amazonaws.com'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'",[[7]]
481,c44c95fc-ae92-4bb8-bdf8-bb9bc412004a,EC2 Public Instance Exposed Through Subnet,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_public_instance_exposed_through_subnet,Unknown,"EC2 instances with public IP addresses shouldn't allow for unrestricted traffic to their subnets<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-route.html)","Resources:
  myVPC_1:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16
      EnableDnsSupport: false
      EnableDnsHostnames: false
      InstanceTenancy: dedicated
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  VPCGatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref myVPC_1
  myRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref myVPC_1
  myRoute:
      Type: AWS::EC2::Route
      DependsOn: VPCGatewayAttachment
      Properties:
        RouteTableId: !Ref myRouteTable
        DestinationCidrBlock: 0.0.0.0/0
        DestinationIpv6CidrBlock: ::/0
        GatewayId: !Ref InternetGateway
  mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref myVPC_1
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
  mySubnetRouteTableAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      SubnetId: !Ref mySubnet
      RouteTableId: !Ref myRouteTable
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-0ff8a91507f77f867
      KeyName: !Ref Keyname
      NetworkInterfaces:
        - AssociatePublicIpAddress: false
          DeviceIndex: ""0""
          SubnetId: !Ref mySubnet

Resources:
  myVPC_3:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16
      EnableDnsSupport: false
      EnableDnsHostnames: false
      InstanceTenancy: dedicated
  InternetGateway_2:
    Type: AWS::EC2::InternetGateway
  VPCGatewayAttachment_2:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway_2
      VpcId: !Ref myVPC_3
  myRouteTable_2:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref myVPC_3
  mySubnet_2:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref myVPC_3
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
  mySubnetRouteTableAssociation_2:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      SubnetId: !Ref mySubnet_2
      RouteTableId: !Ref myRouteTable_2
  Ec2Instance_2:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-0ff8a91507f77f867
      KeyName: !Ref Keyname
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
          DeviceIndex: ""0""
          SubnetId: !Ref mySubnet_2","Resources:
  myVPC_1:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16
      EnableDnsSupport: false
      EnableDnsHostnames: false
      InstanceTenancy: dedicated
  InternetGateway:
    Type: AWS::EC2::InternetGateway
  VPCGatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      InternetGatewayId: !Ref InternetGateway
      VpcId: !Ref myVPC_1
  myRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: !Ref myVPC_1
  myRoute:
      Type: AWS::EC2::Route
      DependsOn: VPCGatewayAttachment
      Properties:
        RouteTableId: !Ref myRouteTable
        DestinationCidrBlock: 0.0.0.0/0
        DestinationIpv6CidrBlock: ::/0
        GatewayId: !Ref InternetGateway
  mySubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref myVPC_1
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: ""us-east-1a""
  mySubnetRouteTableAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      SubnetId: !Ref mySubnet
      RouteTableId: !Ref myRouteTable
  Ec2Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-0ff8a91507f77f867
      KeyName: !Ref Keyname
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
          DeviceIndex: ""0""
          SubnetId: !Ref mySubnet",[[28]]
482,c62e8b7d-1fdf-4050-ac4c-76ba9e1d9621,ELBv2 ALB Access Log Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_v2_alb_access_log_disabled,Unknown,"ELBv2 ALBs should have access log enabled to capture detailed information about requests sent to your load balancer.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticloadbalancingv2-loadbalancer-loadbalancerattributes.html#cfn-elasticloadbalancingv2-loadbalancer-loadbalancerattributes-key)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Parameters:
  EnvironmentName:
    Description: An environment name that will be prefixed to resource names
    Type: String

  VPC:
    Type: AWS::EC2::VPC::Id
    Description: Choose which VPC the Application Load Balancer should be deployed to

  Subnets:
    Description: Choose which subnets the Application Load Balancer should be deployed to
    Type: List<AWS::EC2::Subnet::Id>

  SecurityGroup:
    Description: Select the Security Group to apply to the Application Load Balancer
    Type: AWS::EC2::SecurityGroup::Id
Resources:
  LoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: !Ref EnvironmentName
      Subnets: !Ref Subnets
      SecurityGroups:
        - !Ref SecurityGroup
      Tags:
        - Key: Name
          Value: !Ref EnvironmentName
      LoadBalancerAttributes:
        - Key: access_logs.s3.enabled
          Value: true

AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Parameters:
  EnvironmentName:
    Description: An environment name that will be prefixed to resource names
    Type: String

  VPC:
    Type: AWS::EC2::VPC::Id
    Description: Choose which VPC the Application Load Balancer should be deployed to

  Subnets:
    Description: Choose which subnets the Application Load Balancer should be deployed to
    Type: List<AWS::EC2::Subnet::Id>

  SecurityGroup:
    Description: Select the Security Group to apply to the Application Load Balancer
    Type: AWS::EC2::SecurityGroup::Id
Resources:
  LoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: !Ref EnvironmentName
      Subnets: !Ref Subnets
      SecurityGroups:
        - !Ref SecurityGroup
      Tags:
        - Key: Name
          Value: !Ref EnvironmentName
      LoadBalancerAttributes:
        - Key: access_logs.s3.enabled
          Value: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Parameters:
  EnvironmentName:
    Description: An environment name that will be prefixed to resource names
    Type: String

  VPC:
    Type: AWS::EC2::VPC::Id
    Description: Choose which VPC the Application Load Balancer should be deployed to

  Subnets:
    Description: Choose which subnets the Application Load Balancer should be deployed to
    Type: List<AWS::EC2::Subnet::Id>

  SecurityGroup:
    Description: Select the Security Group to apply to the Application Load Balancer
    Type: AWS::EC2::SecurityGroup::Id
Resources:
  LoadBalancer:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: !Ref EnvironmentName
      Subnets: !Ref Subnets
      SecurityGroups:
        - !Ref SecurityGroup
      Tags:
        - Key: Name
          Value: !Ref EnvironmentName

AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Parameters:
  EnvironmentName:
    Description: An environment name that will be prefixed to resource names
    Type: String

  VPC:
    Type: AWS::EC2::VPC::Id
    Description: Choose which VPC the Application Load Balancer should be deployed to

  Subnets:
    Description: Choose which subnets the Application Load Balancer should be deployed to
    Type: List<AWS::EC2::Subnet::Id>

  SecurityGroup:
    Description: Select the Security Group to apply to the Application Load Balancer
    Type: AWS::EC2::SecurityGroup::Id
Resources:
  LoadBalancertest:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: !Ref EnvironmentName
      Subnets: !Ref Subnets
      SecurityGroups:
        - !Ref SecurityGroup
      Tags:
        - Key: Name
          Value: !Ref EnvironmentName
      LoadBalancerAttributes:
        - Key: access_logs.s3.enabled
          Value: false","[[22], [30]]"
483,c689f51b-9203-43b3-9d8b-caed123f706c,BOM - AWS Elasticache,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/elasticache,Unknown,"A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","Resources:
  ElasticacheCluster:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:    
      Engine: memcached
      CacheNodeType: cache.t2.micro
      NumCacheNodes: '1'
      CacheSubnetGroupName: default
      CacheSecurityGroupNames:
        - !Ref CacheSecurityGroup
  CacheSecurityGroup:
    Type: AWS::ElastiCache::SecurityGroup
    Properties: 
      Description: My ElastiCache Security Group
  SecurityGroupIngress:
    Type: AWS::ElastiCache::SecurityGroupIngress
    Properties: 
      CacheSecurityGroupName: !Ref CacheSecurityGroup
      EC2SecurityGroupName: !Ref SecurityGroup
  SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId: !Ref myVPC
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0

Resources:
  ElasticacheCluster:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:    
      Engine: memcached
      CacheNodeType: cache.t2.micro
      NumCacheNodes: '1'
      CacheSubnetGroupName: default
      CacheSecurityGroupNames:
        - !Ref CacheSecurityGroup2
  CacheSecurityGroup2:
    Type: AWS::ElastiCache::SecurityGroup
    Properties: 
      Description: My ElastiCache Security Group
  SecurityGroupIngress2:
    Type: AWS::ElastiCache::SecurityGroupIngress
    Properties: 
      CacheSecurityGroupName: !Ref CacheSecurityGroup2
      EC2SecurityGroupName: !Ref SecurityGroup2
  SecurityGroup2:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId: !Ref myVPC
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 1.2.3.4/28","[[2], [2]]"
484,c757c6a3-ac87-4b9d-b28d-e5a5add6a315,Serverless API X-Ray Tracing Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_api_xray_tracing_disabled,Unknown,"AWS Serverless API should have X-Ray Tracing enabled<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-api.html#sam-api-tracingenabled)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: true

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi3:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: ""true""","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: false

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  ApiGatewayApi2:
    Type: AWS::Serverless::Api
    Properties:
      StageName: prod
      TracingEnabled: ""false""","[[7], [9], [9]]"
485,c8ae9ba9-c2f7-4e5c-b32e-a4b7712d4d22,Secrets Manager Should Specify KmsKeyId,CloudFormation,Low,Secret Management,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/secrets_manager_should_specify_kms_key_id,Unknown,"Secrets Manager Secret should explicitly specify KmsKeyId, this will allow the secret to be shared cross-account<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-secret.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  SecretsManagerSecret:
    Type: AWS::SecretsManager::Secret
    Properties:
      Description: String
      GenerateSecretString:
        GenerateSecretString
      KmsKeyId: String
      Name: String
      SecretString:
        String
      Tags:
        - Tag","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  SecretsManagerSecret:
    Type: AWS::SecretsManager::Secret
    Properties:
      Description: String
      GenerateSecretString:
        GenerateSecretString
      Name: String
      SecretString:
        String
      Tags:
        - Tag",[[6]]
486,c8dee387-a2e6-4a73-a942-183c975549ac,DynamoDB With Aws Owned CMK,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dynamodb_with_aws_owned_cmk,Unknown,"AWS DynamoDb should be encrypted using AWS Managed CMK, instead of AWS-owned CMK. To verify this, SSEEnabled must be verified if false for AWS-owned CMK or true for AWS-Managed CMK. Default value is false.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dynamodb-table-ssespecification.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Sample CloudFormation template for DynamoDB with customer managed CMK
Resources:
  dynamodbKMSKey:
    Type: AWS::KMS::Key
    Properties:
      Description: ""An example CMK""
      KeyPolicy:
        Version: ""2012-10-17""
        Id: ""key-default-1""
        Statement:
          - Sid: ""Allow administration of the key""
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/ana""
            Action:
              - ""kms:Create*""
              - ""kms:Describe*""
              - ""kms:Enable*""
              - ""kms:List*""
              - ""kms:Put*""
              - ""kms:Update*""
              - ""kms:Revoke*""
              - ""kms:Disable*""
              - ""kms:Get*""
              - ""kms:Delete*""
              - ""kms:ScheduleKeyDeletion""
              - ""kms:CancelKeyDeletion""
            Resource: ""*""
          - Sid: ""Allow use of the key""
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/ana""
            Action:
              - ""kms:DescribeKey""
              - ""kms:Encrypt""
              - ""kms:Decrypt""
              - ""kms:ReEncrypt*""
              - ""kms:GenerateDataKey""
              - ""kms:GenerateDataKeyWithoutPlaintext""
            Resource: ""*""

  DynamoDBOnDemandTable1:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: ""dynamodb-kms""
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        KMSMasterKeyId: !Ref dynamodbKMSKey
        SSEEnabled: true
        SSEType: ""KMS""","AWSTemplateFormatVersion: ""2010-09-09""
Description: Sample CloudFormation template for DynamoDB with AWS-Owned CMK
Resources:
  DynamoDBOnDemandTable2:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: ""dynamodb-kms-0""
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEEnabled: false
        SSEType: ""KMS""

AWSTemplateFormatVersion: ""2010-09-10""
Description: Sample CloudFormation template for DynamoDB with AWS-Owned CMK
Resources:
  DynamoDBOnDemandTable5:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: ""dynamodb-kms-3""
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST

AWSTemplateFormatVersion: ""2010-09-11""
Description: Sample CloudFormation template for DynamoDB with AWS-Owned CMK
Resources:
  DynamoDBOnDemandTable4:
    Type: ""AWS::DynamoDB::Table""
    Properties:
      TableName: ""dynamodb-kms-2""
      AttributeDefinitions:
        - AttributeName: pk
          AttributeType: S
      KeySchema:
        - AttributeName: pk
          KeyType: HASH
      BillingMode: PAY_PER_REQUEST
      SSESpecification:
        SSEType: ""KMS""","[[4], [4], [4]]"
487,c9846969-d066-431f-9b34-8c4abafe422a,Remote Desktop Port Open To Internet,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/remote_desktop_port_open_to_internet,Unknown,"The Remote Desktop port is open to the internet in a Security Group<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow rdp to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3389
          ToPort: 3389
          CidrIp: 192.168.0.0/16","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow rdp to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 3389
          ToPort: 3389
          CidrIp: 0.0.0.0/0",[[8]]
488,cb2f612b-ed42-4ff5-9fb9-255c73d39a18,Serverless Function Without Dead Letter Queue,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_function_without_dead_letter_queue,Unknown,"AWS Serverless Function should be configured for a Dead Letter Queue(DLQ)<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-deadletterqueue)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      DeadLetterConfig:
        TargetArn: arn:aws:sqs:us-east-1:2324243535:aaa
        Type: SQS","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function",[[7]]
489,cc8b294f-006f-4f8f-b5bb-0a9140c33131,Wildcard In ACM Certificate Domain Name,CloudFormation,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/wildcard_in_acm_certificate_domain_name,Unknown,"ACM Certificate should not use wildcards (*) in the domain name<br>
[Documentation](https://docs.aws.amazon.com/acm/latest/userguide/acm-overview.html)","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  DomainName:
    Description: ""Domain for which you are requesting a cert""
    Type: String
    Default: example.com #Put your own domain name here
  HostedZoneId:
    Description: ""hosted zone id in which CNAME record for the validation needs to be added""
    Type: String
    Default: XYZABCDERYH #Put the hosted zone id in which CNAME record for the validation needs to be added

Resources:
  Certificate:
    Type: AWS::CertificateManager::Certificate
    Properties:
      DomainName: CMDomain
      DomainValidationOptions:
        - DomainName: !Ref DomainName
          HostedZoneId: !Ref HostedZoneId
      ValidationMethod: 'DNS'","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  DomainName:
    Description: ""Domain for which you are requesting a cert""
    Type: String
    Default: example.com #Put your own domain name here
  HostedZoneId:
    Description: ""hosted zone id in which CNAME record for the validation needs to be added""
    Type: String
    Default: XYZABCDERYH #Put the hosted zone id in which CNAME record for the validation needs to be added

Resources:
  Certificate:
    Type: AWS::CertificateManager::Certificate
    Properties:
      DomainName: ""*""
      DomainValidationOptions:
        - DomainName: !Ref DomainName
          HostedZoneId: !Ref HostedZoneId
      ValidationMethod: 'DNS'",[[16]]
490,cdbb0467-2957-4a77-9992-7b55b29df7b7,Security Groups With Exposed Admin Ports,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_groups_with_exhibited_admin_ports,Unknown,"Security Groups should not have ports open in (20, 21, 22, 23, 115, 137, 138, 139, 2049, 3389)<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/32
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 127.0.0.1/33

AWSTemplateFormatVersion: 2010-09-09
Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: 11.22.33.44/32","Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
      KeyName: mykey
      ImageId: ''
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 20
          ToPort: 20
          CidrIp: 0.0.0.0/0
        SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0",[[15]]
491,cfdef2e5-1fe4-4ef4-bea8-c56e08963150,ElastiCache Nodes Not Created Across Multi AZ,CloudFormation,Medium,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticache_nodes_not_created_across_multi_az,Unknown,"ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-elasticache-cache-cluster.html)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  myCacheCluster:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:
      AZMode: cross-az
      CacheNodeType: cache.m3.medium
      Engine: memcached
      NumCacheNodes: '3'
      PreferredAvailabilityZones:
        - us-west-2a
        - us-west-2a
        - us-west-2b","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  myCacheCluster3:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:
      AZMode: single-az
      CacheNodeType: cache.m3.medium
      Engine: memcached
      NumCacheNodes: '3'
      PreferredAvailabilityZones:
        - us-west-2a
        - us-west-2a
        - us-west-2b

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  myCacheCluster4:
    Type: 'AWS::ElastiCache::CacheCluster'
    Properties:
      CacheNodeType: cache.m3.medium
      Engine: memcached
      NumCacheNodes: '3'
      PreferredAvailabilityZones:
        - us-west-2a
        - us-west-2a
        - us-west-2b","[[6], [5]]"
492,d24389b4-b209-4ff0-8345-dc7a4569dcdd,ECS Task Definition HealthCheck Missing,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_task_definition_healthcheck_missing,Unknown,"Amazon ECS must have the HealthCheck property defined to give more control over monitoring the health of tasks<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ecs-taskdefinition-healthcheck.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyEC2Instance:
    Type: ""AWS::EC2::Instance""
    Properties:
      ImageId: ""ami-0ff8a91507f77f867""
      InstanceType: t2.micro
      KeyName: testkey
      BlockDeviceMappings:
        - DeviceName: /dev/sdm
          Ebs:
            VolumeType: io1
            Iops: 200
            DeleteOnTermination: false
            VolumeSize: 20
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          HealthCheck:
            Command:
              - CMD-SHELL
              - curl -f http://localhost:8080/ || exit 1
            Interval: 30
            Retries: 3
            StartPeriod: 1
            Timeout: 5
          Memory: 512
          Essential: true
      Volumes:
        - Host:
            SourcePath: ""/var/lib/docker/vfs/dir/""
          Name: ""my-vol""","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyEC2Instance:
    Type: ""AWS::EC2::Instance""
    Properties:
      ImageId: ""ami-0ff8a91507f77f867""
      InstanceType: t2.micro
      KeyName: testkey
      BlockDeviceMappings:
        - DeviceName: /dev/sdm
          Ebs:
            VolumeType: io1
            Iops: 200
            DeleteOnTermination: false
            VolumeSize: 20
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name:
            Ref: ""AppName1""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          HealthCheck:
            Command:
              - CMD-SHELL
              - curl -f http://localhost:8080/ || exit 1
            Interval: 30
            Retries: 3
            StartPeriod: 1
            Timeout: 5
          Memory: 512
          Essential: true
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          Memory: 512
          Essential: true
      Volumes:
        - Host:
            SourcePath: ""/var/lib/docker/vfs/dir/""
          Name: ""my-vol""",[[48]]
493,d53323be-dde6-4457-9a43-42df737e71d2,BOM - AWS Kinesis,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/kinesis,Unknown,"A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","Description: Kinesis
Resources:
  MyStream: 
    Type: AWS::Kinesis::Stream 
    Properties: 
        Name: MyKinesisStream1
        RetentionPeriodHours: 168 
        ShardCount: 3 
        StreamEncryption:
            EncryptionType: KMS 
            KeyId: !Ref myKey",[[3]]
494,d6653eee-2d4d-4e6a-976f-6794a497999a,API Gateway With Invalid Compression,CloudFormation,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_with_invalid_compression,Unknown,"API Gateway should have valid compression, which means attribute 'MinimumCompressionSize' should be set and its value should be greater than -1 and smaller than 10485760.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-restapi.html)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RestApi:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Body:
        swagger: 2.0
        info:
            version: 0.0.1
            title: test
        basePath: /pete
        schemes:
            - https
        definitions:
            Empty:
                type: object
      MinimumCompressionSize: 0
      Name: myApi
      Parameters:
          endpointConfigurationTypes: REGIONAL","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RestApi3:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Body:
        swagger: 2.0
        info:
            version: 0.0.1
            title: test
        basePath: /pete
        schemes:
            - https
        definitions:
            Empty:
                type: object
      MinimumCompressionSize: -1
      Name: myApi
      Parameters:
          endpointConfigurationTypes: REGIONAL

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RestApi4:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Body:
        swagger: 2.0
        info:
            version: 0.0.1
            title: test
        basePath: /pete
        schemes:
            - https
        definitions:
            Empty:
                type: object
      MinimumCompressionSize: 10485760
      Name: myApi
      Parameters:
          endpointConfigurationTypes: REGIONAL

AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RestApi5:
    Type: AWS::ApiGateway::RestApi
    Properties:
      Body:
        swagger: 2.0
        info:
            version: 0.0.1
            title: test
        basePath: /pete
        schemes:
            - https
        definitions:
            Empty:
                type: object
      Name: myApi
      Parameters:
          endpointConfigurationTypes: REGIONAL","[[17], [17], [5]]"
495,d71b5fd7-9020-4b2d-9ec8-b3839faa2744,Support Has No Role Associated,CloudFormation,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/support_has_no_role_associated,Unknown,"Check if any AWS Support policy does not have any role and users and group associated, which means that is not being managed.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Effect: Allow
            Action:
              - s3:GetObject
              - s3:PutObject
              - s3:PutObjectAcl
            Resource: arn:aws:s3:::myAWSBucket/*
      Groups:
        - myexistinggroup1
        - !Ref mygroup","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  noRoles:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: AWSSupportAccess
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: ""*""
      Users: [""SomeUser""]
      Groups: [""SomeGroup""]
  noUsers:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: AWSSupportAccess
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: ""*""
      Roles: [""SomeRole""]
      Groups: [""SomeGroup""]
  noGroups:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: AWSSupportAccess
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: ""*""
      Roles: [""SomeRole""]
      Users: [""SomeUser""]","[[16, 4, 28]]"
496,d7467bb6-3ed1-4c82-8095-5e7a818d0aad,CodeBuild Not Encrypted,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/codebuild_not_encrypted,Unknown,"CodeBuild Project should be encrypted, which means 'EncryptionKey' should be defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    CodeBuildProject:
      Project:
        Type: AWS::CodeBuild::Project
        Properties:
          Name: myProjectName
          Description: A description about my project
          EncryptionKey: ""alias/alias-name""
          ServiceRole: !GetAtt ServiceRole.Arn
          Artifacts:
            Type: no_artifacts
          Environment:
            Type: LINUX_CONTAINER
            ComputeType: BUILD_GENERAL1_SMALL
            Image: aws/codebuild/java:openjdk-8
            EnvironmentVariables:
            - Name: varName
              Type: varType
              Value: varValue
          Source:
            Location: codebuild-demo-test/0123ab9a371ebf0187b0fe5614fbb72c
            Type: S3
          TimeoutInMinutes: 10
          Tags:
            - Key: Key1
              Value: Value1
            - Key: Key2
              Value: Value2","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
    CodeBuildProject:
      Project:
        Type: AWS::CodeBuild::Project
        Properties:
          Name: myProjectName
          Description: A description about my project
          ServiceRole: !GetAtt ServiceRole.Arn
          Artifacts:
            Type: no_artifacts
          Environment:
            Type: LINUX_CONTAINER
            ComputeType: BUILD_GENERAL1_SMALL
            Image: aws/codebuild/java:openjdk-8
            EnvironmentVariables:
            - Name: varName
              Type: varType
              Value: varValue
          Source:
            Location: codebuild-demo-test/0123ab9a371ebf0187b0fe5614fbb72c
            Type: S3
          TimeoutInMinutes: 10
          Tags:
            - Key: Key1
              Value: Value1
            - Key: Key2
              Value: Value2",[[7]]
497,d926aa95-0a04-4abc-b20c-acf54afe38a1,ElasticSearch Encryption With KMS Disabled,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_domain_encryption_with_kms_disabled,Unknown,"Check if any ElasticSearch domain isn't encrypted with KMS.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-encryptionatrestoptions)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EncryptionAtRestOptions:
        Enabled: true
        KmsKeyId: ""some-kms-key-id""
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EncryptionAtRestOptions:
        Enabled: true
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster2
Resources:
  ElasticsearchDomain:
    Type: AWS::Elasticsearch::Domain
    Properties:
      DomainName: ""test""
      ElasticsearchClusterConfig:
        DedicatedMasterEnabled: ""true""
        InstanceCount: ""2""
        ZoneAwarenessEnabled: ""true""
        InstanceType: ""m3.medium.elasticsearch""
        DedicatedMasterType: ""m3.medium.elasticsearch""
        DedicatedMasterCount: ""3""
      EBSOptions:
        EBSEnabled: true
        Iops: 0
        VolumeSize: 20
        VolumeType: ""gp2""
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          -
            Effect: ""Allow""
            Principal:
              AWS: ""arn:aws:iam::123456789012:user/es-user""
            Action: ""es:*""
            Resource: ""arn:aws:es:us-east-1:846973539254:domain/test/*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","[[15], [6]]"
498,da905474-7454-43c0-b8d2-5756ab951aba,KMS Key With Vulnerable Policy,CloudFormation,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/kms_key_with_full_permissions,Unknown,"Checks if the policy is vulnerable and needs updating.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kms-key.html#cfn-kms-key-keypolicy)","Resources:
  RSASigningKey:
    Type: AWS::KMS::Key
    Properties:
      Description: RSA-3047 asymmetric CMK for signing and verification
      KeySpec: RSA_3072
      KeyUsage: SIGN_VERIFY
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:role/Developer
          Action:
          - kms:Sign
          - kms:Verify
          - kms:DescribeKey
          Resource: '*'","Resources:
  RSASigningKey:
    Type: AWS::KMS::Key
    Properties:
      Description: RSA-3047 asymmetric CMK for signing and verification
      KeySpec: RSA_3072
      KeyUsage: SIGN_VERIFY
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: '*'
          Action: kms:*
          Resource: '*'",[[8]]
499,dae9c373-8287-462f-8746-6f93dad93610,Security Group Egress With Port Range,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_egress_with_port_range,Unknown,"AWS Security Group Egress should have a single port<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-security-group-egress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 0
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 87
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        Description: TCP
        FromPort: 80
        ToPort: 87
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      Description: TCP
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[4, 22]]"
500,dc17ee4b-ddf2-4e23-96e8-7a36abad1303,CloudFront Without Minimum Protocol TLS 1.2,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudfront_without_minimum_protocol_tls_1.2,Unknown,"CloudFront Minimum Protocol version should be at least TLS 1.2<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudfront-distribution.html)","AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
        ViewerCertificate:
            AcmCertificateArn: String
            CloudFrontDefaultCertificate: true
            IamCertificateId: String
            MinimumProtocolVersion: ""TLSv1.2_2018""
            SslSupportMethod: String
      Tags:
        - Key: string-value
          Value: string-value","AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
        ViewerCertificate:
            AcmCertificateArn: String
            CloudFrontDefaultCertificate: true
            IamCertificateId: String
            MinimumProtocolVersion: ""TLSv1.1_2016""
            SslSupportMethod: String
      Tags:
        - Key: string-value
          Value: string-value
  cloudfrontdistribution2:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true
        CacheBehaviors:
          - LambdaFunctionAssociations:
              - EventType: string-value
                LambdaFunctionARN: string-value
        DefaultCacheBehavior:
          LambdaFunctionAssociations:
            - EventType: string-value
              LambdaFunctionARN: string-value
        IPV6Enabled: boolean-value
        Origins:
          - CustomOriginConfig:
              OriginKeepaliveTimeout: integer-value
              OriginReadTimeout: integer-value
      Tags:
        - Key: string-value
          Value: string-value","[[25, 33]]"
501,dc1ab429-1481-4540-9b1d-280e3f15f1f8,Serverless Function Without X-Ray Tracing,CloudFormation,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_sam/serverless_function_without_x-ray_tracing,Unknown,"AWS Serverless Function should have Tracing enabled. For this, property 'Tracing' should have the value 'Active'<br>
[Documentation](https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-tracing)","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function3:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Tracing: Active","AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function1:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function

AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: AWS SAM template with a simple API definition
Resources:
  Function2:
    Type: AWS::Serverless::Function
    Properties:
      PackageType: Image
      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name
      ImageConfig:
        Command:
          - ""app.lambda_handler""
        EntryPoint:
          - ""entrypoint1""
        WorkingDirectory: ""workDir""
      Tags:
        - Key: Type
          Value: AWS Serverless Function
      Tracing: PassThrough","[[7], [19]]"
502,ddfc4eaa-af23-409f-b96c-bf5c45dc4daa,HTTP Port Open To Internet,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/http_port_open,Unknown,"The HTTP port is open to the internet in a Security Group<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 192.168.0.0/16","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
        GroupDescription: Allow http to client host
        VpcId:
          Ref: myVPC
        SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0","[[10, 11]]"
503,de38e1d5-54cb-4111-a868-6f7722695007,RDS DB Instance Publicly Accessible,CloudFormation,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/rds_db_instance_publicly_accessible,Unknown,"RDS must not be defined with public interface, which means the attribute 'PubliclyAccessible' must be set to false.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample Template for creating an Amazon RDS DB instance:
  Sample template showing how to create a DB instance with Enhanced Monitoring enabled.
  **WARNING** This template creates an RDS DB instance. You will be billed for the AWS
  resources used if you create a stack from this template.
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
  DBName:
    Default: mydb
    Description: My database
    Type: String
    MinLength: '1'
    MaxLength: '64'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: Must begin with a letter and contain only alphanumeric characters.
  DBInstanceClass:
    Default: db.m5.large
    Description: DB instance class
    Type: String
    ConstraintDescription: Must select a valid DB instance type.
  DBAllocatedStorage:
    Default: '50'
    Description: The size of the database (GiB)
    Type: Number
    MinValue: '5'
    MaxValue: '1024'
    ConstraintDescription: must be between 20 and 65536 GiB.
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      PubliclyAccessible: false

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample Template for creating an Amazon RDS DB instance:
  Sample template showing how to create a DB instance with Enhanced Monitoring enabled.
  **WARNING** This template creates an RDS DB instance. You will be billed for the AWS
  resources used if you create a stack from this template.
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
  DBName:
    Default: mydb
    Description: My database
    Type: String
    MinLength: '1'
    MaxLength: '64'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: Must begin with a letter and contain only alphanumeric characters.
  DBInstanceClass:
    Default: db.m5.large
    Description: DB instance class
    Type: String
    ConstraintDescription: Must select a valid DB instance type.
  DBAllocatedStorage:
    Default: '50'
    Description: The size of the database (GiB)
    Type: Number
    MinValue: '5'
    MaxValue: '1024'
    ConstraintDescription: must be between 20 and 65536 GiB.
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      PubliclyAccessible: 'false'","#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample Template for creating an Amazon RDS DB instance:
  Sample template showing how to create a DB instance with Enhanced Monitoring enabled.
  **WARNING** This template creates an RDS DB instance. You will be billed for the AWS
  resources used if you create a stack from this template.
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
  DBName:
    Default: mydb
    Description: My database
    Type: String
    MinLength: '1'
    MaxLength: '64'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: Must begin with a letter and contain only alphanumeric characters.
  DBInstanceClass:
    Default: db.m5.large
    Description: DB instance class
    Type: String
    ConstraintDescription: Must select a valid DB instance type.
  DBAllocatedStorage:
    Default: '50'
    Description: The size of the database (GiB)
    Type: Number
    MinValue: '5'
    MaxValue: '1024'
    ConstraintDescription: must be between 20 and 65536 GiB.
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      PubliclyAccessible: true

#this is a problematic code where the query should report a result(s)
AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample Template for creating an Amazon RDS DB instance:
  Sample template showing how to create a DB instance with Enhanced Monitoring enabled.
  **WARNING** This template creates an RDS DB instance. You will be billed for the AWS
  resources used if you create a stack from this template.
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
  DBName:
    Default: mydb
    Description: My database
    Type: String
    MinLength: '1'
    MaxLength: '64'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: Must begin with a letter and contain only alphanumeric characters.
  DBInstanceClass:
    Default: db.m5.large
    Description: DB instance class
    Type: String
    ConstraintDescription: Must select a valid DB instance type.
  DBAllocatedStorage:
    Default: '50'
    Description: The size of the database (GiB)
    Type: Number
    MinValue: '5'
    MaxValue: '1024'
    ConstraintDescription: must be between 20 and 65536 GiB.
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      PubliclyAccessible: ""true""","[[69], [69]]"
504,de76a0d6-66d5-45c9-9022-f05545b85c78,Redshift Cluster Without KMS CMK,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/redshift_cluster_without_kms_cmk,Unknown,"AWS Redshift Cluster should have KMS CMK defined<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html)","AWSTemplateFormatVersion: 2010-09-09
Description: Redshift Stack
Resources:
  RedshiftCluster:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
      KmsKeyId: wewewewewefsa
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}","AWSTemplateFormatVersion: 2010-09-09
Description: Redshift Stack
Resources:
  RedshiftCluster:
    Type: AWS::Redshift::Cluster
    Properties:
      ClusterSubnetGroupName: !Ref RedshiftClusterSubnetGroup
      ClusterType: !If [ SingleNode, single-node, multi-node ]
      NumberOfNodes: !If [ SingleNode, !Ref 'AWS::NoValue', !Ref RedshiftNodeCount ] #'
      DBName: !Sub ${DatabaseName}
      IamRoles:
        - !GetAtt RawDataBucketAccessRole.Arn
      MasterUserPassword: !Ref MasterUserPassword
      MasterUsername: !Ref MasterUsername
      PubliclyAccessible: true
      NodeType: dc1.large
      Port: 5439
      VpcSecurityGroupIds:
        - !Sub ${RedshiftSecurityGroup}
      PreferredMaintenanceWindow: Sun:09:15-Sun:09:45
  DataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub ${DataBucketName}",[[6]]
505,de77cd9f-0e8b-46cc-b4a4-b6b436838642,CloudFront Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cloudfront_logging_disabled,Unknown,"AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'DistributionConfig.Logging' should be defined<br>
[Documentation](https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/logging-and-monitoring.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution3:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Origins:
        - DomainName: mybucket.s3.amazonaws.com
          Id: myS3Origin
          S3OriginConfig:
            OriginAccessIdentity: origin-access-identity/cloudfront/E127EXAMPLE51Z
        Enabled: 'true'
        Comment: Some comment
        DefaultRootObject: index.html
        Logging:
          IncludeCookies: 'false'
          Bucket: mylogs.s3.amazonaws.com
          Prefix: myprefix
    DefaultCacheBehavior:
      AllowedMethods:
      - GET
      - HEAD
      - OPTIONS
      TargetOriginId: myS3Origin
      ForwardedValues:
        QueryString: 'false'
        Cookies:
          Forward: none
      TrustedSigners:
      - 1234567890EX
      ViewerProtocolPolicy: allow-all","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution1:
    Type: AWS::CloudFront::Distribution
    Properties:
      DefaultCacheBehavior:
        AllowedMethods:
        - GET
        - HEAD
        - OPTIONS
        TargetOriginId: myS3Origin
        ForwardedValues:
          QueryString: 'false'
          Cookies:
            Forward: none
        TrustedSigners:
        - 1234567890EX
        ViewerProtocolPolicy: allow-all
      DistributionConfig:
        Origins:
        - DomainName: mybucket.s3.amazonaws.com
          Id: myS3Origin
          S3OriginConfig:
            OriginAccessIdentity: origin-access-identity/cloudfront/E127EXAMPLE51Z
        Enabled: 'true'
        Comment: Some comment
        DefaultRootObject: index.html

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution2:
    Type: AWS::CloudFront::Distribution
    Properties:
      DefaultCacheBehavior:
        AllowedMethods:
        - GET
        - HEAD
        - OPTIONS
        TargetOriginId: myS3Origin
        ForwardedValues:
          QueryString: 'false'
          Cookies:
            Forward: none
        TrustedSigners:
        - 1234567890EX
        ViewerProtocolPolicy: allow-all
      DistributionConfig:
        Origins:
        - DomainName: mybucket.s3.amazonaws.com
          Id: myS3Origin
          S3OriginConfig:
            OriginAccessIdentity: origin-access-identity/cloudfront/E127EXAMPLE51Z
        Enabled: 'true'
        Comment: Some comment
        DefaultRootObject: index.html
        Logging:
          IncludeCookies: 'false'
          Bucket: mylogs.amazonaws.com
          Prefix: myprefix","[[5], [30]]"
506,dfb56e5d-ee68-446e-b32a-657b62befe69,Amplify Branch Basic Auth Config Password Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/amplify_branch_basic_auth_config_password_exposed,Unknown,"Amplify Branch BasicAuthConfig Password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amplify-branch.html#cfn-amplify-branch-basicauthconfig)","Resources:
     NewAmpApp:
        Type: AWS::Amplify::App
        Properties:
          BuildSpec: String
          CustomHeaders: String
          Description: String
          EnableBranchAutoDeletion: true
          IAMServiceRole: String
          Name: NewAmpApp
          OauthToken: String
          Repository: String
          BasicAuthConfig :
            EnableBasicAuth: true
            Password: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
            Username: !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::username}}'
     MyAmpAppSecretManagerRotater:
        Type: AWS::SecretsManager::Secret
        Properties:
          Description: 'This is my amp app instance secret'
          GenerateSecretString:
            SecretStringTemplate: '{""username"": ""admin""}'
            GenerateStringKey: 'password'
            PasswordLength: 16
            ExcludeCharacters: '""@/\'

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
  ParentUsername:
    Description: 'Username'
    Type: String
Resources:
  NewAmpApp1:
    Type: AWS::Amplify::Branch
    Properties:
      AppId: String
      BranchName: String
      BuildSpec: String
      Description: String
      EnableAutoBuild: false
      EnablePerformanceMode: false
      EnablePullRequestPreview: false
      EnvironmentVariables:
        - EnvironmentVariable
      PullRequestEnvironmentName: String
      Stage: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: """"
    NoEcho: true
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp4:
    Type: AWS::Amplify::Branch
    Properties:
      AppId: String
      BranchName: String
      BuildSpec: String
      Description: String
      EnableAutoBuild: false
      EnablePerformanceMode: false
      EnablePullRequestPreview: false
      EnvironmentVariables:
        - EnvironmentVariable
      PullRequestEnvironmentName: String
      Stage: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername","Resources:
  NewAmpApp1:
    Type: AWS::Amplify::Branch
    Properties:
      AppId: String
      BranchName: String
      BuildSpec: String
      Description: String
      EnableAutoBuild: false
      EnablePerformanceMode: false
      EnablePullRequestPreview: false
      EnvironmentVariables:
        - EnvironmentVariable
      PullRequestEnvironmentName: String
      Stage: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: ""@skdsjdk0234!AB""
        Username: admin

Parameters:
  ParentPassword:
    Description: 'Password'
    Type: String
    Default: ""@skdsjdk0234!AB""
  ParentUsername:
    Description: 'Username'
    Type: String
    Default: """"
Resources:
  NewAmpApp4:
    Type: AWS::Amplify::Branch
    Properties:
      AppId: String
      BranchName: String
      BuildSpec: String
      Description: String
      EnableAutoBuild: false
      EnablePerformanceMode: false
      EnablePullRequestPreview: false
      EnvironmentVariables:
        - EnvironmentVariable
      PullRequestEnvironmentName: String
      Stage: String
      BasicAuthConfig:
        EnableBasicAuth: true
        Password: !Ref ParentPassword
        Username: !Ref ParentUsername","[[18], [5]]"
507,e200a6f3-c589-49ec-9143-7421d4a2c845,ELB With Security Group Without Inbound Rules,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_with_security_group_without_inbound_rules,Unknown,"An AWS Elastic Load Balancer (ELB) shouldn't have security groups without outbound rules<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html#cfn-ec2-securitygroup-securitygroupingress)","AWSTemplateFormatVersion: 2010-09-09
Resources:
    sgwithingress:
        Type: AWS::EC2::SecurityGroup
        Properties:
            GroupDescription: Limits security group egress traffic
            SecurityGroupIngress:
            -   IpProtocol: tcp
                FromPort: 80
                ToPort: 80
                CidrIp: 0.0.0.0/0
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
            SecurityGroups:
            -   sgwithingress","AWSTemplateFormatVersion: 2010-09-09
Resources:
    sgwithoutingress:
        Type: AWS::EC2::SecurityGroup
        Properties:
            GroupDescription: Limits security group egress traffic
    MyLoadBalancer:
        Type: AWS::ElasticLoadBalancing::LoadBalancer
        Properties:
            SecurityGroups:
            -   sgwithoutingress",[[5]]
508,e415f8d3-fc2b-4f52-88ab-1129e8c8d3f5,Fully Open Ingress,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/fully_open_ingress,Unknown,"ECS Service's security group should not allow unrestricted access to all ports from all IPv4 addresses<br>
[Documentation](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/get-set-up-for-amazon-ecs.html#create-a-base-security-group)","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  VpcId:
    Type: AWS::EC2::VPC::Id
    Description: Select a VPC that allows instances access to the Internet.
  SubnetId:
    Type: List<AWS::EC2::Subnet::Id>
    Description: Select at two subnets in your selected VPC.
Resources:
  ECSCluster:
    Type: AWS::ECS::Cluster
  EcsSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ECS Security Group
      VpcId: !Ref 'VpcId'
  EcsSecurityGroupHTTPinbound:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 80
      ToPort: 80
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupSSHinbound:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 22
      ToPort: 22
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupALBports:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 31000
      ToPort: 61000
      SourceSecurityGroupId: !Ref 'EcsSecurityGroup'
  CloudwatchLogsGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Join ['-', [ECSLogGroup, !Ref 'AWS::StackName']]
      RetentionInDays: 14
  TaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: !Join ['', [!Ref 'AWS::StackName', -ecs-demo-app]]
      ContainerDefinitions:
      - Name: simple-app
        Cpu: 10
        Essential: true
        Image: httpd:2.4
        Memory: 300
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        MountPoints:
        - ContainerPath: /usr/local/apache2/htdocs
          SourceVolume: my-vol
        PortMappings:
        - ContainerPort: 80
      - Name: busybox
        Cpu: 10
        Command: ['/bin/sh -c ""while true; do echo ''<html> <head> <title>Amazon ECS
            Sample App</title></head><body></body></html>'' > bottom; cat top date bottom > /usr/local/apache2/htdocs/index.html
            ; sleep 1; done""']
        EntryPoint: [sh, -c]
        Essential: false
        Image: busybox
        Memory: 200
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        VolumesFrom:
        - SourceContainer: simple-app
      Volumes:
      - Name: my-vol
  ECSALB:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: ECSALB
      Scheme: internet-facing
      LoadBalancerAttributes:
      - Key: idle_timeout.timeout_seconds
        Value: '30'
      Subnets: !Ref 'SubnetId'
      SecurityGroups: [!Ref 'EcsSecurityGroup']
  ALBListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      DefaultActions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      LoadBalancerArn: !Ref 'ECSALB'
      Port: 80
      Protocol: HTTP
  ECSALBListenerRule:
    Type: AWS::ElasticLoadBalancingV2::ListenerRule
    Properties:
      Actions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      Conditions:
      - Field: path-pattern
        Values: [/]
      ListenerArn: !Ref 'ALBListener'
      Priority: 1
  ECSTG:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
      HealthCheckIntervalSeconds: 10
      HealthCheckPath: /
      HealthCheckProtocol: HTTP
      HealthCheckTimeoutSeconds: 5
      HealthyThresholdCount: 2
      Name: ECSTG
      Port: 80
      Protocol: HTTP
      UnhealthyThresholdCount: 2
      VpcId: !Ref 'VpcId'
  ECSAutoScalingGroup:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      VPCZoneIdentifier: !Ref 'SubnetId'
      LaunchConfigurationName: !Ref 'ContainerInstances'
      MinSize: '1'
      MaxSize: 4
      DesiredCapacity: 2
    CreationPolicy:
      ResourceSignal:
        Timeout: PT15M
    UpdatePolicy:
      AutoScalingReplacingUpdate:
        WillReplace: true
  ContainerInstances:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ImageId: ami-09bee01cc997a78a6
      SecurityGroups: [!Ref 'EcsSecurityGroup']
      InstanceType: t2.small
      IamInstanceProfile: !Ref 'EC2InstanceProfile'
      KeyName: my-ssh-key
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash -xe
          echo ECS_CLUSTER=${ECSCluster} >> /etc/ecs/ecs.config
          yum install -y aws-cfn-bootstrap
          /opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource ECSAutoScalingGroup --region ${AWS::Region}
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref 'ECSCluster'
      DesiredCount: 1
      LoadBalancers:
      - ContainerName: simple-app
        ContainerPort: 80
        TargetGroupArn: !Ref 'ECSTG'
      Role: !Ref 'ECSServiceRole'
      TaskDefinition: !Ref 'taskdefinition'
  ECSServiceRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ecs.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['elasticloadbalancing:DeregisterInstancesFromLoadBalancer', 'elasticloadbalancing:DeregisterTargets',
              'elasticloadbalancing:Describe*', 'elasticloadbalancing:RegisterInstancesWithLoadBalancer',
              'elasticloadbalancing:RegisterTargets', 'ec2:Describe*', 'ec2:AuthorizeSecurityGroupIngress']
            Resource: '*'
  ServiceScalingTarget:
    Type: AWS::ApplicationAutoScaling::ScalableTarget
    Properties:
      MaxCapacity: 2
      MinCapacity: 1
      ResourceId: !Join ['', [service/, !Ref 'ECSCluster', /, !GetAtt [service, Name]]]
      RoleARN: !GetAtt [AutoscalingRole, Arn]
      ScalableDimension: ecs:service:DesiredCount
      ServiceNamespace: ecs
  ServiceScalingPolicy:
    Type: AWS::ApplicationAutoScaling::ScalingPolicy
    Properties:
      PolicyName: AStepPolicy
      PolicyType: StepScaling
      ScalingTargetId: !Ref 'ServiceScalingTarget'
      StepScalingPolicyConfiguration:
        AdjustmentType: PercentChangeInCapacity
        Cooldown: 60
        MetricAggregationType: Average
        StepAdjustments:
        - MetricIntervalLowerBound: 0
          ScalingAdjustment: 200
  ALB500sAlarmScaleUp:
    Type: AWS::CloudWatch::Alarm
    Properties:
      EvaluationPeriods: 1
      Statistic: Average
      Threshold: 10
      AlarmDescription: Alarm if our ALB generates too many HTTP 500s.
      Period: 60
      AlarmActions: [!Ref 'ServiceScalingPolicy']
      Namespace: AWS/ApplicationELB
      Dimensions:
        - Name: LoadBalancer
          Value: !GetAtt
            - ECSALB
            - LoadBalancerFullName
      ComparisonOperator: GreaterThanThreshold
      MetricName: HTTPCode_ELB_5XX_Count
  EC2Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ec2.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['ecs:CreateCluster', 'ecs:DeregisterContainerInstance', 'ecs:DiscoverPollEndpoint',
              'ecs:Poll', 'ecs:RegisterContainerInstance', 'ecs:StartTelemetrySession',
              'ecs:Submit*', 'logs:CreateLogStream', 'logs:PutLogEvents']
            Resource: '*'
  AutoscalingRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [application-autoscaling.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: service-autoscaling
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['application-autoscaling:*', 'cloudwatch:DescribeAlarms', 'cloudwatch:PutMetricAlarm',
              'ecs:DescribeServices', 'ecs:UpdateService']
            Resource: '*'
  EC2InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles: [!Ref 'EC2Role']","AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  VpcId:
    Type: AWS::EC2::VPC::Id
    Description: Select a VPC that allows instances access to the Internet.
  SubnetId:
    Type: List<AWS::EC2::Subnet::Id>
    Description: Select at two subnets in your selected VPC.
Resources:
  ECSCluster:
    Type: AWS::ECS::Cluster
  EcsSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ECS Security Group
      VpcId: !Ref 'VpcId'
  EcsSecurityGroupHTTPinbound02:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 80
      ToPort: 0
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupSSHinbound:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 22
      ToPort: 0
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupALBports:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 31000
      ToPort: 61000
      SourceSecurityGroupId: !Ref 'EcsSecurityGroup'
  CloudwatchLogsGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Join ['-', [ECSLogGroup, !Ref 'AWS::StackName']]
      RetentionInDays: 14
  TaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: !Join ['', [!Ref 'AWS::StackName', -ecs-demo-app]]
      ContainerDefinitions:
      - Name: simple-app
        Cpu: 10
        Essential: true
        Image: httpd:2.4
        Memory: 300
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        MountPoints:
        - ContainerPath: /usr/local/apache2/htdocs
          SourceVolume: my-vol
        PortMappings:
        - ContainerPort: 80
      - Name: busybox
        Cpu: 10
        Command: ['/bin/sh -c ""while true; do echo ''<html> <head> <title>Amazon ECS
            Sample App</title></head></html>'' > bottom; cat top date bottom > /usr/local/apache2/htdocs/index.html
            ; sleep 1; done""']
        EntryPoint: [sh, -c]
        Essential: false
        Image: busybox
        Memory: 200
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        VolumesFrom:
        - SourceContainer: simple-app
      Volumes:
      - Name: my-vol
  ECSALB:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: ECSALB
      Scheme: internet-facing
      LoadBalancerAttributes:
      - Key: idle_timeout.timeout_seconds
        Value: '30'
      Subnets: !Ref 'SubnetId'
      SecurityGroups: [!Ref 'EcsSecurityGroup']
  ALBListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      DefaultActions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      LoadBalancerArn: !Ref 'ECSALB'
      Port: 80
      Protocol: HTTP
  ECSALBListenerRule:
    Type: AWS::ElasticLoadBalancingV2::ListenerRule
    Properties:
      Actions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      Conditions:
      - Field: path-pattern
        Values: [/]
      ListenerArn: !Ref 'ALBListener'
      Priority: 1
  ECSTG:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
      HealthCheckIntervalSeconds: 10
      HealthCheckPath: /
      HealthCheckProtocol: HTTP
      HealthCheckTimeoutSeconds: 5
      HealthyThresholdCount: 2
      Name: ECSTG
      Port: 80
      Protocol: HTTP
      UnhealthyThresholdCount: 2
      VpcId: !Ref 'VpcId'
  ECSAutoScalingGroup:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      VPCZoneIdentifier: !Ref 'SubnetId'
      LaunchConfigurationName: !Ref 'ContainerInstances'
      MinSize: '1'
      MaxSize: 4
      DesiredCapacity: 2
    CreationPolicy:
      ResourceSignal:
        Timeout: PT15M
    UpdatePolicy:
      AutoScalingReplacingUpdate:
        WillReplace: true
  ContainerInstances:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ImageId: ami-128731982dhash
      SecurityGroups: [!Ref 'EcsSecurityGroup']
      InstanceType: t2.small
      IamInstanceProfile: !Ref 'EC2InstanceProfile'
      KeyName: my-ssh-key
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash -xe
          echo ECS_CLUSTER=${ECSCluster} >> /etc/ecs/ecs.config
          yum install -y aws-cfn-bootstrap
          /opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource ECSAutoScalingGroup --region ${AWS::Region}
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref 'ECSCluster'
      DesiredCount: 1
      LoadBalancers:
      - ContainerName: simple-app
        ContainerPort: 80
        TargetGroupArn: !Ref 'ECSTG'
      Role: !Ref 'ECSServiceRole'
      TaskDefinition: !Ref 'TaskDefinition'
  ECSServiceRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ecs.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['elasticloadbalancing:DeregisterInstancesFromLoadBalancer', 'elasticloadbalancing:DeregisterTargets',
              'elasticloadbalancing:Describe*', 'elasticloadbalancing:RegisterInstancesWithLoadBalancer',
              'elasticloadbalancing:RegisterTargets', 'ec2:Describe*', 'ec2:AuthorizeSecurityGroupIngress']
            Resource: '*'
  ServiceScalingTarget:
    Type: AWS::ApplicationAutoScaling::ScalableTarget
    Properties:
      MaxCapacity: 2
      MinCapacity: 1
      ResourceId: !Join ['', [service/, !Ref 'ECSCluster', /, !GetAtt [service, Name]]]
      RoleARN: !GetAtt [AutoscalingRole, Arn]
      ScalableDimension: ecs:service:DesiredCount
      ServiceNamespace: ecs
  ServiceScalingPolicy:
    Type: AWS::ApplicationAutoScaling::ScalingPolicy
    Properties:
      PolicyName: AStepPolicy
      PolicyType: StepScaling
      ScalingTargetId: !Ref 'ServiceScalingTarget'
      StepScalingPolicyConfiguration:
        AdjustmentType: PercentChangeInCapacity
        Cooldown: 60
        MetricAggregationType: Average
        StepAdjustments:
        - MetricIntervalLowerBound: 0
          ScalingAdjustment: 200
  ALB500sAlarmScaleUp:
    Type: AWS::CloudWatch::Alarm
    Properties:
      EvaluationPeriods: 1
      Statistic: Average
      Threshold: 10
      AlarmDescription: Alarm if our ALB generates too many HTTP 500s.
      Period: 60
      AlarmActions: [!Ref 'ServiceScalingPolicy']
      Namespace: AWS/ApplicationELB
      Dimensions:
        - Name: LoadBalancer
          Value: !GetAtt
            - ECSALB
            - LoadBalancerFullName
      ComparisonOperator: GreaterThanThreshold
      MetricName: HTTPCode_ELB_5XX_Count
  EC2Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ec2.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['ecs:CreateCluster', 'ecs:DeregisterContainerInstance', 'ecs:DiscoverPollEndpoint',
              'ecs:Poll', 'ecs:RegisterContainerInstance', 'ecs:StartTelemetrySession',
              'ecs:Submit*', 'logs:CreateLogStream', 'logs:PutLogEvents']
            Resource: '*'
  AutoscalingRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [application-autoscaling.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: service-autoscaling
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['application-autoscaling:*', 'cloudwatch:DescribeAlarms', 'cloudwatch:PutMetricAlarm',
              'ecs:DescribeServices', 'ecs:UpdateService']
            Resource: '*'
  EC2InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles: [!Ref 'EC2Role']
Outputs:
  ecsservice:
    Value: !Ref 'service'
  ecscluster:
    Value: !Ref 'ECSCluster'
  ECSALB:
    Description: Your ALB DNS URL
    Value: !Join ['', [!GetAtt [ECSALB, DNSName]]]
  taskdef:
    Value: !Ref 'TaskDefinition'

AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  VpcId:
    Type: AWS::EC2::VPC::Id
    Description: Select a VPC that allows instances access to the Internet.
  SubnetId:
    Type: List<AWS::EC2::Subnet::Id>
    Description: Select at two subnets in your selected VPC.
Resources:
  ECSCluster:
    Type: AWS::ECS::Cluster
  EcsSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ECS Security Group
      VpcId: !Ref 'VpcId'
  EcsSecurityGroupHTTPinbound:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 80
      ToPort: 0
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupSSHinbound:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 22
      ToPort: 22
      CidrIp: 0.0.0.0/0
  EcsSecurityGroupALBports:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      GroupId: !Ref 'EcsSecurityGroup'
      IpProtocol: tcp
      FromPort: 31000
      ToPort: 61000
      SourceSecurityGroupId: !Ref 'EcsSecurityGroup'
  CloudwatchLogsGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Join ['-', [ECSLogGroup, !Ref 'AWS::StackName']]
      RetentionInDays: 14
  TaskDefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: !Join ['', [!Ref 'AWS::StackName', -ecs-demo-app]]
      ContainerDefinitions:
      - Name: simple-app
        Cpu: 10
        Essential: true
        Image: httpd:2.4
        Memory: 300
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        MountPoints:
        - ContainerPath: /usr/local/apache2/htdocs
          SourceVolume: my-vol
        PortMappings:
        - ContainerPort: 80
      - Name: busybox
        Cpu: 10
        Command: ['/bin/sh -c ""while true; do echo ''<html> <head> <title>Amazon ECS
            Sample App</title></head><body></body></html>'' > bottom; cat top date bottom > /usr/local/apache2/htdocs/index.html
            ; sleep 1; done""']
        EntryPoint: [sh, -c]
        Essential: false
        Image: busybox
        Memory: 200
        LogConfiguration:
          LogDriver: awslogs
          Options:
            awslogs-group: !Ref 'CloudwatchLogsGroup'
            awslogs-region: !Ref 'AWS::Region'
            awslogs-stream-prefix: ecs-demo-app
        VolumesFrom:
        - SourceContainer: simple-app
      Volumes:
      - Name: my-vol
  ECSALB:
    Type: AWS::ElasticLoadBalancingV2::LoadBalancer
    Properties:
      Name: ECSALB
      Scheme: internet-facing
      LoadBalancerAttributes:
      - Key: idle_timeout.timeout_seconds
        Value: '30'
      Subnets: !Ref 'SubnetId'
      SecurityGroups: [!Ref 'EcsSecurityGroup']
  ALBListener:
    Type: AWS::ElasticLoadBalancingV2::Listener
    Properties:
      DefaultActions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      LoadBalancerArn: !Ref 'ECSALB'
      Port: 80
      Protocol: HTTP
  ECSALBListenerRule:
    Type: AWS::ElasticLoadBalancingV2::ListenerRule
    Properties:
      Actions:
      - Type: forward
        TargetGroupArn: !Ref 'ECSTG'
      Conditions:
      - Field: path-pattern
        Values: [/]
      ListenerArn: !Ref 'ALBListener'
      Priority: 1
  ECSTG:
    Type: AWS::ElasticLoadBalancingV2::TargetGroup
    Properties:
      HealthCheckIntervalSeconds: 10
      HealthCheckPath: /
      HealthCheckProtocol: HTTP
      HealthCheckTimeoutSeconds: 5
      HealthyThresholdCount: 2
      Name: ECSTG
      Port: 80
      Protocol: HTTP
      UnhealthyThresholdCount: 2
      VpcId: !Ref 'VpcId'
  ECSAutoScalingGroup:
    Type: AWS::AutoScaling::AutoScalingGroup
    Properties:
      VPCZoneIdentifier: !Ref 'SubnetId'
      LaunchConfigurationName: !Ref 'ContainerInstances'
      MinSize: '1'
      MaxSize: 4
      DesiredCapacity: 2
    CreationPolicy:
      ResourceSignal:
        Timeout: PT15M
    UpdatePolicy:
      AutoScalingReplacingUpdate:
        WillReplace: true
  ContainerInstances:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      ImageId: ami-09bee01cc997a78a6
      SecurityGroups: [!Ref 'EcsSecurityGroup']
      InstanceType: t2.small
      IamInstanceProfile: !Ref 'EC2InstanceProfile'
      KeyName: my-ssh-key
      UserData:
        Fn::Base64: !Sub |
          #!/bin/bash -xe
          echo ECS_CLUSTER=${ECSCluster} >> /etc/ecs/ecs.config
          yum install -y aws-cfn-bootstrap
          /opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource ECSAutoScalingGroup --region ${AWS::Region}
  service:
    Type: AWS::ECS::Service
    Properties:
      Cluster: !Ref 'ECSCluster'
      DesiredCount: 1
      LoadBalancers:
      - ContainerName: simple-app
        ContainerPort: 80
        TargetGroupArn: !Ref 'ECSTG'
      Role: !Ref 'ECSServiceRole'
      TaskDefinition: !Ref 'TaskDefinition'
  ECSServiceRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ecs.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['elasticloadbalancing:DeregisterInstancesFromLoadBalancer', 'elasticloadbalancing:DeregisterTargets',
              'elasticloadbalancing:Describe*', 'elasticloadbalancing:RegisterInstancesWithLoadBalancer',
              'elasticloadbalancing:RegisterTargets', 'ec2:Describe*', 'ec2:AuthorizeSecurityGroupIngress']
            Resource: '*'
  ServiceScalingTarget:
    Type: AWS::ApplicationAutoScaling::ScalableTarget
    Properties:
      MaxCapacity: 2
      MinCapacity: 1
      ResourceId: !Join ['', [service/, !Ref 'ECSCluster', /, !GetAtt [service, Name]]]
      RoleARN: !GetAtt [AutoscalingRole, Arn]
      ScalableDimension: ecs:service:DesiredCount
      ServiceNamespace: ecs
  ServiceScalingPolicy:
    Type: AWS::ApplicationAutoScaling::ScalingPolicy
    Properties:
      PolicyName: AStepPolicy
      PolicyType: StepScaling
      ScalingTargetId: !Ref 'ServiceScalingTarget'
      StepScalingPolicyConfiguration:
        AdjustmentType: PercentChangeInCapacity
        Cooldown: 60
        MetricAggregationType: Average
        StepAdjustments:
        - MetricIntervalLowerBound: 0
          ScalingAdjustment: 200
  ALB500sAlarmScaleUp:
    Type: AWS::CloudWatch::Alarm
    Properties:
      EvaluationPeriods: 1
      Statistic: Average
      Threshold: 10
      AlarmDescription: Alarm if our ALB generates too many HTTP 500s.
      Period: 60
      AlarmActions: [!Ref 'ServiceScalingPolicy']
      Namespace: AWS/ApplicationELB
      Dimensions:
        - Name: LoadBalancer
          Value: !GetAtt
            - ECSALB
            - LoadBalancerFullName
      ComparisonOperator: GreaterThanThreshold
      MetricName: HTTPCode_ELB_5XX_Count
  EC2Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [ec2.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: ecs-service
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['ecs:CreateCluster', 'ecs:DeregisterContainerInstance', 'ecs:DiscoverPollEndpoint',
              'ecs:Poll', 'ecs:RegisterContainerInstance', 'ecs:StartTelemetrySession',
              'ecs:Submit*', 'logs:CreateLogStream', 'logs:PutLogEvents']
            Resource: '*'
  AutoscalingRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Effect: Allow
          Principal:
            Service: [application-autoscaling.amazonaws.com]
          Action: ['sts:AssumeRole']
      Path: /
      Policies:
      - PolicyName: service-autoscaling
        PolicyDocument:
          Statement:
          - Effect: Allow
            Action: ['application-autoscaling:*', 'cloudwatch:DescribeAlarms', 'cloudwatch:PutMetricAlarm',
              'ecs:DescribeServices', 'ecs:UpdateService']
            Resource: '*'
  EC2InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: /
      Roles: [!Ref 'EC2Role']","[[32, 24], [24]]"
509,e4239438-e639-44aa-adb8-866e400e3ade,IAM Policy On User,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policy_on_user,Unknown,"IAM policies should be applied to groups and not to users<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html)","#this code is a correct code for which the query should not find any result
Resources:
  GoodPolicy:
    Type: AWS::IAM::Policy
    Properties:
      Description: Policy for something.
      Path: ""/""
      PolicyDocument:
        Version: '2012-10-17'
        Statement: []
      Groups:
      - user_group","#this is a problematic code where the query should report a result(s)
Resources:
  BadPolicy:
    Type: AWS::IAM::Policy
    Properties:
      Description: Policy for something.
      Path: ""/""
      PolicyDocument:
        Version: '2012-10-17'
        Statement: []
      Users:
      - Ref: TestUser",[[11]]
510,e42a3ef0-5325-4667-84bf-075ba1c9d58e,EC2 Instance Using Default VPC,CloudFormation,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_instance_using_default_vpc,Unknown,"EC2 Instances should not be configured under a default VPC network<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-subnetid)","Resources:
  DefaultVPC:
    Type: AWS::EC2::Instance
    Properties: 
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      SubnetId: !Ref PublicSubnetA22
  PublicSubnetA22:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref VPC
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A","Resources:
  DefaultVPC:
    Type: AWS::EC2::Instance
    Properties: 
      ImageId: ""ami-79fd7eee""
      KeyName: ""testkey""
      SubnetId: !Ref PublicSubnetA2
  PublicSubnetA2:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: !Ref DefaultVPC
      CidrBlock: 10.1.10.0/24
      AvailabilityZone: !Select [ 0, !GetAZs ]    # Obtenha o primeiro AZ na lista
      Tags:
          - Key: Name
            Value: !Sub ${AWS::StackName}-Public-A",[[7]]
511,e4ee3903-9225-4b6a-bdfb-e62dbadef821,ElastiCache With Disabled at Rest Encryption,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticache_with_disabled_at_rest_encryption,Unknown,"Ensure AWS ElastiCache Redis clusters have encryption for data at rest enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html#cfn-elasticache-replicationgroup-atrestencryptionenabled)","AWSTemplateFormatVersion: '2010-09-09'
Description: 'State: ElastiCache redis, a cloudonaut.io template'
Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: true
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: !Ref TransitEncryption
    UpdatePolicy:
      UseOnlineResharding: true

AWSTemplateFormatVersion: '2010-09-09'
Description: 'State: ElastiCache redis, a cloudonaut.io template'
Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: ""true""
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, ""true"", ""false""]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: !Ref TransitEncryption
    UpdatePolicy:
      UseOnlineResharding: ""true""","AWSTemplateFormatVersion: '2010-09-09'
Description: 'State: ElastiCache redis, a cloudonaut.io template'
Resources:
  ReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AtRestEncryptionEnabled: false
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: !Ref TransitEncryption

AWSTemplateFormatVersion: '2010-09-09'
Description: 'State: ElastiCache redis, a cloudonaut.io template'
Resources:
  MyReplicationGroup:
    DeletionPolicy: Snapshot
    UpdateReplacePolicy: Snapshot
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupDescription: !Ref 'AWS::StackName'
      AuthToken: !If [HasAuthToken, !Ref AuthToken, !Ref 'AWS::NoValue']
      AutomaticFailoverEnabled: !If [HasAutomaticFailoverEnabled, true, false]
      CacheNodeType: !Ref CacheNodeType
      CacheParameterGroupName: !Ref CacheParameterGroup
      CacheSubnetGroupName: !Ref CacheSubnetGroupName
      Engine: redis
      EngineVersion: !Ref EngineVersion
      KmsKeyId: !If [HasKmsKey, {'Fn::ImportValue': !Sub '${ParentKmsKeyStack}-KeyId'}, !Ref 'AWS::NoValue']
      NotificationTopicArn: !If [HasAlertTopic, {'Fn::ImportValue': !Sub '${ParentAlertStack}-TopicARN'}, !Ref 'AWS::NoValue']
      NumNodeGroups: !Ref NumShards
      ReplicasPerNodeGroup: !Ref NumReplicas
      PreferredMaintenanceWindow: 'sat:07:00-sat:08:00'
      SecurityGroupIds:
      - !Ref SecurityGroup
      SnapshotName: !If [HasSnapshotName, !Ref SnapshotName, !Ref 'AWS::NoValue']
      SnapshotRetentionLimit: !Ref SnapshotRetentionLimit
      SnapshotWindow: '00:00-03:00'
      TransitEncryptionEnabled: !Ref TransitEncryption
    UpdatePolicy:
      UseOnlineResharding: true","[[10], [8]]"
512,e4f54ff4-d352-40e8-a096-5141073c37a2,CDN Configuration Is Missing,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cdn_configuration_is_missing,Unknown,"Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cloudfront-distribution-distributionconfig.html)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
      DistributionConfig:
        Origins:
        - DomainName: www.example.com
          Id: myCustomOrigin
          CustomOriginConfig:
            HTTPPort: '80'
            HTTPSPort: '443'
            OriginProtocolPolicy: http-only
        Enabled: 'true'
        Comment: Somecomment
        DefaultRootObject: index.html
        Logging:
          IncludeCookies: 'true'
          Bucket: mylogs.s3.amazonaws.com
          Prefix: myprefix","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: 'AWS::CloudFront::Distribution'
    Properties:
      DistributionConfig:
        Enabled: 'false'
        Comment: Somecomment
        DefaultRootObject: index.html
        Logging:
          IncludeCookies: 'true'
          Bucket: mylogs.s3.amazonaws.com
          Prefix: myprefix","[[6, 7]]"
513,e519ed6a-8328-4b69-8eb7-8fa549ac3050,MQ Broker Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/mq_broker_logging_disabled,Unknown,"Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general).<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amazonmq-broker.html#cfn-amazonmq-broker-logs)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: true
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: true
        Audit: true

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      AutoMinorVersionUpgrade: ""false""
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EncryptionOptions:
        UseAwsOwnedKey: ""true""
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: ""true""
        Audit: ""true""","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker3:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: true
  BasicBroker4:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        Audit: true
  BasicBroker5:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: false
        Audit: true
  BasicBroker6:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        Audit: false
        General: true
  BasicBroker7:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: false
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create a basic ActiveMQ broker""
Resources:
  BasicBroker3:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: ""true""
  BasicBroker4:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        Audit: ""true""
  BasicBroker5:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        General: ""false""
        Audit: ""true""
  BasicBroker6:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""
      Logs:
        Audit: ""false""
        General: ""true""
  BasicBroker7:
    Type: ""AWS::AmazonMQ::Broker""
    Properties:
      BrokerName: MyBasicBroker
      DeploymentMode: SINGLE_INSTANCE
      EngineType: ActiveMQ
      EngineVersion: ""5.15.0""
      HostInstanceType: mq.t2.micro
      PubliclyAccessible: ""false""
      Users:
        -
          ConsoleAccess: ""true""
          Groups:
            - MyGroup
          Password:
            Ref: ""BrokerPassword""
          Username:
            Ref: ""BrokerUsername""","[[42, 84, 22, 88, 63], [42, 84, 22, 88, 63]]"
514,e52395b4-250b-4c60-81d5-2e58c1d37abc,Default KMS Key Usage,CloudFormation,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/default_kms_key_usage,Unknown,"When `StorageEncrypted` is set to true, `KmsKeyId` should be defined, to avoid the use of the default KMS Key<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template
Parameters:
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyKey-0:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  RDSCluster:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: true
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000
      KmsKeyId: !Ref MyKey-0
      StorageEncrypted: true","AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template
Parameters:
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  RDSCluster1:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: true
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template
Parameters:
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  RDSCluster1:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: ""true""
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000
      StorageEncrypted: ""true""","[[24], [24]]"
515,e649a218-d099-4550-86a4-1231e1fcb60d,Low RDS Backup Retention Period,CloudFormation,Low,Backup,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/low_rds_backup_retention_period,Unknown,"AWS RDS backup retention policy should be at least 7 days<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Parameters:
  PMDatabaseEngine:
    Type: String
    Default: ""MySQL""
    Description: ""Database engine, Aurora, MySQL or PostgreSQL""
  PMRDSSG:
    Description: ""Select the Security Group to use for the ELB""
    Type: ""AWS::EC2::SecurityGroup::Id""
  PMDatabaseEngineVer:
    Type: String
    Description: ""Database engine ver""
  PMDatabaseUsername:
    NoEcho: 'true'
    Type: String
    Description: ""Database admin account name""
  PMDatabasePassword:
    NoEcho: 'true'
    Type: String
    Description: ""Database admin account password""
  PMDBClusterParameterGroupName:
    Description: ""Db Parameter Groupname""
    Type: String
  PMDatabaseInstanceClass:
    Type: String
    Default: ""db.t2.micro""
    Description: ""Database instance class""
  PMPrivateSubnets:
    Description: ""Subnets to launch instances into""
    Type: ""List<AWS::EC2::Subnet::Id>""
  PMServerEnv:
    Description: ""Server Environment name.""
    ConstraintDescription: ""Choose an Environment from the drop down""
    Type: String
  PMDBClusterIdentifier:
    Description: ""Db Cluster Name.""
    Type: String

Resources:
  DatabaseCluster:
    Type: ""AWS::RDS::DBCluster""
    Properties:
      VpcSecurityGroupIds:
      - Ref: ""PMRDSSG""
      Engine: !Ref ""PMDatabaseEngine""
      EngineVersion: !Ref ""PMDatabaseEngineVer""
      MasterUsername: !Ref ""PMDatabaseUsername""
      MasterUserPassword: !Ref ""PMDatabasePassword""
      DBClusterParameterGroupName: !Ref ""RDSDBClusterParameterGroup""
      StorageEncrypted: true
      BackupRetentionPeriod: 16
      PreferredBackupWindow: '12:00-13:00'
      PreferredMaintenanceWindow: 'mon:13:00-mon:14:00'

  Database1:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      Engine: !Ref ""PMDatabaseEngine""
      DBClusterIdentifier: !Ref ""DatabaseCluster""
      DBInstanceClass: !Ref ""PMDatabaseInstanceClass""
      DBSubnetGroupName: !Ref ""DbSubnetGroup""
      DBInstanceIdentifier: !Sub ""${PMDBClusterIdentifier}-db1""

  Database2:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      Engine: !Ref ""PMDatabaseEngine""
      DBClusterIdentifier: !Ref ""DatabaseCluster""
      DBInstanceClass: !Ref ""PMDatabaseInstanceClass""
      DBSubnetGroupName: !Ref ""DbSubnetGroup""
      DBInstanceIdentifier: !Sub ""${PMDBClusterIdentifier}-db2""

  DbSubnetGroup:
    Type: ""AWS::RDS::DBSubnetGroup""
    Properties:
      DBSubnetGroupDescription: !Sub ""${PMServerEnv} RDS DB subnet group""
      SubnetIds:
        Ref: ""PMPrivateSubnets""

  RDSDBClusterParameterGroup:
    Type: ""AWS::RDS::DBClusterParameterGroup""
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: !Ref ""PMDBClusterParameterGroupName""
      Parameters:
        time_zone: ""UTC""
        collation_connection: ""utf8_general_ci""
        character_set_database: ""utf8""

Outputs:
  RdsDbId:
    Description: ""RDS Database Cluster ID""
    Value: !Ref ""DatabaseCluster""
  RdsEndpointAdd:
    Description: ""RDS Database Endpoint""
    Value: !GetAtt ""DatabaseCluster.Endpoint.Address""
  RdsReadEndpointAdd:
    Description: ""RDS Read Database Endpoint""
    Value: !GetAtt ""DatabaseCluster.ReadEndpoint.Address""
  RdsEndpointPort:
    Description: ""RDS Database Port""
    Value: !GetAtt ""DatabaseCluster.Endpoint.Port""
  DbUser:
    Description: ""RDS Database admin account user""
    Value: !Ref ""PMDatabaseUsername""
  DbPassword:
    Description: ""RDS Database admin account password""
    Value: !Ref ""PMDatabasePassword""

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      BackupRetentionPeriod: 7
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  DBUser:
    NoEcho: true
    Description: The database admin account username
    Type: String
    MinLength: 1
    MaxLength: 16
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: true
    Description: The database admin account password
    Type: String
    MinLength: 1
    MaxLength: 41
    AllowedPattern: ""[a-zA-Z0-9]*""
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      AllocatedStorage: '5'
      DBInstanceClass: db.t2.small
      Engine: MySQL
      EngineVersion: '5.5'
      MasterUsername: !Ref DBUser
      MasterUserPassword: !Ref DBPassword
      DBParameterGroupName: !Ref MyRDSParamGroup
      BackupRetentionPeriod: 10
  MyRDSParamGroup:
    Type: ""AWS::RDS::DBParameterGroup""
    Properties:
      Family: MySQL5.5
      Description: CloudFormation Sample Database Parameter Group
      Parameters:
        autocommit: '1'
        general_log: '1'
        old_passwords: '0'","AWSTemplateFormatVersion: ""2010-09-09""
Description: Creates RDS Cluster
Parameters:
  PMDatabaseEngine:
    Type: String
    Default: ""MySQL""
    Description: ""Database engine, Aurora, MySQL or PostgreSQL""
  PMRDSSG:
    Description: ""Select the Security Group to use for the ELB""
    Type: ""AWS::EC2::SecurityGroup::Id""
  PMDatabaseEngineVer:
    Type: String
    Description: ""Database engine ver""
  PMDatabaseUsername:
    NoEcho: 'true'
    Type: String
    Description: ""Database admin account name""
  PMDatabasePassword:
    NoEcho: 'true'
    Type: String
    Description: ""Database admin account password""
  PMDBClusterParameterGroupName:
    Description: ""Db Parameter Groupname""
    Type: String
  PMDatabaseInstanceClass:
    Type: String
    Default: ""db.t2.micro""
    Description: ""Database instance class""
  PMPrivateSubnets:
    Description: ""Subnets to launch instances into""
    Type: ""List<AWS::EC2::Subnet::Id>""
  PMServerEnv:
    Description: ""Server Environment name.""
    ConstraintDescription: ""Choose an Environment from the drop down""
    Type: String
  PMDBClusterIdentifier:
    Description: ""Db Cluster Name.""
    Type: String

Resources:
  DatabaseCluster:
    Type: ""AWS::RDS::DBCluster""
    Properties:
      VpcSecurityGroupIds:
      - Ref: ""PMRDSSG""
      Engine: !Ref ""PMDatabaseEngine""
      EngineVersion: !Ref ""PMDatabaseEngineVer""
      MasterUsername: !Ref ""PMDatabaseUsername""
      MasterUserPassword: !Ref ""PMDatabasePassword""
      DBClusterParameterGroupName: !Ref ""RDSDBClusterParameterGroup""
      StorageEncrypted: true
      BackupRetentionPeriod: 3
      PreferredBackupWindow: '12:00-13:00'
      PreferredMaintenanceWindow: 'mon:13:00-mon:14:00'

  Database1:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      Engine: !Ref ""PMDatabaseEngine""
      DBClusterIdentifier: !Ref ""DatabaseCluster""
      DBInstanceClass: !Ref ""PMDatabaseInstanceClass""
      DBSubnetGroupName: !Ref ""DbSubnetGroup""
      DBInstanceIdentifier: !Sub ""${PMDBClusterIdentifier}-db1""

  Database2:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      Engine: !Ref ""PMDatabaseEngine""
      DBClusterIdentifier: !Ref ""DatabaseCluster""
      DBInstanceClass: !Ref ""PMDatabaseInstanceClass""
      DBSubnetGroupName: !Ref ""DbSubnetGroup""
      DBInstanceIdentifier: !Sub ""${PMDBClusterIdentifier}-db2""

  DbSubnetGroup:
    Type: ""AWS::RDS::DBSubnetGroup""
    Properties:
      DBSubnetGroupDescription: !Sub ""${PMServerEnv} RDS DB subnet group""
      SubnetIds:
        Ref: ""PMPrivateSubnets""

  RDSDBClusterParameterGroup:
    Type: ""AWS::RDS::DBClusterParameterGroup""
    Properties:
      Description: ""CloudFormation Sample Aurora Cluster Parameter Group""
      Family: !Ref ""PMDBClusterParameterGroupName""
      Parameters:
        time_zone: ""UTC""
        collation_connection: ""utf8_general_ci""
        character_set_database: ""utf8""

Outputs:
  RdsDbId:
    Description: ""RDS Database Cluster ID""
    Value: !Ref ""DatabaseCluster""
  RdsEndpointAdd:
    Description: ""RDS Database Endpoint""
    Value: !GetAtt ""DatabaseCluster.Endpoint.Address""
  RdsReadEndpointAdd:
    Description: ""RDS Read Database Endpoint""
    Value: !GetAtt ""DatabaseCluster.ReadEndpoint.Address""
  RdsEndpointPort:
    Description: ""RDS Database Port""
    Value: !GetAtt ""DatabaseCluster.Endpoint.Port""
  DbUser:
    Description: ""RDS Database admin account user""
    Value: !Ref ""PMDatabaseUsername""
  DbPassword:
    Description: ""RDS Database admin account password""
    Value: !Ref ""PMDatabasePassword""

AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      BackupRetentionPeriod: 6
Outputs:
  InstanceId:
    Description: InstanceId of the newly created RDS Instance
    Value: !Ref MyDBSmall

AWSTemplateFormatVersion: ""2010-09-09""
Parameters:
  DBUser:
    NoEcho: true
    Description: The database admin account username
    Type: String
    MinLength: 1
    MaxLength: 16
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: true
    Description: The database admin account password
    Type: String
    MinLength: 1
    MaxLength: 41
    AllowedPattern: ""[a-zA-Z0-9]*""
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      AllocatedStorage: '5'
      DBInstanceClass: db.t2.small
      Engine: MySQL
      EngineVersion: '5.5'
      MasterUsername: !Ref DBUser
      MasterUserPassword: !Ref DBPassword
      DBParameterGroupName: !Ref MyRDSParamGroup
  MyRDSParamGroup:
    Type: ""AWS::RDS::DBParameterGroup""
    Properties:
      Family: MySQL5.5
      Description: CloudFormation Sample Database Parameter Group
      Parameters:
        autocommit: '1'
        general_log: '1'
        old_passwords: '0'","[[52], [35], [22]]"
516,e835bd0d-65da-49f7-b6d1-b646da8727e6,IAM Policy Grants 'AssumeRole' Permission Across All Services,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policy_grants_assumerole_permission_across_all_services,Unknown,"IAM Policy should not grant 'AssumeRole' permission across all services.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  MyPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: ""2012-10-17""
        Statement:
          - Effect: Allow
            Action:
              - s3:GetObject
              - s3:PutObject
              - s3:PutObjectAcl
            Resource: arn:aws:s3:::myAWSBucket/*
      Groups:
        - myexistinggroup1
        - !Ref mygroup","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mypolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""sts:AssumeRole""]
          Resource: ""*""
      Users: [""SomeUser""]",[[8]]
517,ea33fcf7-394b-4d11-a228-985c5d08f205,Default Security Groups With Unrestricted Traffic,CloudFormation,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/default_security_groups_with_unrestricted_traffic,Unknown,"Check if default security group does not restrict all inbound and outbound traffic.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html)","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupName: default
      GroupDescription: Enable SSH access via port 22","Parameters:
  KeyName:
    Description: The EC2 Key Pair to allow SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
Resources:
  Ec2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      SecurityGroups:
        - !Ref InstanceSecurityGroup
        - MyExistingSecurityGroup
      KeyName: !Ref KeyName
      ImageId: ami-7a11e213
  InstanceSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupName: default
      GroupDescription: Enable SSH access via port 22
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
        - IpProtocol: tcp
          FromPort: '22'
          ToPort: '22'
          CidrIp: 0.0.0.0/0",[[16]]
518,ed4c48b8-eccc-4881-95c1-09fdae23db25,API Gateway Without SSL Certificate,CloudFormation,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_without_ssl_certificate,Unknown,"SSL Client Certificate should be enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-stage.html)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  ProdApiGatewayStageNeg:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  ProdApiGatewayStagePos:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'",[[5]]
519,edbd62d4-8700-41de-b000-b3cfebb5e996,Elasticsearch Logs Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elasticsearch_logs_disabled,Unknown,"AWS Elasticsearch should have logs enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-logpublishingoptions)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      LogPublishingOptions:
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs
          Enabled: ""true""
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs
          Enabled: ""true""
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-application-logs
          Enabled: ""true""
        AUDIT_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-audit-logs
          Enabled: ""true""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

Resources:
  ProductionElasticsearch:
    Type: AWS::Elasticsearch::Domain
    Properties:
      EBSOptions:
        EBSEnabled: true
        VolumeSize: 70
        VolumeType: gp2
      ElasticsearchClusterConfig:
        DedicatedMasterCount: 3
        DedicatedMasterEnabled: true
        DedicatedMasterType: omitted
        InstanceCount: 3
        InstanceType: omitted
        ZoneAwarenessConfig:
          AvailabilityZoneCount: 3
        ZoneAwarenessEnabled: true
      ElasticsearchVersion: omitted
      LogPublishingOptions:
        ""INDEX_SLOW_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchIndexSlowLogs.Arn
          Enabled: true
        ""SEARCH_SLOW_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchSearchSlowLogs.Arn
          Enabled: true
        ""ES_APPLICATION_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchApplicationLogs.Arn
          Enabled: true
        ""AUDIT_LOGS"":
          CloudWatchLogsLogGroupArn: !GetAtt ProductionElasticsearchAuditLogs.Arn
          Enabled: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      LogPublishingOptions:
        SEARCH_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-slow-logs
          Enabled: ""false""
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-index-slow-logs
          Enabled: ""true""
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-application-logs
          Enabled: ""true""
        AUDIT_LOGS:
          CloudWatchLogsLogGroupArn: >-
            arn:aws:logs:us-east-1:123456789012:log-group:/aws/aes/domains/es-audit-logs
          Enabled: ""true""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""

AWSTemplateFormatVersion: ""2010-09-09""
Description: ElasticsearchDomain resource
Resources:
  ElasticsearchDomain:
    Type: ""AWS::Elasticsearch::Domain""
    Properties:
      DomainName:
        Ref: DomainName
      ElasticsearchVersion:
        Ref: ElasticsearchVersion
      ElasticsearchClusterConfig:
        InstanceCount: ""1""
        InstanceType:
          Ref: InstanceType
      EBSOptions:
        EBSEnabled: ""true""
        Iops: 0
        VolumeSize: 10
        VolumeType: standard
      SnapshotOptions:
        AutomatedSnapshotStartHour: ""0""
      AccessPolicies:
        Version: ""2012-10-17""
        Statement:
          - Effect: Deny
            Principal:
              AWS: ""*""
            Action: ""es:*""
            Resource: ""*""
      AdvancedOptions:
        rest.action.multi.allow_explicit_index: ""true""","[[34], [6]]"
520,edc95c10-7366-4f30-9b4b-f995c84eceb5,IAM Policies Attached To User,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policies_attached_to_user,Unknown,"IAM policies should be attached only to groups or roles<br>
[Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
    myuser:
      Type: AWS::IAM::User
      Properties:
        Path: ""/""
        LoginProfile:
          Password: myP@ssW0rd
        ManagedPoliciesArns: [
          ""arn:aws:iam::123456789012:policy/UsersManageOwnCredentials"",
          ""arn:aws:iam::123456789012:policy/division_abc/subdivision_xyz/UsersManageOwnCredentials""
        ]
        Policies:
        - PolicyName: giveaccesstoqueueonly
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - sqs:*
              Resource:
              - !GetAtt myqueue.Arn
            - Effect: Deny
              Action:
              - sqs:*
              NotResource:
              - !GetAtt myqueue.Arn","[[10, 14]]"
521,ee12ad32-2863-4c0f-b13f-28272d115028,ELB Access Log Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/elb_access_log_disabled,Unknown,"ELB should have access log enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb-accessloggingpolicy.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Resources:
  MyLoadBalancer:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      AvailabilityZones:
        - ""us-east-2a""
      CrossZone: true
      Listeners:
        - InstancePort: ""80""
          InstanceProtocol: HTTP
          LoadBalancerPort: ""443""
          Protocol: HTTPS
          PolicyNames:
            - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
      HealthCheck:
        Target: HTTP:80/
        HealthyThreshold: ""2""
        UnhealthyThreshold: ""3""
        Interval: ""10""
        Timeout: ""5""
      Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
      AccessLoggingPolicy:
        - Enabled: true
          S3BucketName: teste

AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Resources:
  MyLoadBalancer:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      AvailabilityZones:
        - ""us-east-2a""
      CrossZone: ""true""
      Listeners:
        - InstancePort: ""80""
          InstanceProtocol: HTTP
          LoadBalancerPort: ""443""
          Protocol: HTTPS
          PolicyNames:
            - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
      HealthCheck:
        Target: HTTP:80/
        HealthyThreshold: ""2""
        UnhealthyThreshold: ""3""
        Interval: ""10""
        Timeout: ""5""
      Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
      AccessLoggingPolicy:
        - Enabled: ""true""
          S3BucketName: teste","AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Resources:
  MyLoadBalancer:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      AvailabilityZones:
        - ""us-east-2a""
      CrossZone: true
      Listeners:
        - InstancePort: ""80""
          InstanceProtocol: HTTP
          LoadBalancerPort: ""443""
          Protocol: HTTPS
          PolicyNames:
            - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
      HealthCheck:
        Target: HTTP:80/
        HealthyThreshold: ""2""
        UnhealthyThreshold: ""3""
        Interval: ""10""
        Timeout: ""5""
      Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01

AWSTemplateFormatVersion: ""2010-09-09""
Description: A simple EC2 instance
Resources:
  MyLoadBalancer2:
    Type: AWS::ElasticLoadBalancing::LoadBalancer
    Properties:
      AvailabilityZones:
        - ""us-east-2a""
      CrossZone: true
      Listeners:
        - InstancePort: ""80""
          InstanceProtocol: HTTP
          LoadBalancerPort: ""443""
          Protocol: HTTPS
          PolicyNames:
            - My-SSLNegotiation-Policy
          SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-server-certificate
      HealthCheck:
        Target: HTTP:80/
        HealthyThreshold: ""2""
        UnhealthyThreshold: ""3""
        Interval: ""10""
        Timeout: ""5""
      Policies:
        - PolicyName: My-SSLNegotiation-Policy
          PolicyType: SSLNegotiationPolicyType
          Attributes:
            - Name: Reference-Security-Policy
              Value: ELBSecurityPolicy-TLS-1-2-2017-01
      AccessLoggingPolicy:
        Enabled: false
        S3BucketName: teste","[[6], [31]]"
522,ee464fc2-54a6-4e22-b10a-c6dcd2474d0c,Security Group Egress With All Protocols,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/security_group_egress_with_all_protocols,Unknown,"AWS Security Group Egress should not specify all protocols to prevent allow traffic on all ports<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-security-group-egress.html)","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: tcp
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","Resources:
  InstanceSecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: Allow http to client host
      VpcId:
         Ref: myVPC
      SecurityGroupIngress:
      - IpProtocol: -1
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
      SecurityGroupEgress:
      - IpProtocol: -1
        FromPort: 80
        ToPort: 80
        CidrIp: 0.0.0.0/0
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: -1
      FromPort: 0
      ToPort: 65535
      DestinationSecurityGroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
  InboundRule:
    Type: AWS::EC2::SecurityGroupIngress
    Properties:
      IpProtocol: -1
      FromPort: 0
      ToPort: 65535
      SourceSecurityGroupId:
        Fn::GetAtt:
        - SourceSG
        - GroupId
      GroupId:
        Fn::GetAtt:
        - TargetSG
        - GroupId","[[21, 14]]"
523,ef05a925-8568-4054-8ff1-f5ba82631c16,BOM - AWS EFS,CloudFormation,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws_bom/efs,Unknown,"A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning.<br>
[Documentation](https://kics.io)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  myDistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        Enabled: true","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Resources:
    FileSystemResource:
      Type: 'AWS::EFS::FileSystem'
      Properties:
        AvailabilityZoneName: us-east-1a
        BackupPolicy:
          Status: ENABLED
        Encrypted: true
        LifecyclePolicies:
          - TransitionToIA: AFTER_30_DAYS
        FileSystemTags:
          - Key: Name
            Value: TestFileSystem
        FileSystemPolicy:
          Version: ""2012-10-17""
          Statement:
            - Effect: ""Allow""
              Action:
                - ""elasticfilesystem:ClientMount""
              Principal:
                  AWS: 'arn:aws:iam::111122223333:role/EfsReadOnly'
        KmsKeyId: !GetAtt 
          - key
          - Arn

AWSTemplateFormatVersion: ""2010-09-09""
Description: ""Create EFS system and Mount Targets for test VPC""
Resources:
    FileSystemResource:
      Type: 'AWS::EFS::FileSystem'
      Properties:
        AvailabilityZoneName: us-east-1a
        BackupPolicy:
          Status: ENABLED
        Encrypted: false
        LifecyclePolicies:
          - TransitionToIA: AFTER_30_DAYS
        FileSystemTags:
          - Key: Name
            Value: TestFileSystem","[[4], [4]]"
524,f0104061-8bfc-4b45-8a7d-630eb502f281,Automatic Minor Upgrades Disabled,CloudFormation,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/automatic_minor_upgrades_disabled,Unknown,"RDS instance should have automatic minor upgrades enabled, which means the attribute 'AutoMinorVersionUpgrade' must be set to true.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample""
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      AutoMinorVersionUpgrade: true

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample""
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      AutoMinorVersionUpgrade: ""true""","AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample ""
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
  MyDB2:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      AutoMinorVersionUpgrade: false

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Description"": ""AWS CloudFormation Sample ""
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
  MyDB2:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'
      AutoMinorVersionUpgrade: ""false""","[[18, 42], [18, 42]]"
525,f4c9b5f5-68b8-491f-9e48-4f96644a1d51,ECS Task Definition Invalid CPU or Memory,CloudFormation,Low,Resource Management,https://cwe.mitre.org/data/definitions/697.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_task_definition_invalid_cpu_or_memory,Unknown,"In an ECS Task Definition with the FARGATE launch type, specifying an invalid CPU or Memory value will result in an error.<br>
[Documentation](https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-cpu-memory-error.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  ECSService:
    Type: AWS::ECS::Service
    DependsOn:
      - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers:
        - TargetGroupArn:
            Ref: TargetGroup
          ContainerPort: 80
          ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
      LaunchType: FARGATE
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          Memory: 512
          Essential: true
      Volumes:
        - Host:
            SourcePath: ""/var/lib/docker/vfs/dir/""
          Name: ""my-vol""","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  ECSService:
    Type: AWS::ECS::Service
    DependsOn:
      - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers:
        - TargetGroupArn:
            Ref: TargetGroup
          ContainerPort: 80
          ContainerName: sample-app
      Cluster:
        Ref: ECSCluster
      LaunchType: FARGATE
  taskdefinition:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name:
            Ref: ""AppName""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 256
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          Memory: 4096
          Essential: true
      Volumes:
        - Host:
            SourcePath: ""/var/lib/docker/vfs/dir/""
          Name: ""my-vol""
  taskdefinition2:
    Type: AWS::ECS::TaskDefinition
    Properties:
      ContainerDefinitions:
        - Name:
            Ref: ""AppName2""
          MountPoints:
            - SourceVolume: ""my-vol""
              ContainerPath: ""/var/www/my-vol""
          Image: ""amazon/amazon-ecs-sample""
          Cpu: 100
          PortMappings:
            - ContainerPort:
                Ref: ""AppContainerPort""
              HostPort:
                Ref: ""AppHostPort""
          EntryPoint:
            - ""/usr/sbin/apache2""
            - ""-D""
            - ""FOREGROUND""
          Memory: 4096
          Essential: true
      Volumes:
        - Host:
            SourcePath: ""/var/lib/docker/vfs/dir/""
          Name: ""my-vol""","[[27, 53]]"
526,f57f849c-883b-4cb7-85e7-f7b199dff163,TCP UDP Protocol Network ACL Entry Allows All Ports,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/tcp_or_udp_protocol_network_acl_entry_allows_all_ports,Unknown,"TCP UDP protocol AWS Network ACL Entry should not allow all ports<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-network-acl-entry.html#cfn-ec2-networkaclentry-portrange)","Resources:
  MyNACL9:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule9:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
         To: 22","Resources:
  MyNACL:
    Type: AWS::EC2::NetworkAcl
    Properties:
       VpcId: vpc-1122334455aabbccd
       Tags:
       - Key: Name
         Value: NACLforSSHTraffic
  InboundRule2:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 22
  InboundRule3:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         To: 22
  InboundRule4:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
  InboundRule5:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
       NetworkAclId:
         Ref: MyNACL
       RuleNumber: 100
       Protocol: 6
       RuleAction: allow
       CidrBlock: 172.16.0.0/24
       PortRange:
         From: 0
         To: 65535","[[33, 18, 29, 49]]"
527,f6049677-ec4a-43af-8779-5190b6d03cba,KMS Allows Wildcard Principal,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/kms_allows_wildcard_principal,Unknown,"KMS Should not allow Principal parameter to be set as *<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-kms-key.html)","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::111122223333:root
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'","AWSTemplateFormatVersion: 2010-09-09
Description: A sample template
Resources:
  myKey:
    Type: AWS::KMS::Key
    Properties:
      Description: An example symmetric CMK
      KeyPolicy:
        Version: '2012-10-17'
        Id: key-default-1
        Statement:
        - Sid: Enable IAM User Permissions
          Effect: Allow
          Principal: ""*""
          Action: kms:*
          Resource: '*'
        - Sid: Allow administration of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Alice
          Action:
          - kms:Create*
          - kms:Describe*
          - kms:Enable*
          - kms:List*
          - kms:Put*
          - kms:Update*
          - kms:Revoke*
          - kms:Disable*
          - kms:Get*
          - kms:Delete*
          - kms:ScheduleKeyDeletion
          - kms:CancelKeyDeletion
          Resource: '*'
        - Sid: Allow use of the key
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::123456789012:user/Bob
          Action:
          - kms:DescribeKey
          - kms:Encrypt
          - kms:Decrypt
          - kms:ReEncrypt*
          - kms:GenerateDataKey
          - kms:GenerateDataKeyWithoutPlaintext
          Resource: '*'",[[8]]
528,f62aa827-4ade-4dc4-89e4-1433d384a368,IAM Policy Grants Full Permissions,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_policy_grants_full_permissions,Unknown,"IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  adminPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: arn:aws:iam::aws:policy/AdministratorAccess
      Groups:
      - myexistinggroup1
      - !Ref mygroup

AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  adminPolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: 'ec2messages:GetEndpoint'
          Resource: ['*']
      Groups:
      - myexistinggroup1
      - !Ref mygroup","AWSTemplateFormatVersion: ""2010-09-09""
Description: A sample template
Resources:
  mypolicy:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: [""*""]
          Resource: ""*""
      Groups:
      - myexistinggroup1
      - !Ref mygroup
  mypolicy2:
    Type: AWS::IAM::Policy
    Properties:
      PolicyName: mygrouppolicy
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Action: ""*""
          Resource: ""*""
      Groups:
      - myexistinggroup1
      - !Ref mygroup","[[8, 21]]"
529,f6397a20-4cf1-4540-a997-1d363c25ef58,S3 Bucket Allows Put Action From All Principals,CloudFormation,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_put_actions_from_all_principals,Unknown,"S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:PutObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""PutObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  SampleBucketPolicy4:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - ""PutObject""
              - ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","[[22, 7]]"
530,f6d299d2-21eb-41cc-b1e1-fe12d857500b,VPC FlowLogs Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/vpc_flowlogs_disabled,Unknown,"Every VPC resource should have an associated Flow Log<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-flowlog.html)","AWSTemplateFormatVersion: '2010-09-09'
Description: 'VPC: public and private subnets in two availability zones, a cloudonaut.io template'
Parameters:
  ClassB:
    Description: 'Class B of VPC (10.XXX.0.0/16)'
    Type: Number
    Default: 0
    ConstraintDescription: 'Must be in the range [0-255]'
    MinValue: 0
    MaxValue: 255
Resources:
  Role:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service: 'vpc-flow-logs.amazonaws.com'
          Action: 'sts:AssumeRole'
      Policies:
      - PolicyName: 'flowlogs-policy'
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - 'logs:CreateLogStream'
            - 'logs:PutLogEvents'
            - 'logs:DescribeLogGroups'
            - 'logs:DescribeLogStreams'
            Resource: !GetAtt 'LogGroup.Arn'
  MyVPC:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: !Sub '10.${ClassB}.0.0/16'
      EnableDnsSupport: true
      EnableDnsHostnames: true
      InstanceTenancy: default
      Tags:
      - Key: Name
        Value: !Sub '10.${ClassB}.0.0/16'
  LogGroup:
    Type: 'AWS::Logs::LogGroup'
    Properties:
      RetentionInDays: 14
  FlowLog:
    Type: 'AWS::EC2::FlowLog'
    Properties:
      DeliverLogsPermissionArn: !GetAtt 'Role.Arn'
      LogGroupName: !Ref LogGroup
      ResourceId: !Ref MyVPC
      ResourceType: 'VPC'
      TrafficType: ACCEPT","AWSTemplateFormatVersion: '2010-09-09'
Description: 'VPC: public and private subnets in two availability zones, a cloudonaut.io template'
Parameters:
  ClassB:
    Description: 'Class B of VPC (10.XXX.0.0/16)'
    Type: Number
    Default: 0
    ConstraintDescription: 'Must be in the range [0-255]'
    MinValue: 0
    MaxValue: 255
Resources:
  Role:
    Type: 'AWS::IAM::Role'
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service: 'vpc-flow-logs.amazonaws.com'
          Action: 'sts:AssumeRole'
      Policies:
      - PolicyName: 'flowlogs-policy'
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Effect: Allow
            Action:
            - 'logs:CreateLogStream'
            - 'logs:PutLogEvents'
            - 'logs:DescribeLogGroups'
            - 'logs:DescribeLogStreams'
            Resource: !GetAtt 'LogGroup.Arn'
  MyVPC:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: !Sub '10.${ClassB}.0.0/16'
      EnableDnsSupport: true
      EnableDnsHostnames: true
      InstanceTenancy: default
      Tags:
      - Key: Name
        Value: !Sub '10.${ClassB}.0.0/16'
  LogGroup:
    Type: 'AWS::Logs::LogGroup'
    Properties:
      RetentionInDays: 14
  FlowLog:
    Type: 'AWS::EC2::FlowLog'
    Properties:
      DeliverLogsPermissionArn: !GetAtt 'Role.Arn'
      LogGroupName: !Ref LogGroup
      ResourceId: !Ref MyVPC1
      ResourceType: 'VPC'
      TrafficType: ACCEPT",[[34]]
531,f80e3aa7-7b34-4185-954e-440a6894dde6,IAM Role Allows All Principals To Assume,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/iam_role_allows_all_principals_to_assume,Unknown,"IAM role allows all services or principals to assume it<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-role.html#cfn-iam-role-assumerolepolicydocument)","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
            ""Version"": ""2012-10-17"",
            ""Statement"": [
                {
                    ""Action"": ""sts:AssumeRole"",
                    ""Principal"": {
                        ""AWS"": ""arn:aws:iam::root""
                    },
                    ""Effect"": ""Deny"",
                    ""Sid"": """"
                }
            ]
        }","AWSTemplateFormatVersion: ""2010-09-09""
Resources:
  RootRole:
    Type: ""AWS::IAM::Role""
    Properties:
      AssumeRolePolicyDocument: >
        {
            ""Version"": ""2012-10-17"",
            ""Statement"": [
                {
                    ""Action"": ""sts:AssumeRole"",
                    ""Principal"": {
                        ""AWS"": ""arn:aws:iam::root""
                    },
                    ""Effect"": ""Allow"",
                    ""Sid"": """"
                }
            ]
        }",[[6]]
532,f914357d-8386-4d56-9ba6-456e5723f9a6,EC2 Instance Has No IAM Role,CloudFormation,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ec2_instance_has_no_iam_role,Unknown,"Check if an EC2 instance refers to an IAM profile, which represents an IAM Role.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html)","Resources:
  Test:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
        - AMIs
        - Ref: AWS::Region
        - Name
      KeyName:
        Ref: KeyName
      IamInstanceProfile:
        Ref: ListS3BucketsInstanceProfile
      SecurityGroupIds:
      - Ref: SSHAccessSG
      Tags:
      - Key: Name
        Value: Test
  ListS3BucketsInstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: ""/""
      Roles:
      - Ref: ListS3BucketsRole
  ListS3BucketsRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
        - Effect: Allow
          Principal:
            Service:
            - ec2.amazonaws.com
          Action:
          - sts:AssumeRole
      Path: ""/""","Resources:
  NoIAM:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      Tags:
        - Key: Name
          Value: Test
  IAM_Missing:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      IamInstanceProfile:
        Ref: NonExistantProfile
      SecurityGroupIds:
        - Ref: SSHAccessSG
      Tags:
        - Key: Name
          Value: Test
  IAMNoRoles:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      IamInstanceProfile:
        Ref: NoRolesProfile
      Tags:
        - Key: Name
          Value: Test
  NoRolesProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: ""/""

Resources:
  NoIAM:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      Tags:
        - Key: Name
          Value: Test
  IAM_Missing:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      IamInstanceProfile: NonExistantProfile
      SecurityGroupIds:
        - Ref: SSHAccessSG
      Tags:
        - Key: Name
          Value: Test
  IAMNoRoles:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType:
        Ref: InstanceType
      ImageId:
        Fn::FindInMap:
          - AMIs
          - Ref: AWS::Region
          - Name
      KeyName:
        Ref: KeyName
      IamInstanceProfile: NoRolesProfile
      Tags:
        - Key: Name
          Value: Test
  NoRolesProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Path: ""/""","[[4, 29, 55], [29, 4, 53]]"
533,f97b7d23-568f-4bcc-9ac9-02df0d57fbba,S3 Bucket Allows Get Action From All Principals,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_get_actions_from_all_principals,Unknown,"S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:GetObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  SampleBucketPolicy4:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - ""DeleteObject""
              - ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","[[22, 7]]"
534,f988a17f-1139-46a3-8928-f27eafd8b024,DMS Endpoint MongoDB Settings Password Exposed,CloudFormation,High,Secret Management,https://cwe.mitre.org/data/definitions/256.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/dms_endpoint_mongo_db_settings_password_exposed,Unknown,"DMS Endpoint MongoDbSettings Password must not be a plaintext string or a Ref to a Parameter with a Default value.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dms-endpoint-mongodbsettings.html)","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
  MasterMongoDBPassword:
    Description: 'Password'
    Type: String
    Default: ''
Resources:
  NewAmpApp1:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
          AuthMechanism: String
          AuthSource: String
          AuthType: String
          DatabaseName: String
          DocsToInvestigate: String
          ExtractDocId: String
          NestingLevel: String
          Password: !Ref MasterMongoDBPassword
          Port: 80
          ServerName: String
          Username: String
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
  MasterMongoDBPassword:
    Description: 'Password'
    Type: String
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username'
Resources:
  NewAmpApp2:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
          AuthMechanism: String
          AuthSource: String
          AuthType: String
          DatabaseName: String
          DocsToInvestigate: String
          ExtractDocId: String
          NestingLevel: String
          Password: !Ref MasterMongoDBPassword
          Port: 80
          ServerName: String
          Username: String
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Resources:
    NewAmpApp3:
      Type: AWS::DMS::Endpoint
      Properties:
        CertificateArn: String
        DatabaseName: String
        EndpointIdentifier: String
        EndpointType: String
        EngineName: String
        ExtraConnectionAttributes: String
        KafkaSettings:
          KafkaSettings
        KinesisSettings:
          KinesisSettings
        KmsKeyId: String
        MongoDbSettings:
            AuthMechanism: String
            AuthSource: String
            AuthType: String
            DatabaseName: String
            DocsToInvestigate: String
            ExtractDocId: String
            NestingLevel: String
            Password:  !Sub '{{resolve:secretsmanager:${MongoDBSecretManagerRotater}::password}}'
            Port: 80
            ServerName: String
            Username: String
        NeptuneSettings:
          NeptuneSettings
        Password:  !Sub '{{resolve:secretsmanager:${MyAmpAppSecretManagerRotater}::password}}'
        Port: 80
        S3Settings:
          S3Settings
        ServerName: String
        SslMode: String
        Tags:
          - Tag
        Username: String
    MyAmpAppSecretManagerRotater:
      Type: AWS::SecretsManager::Secret
      Properties:
        Description: 'This is my amp app instance secret'
        GenerateSecretString:
          SecretStringTemplate: '{""username"": ""admin""}'
          GenerateStringKey: 'password'
          PasswordLength: 16
          ExcludeCharacters: '""@/\'
    MongoDBSecretManagerRotater:
      Type: AWS::SecretsManager::Secret
      Properties:
        Description: 'This is my MongoDBSecretManagerRotater instance secret'
        GenerateSecretString:
          SecretStringTemplate: '{""username"": ""admin""}'
          GenerateStringKey: 'password'
          PasswordLength: 16
          ExcludeCharacters: '""@/\'","Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
    Default: ''
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username!'
  MasterMongoDBPassword:
    Description: 'Password'
    Type: String
    Default: 'as@3djdkDjskjs73!!'
Resources:
  NewAmpApp4:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
          AuthMechanism: String
          AuthSource: String
          AuthType: String
          DatabaseName: String
          DocsToInvestigate: String
          ExtractDocId: String
          NestingLevel: String
          Password: !Ref MasterMongoDBPassword
          Port: 80
          ServerName: String
          Username: String
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Resources:
  NewAmpApp5:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
          AuthMechanism: String
          AuthSource: String
          AuthType: String
          DatabaseName: String
          DocsToInvestigate: String
          ExtractDocId: String
          NestingLevel: String
          Password: 'as@3djdkDjskjs73!!'
          Port: 80
          ServerName: String
          Username: String
      NeptuneSettings:
        NeptuneSettings
      Password: 'asDjskjs73!!'
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String

Parameters:
  ParentMasterPassword:
    Description: 'Password'
    Type: String
  MasterMongoDBPassword:
    Description: 'Password'
    Type: String
  ParentMasterUsername:
    Description: 'username'
    Type: String
    Default: 'username'
Resources:
  NewAmpApp6:
    Type: AWS::DMS::Endpoint
    Properties:
      CertificateArn: String
      DatabaseName: String
      EndpointIdentifier: String
      EndpointType: String
      EngineName: String
      ExtraConnectionAttributes: String
      KafkaSettings:
        KafkaSettings
      KinesisSettings:
        KinesisSettings
      KmsKeyId: String
      MongoDbSettings:
          AuthMechanism: String
          AuthSource: String
          AuthType: String
          DatabaseName: String
          DocsToInvestigate: String
          ExtractDocId: String
          NestingLevel: String
          Password: 'asDjskjs73!!'
          Port: 80
          ServerName: String
          Username: String
      NeptuneSettings:
        NeptuneSettings
      Password: !Ref ParentMasterPassword
      Port: 80
      S3Settings:
        S3Settings
      ServerName: String
      SslMode: String
      Tags:
        - Tag
      Username: String","[[13], [24], [35]]"
535,faa8fddf-c0aa-4b2d-84ff-e993e233ebe9,S3 Bucket Allows List Action From All Principals,CloudFormation,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/s3_bucket_allows_list_actions_from_all_principals,Unknown,"S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)","#this code is a correct code for which the query should not find any result
Resources:
  SampleBucketPolicy1:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - 's3:ListObject'
            Effect: Deny
            Resource: '*'
            Principal: '*'
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","#this is a problematic code where the query should report a result(s)
Resources:
  SampleBucketPolicy3:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action: ""ListObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'
  SampleBucketPolicy4:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref DOC-EXAMPLE-BUCKET
      PolicyDocument:
        Statement:
          - Action:
              - ""ListObject""
              - ""GetObject""
            Effect: Allow
            Resource: ""*""
            Principal: ""*""
            Condition:
              StringLike:
                'aws:Referer':
                  - 'http://www.example.com/*'
                  - 'http://example.net/*'","[[22, 7]]"
536,fb2b0ecf-1492-491a-a70d-ba1df579175d,ECS No Load Balancer Attached,CloudFormation,Medium,Best Practices,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/ecs_no_load_balancer_attached,Unknown,"Amazon ECS service should be configured to use Load Balancing to distribute traffic evenly across the tasks, which means there must exist at least one LoadBalancer.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-service.html)","#this code is a correct code for which the query should not find any result
Resources:
  ECSService:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers:
      - TargetGroupArn:
          Ref: TargetGroup
        ContainerPort: 80
        ContainerName: sample-app
      Cluster:
        Ref: ECSCluster","#this is a problematic code where the query should report a result(s)
Resources:
  ECSService:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      Cluster:
        Ref: ECSCluster
  ECSService2:
    Type: AWS::ECS::Service
    DependsOn:
    - Listener
    Properties:
      Role:
        Ref: ECSServiceRole
      TaskDefinition:
        Ref: ECSTaskDefinition
      DesiredCount: 1
      LoadBalancers: []
      Cluster:
        Ref: ECSCluster","[[25, 7]]"
537,fc7c2c15-f5d0-4b80-adb2-c89019f8f62b,MSK Cluster Logging Disabled,CloudFormation,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/msk_cluster_logging_disabled,Unknown,"Ensure MSK Cluster Logging is enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-msk-cluster.html)","AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      LoggingInfo:
         BrokerLogs:
          CloudWatchLogs:
            Enabled: true
            LogGroup: aws_cloudwatch_log_group.test.name
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster2:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      LoggingInfo:
         BrokerLogs:
          CloudWatchLogs:
            Enabled: false
            LogGroup: aws_cloudwatch_log_group.test.name
          S3:
            Enabled: true
            LogGroup: s3.test.name
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3","AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster5:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster6:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      LoggingInfo:
         BrokerLogs:
          CloudWatchLogs:
            Enabled: false
            LogGroup: aws_cloudwatch_log_group.test.name
          Firehose:
            Enabled: false
            LogGroup: firehose.test.name
          S3:
            Enabled: false
            LogGroup: s3.test.name
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3

AWSTemplateFormatVersion: ""2010-09-09""
Description: MSK Cluster with required properties.
Resources:
  TestCluster7:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: ClusterWithRequiredProperties
      KafkaVersion: 2.2.1
      LoggingInfo:
         BrokerLogs:
          CloudWatchLogs:
            Enabled: false
            LogGroup: aws_cloudwatch_log_group.test.name
      NumberOfBrokerNodes: 3
      BrokerNodeGroupInfo:
        InstanceType: kafka.m5.large
        ClientSubnets:
          - ReplaceWithSubnetId1
          - ReplaceWithSubnetId2
          - ReplaceWithSubnetId3","[[6], [18, 12, 15], [12]]"
538,fcbf9019-566c-4832-a65c-af00d8137d2b,API Gateway without WAF,CloudFormation,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/api_gateway_without_waf,Unknown,"API Gateway should have WAF (Web Application Firewall) enabled<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-wafv2-webaclassociation.html#cfn-wafv2-webaclassociation-resourcearn)","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  Production:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Production
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Production
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
  SampleWebACLAssociation:
    Type: 'AWS::WAFv2::WebACLAssociation'
    Properties:
      WebACLArn: ExampleARNForWebACL
      ResourceArn: arn:aws:apigateway:region::/restapis/api-id/stages/Production","AWSTemplateFormatVersion: ""2010-09-09""
Description: ""BatchJobDefinition""
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      RestApiId: !Ref MyRestApi
      DeploymentId: !Ref TestDeployment
      DocumentationVersion: !Ref MyDocumentationVersion
      ClientCertificateId: !Ref ClientCertificate
      Variables:
        Stack: Prod
      MethodSettings:
        - ResourcePath: /
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
        - ResourcePath: /stack
          HttpMethod: POST
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '999'
        - ResourcePath: /stack
          HttpMethod: GET
          MetricsEnabled: 'true'
          DataTraceEnabled: 'false'
          ThrottlingBurstLimit: '555'
  SampleWebACLAssociation:
    Type: 'AWS::WAFv2::WebACLAssociation'
    Properties:
      WebACLArn: ExampleARNForWebACL
      ResourceArn: arn:aws:apigateway:region::/restapis/api-id/stages/stage",[[7]]
539,fe974ae9-858e-4991-bbd5-e040a834679f,Stack Retention Disabled,CloudFormation,Medium,Backup,https://cwe.mitre.org/data/definitions/404.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/stack_retention_disabled,Unknown,"Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cloudformation-stackset-autodeployment.html#cfn-cloudformation-stackset-autodeployment-retainstacksonaccountremoval)","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  stackset:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: true
        RetainStacksOnAccountRemoval: true

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  stackset:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: ""true""
        RetainStacksOnAccountRemoval: ""true""","AWSTemplateFormatVersion: '2010-09-09'
Resources:
  stackset3:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: true
        RetainStacksOnAccountRemoval: false
  stackset4:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: true
  stackset5:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: false
        RetainStacksOnAccountRemoval: true
  stackset6:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        RetainStacksOnAccountRemoval: false
  stackset7:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link

AWSTemplateFormatVersion: '2010-09-09'
Resources:
  stackset3:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: ""true""
        RetainStacksOnAccountRemoval: ""false""
  stackset4:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: ""true""
  stackset5:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        Enabled: ""false""
        RetainStacksOnAccountRemoval: ""true""
  stackset6:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link
      AutoDeployment:
        RetainStacksOnAccountRemoval: ""false""
  stackset7:
    Type: AWS::CloudFormation::StackSet
    Properties:
      PermissionModel: SERVICE_MANAGED
      StackSetName: some_stack_name
      TemplateURL: some_stack_link","[[35, 39, 11, 18, 27], [35, 39, 11, 18, 27]]"
540,ffee2785-c347-451e-89f3-11aeb08e5c84,CMK Unencrypted Storage,CloudFormation,High,Encryption,https://cwe.mitre.org/data/definitions/312.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/cloudFormation/aws/cmk_unencrypted_storage,Unknown,"Ensure that storage is encrypted.<br>
[Documentation](https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html)","AWSTemplateFormatVersion: 2010-09-09
Description: RDS Storage Encrypted
Parameters:
  SourceDBInstanceIdentifier:
    Type: String
  DBInstanceType:
    Type: String
  SourceRegion:
    Type: String
Resources:
  MyKey:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  MyDBSmall:
    Type: ""AWS::RDS::DBInstance""
    Properties:
      DBInstanceClass: !Ref DBInstanceType
      SourceDBInstanceIdentifier: !Ref SourceDBInstanceIdentifier
      SourceRegion: !Ref SourceRegion
      KmsKeyId: !Ref MyKey
      StorageEncrypted: true

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template
Parameters:
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyKey-0:
    Type: ""AWS::KMS::Key""
    Properties:
      KeyPolicy:
        Version: 2012-10-17
        Id: key-default-1
        Statement:
          - Sid: Enable IAM User Permissions
            Effect: Allow
            Principal:
              AWS: !Join
                - """"
                - - ""arn:aws:iam::""
                  - !Ref ""AWS::AccountId""
                  - "":root""
            Action: ""kms:*""
            Resource: ""*""
  RDSCluster:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: true
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000
      KmsKeyId: !Ref MyKey-0
      StorageEncrypted: true","AWSTemplateFormatVersion: 2010-09-09
Description: >-
 AWS CloudFormation Sample
Parameters:
  DBInstanceID:
    Default: mydbinstance
    Description: My database instance
    Type: String
    MinLength: '1'
    MaxLength: '63'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: >-
      Must begin with a letter and must not end with a hyphen or contain two
      consecutive hyphens.
  DBName:
    Default: mydb
    Description: My database
    Type: String
    MinLength: '1'
    MaxLength: '64'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: Must begin with a letter and contain only alphanumeric characters.
  DBInstanceClass:
    Default: db.m5.large
    Description: DB instance class
    Type: String
    ConstraintDescription: Must select a valid DB instance type.
  DBAllocatedStorage:
    Default: '50'
    Description: The size of the database (GiB)
    Type: Number
    MinValue: '5'
    MaxValue: '1024'
    ConstraintDescription: must be between 20 and 65536 GiB.
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  MyDB:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBInstanceIdentifier: !Ref DBInstanceID
      DBName: !Ref DBName
      DBInstanceClass: !Ref DBInstanceClass
      AllocatedStorage: !Ref DBAllocatedStorage
      Engine: MySQL
      EngineVersion: 8.0.16
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      MonitoringInterval: '60'
      MonitoringRoleArn: 'arn:aws:iam::123456789012:role/rds-monitoring-role'

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template
Parameters:
  DBUsername:
    NoEcho: ""true""
    Description: Username for MySQL database access
    Type: String
    MinLength: ""1""
    MaxLength: ""16""
    AllowedPattern: ""[a-zA-Z][a-zA-Z0-9]*""
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: ""true""
    Description: Password MySQL database access
    Type: String
    MinLength: ""8""
    MaxLength: ""41""
    AllowedPattern: ""[a-zA-Z0-9]*""
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  RDSCluster1:
    Type: ""AWS::RDS::DBCluster""
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: true
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  AWS CloudFormation Sample Template AuroraServerlessDBCluster
Parameters:
  DBUsername:
    NoEcho: 'true'
    Description: Username for MySQL database access
    Type: String
    MinLength: '1'
    MaxLength: '16'
    AllowedPattern: '[a-zA-Z][a-zA-Z0-9]*'
    ConstraintDescription: must begin with a letter and contain only alphanumeric characters.
  DBPassword:
    NoEcho: 'true'
    Description: Password MySQL database access
    Type: String
    MinLength: '8'
    MaxLength: '41'
    AllowedPattern: '[a-zA-Z0-9]*'
    ConstraintDescription: must contain only alphanumeric characters.
Resources:
  RDSCluster-2:
    Type: 'AWS::RDS::DBCluster'
    Properties:
      MasterUsername: !Ref DBUsername
      MasterUserPassword: !Ref DBPassword
      DBClusterIdentifier: my-serverless-cluster
      Engine: aurora
      EngineVersion: 5.6.10a
      EngineMode: serverless
      ScalingConfiguration:
        AutoPause: true
        MinCapacity: 4
        MaxCapacity: 32
        SecondsUntilAutoPause: 1000
      StorageEncrypted: false","[[54], [24], [36]]"
541,a88baa34-e2ad-44ea-ad6f-8cac87bc7c71,Passwords And Secrets,Common,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/common/passwords_and_secrets,common-queries,"Query to find passwords and secrets in infrastructure code.<br>
[Documentation](https://docs.kics.io/latest/secrets/)","#k8s test
apiVersion: v1
kind: Pod
metadata:
  name: nginx
  labels:
    env: test
spec:
  containers:
    - name: nginx
      image: nginx
      # trigger validation","#k8s test
apiVersion: v1
kind: Secret
metadata:
  name: secret-basic-auth
type: kubernetes.io/basic-auth
stringData:
  password: ""root""

openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths: {}
servers:
  - url: http://bob:sekret@example.invalid/some/path
    description: My API Server 1
  - url: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX
    description: My API Server 2
  - url: https://team_name.webhook.office.com/webhookb2/7aa49aa6-7840-443d-806c-08ebe8f59966@c662313f-14fc-43a2-9a7a-d2e27f4f3478/IncomingWebhook/8592f62b50cf41b9b93ba0c0a00a0b88/eff4cd58-1bb8-4899-94de-795f656b4a18
    description: My API Server 3","[[8], [9, 11, 7]]"
542,0c7a76d9-7dc5-499e-81ac-9245839177cb,ECS Cluster with Container Insights Disabled,Crossplane,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/ecs_cluster_with_container_insights_disabled,Unknown,"ECS Cluster should enable container insights<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/ecs.aws.crossplane.io/Cluster/v1alpha1@v0.42.0#spec-forProvider-settings)","apiVersion: ecs.aws.crossplane.io/v1alpha1
kind: Cluster
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1
    settings:
      - name: ""containerInsights""
        value: ""enabled""","apiVersion: ecs.aws.crossplane.io/v1alpha1
kind: Cluster
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1

apiVersion: ecs.aws.crossplane.io/v1alpha1
kind: Cluster
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1
    settings: []

apiVersion: ecs.aws.crossplane.io/v1alpha1
kind: Cluster
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1
    settings:
      - name: ""containerInsights""
        value: ""disabled""","[[6], [8], [8]]"
543,255b0fcc-9f82-41fe-9229-01b163e3376b,CloudFront Without Minimum Protocol TLS 1.2,Crossplane,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/cloudfront_without_minimum_protocol_tls_1.2,Unknown,"CloudFront Minimum Protocol version should be at least TLS 1.2<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/cloudfront.aws.crossplane.io/Distribution/v1alpha1@v0.29.0#spec-forProvider-distributionConfig-viewerCertificate-minimumProtocolVersion)","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      viewerCertificate:
        sslSupportMethod: sni-only
        cloudFrontDefaultCertificate: false
        minimumProtocolVersion: TLSv1.2_2018
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              viewerCertificate:
                sslSupportMethod: sni-only
                cloudFrontDefaultCertificate: false
                minimumProtocolVersion: TLSv1.2_2018
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      viewerCertificate:
        sslSupportMethod: sni-only
        cloudFrontDefaultCertificate: false
        minimumProtocolVersion: TLSv1.1_2016
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              viewerCertificate:
                sslSupportMethod: sni-only
                cloudFrontDefaultCertificate: false
                minimumProtocolVersion: TLSv1.1_2016
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"

apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"

apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      viewerCertificate:
        sslSupportMethod: sni-only
        cloudFrontDefaultCertificate: false
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              viewerCertificate:
                sslSupportMethod: sni-only
                cloudFrontDefaultCertificate: false
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"","[[54, 14], [8, 44], [50, 11]]"
544,6d19ce0f-b3d8-4128-ac3d-1064e0f00494,CloudFront Without WAF,Crossplane,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/cloudfront_without_waf,Unknown,"All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/cloudfront.aws.crossplane.io/Distribution/v1alpha1@v0.29.0#spec-forProvider-distributionConfig-webACLID)","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      viewerCertificate:
        sslSupportMethod: sni-only
        cloudFrontDefaultCertificate: false
        minimumProtocolVersion: TLSv1.2_2018
      webACLID: 473e64fd-f30b-4765-81a0-62ad96dd167a   
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              viewerCertificate:
                sslSupportMethod: sni-only
                cloudFrontDefaultCertificate: false
                minimumProtocolVersion: TLSv1.2_2018
              webACLID: 473e64fd-f30b-4765-81a0-62ad96dd167a
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      viewerCertificate:
        sslSupportMethod: sni-only
        cloudFrontDefaultCertificate: false
        minimumProtocolVersion: TLSv1.2_2018
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              viewerCertificate:
                sslSupportMethod: sni-only
                cloudFrontDefaultCertificate: false
                minimumProtocolVersion: TLSv1.2_2018
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"","[[8, 48]]"
545,72840c35-3876-48be-900d-f21b2f0c2ea1,EFS Not Encrypted,Crossplane,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/efs_not_encrypted,Unknown,"Elastic File System (EFS) must be encrypted<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/efs.aws.crossplane.io/FileSystem/v1alpha1@v0.29.0#spec-forProvider-encrypted)","apiVersion: efs.aws.crossplane.io/v1alpha1
kind: FileSystem
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1
    encrypted: true
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: efs.aws.crossplane.io/v1alpha1
        kind: FileSystem
        metadata:
          name: example2
        spec:
          forProvider:
            region: us-east-1
            encrypted: true
          providerConfigRef:
            name: example","apiVersion: efs.aws.crossplane.io/v1alpha1
kind: FileSystem
metadata:
  name: example3
spec:
  forProvider:
    region: us-east-1
    encrypted: false
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: efs.aws.crossplane.io/v1alpha1
        kind: FileSystem
        metadata:
          name: example4
        spec:
          forProvider:
            region: us-east-1
            encrypted: false
          providerConfigRef:
            name: example

apiVersion: efs.aws.crossplane.io/v1alpha1
kind: FileSystem
metadata:
  name: example5
spec:
  forProvider:
    region: us-east-1
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: efs.aws.crossplane.io/v1alpha1
        kind: FileSystem
        metadata:
          name: example6
        spec:
          forProvider:
            region: us-east-1
          providerConfigRef:
            name: example","[[8, 38], [35, 6]]"
546,7b590235-1ff4-421b-b9ff-5227134be9bb,CloudFront Logging Disabled,Crossplane,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/cloudfront_logging_disabled,Unknown,"AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging' must be defined with 'enabled' set to true<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/cloudfront.aws.crossplane.io/Distribution/v1alpha1@v0.29.0#spec-forProvider-distributionConfig-logging)","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      logging:
        enabled: true
        include_cookies: false
        bucket: sample.s3.amazonaws.com
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
  - name: metadata
    patches:
    - fromFieldPath: metadata.labels
  resources:
    - name: sample-cloudfront
      base: 
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            region: us-east-1
            distributionConfig:
              enabled: true
              comment: Crossplane - auto provisioning
              logging:
                enabled: true
                include_cookies: false
                bucket: sample.s3.amazonaws.com
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"","apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      logging:
        enabled: false
        include_cookies: false
        bucket: sample.s3.amazonaws.com
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  labels:
    cluster: eks
    provider: aws
  name: cluster-aws
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - base:
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            distributionConfig:
              comment: ""Crossplane - auto provisioning""
              enabled: true
              logging:
                bucket: sample.s3.amazonaws.com
                enabled: false
                include_cookies: false
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"
            region: us-east-1
      name: sample-cloudfront
  writeConnectionSecretsToNamespace: crossplane-system

apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  labels:
    cluster: eks
    provider: aws
  name: cluster-aws
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - base:
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            distributionConfig:
              comment: ""Crossplane - auto provisioning""
              enabled: true
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"
            region: us-east-1
      name: sample-cloudfront
  writeConnectionSecretsToNamespace: crossplane-system

apiVersion: cloudfront.aws.crossplane.io/v1alpha1
kind: Distribution
metadata:
  name: sample-distribution
spec:
  forProvider:
    region: us-east-1
    distributionConfig:
      enabled: true
      comment: Crossplane - auto provisioning
      logging:
        include_cookies: false
        bucket: sample.s3.amazonaws.com
      origins:
        items:
          - domainName: sample.s3.amazonaws.com
            id: s3Origin
            s3OriginConfig:
              originAccessIDentity: """"
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  labels:
    cluster: eks
    provider: aws
  name: cluster-aws
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - base:
        apiVersion: cloudfront.aws.crossplane.io/v1alpha1
        kind: Distribution
        metadata:
          name: sample-distribution
        spec:
          forProvider:
            distributionConfig:
              comment: ""Crossplane - auto provisioning""
              enabled: true
              logging:
                include_cookies: false
                bucket: sample.s3.amazonaws.com
              origins:
                items:
                  - domainName: sample.s3.amazonaws.com
                    id: s3Origin
                    s3OriginConfig:
                      originAccessIDentity: """"
            region: us-east-1
      name: sample-cloudfront
  writeConnectionSecretsToNamespace: crossplane-system","[[50, 12], [8, 41], [11, 47]]"
547,83bf5aca-138a-498e-b9cd-ad5bc5e117b4,Neptune Database Cluster Encryption Disabled,Crossplane,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/neptune_database_cluster_encryption_disabled,Unknown,"Neptune database cluster storage should have encryption enabled<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/neptune.aws.crossplane.io/DBCluster/v1alpha1@v0.29.0#spec-forProvider-storageEncrypted)","apiVersion: neptune.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: sample-cluster
spec:
  forProvider:
    region: eu-central-1
    applyImmediately: true
    backupRetentionPeriod: 5
    engine: neptune
    enableIAMDatabaseAuthentication: true
    deletionProtection: false
    preferredBackupWindow: 07:00-09:00
    skipFinalSnapshot: true
    storageEncrypted: true
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: neptune.aws.crossplane.io/v1alpha1
        kind: DBCluster
        metadata:
          name: sample-cluster2
        spec:
          forProvider:
            region: eu-central-1
            applyImmediately: true
            backupRetentionPeriod: 5
            engine: neptune
            enableIAMDatabaseAuthentication: true
            deletionProtection: false
            preferredBackupWindow: 07:00-09:00
            skipFinalSnapshot: true
            storageEncrypted: true","apiVersion: neptune.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: sample-cluster3
spec:
  forProvider:
    region: eu-central-1
    applyImmediately: true
    backupRetentionPeriod: 5
    engine: neptune
    enableIAMDatabaseAuthentication: true
    deletionProtection: false
    preferredBackupWindow: 07:00-09:00
    skipFinalSnapshot: true
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: neptune.aws.crossplane.io/v1alpha1
        kind: DBCluster
        metadata:
          name: sample-cluster4
        spec:
          forProvider:
            region: eu-central-1
            applyImmediately: true
            backupRetentionPeriod: 5
            engine: neptune
            enableIAMDatabaseAuthentication: true
            deletionProtection: false
            preferredBackupWindow: 07:00-09:00
            skipFinalSnapshot: true

apiVersion: neptune.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: sample-cluster3
spec:
  forProvider:
    region: eu-central-1
    applyImmediately: true
    backupRetentionPeriod: 5
    engine: neptune
    enableIAMDatabaseAuthentication: true
    deletionProtection: false
    preferredBackupWindow: 07:00-09:00
    skipFinalSnapshot: true
    storageEncrypted: false
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: neptune.aws.crossplane.io/v1alpha1
        kind: DBCluster
        metadata:
          name: sample-cluster4
        spec:
          forProvider:
            region: eu-central-1
            applyImmediately: true
            backupRetentionPeriod: 5
            engine: neptune
            enableIAMDatabaseAuthentication: true
            deletionProtection: false
            preferredBackupWindow: 07:00-09:00
            skipFinalSnapshot: true
            storageEncrypted: false","[[40, 6], [50, 15]]"
548,9296f1cc-7a40-45de-bd41-f31745488a0e,SQS With SSE Disabled,Crossplane,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/sqs_with_sse_disabled,Unknown,"Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE)<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/sqs.aws.crossplane.io/Queue/v1beta1@v0.29.0#spec-forProvider-kmsMasterKeyId)","apiVersion: sqs.aws.crossplane.io/v1beta1
kind: Queue
metadata:
  name: test-queue
spec:
  forProvider:
    region: us-east-1
    kmsMasterKeyId: KMS-KEY-ARN
    delaySeconds: 4
    redrivePolicy:
      deadLetterTargetArnRef:
        name: test-queue2
      maxReceiveCount: 1
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: sqs.aws.crossplane.io/v1beta1
        kind: Queue
        metadata:
          name: test-queue2
        spec:
          forProvider:
            region: us-east-1
            kmsMasterKeyId: KMS-KEY-ARN
            delaySeconds: 4
            redrivePolicy:
              deadLetterTargetArnRef:
                name: test-queue2
              maxReceiveCount: 1
          providerConfigRef:
            name: example","apiVersion: sqs.aws.crossplane.io/v1beta1
kind: Queue
metadata:
  name: test-queue3
spec:
  forProvider:
    region: us-east-1
    delaySeconds: 4
    redrivePolicy:
      deadLetterTargetArnRef:
        name: test-queue2
      maxReceiveCount: 1
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: sqs.aws.crossplane.io/v1beta1
        kind: Queue
        metadata:
          name: test-queue4
        spec:
          forProvider:
            region: us-east-1
            delaySeconds: 4
            redrivePolicy:
              deadLetterTargetArnRef:
                name: test-queue2
              maxReceiveCount: 1
          providerConfigRef:
            name: example","[[40, 6]]"
549,934613fe-b12c-4e5a-95f5-c1dcdffac1ff,CloudWatch Without Retention Period Specified,Crossplane,Info,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/cloudwatch_without_retention_period_specified,Unknown,"AWS CloudWatch should have CloudWatch Logs enabled in order to monitor, store, and access log events<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/cloudwatchlogs.aws.crossplane.io/LogGroup/v1alpha1@v0.29.0#spec-forProvider-retentionInDays)","apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
kind: LogGroup
metadata:
  name: lg-1
spec:
  forProvider:
    logGroupName: /aws/eks/sample-cluster/cluster
    region: us-east-1
    retentionInDays: 1
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
        kind: LogGroup
        metadata:
          name: lg-2
        spec:
          forProvider:
            logGroupName: /aws/eks/sample-cluster/cluster
            region: us-east-1
            retentionInDays: 1","apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
kind: LogGroup
metadata:
  name: lg-3
spec:
  forProvider:
    logGroupName: /aws/eks/sample-cluster/cluster
    region: us-east-1
    retentionInDays: 0
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
        kind: LogGroup
        metadata:
          name: lg-4
        spec:
          forProvider:
            logGroupName: /aws/eks/sample-cluster/cluster
            region: us-east-1
            retentionInDays: 0

apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
kind: LogGroup
metadata:
  name: lg-5
spec:
  forProvider:
    logGroupName: /aws/eks/sample-cluster/cluster
    region: us-east-1
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: cloudwatchlogs.aws.crossplane.io/v1alpha1
        kind: LogGroup
        metadata:
          name: lg-6
        spec:
          forProvider:
            logGroupName: /aws/eks/sample-cluster/cluster
            region: us-east-1","[[9, 38], [34, 6]]"
550,a507daa5-0795-4380-960b-dd7bb7c56661,ELB Using Weak Ciphers,Crossplane,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/elb_using_weak_ciphers,Unknown,"ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'sslPolicy' of 'Listener' must not coincide with any of a predefined list of weak ciphers.<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/elbv2.aws.crossplane.io/Listener/v1alpha1@v0.29.0#spec-forProvider-sslPolicy)","apiVersion: elbv2.aws.crossplane.io/v1alpha1
kind: Listener
metadata:
  name: test-listener
spec:
  forProvider:
    region: us-east-1
    defaultActions:
      - actionType: forward
        forwardConfig:
          targetGroups:
            - targetGroupArnRef:
                name: test-targetgroup
    loadBalancerArnRef:
      name: test-loadbalancer
    port: 80
    protocol: HTTP
    sslPolicy: ELBSecurityPolicy-2015-05
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: elbv2.aws.crossplane.io/v1alpha1
        kind: Listener
        metadata:
          name: test-listener2
        spec:
          forProvider:
            region: us-east-1
            defaultActions:
              - actionType: forward
                forwardConfig:
                  targetGroups:
                    - targetGroupArnRef:
                        name: test-targetgroup
            loadBalancerArnRef:
              name: test-loadbalancer
            port: 80
            protocol: HTTP
            sslPolicy: ELBSecurityPolicy-2015-05
          providerConfigRef:
            name: example","apiVersion: elbv2.aws.crossplane.io/v1alpha1
kind: Listener
metadata:
  name: test-listener
spec:
  forProvider:
    region: us-east-1
    defaultActions:
      - actionType: forward
        forwardConfig:
          targetGroups:
            - targetGroupArnRef:
                name: test-targetgroup
    loadBalancerArnRef:
      name: test-loadbalancer
    port: 80
    protocol: HTTP
    sslPolicy: TLS_NULL_WITH_NULL_NULL
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: elbv2.aws.crossplane.io/v1alpha1
        kind: Listener
        metadata:
          name: test-listener2
        spec:
          forProvider:
            region: us-east-1
            defaultActions:
              - actionType: forward
                forwardConfig:
                  targetGroups:
                    - targetGroupArnRef:
                        name: test-targetgroup
            loadBalancerArnRef:
              name: test-loadbalancer
            port: 80
            protocol: HTTP
            sslPolicy: TLS_NULL_WITH_NULL_NULL
          providerConfigRef:
            name: example","[[18, 58]]"
551,bdecd6db-2600-47dd-a10c-72c97cf17ae9,EFS Without KMS,Crossplane,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/efs_without_kms,Unknown,"Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/efs.aws.crossplane.io/FileSystem/v1alpha1@v0.29.0#spec-forProvider-kmsKeyID)","apiVersion: efs.aws.crossplane.io/v1alpha1
kind: FileSystem
metadata:
  name: example
spec:
  forProvider:
    region: us-east-1
    kmsKeyID: 1234abcd-12ab-34cd-56ef-1234567890ab
    encrypted: true
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: efs.aws.crossplane.io/v1alpha1
        kind: FileSystem
        metadata:
          name: example2
        spec:
          forProvider:
            region: us-east-1
            kmsKeyID: 1234abcd-12ab-34cd-56ef-1234567890ab
            encrypted: true
          providerConfigRef:
            name: example","apiVersion: efs.aws.crossplane.io/v1alpha1
kind: FileSystem
metadata:
  name: example3
spec:
  forProvider:
    region: us-east-1
    encrypted: false
  providerConfigRef:
    name: example
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: efs.aws.crossplane.io/v1alpha1
        kind: FileSystem
        metadata:
          name: example4
        spec:
          forProvider:
            region: us-east-1
            encrypted: false
          providerConfigRef:
            name: example","[[36, 6]]"
552,d9dc6429-5140-498a-8f55-a10daac5f000,RDS DB Instance Publicly Accessible,Crossplane,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/rds_db_instance_publicly_accessible,Unknown,"RDS must not be defined with public interface, which means the attribute 'PubliclyAccessible' must be set to false and neither dbSubnetGroupName' subnets being part of a VPC that has an Internet gateway attached to it<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/database.aws.crossplane.io/RDSInstance/v1beta1@v0.17.0)","apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: sample-cluster3
spec: 
  forProvider:
    publiclyAccessible: false

---

apiVersion: database.aws.crossplane.io/v1alpha3
kind: DBSubnetGroup
metadata:
  name: my-db-subnet-group
spec:
  forProvider:
    description: ""My DB Subnet Group""
    subnetIds:
      - subnet-12345678
      - subnet-87654321

apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: my-rds-instance
spec:
  forProvider:
    engine: mysql
    engineVersion: ""8.0""
    instanceClass: db.t2.micro
    allocatedStorage: 20
    dbSubnetGroupName: my-db-subnet-group
  writeConnectionSecretToRef:
    name: my-rds-instance-connection

---

apiVersion: database.aws.crossplane.io/v1alpha3
kind: DBSubnetGroup
metadata:
  name: my-db-subnet-group
spec:
  forProvider:
    description: ""My DB Subnet Group""
    subnetIds:
      - subnet-12345678
      - subnet-87654321

---

apiVersion: ec2.aws.crossplane.io/v1beta1
kind: Subnet
metadata:
  name: subnet-12345678
spec:
  forProvider:
    cidrBlock: ""10.0.0.0/24""
    vpcId: vpc-abcdef12
    availabilityZone: us-west-2a

---

apiVersion: ec2.aws.crossplane.io/v1beta1
kind: Subnet
metadata:
  name: subnet-87654321
spec:
  forProvider:
    cidrBlock: ""10.0.0.1/24""
    vpcId: vpc-abcdef12
    availabilityZone: us-west-2a

---

apiVersion: network.aws.crossplane.io/v1alpha3
kind: InternetGateway
metadata:
  name: my-internet-gateway
spec:
  forProvider:
    vpcId: vpc-abcdef12345","apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: sample-cluster3
spec: 
  forProvider:
    publiclyAccessible: true

---

apiVersion: database.aws.crossplane.io/v1alpha3
kind: DBSubnetGroup
metadata:
  name: my-db-subnet-group
spec:
  forProvider:
    description: ""My DB Subnet Group""
    subnetIds:
      - subnet-12345678
      - subnet-87654321

apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: my-rds-instance
spec:
  forProvider:
    engine: mysql
    engineVersion: ""8.0""
    instanceClass: db.t2.micro
    allocatedStorage: 20
    dbSubnetGroupName: my-db-subnet-group
  writeConnectionSecretToRef:
    name: my-rds-instance-connection

---

apiVersion: database.aws.crossplane.io/v1alpha3
kind: DBSubnetGroup
metadata:
  name: my-db-subnet-group
spec:
  forProvider:
    description: ""My DB Subnet Group""
    subnetIds:
      - subnet-12345678
      - subnet-87654321

---

apiVersion: ec2.aws.crossplane.io/v1beta1
kind: Subnet
metadata:
  name: subnet-12345678
spec:
  forProvider:
    cidrBlock: ""10.0.0.0/24""
    vpcId: vpc-abcdef12
    availabilityZone: us-west-2a

---

apiVersion: ec2.aws.crossplane.io/v1beta1
kind: Subnet
metadata:
  name: subnet-87654321
spec:
  forProvider:
    cidrBlock: ""10.0.0.1/24""
    vpcId: vpc-abcdef12
    availabilityZone: us-west-2a

---

apiVersion: network.aws.crossplane.io/v1alpha3
kind: InternetGateway
metadata:
  name: my-internet-gateway
spec:
  forProvider:
    vpcId: vpc-abcdef12","[[7], [11]]"
553,dd667399-8d9d-4a8d-bbb4-e49ab53b2f52,DB Security Group Has Public Interface,Crossplane,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/db_security_group_has_public_interface,Unknown,"The CIDR IP should not be a public interface<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/ec2.aws.crossplane.io/SecurityGroup/v1beta1@v0.29.0#spec-forProvider-ingress-ipRanges-cidrIp)","apiVersion: ec2.aws.crossplane.io/v1beta1
kind: SecurityGroup
metadata:
  name: ec2-rule1
spec:
  forProvider:
    region: us-east-1
    vpcIdSelector:
      matchControllerRef: true
    groupName: crossplane-getting-started
    description: Allow access to PostgreSQL
    ingress:
      - fromPort: 5432
        toPort: 5432
        ipProtocol: tcp
        ipRanges:
          - cidrIp: 10.0.0.0/8
            description: sample
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: ec2.aws.crossplane.io/v1beta1
        kind: SecurityGroup
        metadata:
          name: ec2-rule
        spec:
          forProvider:
            region: us-east-1
            vpcIdSelector:
              matchControllerRef: true
            groupName: crossplane-getting-started
            description: Allow access to PostgreSQL
            ingress:
              - fromPort: 5432
                toPort: 5432
                ipProtocol: tcp
                ipRanges:
                  - cidrIp: 10.0.0.0/8
                    description: sample","apiVersion: ec2.aws.crossplane.io/v1beta1
kind: SecurityGroup
metadata:
  name: ec2-rule2
spec:
  forProvider:
    region: us-east-1
    vpcIdSelector:
      matchControllerRef: true
    groupName: crossplane-getting-started
    description: Allow access to PostgreSQL
    ingress:
      - fromPort: 5432
        toPort: 5432
        ipProtocol: tcp
        ipRanges:
          - cidrIp: 0.0.0.0/0
            description: Everywhere
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: ec2.aws.crossplane.io/v1beta1
        kind: SecurityGroup
        metadata:
          name: ec2-rule5
        spec:
          forProvider:
            region: us-east-1
            vpcIdSelector:
              matchControllerRef: true
            groupName: crossplane-getting-started
            description: Allow access to PostgreSQL
            ingress:
              - fromPort: 5432
                toPort: 5432
                ipProtocol: tcp
                ipRanges:
                  - cidrIp: 0.0.0.0/0
                    description: Everywhere","[[17, 55]]"
554,e50eb68a-a4af-4048-8bbe-8ec324421469,DB Instance Storage Not Encrypted,Crossplane,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/db_instance_storage_not_encrypted,Unknown,"RDS Instance should have its storage encrypted by setting the parameter to 'true'. The storageEncrypted default value is 'false'.<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/database.aws.crossplane.io/RDSInstance/v1beta1@v0.29.0#spec-forProvider-storageEncrypted)","apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: rds1
spec:
  forProvider:
    allocatedStorage: 50
    applyModificationsImmediately: false
    backupRetentionPeriod: 0
    caCertificateIdentifier: rds-ca-2019
    copyTagsToSnapshot: false
    dbInstanceClass: db.t3.medium
    deletionProtection: false
    enableIAMDatabaseAuthentication: false
    enablePerformanceInsights: false
    engine: mysql
    region: us-west-2
    engineVersion: 5.7.33
    licenseModel: general-public-license
    publiclyAccessible: false
    storageEncrypted: true
    storageType: gp2
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: database.aws.crossplane.io/v1beta1
        kind: RDSInstance
        metadata:
          name: rds2
        spec:
          forProvider:
            allocatedStorage: 50
            applyModificationsImmediately: false
            backupRetentionPeriod: 0
            caCertificateIdentifier: rds-ca-2019
            copyTagsToSnapshot: false
            dbInstanceClass: db.t3.medium
            deletionProtection: false
            enableIAMDatabaseAuthentication: false
            enablePerformanceInsights: false
            engine: mysql
            region: us-west-2
            engineVersion: 5.7.33
            licenseModel: general-public-license
            publiclyAccessible: false
            storageEncrypted: true
            storageType: gp2","apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: rds3
spec:
  forProvider:
    allocatedStorage: 50
    applyModificationsImmediately: false
    backupRetentionPeriod: 0
    caCertificateIdentifier: rds-ca-2019
    copyTagsToSnapshot: false
    dbInstanceClass: db.t3.medium
    deletionProtection: false
    enableIAMDatabaseAuthentication: false
    enablePerformanceInsights: false
    engine: mysql
    region: us-west-2
    engineVersion: 5.7.33
    licenseModel: general-public-license
    publiclyAccessible: false
    storageEncrypted: false
    storageType: gp2
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: database.aws.crossplane.io/v1beta1
        kind: RDSInstance
        metadata:
          name: rds4
        spec:
          forProvider:
            allocatedStorage: 50
            applyModificationsImmediately: false
            backupRetentionPeriod: 0
            caCertificateIdentifier: rds-ca-2019
            copyTagsToSnapshot: false
            dbInstanceClass: db.t3.medium
            deletionProtection: false
            enableIAMDatabaseAuthentication: false
            enablePerformanceInsights: false
            engine: mysql
            region: us-west-2
            engineVersion: 5.7.33
            licenseModel: general-public-license
            publiclyAccessible: false
            storageEncrypted: false
            storageType: gp2

apiVersion: database.aws.crossplane.io/v1beta1
kind: RDSInstance
metadata:
  name: rds5
spec:
  forProvider:
    allocatedStorage: 50
    applyModificationsImmediately: false
    backupRetentionPeriod: 0
    caCertificateIdentifier: rds-ca-2019
    copyTagsToSnapshot: false
    dbInstanceClass: db.t3.medium
    deletionProtection: false
    enableIAMDatabaseAuthentication: false
    enablePerformanceInsights: false
    engine: mysql
    region: us-west-2
    engineVersion: 5.7.33
    licenseModel: general-public-license
    publiclyAccessible: false
    storageType: gp2
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: cluster-aws
  labels:
    provider: aws
    cluster: eks
spec:
  compositeTypeRef:
    apiVersion: mydev.org/v1alpha1
    kind: CompositeCluster
  writeConnectionSecretsToNamespace: crossplane-system
  patchSets:
    - name: metadata
      patches:
        - fromFieldPath: metadata.labels
  resources:
    - name: sample-ec2
      base:
        apiVersion: database.aws.crossplane.io/v1beta1
        kind: RDSInstance
        metadata:
          name: rds6
        spec:
          forProvider:
            allocatedStorage: 50
            applyModificationsImmediately: false
            backupRetentionPeriod: 0
            caCertificateIdentifier: rds-ca-2019
            copyTagsToSnapshot: false
            dbInstanceClass: db.t3.medium
            deletionProtection: false
            enableIAMDatabaseAuthentication: false
            enablePerformanceInsights: false
            engine: mysql
            region: us-west-2
            engineVersion: 5.7.33
            licenseModel: general-public-license
            publiclyAccessible: false
            storageType: gp2","[[21, 63], [6, 47]]"
555,e6cd49ba-77ed-417f-9bca-4f5303554308,DocDB Logging Is Disabled,Crossplane,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/aws/docdb_logging_disabled,Unknown,"DocDB logging should be enabled<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-aws/docdb.aws.crossplane.io/DBCluster/v1alpha1@v0.21.1#status-atProvider-enabledCloudwatchLogsExports)","apiVersion: docdb.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: example-cluster-autogen-password
spec:
  forProvider:
    autogeneratePassword: true
    availabilityZones:
      - us-east-1b
      - us-east-1c
    dbClusterParameterGroupName: example-parameter-group
    dbSubnetGroupName: example-subnet-group
    engine: docdb
    masterUserPasswordSecretRef:
      key: password
      name: my-docdb-creds
      namespace: crossplane-system
    masterUsername: master
    region: us-east-1
    skipFinalSnapshot: true
    tags:
      - key: cluster
        value: my-cluster
    vpcSecurityGroupIDsRefs:
      - name: sample-cluster-sg
    enableCloudwatchLogsExports:
      - audit
      - profiler
  providerConfigRef:
    name: example","apiVersion: docdb.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: example-cluster-autogen-password
spec:
  forProvider:
    autogeneratePassword: true
    availabilityZones:
      - us-east-1b
      - us-east-1c
    dbClusterParameterGroupName: example-parameter-group
    dbSubnetGroupName: example-subnet-group
    engine: docdb
    masterUserPasswordSecretRef:
      key: password
      name: my-docdb-creds
      namespace: crossplane-system
    masterUsername: master
    region: us-east-1
    skipFinalSnapshot: true
    tags:
      - key: cluster
        value: my-cluster
    vpcSecurityGroupIDsRefs:
      - name: sample-cluster-sg
  providerConfigRef:
    name: example

apiVersion: docdb.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: example-cluster-autogen-password
spec:
  forProvider:
    autogeneratePassword: true
    availabilityZones:
      - us-east-1b
      - us-east-1c
    dbClusterParameterGroupName: example-parameter-group
    dbSubnetGroupName: example-subnet-group
    engine: docdb
    masterUserPasswordSecretRef:
      key: password
      name: my-docdb-creds
      namespace: crossplane-system
    masterUsername: master
    region: us-east-1
    skipFinalSnapshot: true
    tags:
      - key: cluster
        value: my-cluster
    vpcSecurityGroupIDsRefs:
      - name: sample-cluster-sg
    enableCloudwatchLogsExports: []
  providerConfigRef:
    name: example

apiVersion: docdb.aws.crossplane.io/v1alpha1
kind: DBCluster
metadata:
  name: example-cluster-autogen-password
spec:
  forProvider:
    autogeneratePassword: true
    availabilityZones:
      - us-east-1b
      - us-east-1c
    dbClusterParameterGroupName: example-parameter-group
    dbSubnetGroupName: example-subnet-group
    engine: docdb
    masterUserPasswordSecretRef:
      key: password
      name: my-docdb-creds
      namespace: crossplane-system
    masterUsername: master
    region: us-east-1
    skipFinalSnapshot: true
    tags:
      - key: cluster
        value: my-cluster
    vpcSecurityGroupIDsRefs:
      - name: sample-cluster-sg
    enableCloudwatchLogsExports:
      - audit
      - error
  providerConfigRef:
    name: example","[[6], [26], [26]]"
556,6c7cfec3-c686-4ed2-bf58-a1ec054b63fc,Redis Cache Allows Non SSL Connections,Crossplane,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/azure/redis_cache_allows_non_ssl_connections,Unknown,"Redis Cache resource should not allow non-SSL connections.<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-azure/cache.azure.crossplane.io/Redis/v1beta1@v0.19.0#spec-forProvider-enableNonSslPort)","apiVersion: cache.azure.crossplane.io/v1beta1
kind: Redis
metadata:
  name: azureRedis
spec:
  providerConfigRef:
    name: crossplane-azure
  forProvider:
    location: West Europe
    sku:
      name: Basic
      family: C
      capacity: 0
    enableNonSslPort: false
---
apiVersion: cache.azure.crossplane.io/v1beta1
kind: Redis
metadata:
  name: azureRedis2
spec:
  providerConfigRef:
    name: crossplane-azure
  forProvider:
    location: West Europe
    sku:
      name: Basic
      family: C
      capacity: 0","apiVersion: cache.azure.crossplane.io/v1beta1
kind: Redis
metadata:
  name: azureRedis3
spec:
  providerConfigRef:
    name: crossplane-azure
  forProvider:
    location: West Europe
    sku:
      name: Basic
      family: C
      capacity: 0
    enableNonSslPort: true",[[14]]
557,b2418936-cd47-4ea2-8346-623c0bdb87bd,AKS RBAC Disabled,Crossplane,Medium,Access Control,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/azure/aks_rbac_disabled,Unknown,"Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-azure/compute.azure.crossplane.io/AKSCluster/v1alpha3@v0.19.0#spec-disableRBAC)","apiVersion: compute.azure.crossplane.io/v1alpha3
kind: AKSCluster
metadata:
  name: anais-crossplane-demo
spec:
  location: eastus
  version: ""1.19.7""
  nodeVMSize: Standard_D2_v2
  resourceGroupNameRef:
    name: anais-resource
  dnsNamePrefix: dt
  nodeCount: 2
  disableRBAC: false
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: aks.multik8s.platformref.crossplane.io
  labels:
    provider: AZURE
spec:
  compositeTypeRef:
    apiVersion: multik8s.platformref.crossplane.io/v1alpha1
    kind: AKS
  resources:
    - name: sample-ec2
      base:
        apiVersion: compute.azure.crossplane.io/v1alpha3
        kind: AKSCluster
        metadata:
          name: anais-crossplane-demo
        spec:
          location: eastus
          version: ""1.19.7""
          nodeVMSize: Standard_D2_v2
          resourceGroupNameRef:
            name: anais-resource
          dnsNamePrefix: dt
          nodeCount: 2","apiVersion: compute.azure.crossplane.io/v1alpha3
kind: AKSCluster
metadata:
  name: anais-crossplane-demo
spec:
  location: eastus
  version: ""1.19.7""
  nodeVMSize: Standard_D2_v2
  resourceGroupNameRef:
    name: anais-resource
  dnsNamePrefix: dt
  nodeCount: 2
  disableRBAC: true
---
apiVersion: apiextensions.crossplane.io/v1
kind: Composition
metadata:
  name: aks.multik8s.platformref.crossplane.io
  labels:
    provider: AZURE
spec:
  compositeTypeRef:
    apiVersion: multik8s.platformref.crossplane.io/v1alpha1
    kind: AKS
  resources:
    - name: sample-ec2
      base:
        apiVersion: compute.azure.crossplane.io/v1alpha3
        kind: AKSCluster
        metadata:
          name: anais-crossplane-demo
        spec:
          location: eastus
          version: ""1.19.7""
          nodeVMSize: Standard_D2_v2
          resourceGroupNameRef:
            name: anais-resource
          dnsNamePrefix: dt
          nodeCount: 2
          disableRBAC: true","[[40, 13]]"
558,6c2d627c-de0f-45fb-b33d-dad9bffbb421,Cloud Storage Bucket Logging Not Enabled,Crossplane,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/gcp/cloud_storage_bucket_logging_not_enabled,Unknown,"Cloud storage bucket should have logging enabled<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-gcp/storage.gcp.crossplane.io/Bucket/v1alpha3@v0.21.0#spec-logging)","apiVersion: storage.gcp.crossplane.io/v1alpha3
kind: Bucket
metadata:
  name: bucketSample
spec:
  location: EU
  logging:
    logBucket: example-logs-bucket
  storageClass: MULTI_REGIONAL
  providerConfigRef:
    name: crossplane-gcp
  labels:
    made-by: crossplane
  deletionPolicy: Delete","apiVersion: storage.gcp.crossplane.io/v1alpha3
kind: Bucket
metadata:
  name: bucketSample
spec:
  location: EU
  storageClass: MULTI_REGIONAL
  providerConfigRef:
    name: crossplane-gcp
  labels:
    made-by: crossplane
  deletionPolicy: Delete",[[5]]
559,b4f65d13-a609-4dc1-af7c-63d2e08bffe9,Google Container Node Pool Auto Repair Disabled,Crossplane,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/crossplane/gcp/google_container_node_pool_auto_repair_disabled,Unknown,"Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state.<br>
[Documentation](https://doc.crds.dev/github.com/crossplane/provider-gcp/container.gcp.crossplane.io/NodePool/v1beta1@v0.21.0#spec-forProvider-management-autoRepair)","apiVersion: container.gcp.crossplane.io/v1beta1
kind: NodePool
metadata:
  name: cluster-np
spec:
  forProvider:
    management:
      autoRepair: true
    autoscaling:
      autoprovisioned: false
      enabled: true
      maxNodeCount: 5
      minNodeCount: 3 
    clusterRef:
      name: eutuxia-cluster
    initialNodeCount: 3 
    config:
      machineType: n1-standard-1
    locations:
      - ""us-central1-a""","apiVersion: container.gcp.crossplane.io/v1beta1
kind: NodePool
metadata:
  name: cluster-np
spec:
  forProvider:
    autoscaling:
      autoprovisioned: false
      enabled: true
      maxNodeCount: 5
      minNodeCount: 3 
    clusterRef:
      name: eutuxia-cluster
    initialNodeCount: 3 
    config:
      machineType: n1-standard-1
    locations:
      - ""us-central1-a""    
---
apiVersion: container.gcp.crossplane.io/v1beta1
kind: NodePool
metadata:
  name: cluster-np
spec:
  forProvider:
    management:
      autoRepair: false
    autoscaling:
      autoprovisioned: false
      enabled: true
      maxNodeCount: 5
      minNodeCount: 3 
    clusterRef:
      name: eutuxia-cluster
    initialNodeCount: 3 
    config:
      machineType: n1-standard-1
    locations:
      - ""us-central1-a""","[[27, 6]]"
560,071a71ff-f868-47a4-ac0b-3c59e4ab5443,Shared Host Network Namespace,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/shared_host_network_namespace,dockercompose-queries,"Container should not share the host network namespace<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#network_mode)","version: '2'

volumes:
  dhcp-leases:
    external: false

services:

  mongo: # 27017
    image: mongo:latest
    network_mode: ""none""
    privileged: true","version: '2'

volumes:
  dhcp-leases:
    external: false

services:

  mongo: # 27017
    image: mongo:latest
    network_mode: ""host""
    privileged: true",[[11]]
561,1c1325ff-831d-43a1-973e-839ae57dfcc0,Volume Has Sensitive Host Directory,DockerCompose,High,Build Process,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/volume_has_sensitive_host_directory,dockercompose-queries,"Container has sensitive host directory mounted as a volume<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#volume-configuration-reference)","version: ""3""
services:
    proxy:
        build: ./pyproxy
        deploy:
            mode: replicated
            placement:
                constraints: [node.role == manager]
            replicas: 8
        depends_on:
          - storage-node-1
          - storage-node-2
          - storage-node-3
          - storage-node-4
          - storage-node-5
          - storage-node-6
          - storage-node-7
          - storage-node-8
          - storage-node-9
          - storage-node-10
          - storage-node-11
          - storage-node-12
          - storage-node-13
          - storage-node-14
          - storage-node-15
          - storage-node-16
    zoo1:
        image: zookeeper
        restart: always
        ports:
          - 2181:2181
        environment:
          - ZOO_MY_ID=1
        deploy:
            mode: replicated
            placement:
                constraints: [node.role == manager]

    metadata:
        image: redis:3.2.8
        command: redis-server --appendonly yes
        deploy:
            mode: replicated
            placement:
                constraints: [node.role == manager]
        volumes:
          - ./volumes/metadata/:/data/

version: '3'

services:
    image: docker
volumes:
  wordpress-db-data:
     driver: local-persist
     driver_opts:
       mountpoint: ${CONTAINERVOLUME}/dockerData/mysql
  wordpress:
  wp-content:
     driver: local-persist
     driver_opts:
       mountpoint: ${CONTAINERVOLUME}/wp-content

version: ""3.9""
services:
  web:
    image: nginx:alpine
    ports:
      - ""80:80""
    volumes:
      - type: volume
        source: mydata
        target: /data
        volume:
          nocopy: true
      - type: bind
        source: ./static
        target: /opt/app/static

networks:
  webnet:

volumes:
  mydata:","version: ""3.9""

services:
  db:
    image: db
    volumes:
      - data-volume:/var/lib/db
  backup:
    image: backup-service
    volumes:
      - /var/lib/backup/data

volumes:
  data-volume:

version: ""3.9""
services:
  web:
    image: nginx:alpine
    volumes:
      - type: volume
        source: vol
        target: /data
        volume:
          nocopy: true
      - type: bind
        source: ./static
        target: /opt/app/static
volumes:
  vol:
    driver: local
    driver_opts:
      device: /var/lib/backup/data
      o: bind

version: '3'

services:
    image: docker
volumes:
  wordpress-db-data:
     driver: local-persist
     driver_opts:
       mountpoint: ${CONTAINERVOLUME}/dockerData/mysql
  wordpress:
  wp-content:
     driver: local-persist
     driver_opts:
       mountpoint: /var/data","[[11], [18], [14]]"
562,221e0658-cb2a-44e3-b08a-db96a341d6fa,Pids Limit Not Set,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/pids_limit_not_set,dockercompose-queries,"'pids_limit' should be set and different than -1<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir)","version: '2.2'

volumes:
  front_build:

services:
  auth:
    build:
      context: .
      dockerfile: docker_config/Dockerfile
    restart: on-failure
    pids_limit: 10
    cpus: 0.25
    mem_limit: 500M","version: '2.2'

volumes:
  front_build:

services:
  auth:
    build:
      context: .
      dockerfile: docker_config/Dockerfile
    restart: on-failure
    cpus: 0.25
    mem_limit: 500M

version: '2.2'

volumes:
  front_build:

services:
  auth:
    build:
      context: .
      dockerfile: docker_config/Dockerfile
    restart: on-failure
    pids_limit: -1
    cpus: 0.25
    mem_limit: 500M","[[7], [12]]"
563,27fcc7d6-c49b-46e0-98f1-6c082a6a2750,No New Privileges Not Set,DockerCompose,High,Resource Management,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/no_new_privileges_not_set,dockercompose-queries,"Ensuring the process does not gain any new privileges lessens the risk associated with many operations.<br>
[Documentation](https://docs.docker.com/engine/reference/run/#security-configuration)","version: ""3.4""
services:
  service-service-service:
    build:
      context: ./
      dockerfile: service.dockerfile
    ports:
      - ""6969:8080""
    networks:
      - service-service-frontend
    restart: always
    security_opt:
      - no-new-privileges:true

networks:
  service-service-frontend:","version: ""3.4""
services:
  service-service-service:
    build:
      context: ./
      dockerfile: service.dockerfile
    ports:
      - ""6969:8080""
    networks:
      - service-service-frontend
    restart: always
    security_opt:
      - no-new-privileges:false

networks:
  service-service-frontend:

version: ""3.4""
services:
  service-service-service:
    build:
      context: ./
      dockerfile: service.dockerfile
    ports:
      - ""6969:8080""
    networks:
      - service-service-frontend
    restart: always
    security_opt:
      - ""apparmor: false""

networks:
  service-service-frontend:","[[12], [12]]"
564,2fc99041-ddad-49d5-853f-e35e70a48391,Restart Policy On Failure Not Set To 5,DockerCompose,Medium,Build Process,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/restart_policy_on_failure_not_set_to_5,dockercompose-queries,"Attribute 'restart:on-failure' should be set to 5. Restart policies in general should be used, and 5 retries is the recommended by CIS.<br>
[Documentation](https://docs.docker.com/config/containers/start-containers-automatically/#use-a-restart-policy)","version: ""3.9""

services:
  customer:
    image: whoa/hello
    restart: on-failure:5
    networks:
      - netnet
    expose:
     - 8080
    ports:
     - 8082:8080
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 5
        window: 120s

networks:
  netnet:","version: ""3.9""

services:
  customer:
    image: whoa/hello
    restart: on-failure:10
    networks:
      - netnet
    expose:
     - 8080
    ports:
     - 8082:8080
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 10
        window: 120s

networks:
  netnet:

version: '3.6'

networks:
  name_of_network:
    name: name_of_network
    driver: overlay

services:
  name_of_service:
    image: not_a_real_one
    container_name: container1
    build: ./
    ports:
      - '5002:80'
    restart: on-failure:3
    networks:
      - name_of_network

version: ""3.9""

services:
  customer:
    image: whoa/hello
    restart: on-failure:10
    networks:
      - netnet
    expose:
     - 8080
    ports:
     - 8082:8080
    deploy:
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 5
        window: 120s

networks:
  netnet:","[[17, 6], [15], [6]]"
565,404fde2c-bc4b-4371-9747-7054132ac953,Default Seccomp Profile Disabled,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/default_seccomp_profile_disabled,dockercompose-queries,"Seccomp offers a whitelist of common system calls, blocking all others. This reduces the kernel's exposure to the application, thereby increasing security.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#security_opt)","version: ""3.9""

services:
  webapp:
    build:
      context: ./
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1","version: ""3.8""

services:
  demo:
    image: not/a/real/image
    cap_add:
      - SYS_PTRACE
    volumes:
      - type: volume
        source: not-a-real-source-docker
        target: /var/lib/docker
    security_opt:
      - label:seccomp:unconfined

volumes:
  not-a-real-source-docker:

version: ""3.9""

networks:
  backend:

services:
  example:
    build: .
    security_opt:
      - seccomp:unconfined
    networks:
      - backend
    ports:
      - ""5002:5002""","[[13], [10]]"
566,451d79dc-0588-476a-ad03-3c7f0320abb3,Container Traffic Not Bound To Host Interface,DockerCompose,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/container_traffic_not_bound_to_host_interface,dockercompose-queries,"Incoming container traffic should be bound to a specific host interface<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#ports)","version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""127.0.0.1:8000:8001""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""127.0.0.1:5000-5010:5000-5010""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      -  ""127.0.0.1::5000""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""","version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""7000:8000""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""12400-12500:1240""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""

version: '3.2'

services:
  webapp:
    container_name: webapp
    build: ./
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - target: 8000
        published: 8080
        protocol: tcp
        mode: host
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""","[[11], [11], [11]]"
567,4d9f44c6-2f4a-4317-9bb5-267adbea0232,Cgroup Not Default,DockerCompose,Medium,Build Process,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/cgroup_not_default,dockercompose-queries,"Control groups restrict the access processes and containers have to system resources such as CPU, RAM, IOPS and network. Not having a cgroup well configured may prove to be a security fault.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#cgroup_parent)","version: '2'

services:
  iperfclient:
    build:
      context: .
      dockerfile: client.Dockerfile
    container_name: ipc
    volumes:
      - ./host:container.yaml
    networks:
      - netnet
    expose:
      - 1234

networks:
  netnet:","version: '2'

services:
  iperfclient:
    build:
      context: .
      dockerfile: client.Dockerfile
    container_name: ipc
    cgroup_parent: nat-docker
    volumes:
      - ./host:container.yaml
    networks:
      - netnet
    expose:
      - 1234

networks:
  netnet:",[[9]]
568,4f31dd9f-2cc3-4751-9b53-67e4af83dac0,Host Namespace is Shared,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/host_namespace_is_shared,dockercompose-queries,"The hosts process namespace should not be shared by containers<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#pid)","version: '2.1'

services:

  service_name_4:
    image: not/a-real-image:latest
    command: [""launch""]
    ports:
      - ""8080:8080""
    pid: ""container:container_name_4""

version: '2.1'

services:

  service_name_5:
    image: not/a-real-image:latest
    command: [""launch""]
    ports:
      - ""8080:8080""
    pid: ""container:service_name_4""

version: '3'

services:

  service_name_3:
    image: not/a-real-image:latest
    command: [""launch""]
    ports:
      - ""8080:8080""","version: '3'

services:

  service_name_1:
    image: not/a-real-image:latest
    command: [""launch""]
    ports:
      - ""8080:8080""
    pid: ""host"" # Share Process ID Namespace

version: ""2.4""
services:
  service_name_2:
    build: ./
    restart: always
    pid: ""host""
    entrypoint: node /app/directory.js
    volumes:
      - ""./directory:/app""

version: ""3""

services:
  app:
    build: app
    ports:
      - ""0.0.0.0:80:80""

  internal:
      build: internal
      pid: ""host""","[[10], [6], [11]]"
569,610e266e-6c12-4bca-9925-1ed0cd29742b,Security Opt Not Set,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/security_opt_not_set,dockercompose-queries,"Attribute 'security_opt' should be defined.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#security_opt)","version: ""3.9""

services:
  webapp:
    build:
      context: ./
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    security_opt:
      - apparmor:unconfined","version: ""3.9""

services:
  webapp:
    build:
      context: ./
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""",[[4]]
570,698ed579-b239-4f8f-a388-baa4bcb13ef8,Healthcheck Not Set,DockerCompose,Medium,Availability,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/healthcheck_not_set,dockercompose-queries,"Check containers periodically to see if they are running properly.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#healthcheck)","version: '3.1'

services:
 lelele-service:
    build: ./
    image: lelele-service
    restart: always
    container_name: lelele
    network_mode: ""host""
    hostname: localhost
    ports:
      - 8092:8092
    healthcheck:
      test: [""CMD"", ""curl"", ""-f"", ""http://localhost""]
      interval: 1m30s
      timeout: 10s
      retries: 3
      start_period: 40s

version: '3.1'

services:
 lelele-service:
    build: ./
    image: lelele-service
    restart: always
    container_name: lelele
    network_mode: ""host""
    hostname: localhost
    ports:
      - 8092:8092
    healthcheck:
      test: [""CMD"", ""curl"", ""-f"", ""http://localhost""]","version: '2.1'

services:
 lelele-service:
    build: ./
    image: lelele-service
    restart: always
    container_name: lelele
    network_mode: ""host""
    hostname: localhost
    ports:
      - 8092:8092

version: '2.1'

services:
 lelele-service:
    build: ./
    image: lelele-service
    restart: always
    container_name: lelele
    network_mode: ""host""
    hostname: localhost
    ports:
      - 8092:8092
    healthcheck:
      disable: true

version: '2.1'

services:
 lelele-service:
    build: ./
    image: lelele-service
    restart: always
    container_name: lelele
    network_mode: ""host""
    hostname: localhost
    ports:
      - 8092:8092
    healthcheck:
      test: [""NONE""]","[[4], [14], [14]]"
571,6b610c50-99fb-4ef0-a5f3-e312fd945bc3,Cpus Not Limited,DockerCompose,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/cpus_not_limited,dockercompose-queries,"CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#resources)","version: ""3.7""
services:
  zipkin:
    image: openzipkin/zipkin
    ports:
      - 9411:9411
    deploy:
      resources:
        limits:
          cpus: '0.3'
          memory: 256M
        reservations:
          cpus: '0.1'
          memory: 128M

version: ""2.4""

services:
  # CRYPTO
  crypto_padding_oracle:
    build:
      context: ""./crypto/paddingoracle""
    restart: ""unless-stopped""
    cpus: 0.25
    mem_limit: 512m
    environment:
      - NODE_ENV=production
      - PORT=5000

      - FLAG=FLAG-TOO_MANY_ERRORS_TOO_MANY_DETAILS
    ports:
      - 11111:5000","version: ""3.7""
services:
  zapzop:
    image: openzapzop/zapzop
    ports:
      - 6412:6412
    deploy:
      resources:
        limits:
          memory: 256M
        reservations:
          cpus: '0.1'

version: ""2.4""

services:
  criwhat:
    build:
      context: ""./cri/what""
    restart: ""unless-stopped""
    mem_limit: 512m
    environment:
      - NODE_ENV=production
      - PORT=5000
      - FLAG=FLAG-TOO_MANY_ERRORS_TOO_MANY_DETAILS
    ports:
      - 12345:6000

version: ""3.7""
services:
  zapzop:
    image: openzapzop/zapzop
    ports:
      - 6412:6412
    deploy:","[[9], [4], [3, 7]]"
572,8af7162d-6c98-482f-868e-0d33fb675ca8,Shared Host User Namespace,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/shared_host_user_namespace,dockercompose-queries,"The host's user namespace should not be shared.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#userns_mode)","version: ""3.9""

services:
  webapp:
    build:
      context: ./
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    security_opt:
      - apparmor:unconfined

version: ""3.9""

services:
  webapp:
    build:
      context: ./
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    security_opt:
      - apparmor:unconfined
    userns_mode: anything_but_host","version: ""3""

services:
  service1:
    image: service1:3.4
    hostname: servicer
    network_mode: host
    pid: host
    userns_mode: host
    privileged: true",[[9]]
573,8c978947-0ff6-485c-b0c2-0bfca6026466,Shared Volumes Between Containers,DockerCompose,Info,Insecure Configurations,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/shared_volumes_between_containers,dockercompose-queries,"Volumes shared between containers can cause data corruption or can be used to share malicious files between containers.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#volumes)","version: ""3""

services:
  frontend:
    build: frontend
    ports:
      - ""8000:80""
    volumes:
        - ./logic:/app

  backend:
    build: backend
    expose:
        - 8080
    volumes:
        - ./bin:/app","version: ""3""

services:
  frontend:
    build: frontend
    ports:
      - ""8000:80""
    volumes:
        - ./logic:/app

  backend:
    build: backend
    expose:
        - 8080
    volumes:
        - ./logic:/app

version: ""3""
services:
  app:
    build: app
    ports:
      - ""0.0.0.0:80:80""
    volumes:
      - shared-volume:/app/uploads
    depends_on:
      - checker

  checker:
    build: checker
    expose:
      - 8080
    volumes:
      - shared-volume:/uploads

volumes:
  shared-volume:","[[16, 9], [8, 17]]"
574,ae5b6871-7f45-42e0-bb4c-ab300c4d2026,Privileged Containers Enabled,DockerCompose,High,Resource Management,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/privileged_containers_enabled,dockercompose-queries,"Privileged containers should be used with extreme caution, they have all of the capabilities that the linux kernel offers for docker.<br>
[Documentation](https://docs.docker.com/compose/compose-file/#privileged)","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1

version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    privileged: false","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    privileged: true

version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    privileged: true
    cap_drop:
      - all","[[10], [13]]"
575,baa3890f-bed7-46f5-ab8f-1da8fc91c729,Shared Host IPC Namespace,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/shared_host_ipc_namespace,dockercompose-queries,"Container should not share the host IPC namespace<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir)","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1

version: ""2.4""

services:
  service:
    image: busybox
    command: top
    ipc: ""service:shareable""

  container:
    image: busybox
    command: top
    ipc: ""container:composetest_ipc_mode_container""

  shareable:
    image: busybox
    command: top
    ipc: shareable","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ipc: ""host""

version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    ipc: ""host""
    cap_drop:
      - all","[[10], [13]]"
576,baa452f0-1f21-4a25-ace5-844e7a5f410d,Volume Mounted In Multiple Containers,DockerCompose,High,Build Process,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/volume_mounted_in_multiple_containers,dockercompose-queries,"Volume mounts should not be shared, which means that 'propagation' should not be set to 'shared', 'rshared', 'slave', or 'rslave'<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#volumes)","version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c5""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""
        bind:
          propagation: private

version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c6""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""
        bind:
          propagation: rprivate #this is the default value

version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c7""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""","version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c1""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""
        bind:
          propagation: rshared

version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c2""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""
        bind:
          propagation: shared

version: ""3.2""
services:
  old8k:
    image: notreal
    container_name: ""c3""
    restart: always
    expose:
      - 74746
      - 76867
    volumes:
      - type: bind
        source: $ENVVAR/.whew/path/datapath
        target: ""/data""
        bind:
          propagation: rslave","[[15], [15], [15]]"
577,bb9ac4f7-e13b-423d-a010-c74a1bfbe492,Memory Not Limited,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/memory_not_limited,dockercompose-queries,"Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#resources)","version: ""3.7""
services:
  zapzop:
    image: openzapzop/zapzop
    ports:
      - 6412:6412
    deploy:
      resources:
        limits:
          cpus: '0.3'
          memory: 256M
        reservations:
          cpus: '0.1'
          memory: 128M

version: ""2.4""

services:
  criwhat:
    build:
      context: ""./cri/what""
    restart: ""unless-stopped""
    cpus: 0.25
    mem_limit: 512m
    environment:
      - NODE_ENV=production
      - PORT=4000
      - FLAG=FLAG-TOO_MANY_ERRORS_TOO_MANY_DETAILS
    ports:
      - 12345:6000","version: ""3.7""
services:
  zapzop:
    image: openzapzop/zapzop
    ports:
      - 6412:6412
    deploy:
      resources:
        limits:
          cpus: '0.3'
        reservations:
          cpus: '0.1'

version: ""2.4""

services:
  criwhat:
    build:
      context: ""./cri/what""
    restart: ""unless-stopped""
    cpus: 0.25
    environment:
      - NODE_ENV=production
      - PORT=5000
      - FLAG=FLAG-TOO_MANY_ERRORS_TOO_MANY_DETAILS
    ports:
      - 12345:6000

version: ""3.7""
services:
  zapzop:
    image: openzapzop/zapzop
    ports:
      - 6412:6412
    deploy:","[[9], [4], [3, 7]]"
578,bc2908f3-f73c-40a9-8793-c1b7d5544f79,Privileged Ports Mapped In Container,DockerCompose,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/privileged_ports_mapped_in_container,dockercompose-queries,"Privileged ports (1 to 1023) should not be mapped. Also you should drop net_bind_service linux capability from the container unless you absolutely need to use priviledged ports.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#cap_add-cap_drop)","services:
  dhcpd:
    image: networkboot/dhcpd:latest
    container_name: dhcpd
    ports:
      - 6700:6700/udp
    cap_drop:
      - NET_BIND_SERVICE
    networks:
      - privnet
  dhcp_client:
    build: dhcp_client
    container_name: dhcp_client
    ports:
      - 6800:6800/udp

networks:
  privnet:
    ipam:
      config:
        - subnet: 192.168.0.0/24

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./webapp
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - target: 8000
        published: 8080
        protocol: tcp
        mode: host
    cap_drop:
      - CHOWN
    network_mode: ""LDC""

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./webapp
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""7000:8000""
    cap_drop:
      - NET_BIND_SERVICE
    network_mode: ""LDC""","services:
  dhcpd:
    image: networkboot/dhcpd:latest
    container_name: dhcpd
    ports:
      - 67:67/udp
    networks:
      - privnet
  dhcp_client:
    build: dhcp_client
    container_name: dhcp_client
    ports:
      - 68:68/udp

networks:
  privnet:
    ipam:
      config:
        - subnet: 192.168.0.0/24

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./webapp
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""127.0.0.1::50""
    network_mode: ""LDC""

version: '2.1'

services:
  webapp:
    container_name: webapp
    build: ./webapp
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://0.0.0.0:80
      - TradeUrl=http://trading.api
    ports:
      - ""12400-12500:124""
    network_mode: ""LDC""","[[12, 5], [11], [11]]"
579,ce76b7d0-9e77-464d-b86f-c5c48e03e22d,Container Capabilities Unrestricted,DockerCompose,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/container_capabilities_unrestricted,dockercompose-queries,"Some capabilities are not needed in certain (or any) containers. Make sure that you only add capabilities that your container needs. Drop unnecessary capabilities as well.<br>
[Documentation](https://docs.docker.com/compose/compose-file/compose-file-v3/#cap_add-cap_drop)","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    cap_drop: 
      - all","version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    cap_add: 
      - all

version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    cap_add: 
      - all
    cap_drop:
      - SYS_CHROOT

version: ""3.9""

services:
  webapp:
    build:
      context: ./dir
      dockerfile: Dockerfile-alternate
      args:
        buildno: 1
    ports:
      - ""8080:8080""
      - ""3000:3000""
    cap_add: 
      - all
    cap_drop:
      - all","[[4, 13], [13], [13]]"
580,d6355c88-1e8d-49e9-b2f2-f8a1ca12c75b,Docker Socket Mounted In Container,DockerCompose,High,Build Process,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerCompose/docker_socket_mounted_in_container,dockercompose-queries,"Docker socket docker.sock should not be mounted on host. If the docker socket is mounted, it can allow its processes to execute docker commands.<br>
[Documentation](https://docs.docker.com/compose/compose-file/#volumes)","version: ""3.1""

services:
  service1:
    container_name: service
    image: notareal/image:latest
    restart: always
    ports:
      - 8080:8080","version: ""3.1""

services:
  service1:
    container_name: service
    image: notareal/image:latest
    restart: always
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    ports:
      - 8080:8080",[[9]]
581,0008c003-79aa-42d8-95b8-1c2fe37dbfe6,"Multiple RUN, ADD, COPY, Instructions Listed",Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/multiple_run_add_copy_instructions_listed,dockerfile-queries,"Multiple commands (RUN, COPY, ADD) should be grouped in order to reduce the number of layers.<br>
[Documentation](https://sysdig.com/blog/dockerfile-best-practices/)",,,[]
582,00481784-25aa-4a55-8633-3136dfcf4f37,Yum Clean All Missing,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/yum_clean_all_missing,dockerfile-queries,"Need to use 'yum clean all' after using a 'yum install' command to clean package cached data and reduce image size<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
583,02d9c71f-3ee8-4986-9c27-1a20d0d19bfc,Unpinned Package Version in Pip Install,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/unpinned_package_version_in_pip_install,dockerfile-queries,"Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
584,22cd11f7-9c6c-4f6e-84c0-02058120b341,Gem Install Without Version,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/gem_install_without_version,dockerfile-queries,"Instead of 'gem install ' we should use 'gem install :'<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
585,295acb63-9246-4b21-b441-7c1f1fb62dc0,Missing Dnf Clean All,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_dnf_clean_all,dockerfile-queries,"Cached package data should be cleaned after installation to reduce image size<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
586,38300d1a-feb2-4a48-936a-d1ef1cd24313,Missing Zypper Clean,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_zypper_clean,dockerfile-queries,"Reduce layer and image size by deleting unneeded caches after running zypper<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
587,41c195f4-fc31-4a5c-8a1b-90605538d49f,Multiple CMD Instructions Listed,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/1041.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/multiple_cmd_instructions_listed,dockerfile-queries,"There can only be one CMD instruction in a Dockerfile. If you list more than one CMD then only the last CMD will take effect<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#cmd)",,,[]
588,45e1fca5-f90e-465d-825f-c2cb63fa3944,Missing Zypper Non-interactive Switch,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_zypper_non_interactive_switch,dockerfile-queries,"Omitting the non-interactive switch causes the command to fail during the build process, because zypper would expect manual input<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
589,4b410d24-1cbe-4430-a632-62c9a931cf1c,Curl or Wget Instead of Add,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/610.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/curl_or_wget_instead_of_add,dockerfile-queries,"Use of Curl or Wget should be done instead of Add to fetch packages from remote URLs due to the use of Add being strongly discouraged<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
590,562952e4-0348-4dea-9826-44f3a2c6117b,Zypper Install Without Version,Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/zypper_install_without_version,dockerfile-queries,"Not specifying the package version can cause failures due to unanticipated changes in required packages<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
591,5907595b-5b6d-4142-b173-dbb0e73fbff8,Exposing Port 22 (SSH),Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/exposing_port_22,dockerfile-queries,"Expose only the ports that your application needs and avoid exposing ports like SSH (22)<br>
[Documentation](https://sysdig.com/blog/dockerfile-best-practices/)",,,[]
592,6452c424-1d92-4deb-bb18-a03e95d579c4,Yum install Without Version,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/yum_install_without_version,dockerfile-queries,"Not specifying the package version can cause failures due to unanticipated changes in required packages<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
593,67fd0c4a-68cf-46d7-8c41-bc9fba7e40ae,Last User Is 'root',Dockerfile,High,Best Practices,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/last_user_is_root,dockerfile-queries,"Leaving the last user as root can cause security risks. Change to another user after running the commands that need privileges<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#user)",,,[]
594,68a51e22-ae5a-4d48-8e87-b01a323605c9,Using Unnamed Build Stages,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/using_unnamed_build_stages,dockerfile-queries,"This query is used to ensure that build stages are named. This way even if the Dockerfile is re-ordered, the COPY instruction doesn't break.<br>
[Documentation](https://docs.docker.com/develop/develop-images/multistage-build/)",,,[]
595,6938958b-3f1a-451c-909b-baeee14bdc97,Multiple ENTRYPOINT Instructions Listed,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/1041.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/multiple_entrypoint_instructions_listed,dockerfile-queries,"There can only be one ENTRYPOINT instruction in a Dockerfile. Only the last ENTRYPOINT instruction in the Dockerfile will have an effect<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#entrypoint)",,,[]
596,6b376af8-cfe8-49ab-a08d-f32de23661a4,WORKDIR Path Not Absolute,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/workdir_path_not_absolute,dockerfile-queries,"For clarity and reliability, you should always use absolute paths for your WORKDIR<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir)",,,[]
597,6db6e0c2-32a3-4a2e-93b5-72c35f4119db,Copy With More Than Two Arguments Not Ending With Slash,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/628.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/copy_with_more_than_two_arguments_not_ending_with_slash,dockerfile-queries,"When a COPY command has more than two arguments, the last one should end with a slash<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#copy)",,,[]
598,6e19193a-8753-436d-8a09-76dcff91bb03,Yum Install Allows Manual Input,Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/yum_install_allows_manual_input,dockerfile-queries,"Need to use -y to avoid manual input 'yum install -y <package>'<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
599,71bf8cf8-f0a1-42fa-b9d2-d10525e0a38e,UNIX Ports Out Of Range,Dockerfile,Info,Networking and Firewall,https://cwe.mitre.org/data/definitions/682.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/unix_ports_out_of_range,dockerfile-queries,"Exposing UNIX ports out of range from 0 to 65535<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#expose)",,,[]
600,7384dfb2-fcd1-4fbf-91cd-6c44c318c33c,APT-GET Not Avoiding Additional Packages,Dockerfile,Info,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/apt_get_not_avoiding_additional_packages,dockerfile-queries,"Check if any apt-get installs don't use '--no-install-recommends' flag to avoid installing additional packages.<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
601,77783205-c4ca-4f80-bb80-c777f267c547,APT-GET Missing Flags To Avoid Manual Input,Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/apt_get_missing_flags_to_avoid_manual_input,dockerfile-queries,"Check if apt-get calls use flags to avoid user manual input.<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
602,7ebd323c-31b7-4e5b-b26f-de5e9e477af8,Missing Flag From Dnf Install,Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_flag_from_dnf_install,dockerfile-queries,"The '-y' or '--assumeyes' flag should be added when invoking dnf install. If omitted, it can cause the command to fail during the build process, because dnf would expect manual input.<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
603,8a301064-c291-4b20-adcb-403fe7fd95fd,Changing Default Shell Using RUN Command,Dockerfile,Medium,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/changing_default_shell_using_run_command,dockerfile-queries,"Using the command RUN to override the default shell instead of the SHELL command leads to inefficiencies. It also does not make sense since Docker provides the SHELL command for this exact purpose.<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#shell)",,,[]
604,8ada6e80-0ade-439e-b176-0b28f6bce35a,Run Using Sudo,Dockerfile,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/440.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/run_using_sudo,dockerfile-queries,"Avoid RUN with sudo command as it leads to unpredictable behavior<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
605,93d88cf7-f078-46a8-8ddc-178e03aeacf1,Missing Version Specification In dnf install,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_version_specification_in_dnf_install,dockerfile-queries,"Specifying a package version allows to reduce failures due to unanticipated changes in required packages.<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
606,9513a694-aa0d-41d8-be61-3271e056f36b,Add Instead of Copy,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/610.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/add_instead_of_copy,dockerfile-queries,"Using ADD to load external installation scripts could lead to an evil web server leveraging this and loading a malicious script.<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#add)",,,[]
607,965a08d7-ef86-4f14-8792-4a3b2098937e,Apt Get Install Pin Version Not Defined,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/apt_get_install_pin_version_not_defined,dockerfile-queries,"When installing a package, its pin version should be defined<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
608,99614418-f82b-4852-a9ae-5051402b741c,MAINTAINER Instruction Being Used,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/maintainer_instruction_being_used,dockerfile-queries,"The MAINTAINER instruction sets the Author field of the generated images. The LABEL instruction is a much more flexible version of this and you should use it instead, as it enables setting any metadata you require, and can be viewed easily<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#maintainer-deprecated)",,,[]
609,9b6b0f38-92a2-41f9-b881-3a1083d99f1b,Run Utilities And POSIX Commands,Dockerfile,Info,Supply-Chain,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/run_utilities_and_posix_commands,dockerfile-queries,"Some POSIX commands and interactive utilities shouldn't run inside a Docker Container<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
610,9bae49be-0aa3-4de5-bab2-4c3a069e40cd,Update Instruction Alone,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/update_instruction_alone,dockerfile-queries,"Instruction 'RUN update' should always be followed by ' install' in the same RUN statement<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
611,9efb0b2d-89c9-41a3-91ca-dcc0aec911fd,Image Version Not Explicit,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/image_version_not_explicit,dockerfile-queries,"Always tag the version of an image explicitly<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#from)",,,[]
612,aa93e17f-b6db-4162-9334-c70334e7ac28,Chown Flag Exists,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/282.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/chown_flag_exists,dockerfile-queries,"It is considered a best practice for every executable in a container to be owned by the root user even if it is executed by a non-root user, only execution permissions are required on the file, not ownership<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
613,ae9c56a6-3ed1-4ac0-9b54-31267f51151d,Apk Add Using Local Cache Path,Dockerfile,Info,Supply-Chain,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/apk_add_using_local_cache_path,dockerfile-queries,"When installing packages, use the '--no-cache' switch to avoid the need to use '--update' and remove '/var/cache/apk/*'<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
614,b03a748a-542d-44f4-bb86-9199ab4fd2d5,Healthcheck Instruction Missing,Dockerfile,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/healthcheck_instruction_missing,dockerfile-queries,"Ensure that HEALTHCHECK is being used. The HEALTHCHECK instruction tells Docker how to test a container to check that it is still working<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#healthcheck)",,,[]
615,b16e8501-ef3c-44e1-a543-a093238099c9,Using Platform Flag with FROM Command,Dockerfile,Info,Best Practices,https://cwe.mitre.org/data/definitions/695.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/using_platform_with_from,dockerfile-queries,"'FROM' instruction should not use the flag '--platform'<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#from)",,,[]
616,b84a0b47-2e99-4c9f-8933-98bcabe2b94d,Run Using apt,Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/758.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/run_using_apt,dockerfile-queries,"apt is discouraged by the linux distributions as an unattended tool as its interface may suffer changes between versions. Better use the more stable apt-get and apt-cache<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
617,b86987e1-6397-4619-81d5-8807f2387c79,Not Using JSON In CMD And ENTRYPOINT Arguments,Dockerfile,Medium,Build Process,https://cwe.mitre.org/data/definitions/573.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/not_using_json_in_cmd_and_entrypoint_arguments,dockerfile-queries,"Ensure that we are using JSON in the CMD and ENTRYPOINT Arguments<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#entrypoint)",,,[]
618,cdddb86f-95f6-4fc4-b5a1-483d9afceb2b,COPY '--from' References Current FROM Alias,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/706.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/copy_from_references_current_from_alias,dockerfile-queries,"COPY '--from' should not mention the current FROM alias, since it is impossible to copy from itself<br>
[Documentation](https://docs.docker.com/develop/develop-images/multistage-build/)",,,[]
619,d3499f6d-1651-41bb-a9a7-de925fea487b,Unpinned Package Version in Apk Add,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/unpinned_package_version_in_apk_add,dockerfile-queries,"Package version pinning reduces the range of versions that can be installed, reducing the chances of failure due to unanticipated changes<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
620,df746b39-6564-4fed-bf85-e9c44382303c,Apt Get Install Lists Were Not Deleted,Dockerfile,Info,Supply-Chain,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/apt_get_install_lists_were_not_deleted,dockerfile-queries,"After using apt-get install, it is needed to delete apt-get lists<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
621,e36d8880-3f78-4546-b9a1-12f0745ca0d5,NPM Install Command Without Pinned Version,Dockerfile,Medium,Supply-Chain,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/npm_install_without_pinned_version,dockerfile-queries,"Check if packages installed by npm are pinning a specific version.<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
622,efbf148a-67e9-42d2-ac47-02fa1c0d0b22,Shell Running A Pipe Without Pipefail Flag,Dockerfile,Low,Insecure Defaults,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/shell_running_a_pipe_without_pipefail_flag,dockerfile-queries,"Check if shell commands with pipes (except Powershell) have the pipefail flag set (-o).<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#run)",,,[]
623,f2daed12-c802-49cd-afed-fe41d0b82fed,Same Alias In Different Froms,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/694.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/same_alias_in_different_froms,dockerfile-queries,"Different FROMS cant have the same alias defined<br>
[Documentation](https://docs.docker.com/develop/develop-images/multistage-build/)",,,[]
624,f2f903fb-b977-461e-98d7-b3e2185c6118,Pip install Keeping Cached Packages,Dockerfile,Low,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/pip_install_keeping_cached_packages,dockerfile-queries,"When installing packages with pip, the '--no-cache-dir' flag should be set to make Docker images smaller<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)",,,[]
625,f45ea400-6bbe-4501-9fc7-1c3d75c32067,Image Version Using 'latest',Dockerfile,Medium,Best Practices,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/image_version_using_latest,dockerfile-queries,"When building images, always tag them with useful tags which codify version information, intended destination (prod or test, for instance), stability, or other information that is useful when deploying the application in different environments. Do not rely on the automatically-created latest tag<br>
[Documentation](https://docs.docker.com/develop/dev-best-practices/)",,,[]
626,f4a6bcd3-e231-4acf-993c-aa027be50d2e,RUN Instruction Using 'cd' Instead of WORKDIR,Dockerfile,Low,Build Process,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/run_command_cd_instead_of_workdir,dockerfile-queries,"When using RUN command 'cd' should only be used for full path. For relative path make use of WORKDIR command instead.<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#workdir)",,,[]
627,fc775e75-fcfb-4c98-b2f2-910c5858b359,Run Using 'wget' and 'curl',Dockerfile,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/1041.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/run_using_wget_and_curl,dockerfile-queries,"Shouldn't use both 'wget' and 'curl' since they are two tools that have the same effect<br>
[Documentation](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run)",,,[]
628,fd54f200-402c-4333-a5a4-36ef6709af2f,Missing User Instruction,Dockerfile,High,Build Process,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/dockerfile/missing_user_instruction,dockerfile-queries,"A user should be specified in the dockerfile, otherwise the image will run as root<br>
[Documentation](https://docs.docker.com/engine/reference/builder/#user)",,,[]
629,1239f54b-33de-482a-8132-faebe288e6a6,Google Storage Bucket Level Access Disabled,GoogleDeploymentManager,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/google_storage_bucket_level_access_disabled,Unknown,"Google Storage Bucket Level Access should be enabled<br>
[Documentation](https://cloud.google.com/storage/docs/json_api/v1/buckets)","resources:
- name: a-new-pubsub-topic2
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    versioning:
      enabled: true
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true","resources:
- name: a-new-pubsub-topic1
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    versioning:
      enabled: true
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: false",[[11]]
630,227c2f58-70c6-4432-8e9a-a89c1a548cf5,Bucket Without Versioning,GoogleDeploymentManager,Medium,Observability,https://cwe.mitre.org/data/definitions/280.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/bucket_without_versioning,Unknown,"Bucket should have versioning enabled<br>
[Documentation](https://cloud.google.com/storage/docs/json_api/v1/buckets)","resources:
  - name: bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket
      versioning:
        enabled: true","resources:
  - name: bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket

resources:
  - name: bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket
      versioning:
        enabled: false","[[4], [7]]"
631,268c65a8-58ad-43e4-9019-1a9bbc56749f,BOM - GCP PD,GoogleDeploymentManager,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp_bom/pd,Unknown,"A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine.<br>
[Documentation](https://kics.io)","resources:
- name: vm-template4
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
    networkInterfaces:
    - network: global/networks/default","resources:
- type: compute.v1.disk
  name: disk-1-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
- type: compute.v1.disk
  name: disk-2-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      kmsKeyName: disk-crypto-key
- type: compute.v1.disk
  name: disk-3-data
  properties:
    sizeGb: 10
    zone: us-east1-c
- type: compute.v1.disk
  name: disk-4-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
- type: compute.v1.disk
  name: disk-5-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      rawKey: """"","[[3, 11, 19, 24, 31]]"
632,28727987-e398-49b8-aef1-8a3e7789d111,IP Aliasing Disabled,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/ip_aliasing_disabled,Unknown,"Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribute 'ipAllocationPolicy' must be defined and the subattribute 'useIpAliases' must be set to 'true'.<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.locations.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      ipAllocationPolicy:
        subnetworkName: my-network
        useIpAliases: true","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      ipAllocationPolicy:
        subnetworkName: my-network

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      ipAllocationPolicy:
        subnetworkName: my-network
        useIpAliases: false","[[4], [6], [8]]"
633,313d6deb-3b67-4948-b41d-35b699c2492e,Cloud DNS Without DNSSEC,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/353.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cloud_dns_without_dnnsec,Unknown,"DNSSEC must be enabled for Cloud DNS<br>
[Documentation](https://cloud.google.com/dns/docs/reference/v1/managedZones)","resources:
- name: dns4
  type: dns.v1.managedZone
  properties:
    name: my-zone4
    dnssecConfig:
      state: ""on""","resources:
- name: dns
  type: dns.v1.managedZone
  properties:
    name: my-zone

resources:
- name: dns2
  type: dns.v1.managedZone
  properties:
    name: my-zone2
    dnssecConfig:
      kind: ""dns#managedZoneDnsSecConfig""

resources:
- name: dns3
  type: dns.v1.managedZone
  properties:
    name: my-zone3
    dnssecConfig:
      state: ""off""","[[4], [6], [7]]"
634,48c61fbd-09c9-46cc-a521-012e0c325412,Private Cluster Disabled,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/private_cluster_disabled,Unknown,"Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'privateClusterConfig' must be defined and the attributes 'enablePrivateEndpoint' and 'enablePrivateNodes' must be true.<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
- name: mycluster3
  type: container.v1.cluster
  properties:
    zone: us-east1-b
    privateClusterConfig:
      enablePrivateEndpoint: true
      enablePrivateNodes: true","resources:
- name: mycluster
  type: container.v1.cluster
  properties:
    zone: us-east1-b

resources:
- name: mycluster2
  type: container.v1.cluster
  properties:
    zone: us-east1-b
    privateClusterConfig:
      enablePrivateEndpoint: false","[[4], [6, 7]]"
635,50cb6c3b-c878-4b88-b50e-d1421bada9e8,RDP Access Is Not Restricted,GoogleDeploymentManager,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/rdp_access_is_not_restricted,Unknown,"Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/firewalls)","resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""","resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""0.0.0.0/0""
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
        - IPProtocol: tcp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
            - ""3389""

resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""::/0""
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
        - IPProtocol: udp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
            - ""21-3389""

resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""::/0""
      allowed:
        - IPProtocol: all","[[14], [14], [9]]"
636,62c8cf50-87f0-4295-a974-8184ed78fe02,GKE Master Authorized Networks Disabled,GoogleDeploymentManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/gke_master_authorized_networks_disabled,Unknown,"Master authorized networks must be enabled in GKE clusters<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster
      masterAuthorizedNetworksConfig:
        enabled: true","resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster

resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster
      masterAuthorizedNetworksConfig:
        enabled: false","[[4], [7]]"
637,63ae3638-a38c-4ff4-b616-6e1f72a31a6a,Cloud Storage Anonymous or Publicly Accessible,GoogleDeploymentManager,Critical,Access Control,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cloud_storage_anonymous_or_publicly_accessible,Unknown,"Cloud Storage Buckets must not be anonymously or publicly accessible, which means the subattribute 'entity' from attributes 'acl' and 'defaultObjectAcl' must not be 'allUsers' or 'allAuthenticatedUsers'<br>
[Documentation](https://cloud.google.com/storage/docs/json_api/v1/buckets)","resources:
  - name: storage-bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket
      acl:
        - entity: user-liz@example.com
      defaultObjectAcl:
        - entity: user-liz@example.com","resources:
  - name: storage-bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket

resources:
  - name: storage-bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket
      defaultObjectAcl:
        - entity: allAuthenticatedUsers

resources:
  - name: storage-bucket
    type: storage.v1.bucket
    properties:
      name: my-bucket
      acl:
        - entity: allUsers
        - entity: user-liz@example.com
      defaultObjectAcl:
        - entity: allAuthenticatedUsers
        - entity: user-liz@example.com","[[4], [4, 7], [10, 7]]"
638,660360d3-9ca7-46d1-b147-3acc4002953f,SQL DB Instance With SSL Disabled,GoogleDeploymentManager,High,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/sql_db_instance_with_ssl_disabled,Unknown,"Cloud SQL Database Instance should have SSL enabled<br>
[Documentation](https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/instances)","resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        ipConfiguration:
          requireSsl: true","resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840

resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        ipConfiguration:
          ipv4Enabled: true

resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        ipConfiguration:
          ipv4Enabled: true
          requireSsl: false","[[5], [7], [9]]"
639,6d7b121a-a2ed-4e37-bd2f-80d9df1dfd35,DNSSEC Using RSASHA1,GoogleDeploymentManager,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/dnssec_using_rsasha1,Unknown,"DNSSEC should not use the RSASHA1 algorithm<br>
[Documentation](https://cloud.google.com/dns/docs/reference/v1/managedZones)","resources:
- name: dns2
  type: dns.v1.managedZone
  properties:
    name: my-zone2
    dnssecConfig:
      state: ""on""
      defaultKeySpecs:
        - algorithm: rsasha256","resources:
- name: dns
  type: dns.v1.managedZone
  properties:
    name: my-zone
    dnssecConfig:
      state: ""on""
      defaultKeySpecs:
        - algorithm: rsasha1",[[9]]
640,6e2b1ec1-1eca-4eb7-9d4d-2882680b4811,Project-wide SSH Keys Are Enabled In VM Instances,GoogleDeploymentManager,Medium,Secret Management,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/project_wide_ssh_keys_are_enabled_in_vm_instances,Unknown,"VM Instance should block project-wide SSH keys<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: my-key
            value: true
          - key: block-project-ssh-keys
            value: true","resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm

resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: my-key
            value: true
          - key: my-key-2
            value: false

resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: my-key
            value: true
          - key: block-project-ssh-keys
            value: false","[[4], [8], [12]]"
641,77c1fa3f-83dc-4c9d-bfed-e1d0cc8fd9dc,Cloud Storage Bucket Is Publicly Accessible,GoogleDeploymentManager,Medium,Access Control,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cloud_storage_bucket_is_publicly_accessible,Unknown,"Cloud Storage Bucket is anonymously or publicly accessible<br>
[Documentation](https://cloud.google.com/storage/docs/json_api/v1/bucketAccessControls)","resources:
  - name: bucket-access-control
    type: storage.v1.bucketAccessControl
    properties:
      storageClass: STANDARD
      location: EUROPE-WEST3

resources:
  - name: bucket-access-control
    type: storage.v1.bucketAccessControl
    properties:
      storageClass: STANDARD
      location: EUROPE-WEST3
      entity: user-liz@example.com","resources:
  - name: bucket-access-control
    type: storage.v1.bucketAccessControl
    properties:
      entity: allUsers

resources:
  - name: bucket-access-control
    type: storage.v1.bucketAccessControl
    properties:
      entity: allAuthenticatedUsers","[[5], [5]]"
642,7c98538a-81c6-444b-bf04-e60bc3ceeec0,IP Forwarding Enabled,GoogleDeploymentManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/ip_forwarding_enabled,Unknown,"Instances must not have IP forwarding enabled, which means the attribute 'canIpForward' must not be true<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
- name: vm-template2
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
    canIpForward: false","resources:
- name: vm-template
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
    canIpForward: true",[[16]]
643,7ef7d141-9fbb-4679-a977-fd0883436906,Cluster Master Authentication Disabled,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cluster_master_authentication_disabled,Unknown,"Kubernetes Engine Clusters must have Master Authentication set to enabled, which means the attribute 'masterAuth' must have the subattributes 'username' and 'password' defined and not empty<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.locations.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      masterAuth:
        username: test
        password: test","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      masterAuth:
        clientKey: test

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      masterAuth:
        username:
        password:","[[4], [5], [5]]"
644,8212e2d7-e683-49bc-bf78-d6799075c5a7,Compute Instance Is Publicly Accessible,GoogleDeploymentManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/compute_instance_is_publicly_accessible,Unknown,"Compute instances shouldn't be accessible from the Internet.<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
- name: instance2
  type: compute.v1.instance
  properties:
    scheduling:
      automaticRestart: true
    networkInterfaces:
      network: network","resources:
- name: instance
  type: compute.v1.instance
  properties:
    scheduling:
      automaticRestart: true
    networkInterfaces:
      - accessConfigs:
        - name: External NAT
          type: ONE_TO_ONE_NAT
        network: network",[[8]]
645,83103dff-d57f-42a8-bd81-40abab64c1a7,BigQuery Dataset Is Public,GoogleDeploymentManager,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/bigquery_database_is_public,Unknown,"BigQuery dataset is anonymously or publicly accessible. Attribute access.specialGroup should not contain 'allAuthenticatedUsers'<br>
[Documentation](https://cloud.google.com/bigquery/docs/reference/rest/v2/datasets)","resources:
  - name: bigquery
    type: bigquery.v2.dataset
    properties:
      access:
        - role: owner
          specialGroup: my-group

resources:
  - name: bigquery
    type: bigquery.v2.dataset
    properties:
      description: my-bigquery","resources:
  - name: bigquery
    type: bigquery.v2.dataset
    properties:
      access:
        - role: owner
          specialGroup: allAuthenticatedUsers
        - role: owner
          specialGroup: my-group",[[7]]
646,8810968b-4b15-421d-918b-d91eb4bb8d1d,Cluster Labels Disabled,GoogleDeploymentManager,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cluster_labels_disabled,Unknown,"Kubernetes Clusters must be configured with labels, which means the attribute 'resourceLabels' must be defined<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      resourceLabels:
        name: ""wrench""","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster",[[4]]
647,9038b526-4c19-4928-bca2-c03d503bdb79,Shielded VM Disabled,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/shielded_vm_disabled,Unknown,"Compute instances must be launched with Shielded VM enabled, which means the attribute 'shieldedInstanceConfig' must be defined and its sub attributes 'enableSecureBoot', 'enableVtpm' and 'enableIntegrityMonitoring' must be set to true<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
- name: vm-templatee
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
    canIpForward: false
    shieldedInstanceConfig:
      enableSecureBoot: true
      enableVtpm: true
      enableIntegrityMonitoring: true","resources:
- name: vm-template
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
    canIpForward: false

resources:
- name: vm-template2
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
    canIpForward: false
    shieldedInstanceConfig:
      enableSecureBoot: false","[[4], [17, 18]]"
648,95601b9a-7fe8-4aee-9b58-d36fd9382dfc,Stackdriver Logging Disabled,GoogleDeploymentManager,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/stackdriver_logging_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'loggingService' must be defined and different from 'none'<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      loggingService: ""logging.googleapis.com""","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      loggingService: none","[[4], [6]]"
649,9ed08714-b2f3-4c6d-8fb0-ac0b74ad71d8,BOM - GCP PST,GoogleDeploymentManager,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp_bom/pst,Unknown,"A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages.<br>
[Documentation](https://kics.io)","resources:
- name: vm-template4
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
    networkInterfaces:
    - network: global/networks/default","resources:
- type: pubsub.v1.topic
  name: topic-1
  properties:
    kmsKeyName: some key
    topic: classified-topic
- type: pubsub.v1.topic
  name: topic-2
  properties:
    topic: classified-topic","[[8, 3]]"
650,a21b8df3-c840-4b3d-a41a-10fb2afda171,Not Proper Email Account In Use,GoogleDeploymentManager,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/not_proper_email_account_in_use,Unknown,"Gmail accounts are being used instead of corporate credentials<br>
[Documentation](https://cloud.google.com/deployment-manager/docs/configuration/set-access-control-resources)","resources:
- name: a-new-pubsub-topic
  type: pubsub.v1.topic

  accessControl:
    gcpIamPolicy:
      bindings:
      - role: roles/pubsub.publisher
        members:
        - ""user:jane@example.com""
        - ""serviceAccount:my-other-app@appspot.gserviceaccount.com""","resources:
- name: a-new-pubsub-topic
  type: pubsub.v1.topic

  accessControl:
    gcpIamPolicy:
      bindings:
      - role: roles/pubsub.publisher
        members:
        - ""user:jane@gmail.com""
        - ""serviceAccount:my-other-app@appspot.gserviceaccount.com""",[[9]]
651,a5bf1a1c-92c7-401c-b4c6-ebdc8b686c01,SQL DB Instance Backup Disabled,GoogleDeploymentManager,Medium,Backup,https://cwe.mitre.org/data/definitions/497.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/sql_db_instance_backup_disabled,Unknown,"Checks if backup configuration is enabled for all Cloud SQL Database instances<br>
[Documentation](https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/instances)","resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        backupConfiguration:
          enabled: true","resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840

resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        backupConfiguration:
          binaryLogEnabled: true

resources:
  - name: sql-instance
    type: sqladmin.v1beta4.instance
    properties:
      settings:
        tier: db-custom-1-3840
        backupConfiguration:
          enabled: false","[[5], [7], [8]]"
652,ad0875c1-0b39-4890-9149-173158ba3bba,Cloud Storage Bucket Versioning Disabled,GoogleDeploymentManager,Medium,Observability,https://cwe.mitre.org/data/definitions/1357.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cloud_storage_bucket_versioning_disabled,Unknown,"Cloud Storage Bucket should have versioning enabled<br>
[Documentation](https://cloud.google.com/storage/docs/json_api/v1/buckets)","resources:
- name: a-new-pubsub-topic3
  type: storage.v1.bucket
  properties:
      storageClass: STANDARD
      location: EUROPE-WEST3
      versioning:
        enabled: true","resources:
- name: a-new-pubsub-topic
  type: storage.v1.bucket
  properties:
      storageClass: STANDARD
      location: EUROPE-WEST3

resources:
- name: a-new-pubsub-topic2
  type: storage.v1.bucket
  properties:
      storageClass: STANDARD
      location: EUROPE-WEST3
      versioning:
        enabled: false","[[4], [8]]"
653,bbfc97ab-e92a-4a7b-954c-e88cec815011,Stackdriver Monitoring Disabled,GoogleDeploymentManager,Medium,Observability,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/stackdriver_monitoring_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoringService' must be defined and different than 'none'<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster
      monitoringService: ""monitoring.googleapis.com/kubernetes""","resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster

resources:
  - name: my-cluster
    type: container.v1.cluster
    properties:
      description: cluster
      monitoringService: ""none""","[[4], [6]]"
654,c47f90e8-4a19-43f0-8413-cc434d286c4e,Network Policy Disabled,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/network_policy_disabled,Unknown,"Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'networkPolicy.enabled' must be true and the attribute 'addonsConfig.networkPolicyConfig.disabled' must be false<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      networkPolicy:
        enabled: true
      addonsConfig:
        networkPolicyConfig:
          disabled: false","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      networkPolicy:
        enabled: false

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      addonsConfig:
        networkPolicyConfig:
          disabled: true","[[4], [4, 7], [8, 4]]"
655,c759d6f2-4dd3-4160-82d3-89202ef10d87,MySQL Instance With Local Infile On,GoogleDeploymentManager,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/119.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/mysql_instance_with_local_infile_on,Unknown,"MySQL Instance should not have Local Infile On<br>
[Documentation](https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/instances)","resources:
  - name: db-instance
    type: sqladmin.v1beta4.instance
    properties:
      databaseVersion: MYSQL_5_7
      settings:
        databaseFlags:
          - name: local_infile
            value: off

resources:
  - name: db-instance
    type: sqladmin.v1beta4.instance
    properties:
      databaseVersion: MYSQL_5_7
      settings:
        databaseFlags:
          - name: log_queries_not_using_indexes
            value: on","resources:
  - name: db-instance
    type: sqladmin.v1beta4.instance
    properties:
      databaseVersion: MYSQL_5_7
      settings:
        databaseFlags:
          - name: local_infile
            value: on",[[8]]
656,c7781feb-a955-4f9f-b9cf-0d7c6f54bb59,BOM - GCP SB,GoogleDeploymentManager,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp_bom/sb,Unknown,"A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket.<br>
[Documentation](https://kics.io)","resources:
- name: vm-template4
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
    networkInterfaces:
    - network: global/networks/default","resources:
- name: sample-input
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true
    encryption:
      defaultKmsKeyName: some-key
- name: sample-input2
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true
- name: sample-input3
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true
    acl:
    - entity: ""project-viewers-ucg-configuration-project""
      role: READER
    - entity: allUsers
      role: READER
- name: sample-input4
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true
    defaultObjectAcl:
    - entity: allUsers
      role: READER
- name: sample-input5
  type: storage.v1.bucket
  properties:
    storageClass: STANDARD
    location: EUROPE-WEST3
    iamConfiguration:
      uniformBucketLevelAccess:
        enabled: true
- name: sample-ac
  type: storage.v1.bucketAccessControl
  properties:
    bucket: sample-input5
    entity: allUsers
    role: OWNER","[[33, 2, 12, 44, 20]]"
657,dbe058d7-b82e-430b-8426-992b2e4677e7,COS Node Image Not Used,GoogleDeploymentManager,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/cos_node_image_not_used,Unknown,"The node image should be Container-Optimized OS(COS)<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters.nodePools)","resources:
  - name: nodePool
    type: container.v1.nodePool
    properties:
      name: my-node
      config:
        imageType: cos

resources:
  - name: nodePool
    type: container.v1.nodePool
    properties:
      name: my-node
      config:
        imageType: cos_containerd

resources:
  - name: nodePool
    type: container.v1.nodePool
    properties:
      name: my-node","resources:
  - name: nodePool
    type: container.v1.nodePool
    properties:
      name: my-node
      config:
        imageType: ubuntu",[[7]]
658,dc5c5fee-6c53-43b0-ab11-4c660e064aaf,Node Auto Upgrade Disabled,GoogleDeploymentManager,Medium,Resource Management,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/node_auto_upgrade_disabled,Unknown,"Kubernetes nodes must have auto upgrades set to true, which means the attribute 'nodePools' must be defined and the subattribute 'managment' must be defined and have the attribute 'autoUpgrade' set to true<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      nodePools:
        initialNodeCount: 2
        management:
          autoUpgrade: true","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      nodePools:
        initialNodeCount: 2

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      nodePools:
        initialNodeCount: 2
        management:
          autoRepair: true","[[4], [6], [8]]"
659,dd690686-2bf9-4012-a821-f61912dd77be,Client Certificate Disabled,GoogleDeploymentManager,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/client_certificate_disabled,Unknown,"Kubernetes Clusters must be created with Client Certificate enabled, which means 'masterAuth' must have 'clientCertificateConfig' with the attribute 'issueClientCertificate' equal to true<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.zones.clusters)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      masterAuth:
        clientCertificateConfig:
          issueClientCertificate: true","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      masterAuth:
        clientKey: key

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      name: my-cluster
      masterAuth:
        clientCertificateConfig:
          issueClientCertificate: false","[[4], [6], [8]]"
660,dee21308-2a7a-49de-8ff7-c9b87e188575,SSH Access Is Not Restricted,GoogleDeploymentManager,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/ssh_access_is_not_restricted,Unknown,"Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/firewalls)","resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""","resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""0.0.0.0/0""
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
            - ""22""

resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""0.0.0.0/0""
      allowed:
        - IPProtocol: icmp
          ports:
            - ""80""
            - ""8080""
            - ""1000-2000""
            - ""21-3390""

resources:
  - name: firewall
    type: compute.v1.firewall
    properties:
      name: my-firewall
      sourceRanges:
        - ""0.0.0.0/0""
      allowed:
        - IPProtocol: all","[[10], [10], [4]]"
661,df58d46c-783b-43e0-bdd0-d99164f712ee,GKE Legacy Authorization Enabled,GoogleDeploymentManager,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/gke_legacy_authorization_enabled,Unknown,"Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'legacyAbac.enabled' must be false.<br>
[Documentation](https://cloud.google.com/kubernetes-engine/docs/reference/rest/v1/projects.locations.clusters#Cluster.LegacyAbac)","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster

resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      legacyAbac:
        enabled: false","resources:
  - name: cluster
    type: container.v1.cluster
    properties:
      description: my-cluster
      legacyAbac:
        enabled: true",[[7]]
662,e66e1b71-c810-4b4e-a737-0ab59e7f5e41,OSLogin Is Disabled In VM Instance,GoogleDeploymentManager,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/os_login_is_disabled_for_vm_instance,Unknown,"VM instance should have OSLogin enabled<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: my-key-2
            value: false

resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: enable-oslogin
            value: true
          - key: my-key-2
            value: false","resources:
  - name: vm
    type: compute.v1.instance
    properties:
      description: my-vm
      metadata:
        fingerprint: fingerprint
        items:
          - key: enable-oslogin
            value: false
          - key: my-key-2
            value: false",[[10]]
663,fc040fb6-4c23-4c0d-b12a-39edac35debb,Disk Encryption Disabled,GoogleDeploymentManager,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/googleDeploymentManager/gcp/disk_encryption_disabled,Unknown,"VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'diskEncryptionKey' must be defined and its sub attributes 'rawKey' or 'kmsKeyName' must also be defined<br>
[Documentation](https://cloud.google.com/compute/docs/reference/rest/v1/instances)","resources:
- name: vm-template4
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=
    networkInterfaces:
    - network: global/networks/default
- type: compute.v1.disk
  name: disk-1-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      rawKey: SGVsbG8gZnJvbSBHb29nbGUgQ2xvdWQgUGxhdGZvcm0=

resources:
- name: vm-template5
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        kmsKeyName: disk-crypto-key
    networkInterfaces:
    - network: global/networks/default
- type: compute.v1.disk
  name: disk-2-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      kmsKeyName: disk-crypto-key","resources:
- name: vm-template
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
    networkInterfaces:
    - network: global/networks/default
- type: compute.v1.disk
  name: disk-3-data
  properties:
    sizeGb: 10
    zone: us-east1-c

resources:
- name: vm-template2
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
    networkInterfaces:
    - network: global/networks/default
- type: compute.v1.disk
  name: disk-4-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29

resources:
- name: vm-template3
  type: compute.v1.instance
  properties:
    zone: us-central1-a
    machineType: zones/us-central1-a/machineTypes/n1-standard-1
    disks:
    - deviceName: boot
      type: PERSISTENT
      boot: true
      autoDelete: true
      initializeParams:
        sourceImage: projects/debian-cloud/global/images/family/debian-9
      diskEncryptionKey:
        sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
        rawKey: """"
    networkInterfaces:
    - network: global/networks/default
- type: compute.v1.disk
  name: disk-5-data
  properties:
    sizeGb: 10
    zone: us-east1-c
    diskEncryptionKey:
      sha_256: 68b4caecf5d5130426a8b8f0222cdd7f31232b5c99a5bf0daf19099e26e2ec29
      rawKey: """"","[[8, 18], [14, 23], [16, 26]]"
664,daaace5f-c0dc-4835-b526-7a116b7f4b4e,Enum Name Not CamelCase,GRPC,Info,Best Practices,https://cwe.mitre.org/data/definitions/1099.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/grpc/enum_name_not_camel_case,grpc-queries,"All Enum Names should follow CamelCase and start with Capital Letter<br>
[Documentation](https://developers.google.com/protocol-buffers/docs/reference/proto3-spec#enum_definition)",,,[]
665,e8bb41e4-2f24-4e84-8bea-8c7c070cf93d,Serving Revision Spec Without Timeout Seconds,Knative,Info,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/knative/serving_revision_spec_without_timeout_settings,knative-queries,"Serving Revision Spec should have Timeout Seconds defined to avoid Denial of Service<br>
[Documentation](https://knative.dev/docs/reference/api/serving-api/#serving.knative.dev/v1.RevisionSpec)","apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          securityContext:
            allowPrivilegeEscalation: false
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""
            limits:
              memory: ""128Mi""
              cpu: ""500m""
      containerConcurrency: 100
      timeoutSeconds: 600","apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          securityContext:
            allowPrivilegeEscalation: false
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""
            limits:
              memory: ""128Mi""
              cpu: ""500m""
      containerConcurrency: 100
---
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          securityContext:
            allowPrivilegeEscalation: false
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""
            limits:
              memory: ""128Mi""
              cpu: ""500m""
      containerConcurrency: 100
      timeoutSeconds: 0","[[42, 7]]"
666,02323c00-cdc3-4fdc-a310-4f2b3e7a1660,Container Running With Low UID,Kubernetes,Medium,Best Practices,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/containers_run_with_low_uid,kubernetes-queries,"Check if containers are running with low UID, which might cause conflicts with the host's user table.<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 10000
  containers:
    - name: sec-ctx-demo-2
      image: gcr.io/google-samples/node-hello:1.0
      securityContext:
        runAsUser: 10100
        allowPrivilegeEscalation: false

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 65532
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            readOnlyRootFilesystem: true
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 19000
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            runAsUser: 12000
            readOnlyRootFilesystem: true
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080
          securityContext:
            readOnlyRootFilesystem: true","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: sec-ctx-demo-2
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 2000
      allowPrivilegeEscalation: false

apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 10
    runAsNonRoot: false
  containers:
    - name: sec-ctx-demo-100
      image: gcr.io/google-samples/node-hello:1.0
      securityContext:
        runAsUser: 333
        runAsNonRoot: false
    - name: sec-ctx-demo-200
      image: gcr.io/google-samples/node-hedwfwllo:1.0
      securityContext:
        runAsUser: 340
        runAsNonRoot: false

apiVersion: v1
kind: Pod
metadata:
  name: containers-runs-as-root
spec:
  securityContext:
    runAsNonRoot: false
  containers:
    - name: sec-ctx-demo-100
      image: gcr.io/google-samples/node-hello:1.0
      securityContext:
        runAsUser: 13
        runAsNonRoot: false","[[12], [18, 13], [12]]"
667,03aabc8c-35d6-481e-9c85-20139cf72d23,CNI Plugin Does Not Support Network Policies,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/923.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cni_plugin_does_not_support_network_policies,kubernetes-queries,"Ensure the use of CNI Plugin that support Network Policies. If the CNI Plugin in use does not support Network Policies it may not be possible to effectively restrict traffic in the cluster<br>
[Documentation](https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/)","kind: ConfigMap
apiVersion: v1
metadata:
  name: kube-flannel-cfg
  namespace: kube-system
  labels:
    tier: node
    app: calico
data:
  cni-conf.json: |
    {
      ""name"": ""cbr0"",
      ""plugins"": [
        {
          ""type"": ""calico"",
          ""delegate"": {
            ""hairpinMode"": true,
            ""isDefaultGateway"": true
          }
        },
        {
          ""type"": ""portmap"",
          ""capabilities"": {
            ""portMappings"": true
          }
        }
      ]
    }
  net-conf.json: |
    {
      ""Network"": ""10.244.0.0/16"",
      ""Backend"": {
        ""Type"": ""vxlan""
      }
    }","kind: ConfigMap
apiVersion: v1
metadata:
  name: kube-flannel-cfg
  namespace: kube-system
  labels:
    tier: node
    app: flannel
data:
  cni-conf.json: |
    {
      ""name"": ""cbr0"",
      ""plugins"": [
        {
          ""type"": ""flannel"",
          ""delegate"": {
            ""hairpinMode"": true,
            ""isDefaultGateway"": true
          }
        },
        {
          ""type"": ""portmap"",
          ""capabilities"": {
            ""portMappings"": true
          }
        }
      ]
    }
  net-conf.json: |
    {
      ""Network"": ""10.244.0.0/16"",
      ""Backend"": {
        ""Type"": ""vxlan""
      }
    }",[[10]]
668,0401f71b-9c1e-4821-ab15-a955caa621be,Pod Misconfigured Network Policy,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/pod_misconfigured_network_policy,kubernetes-queries,"Check if any pod is not being targeted by a proper network policy.<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/network-policies/)","apiVersion: v1
kind: Pod
metadata:
  name: negative1-pod
  namespace: negative1
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: negative1-policy
  namespace: negative1
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

apiVersion: v1
kind: Pod
metadata:
  name: negative2-pod
  namespace: negative2-namespace
  labels:
    app: negative2-app
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: negative2-policy
  namespace: negative2-othernamespace
spec:
  podSelector:
    matchLabels:
      app: negative2-app
  policyTypes:
  - Ingress
  egress:
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
    ports:
    - protocol: TCP
      port: 5978

apiVersion: v1
kind: Pod
metadata:
  name: negative3-pod
  namespace: negative3
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
    ports:
    - containerPort: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: negative3-netpol
  labels:
    policy: just-egress
  namespace: negative3
spec:
  podSelector: {}
  egress:
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
    ports:
    - protocol: TCP
      port: 5978","apiVersion: v1
kind: Pod
metadata:
  name: positive1-pod
  namespace: positive1-one
  labels:
    app: shouldmatch
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
    ports:
    - containerPort: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: positive1-netpol
  labels:
    policy: no-ingress-no-egress
  namespace: positive1-anotherone
spec:
  podSelector:
    matchLabels:
      app: shouldmatch
  policyTypes: []

apiVersion: v1
kind: Pod
metadata:
  name: positive2-pod
  namespace: positive2
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
    ports:
    - containerPort: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: positive2-netpol
  namespace: positive2
spec:
  podSelector: {}
  policyTypes: []","[[4], [4]]"
669,056ac60e-fe07-4acc-9b34-8e1d51716ab9,ServiceAccount Allows Access Secrets,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_allows_access_secrets,kubernetes-queries,"Roles and ClusterRoles when binded, should not use get, list or watch as verbs<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","# Vulnerable Role Without Binding
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleWithoutBindingVulnerable
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
# Vulnerable Role With Binding Not Service Account
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleWithBindingVulnerableNotSA
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingNotSATestRoleWithBindingVulnerable
  namespace: bindingNotSATestRoleWithBindingVulnerableNamespace
subjects:
- kind: NotServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: Role
  name: testRoleWithBindingVulnerableNotSA
  apiGroup: rbac.authorization.k8s.io
---
# Safe Role With Binding
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleWithBindingSafe
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""update""]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingtestRoleWithBindingSafe
  namespace: bindingtestRoleWithBindingSafeNamespace
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: Role
  name: testRoleWithBindingSafe
  apiGroup: rbac.authorization.k8s.io
---
# Vulnerable Role with Pod
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleVulnerablePod
rules:
- apiGroups: [""""]
  resources: [""pod""]
  verbs: [""get"", ""watch"", ""list""]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: testRoleBinding
  namespace: bindingTestWithBindingPod
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: Role
  name: testRoleVulnerablePod
  apiGroup: rbac.authorization.k8s.io
---
# Vulnerable Cluster Role Without Binding
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: testClusterRoleWithoutBindingVulnerable
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
# Vulnerable Cluster Role With Binding Not Service Account
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  namespace: default
  name: testClusterRoleWithBindingVulnerableNotSA
rules:
- apiGroups: [""""] # """" indicates the core API group
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingNotSATestClusterRoleWithBindingVulnerable
  namespace: bindingNotSATestClusterRoleWithBindingVulnerableNamespace
subjects:
- kind: NotServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: testClusterRoleWithBindingVulnerableNotSA
  apiGroup: rbac.authorization.k8s.io
---
# Safe ClusterRole With Binding
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  namespace: default
  name: testClusterRoleWithBindingSafe
rules:
- apiGroups: [""""] # """" indicates the core API group
  resources: [""secrets""]
  verbs: [""update""]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingTestClusterRoleWithBindingSafe
  namespace: bindingTestClusterRoleWithBindingSafeNamespace
subjects:
- kind: NotServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: testClusterRoleWithBindingSafe
  apiGroup: rbac.authorization.k8s.io
---
# Vulnerable Cluster Role With Pod
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: testClusterRoleVulnerablePod
rules:
- apiGroups: [""""]
  resources: [""pod""]
  verbs: [""update"", ""list""]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingTestClusterRoleWithBinding
  namespace: bindingTestClusterRoleWithBindingNamespace
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: testClusterRoleVulnerablePod
  apiGroup: rbac.authorization.k8s.io","#Vulnerable Role
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleVulnerable
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: testRoleBinding
  namespace: bindingTestWithBinding
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: Role
  name: testRoleVulnerable
  apiGroup: rbac.authorization.k8s.io
---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: assembly-prod
  name: testRoleVulnerable2
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""*""]
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: testRoleBinding
  namespace: bindingTestWithBinding2
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: Role
  name: testRoleVulnerable2
  apiGroup: rbac.authorization.k8s.io
---
# Vulnerable Cluster Role
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: testClusterRoleVulnerable
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""update"", ""list""]
---
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: bindingTestClusterRoleWithBinding
  namespace: bindingTestClusterRoleWithBindingNamespace
subjects:
- kind: ServiceAccount
  name: testsa
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: testClusterRoleVulnerable
  apiGroup: rbac.authorization.k8s.io","[[10, 34, 58]]"
670,05fb986f-ac73-4ebb-a5b2-7faafa93d882,Root CA File Not Defined,Kubernetes,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/root_ca_file_not_defined,kubernetes-queries,"When using kube-controller-manager commands, the '--root-ca-file' should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--root-ca-file=/path/to/ca/file.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--root-ca-file=/path/to/ca/file.pem""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: []
  restartPolicy: OnFailure",[[11]]
671,075ca296-6768-4322-aea2-ba5063b969a9,Etcd TLS Certificate Files Not Properly Set,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_tls_certificate_files_not_properly_set,kubernetes-queries,"When using etcd commands, the '--cert-file' and '--key-file' should be defined<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--cert-file=/etc/env/file.crt"", ""--key-file=/etc/env/file2.key""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd"", ""--cert-file=/etc/env/file.crt"", ""--key-file=/etc/env/file2.key""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--cert-file=/etc/env/file.crt""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--key-file=/etc/env/file2.key""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","[[21], [21]]"
672,09bb9e96-8da3-4736-b89a-b36814acca60,Etcd Peer TLS Certificate Files Not Properly Set,Kubernetes,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_peer_tls_certificate_files_not_properly_set,kubernetes-queries,"When using etcd commands, the '--peer-cert-file' and '--peer-key-file' should be defined<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-cert-file=/etc/env/file.crt"", ""--peer-key-file=/etc/env/file2.key""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd"", ""--peer-cert-file=/etc/env/file.crt"", ""--peer-key-file=/etc/env/file2.key""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-cert-file=/etc/env/file.crt""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-key-file=/etc/env/file2.key""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","[[21], [21]]"
673,10efce34-5af6-4d83-b414-9e096d5a06a9,Encryption Provider Not Properly Configured,Kubernetes,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/encryption_provider_not_properly_configured,kubernetes-queries,"The EncryptionConfiguration should be configured to have at least one 'aescbc', 'kms' or 'secretbox' provider<br>
[Documentation](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/#understanding-the-encryption-at-rest-configuration)","apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
      - secrets
    providers:
      - identity: {}
      - aesgcm:
          keys:
            - name: key1
              secret: c2VjcmV0IGlzIHNlY3VyZQ==
            - name: key2
              secret: dGhpcyBpcyBwYXNzd29yZA==
      - aescbc:
          keys:
            - name: key1
              secret: c2VjcmV0IGlzIHNlY3VyZQ==
            - name: key2
              secret: dGhpcyBpcyBwYXNzd29yZA==
      - secretbox:
          keys:
            - name: key1
              secret: YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoxMjM0NTY=","apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
      - secrets
    providers:
      - identity: {}
      - aesgcm:
          keys:
            - name: key1
              secret: c2VjcmV0IGlzIHNlY3VyZQ==
            - name: key2
              secret: dGhpcyBpcyBwYXNzd29yZA==",[[6]]
674,1123031a-f921-4c5b-bd86-ef354ecfd37a,Metadata Label Is Invalid,Kubernetes,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/metadata_label_is_invalid,kubernetes-queries,"Check if any label in the metadata is invalid.<br>
[Documentation](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)","apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: goproxy
spec:
  containers:
  - name: goproxy
    image: k8s.gcr.io/goproxy:0.1
    ports:
    - containerPort: 8080
    readinessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 5
      periodSeconds: 10
    livenessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 20","apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: g**dy.l+bel.
spec:
  containers:
  - name: goproxy
    image: k8s.gcr.io/goproxy:0.1
    ports:
    - containerPort: 8080
    livenessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 20",[[6]]
675,13a49a2e-488e-4309-a7c0-d6b05577a5fb,Audit Policy File Not Defined,Kubernetes,Medium,Observability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_policy_file_not_defined,kubernetes-queries,"When using kube-apiserver command, the '--audit-policy-file' flag should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-policy-file=/home/foo/cx/kics/assets/queries/k8s/audit_policy_file_not_defined/test/negative1.yaml""]
  restartPolicy: OnFailure
---
apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
omitStages:
  - ""RequestReceived""
rules:
  # Log pod changes at RequestResponse level
  - level: RequestResponse
    resources:
    - group: """"
      # Resource ""pods"" doesn't match requests to any subresource of pods,
      # which is consistent with the RBAC policy.
      resources: [""pods""]
  # Log ""pods/log"", ""pods/status"" at Metadata level
  - level: Metadata
    resources:
    - group: """"
      resources: [""pods/log"", ""pods/status""]

  # Don't log requests to a configmap called ""controller-leader""
  - level: None
    resources:
    - group: """"
      resources: [""configmaps""]
      resourceNames: [""controller-leader""]

  # Don't log watch requests by the ""system:kube-proxy"" on endpoints or services
  - level: None
    users: [""system:kube-proxy""]
    verbs: [""watch""]
    resources:
    - group: """" # core API group
      resources: [""endpoints"", ""services""]

  # Don't log authenticated requests to certain non-resource URL paths.
  - level: None
    userGroups: [""system:authenticated""]
    nonResourceURLs:
    - ""/api*"" # Wildcard matching.
    - ""/version""

  # Log the request body of configmap changes in kube-system.
  - level: Request
    resources:
    - group: """" # core API group
      resources: [""configmaps""]
    # This rule only applies to resources in the ""kube-system"" namespace.
    # The empty string """" can be used to select non-namespaced resources.
    namespaces: [""kube-system""]

  # Log configmap and secret changes in all other namespaces at the Metadata level.
  - level: Metadata
    resources:
    - group: """" # core API group
      resources: [""secrets"", ""configmaps""]

  # Log all other resources in core and extensions at the Request level.
  - level: Request
    resources:
    - group: """" # core API group
    - group: ""extensions"" # Version of group should NOT be included.

  # A catch-all rule to log all other requests at the Metadata level.
  - level: Metadata
    # Long-running requests like watches that fall under this rule will not
    # generate an audit event in RequestReceived.
    omitStages:
      - ""RequestReceived""

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-policy-file=/home/foo/cx/kics/assets/queries/k8s/audit_policy_file_not_defined/test/negative2.yaml""]
      args: []
  restartPolicy: OnFailure
---
apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
omitStages:
  - ""RequestReceived""
rules:
  # Log pod changes at RequestResponse level
  - level: RequestResponse
    resources:
    - group: """"
      # Resource ""pods"" doesn't match requests to any subresource of pods,
      # which is consistent with the RBAC policy.
      resources: [""pods""]
  # Log ""pods/log"", ""pods/status"" at Metadata level
  - level: Metadata
    resources:
    - group: """"
      resources: [""pods/log"", ""pods/status""]

  # Don't log requests to a configmap called ""controller-leader""
  - level: None
    resources:
    - group: """"
      resources: [""configmaps""]
      resourceNames: [""controller-leader""]

  # Don't log watch requests by the ""system:kube-proxy"" on endpoints or services
  - level: None
    users: [""system:kube-proxy""]
    verbs: [""watch""]
    resources:
    - group: """" # core API group
      resources: [""endpoints"", ""services""]

  # Don't log authenticated requests to certain non-resource URL paths.
  - level: None
    userGroups: [""system:authenticated""]
    nonResourceURLs:
    - ""/api*"" # Wildcard matching.
    - ""/version""

  # Log the request body of configmap changes in kube-system.
  - level: Request
    resources:
    - group: """" # core API group
      resources: [""configmaps""]
    # This rule only applies to resources in the ""kube-system"" namespace.
    # The empty string """" can be used to select non-namespaced resources.
    namespaces: [""kube-system""]

  # Log configmap and secret changes in all other namespaces at the Metadata level.
  - level: Metadata
    resources:
    - group: """" # core API group
      resources: [""secrets"", ""configmaps""]

  # Log all other resources in core and extensions at the Request level.
  - level: Request
    resources:
    - group: """" # core API group
    - group: ""extensions"" # Version of group should NOT be included.

  # A catch-all rule to log all other requests at the Metadata level.
  - level: Metadata
    # Long-running requests like watches that fall under this rule will not
    # generate an audit event in RequestReceived.
    omitStages:
      - ""RequestReceived""","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-policy-file=./not/valid/file.yaml""]
      args: []
  restartPolicy: OnFailure

apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
      - name: command-demo-container
        image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
        command: [""kube-apiserver""]
        args: []
    restartPolicy: OnFailure","[[11], [11], [12]]"
676,14abda69-8e91-4acb-9931-76e2bee90284,Image Policy Webhook Admission Control Plugin Not Set,Kubernetes,Low,Build Process,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/image_policy_webhook_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the --enable-admission-plugins flag should have 'ImagePolicyWebhook' plugin and the plugin should be correctly configured in AdmissionControl Config file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=ImagePolicyWebhook"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=ImagePolicyWebhook"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
677,1828a670-5957-4bc5-9974-47da228f75e2,Audit Policy Not Cover Key Security Concerns,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_policy_not_cover_key_security_concerns,kubernetes-queries,"Audit Policy should cover key security concerns about the sensitive data logged in Kubernetes audit policies<br>
[Documentation](https://kubernetes.io/docs/tasks/debug-application-cluster/audit/)","apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
omitStages:
  - ""RequestReceived""
rules:
  - level: Metadata
    resources:
    - group: """"
      resources: [""secrets"",""configmaps"",""tokenreviews""]
  - level: Metadata
    resources:
    - group: """"
      resources: [""pods"",""deployments""]
  - level: RequestResponse
    resources:
    - group: """"
      resources: [""pods/exec"", ""pods/portforward"", ""pods/proxy"", ""services/proxy""]","apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
omitStages:
  - ""RequestReceived""
rules:

apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
rules:
  - level: RequestResponse
    resources:
    - group: """"
      resources: [""secrets"",""configmaps"",""tokenreviews""]
  - level: Metadata
    resources:
    - group: """"
      resources: [""pods"",""deployments""]
  - level: None
    resources:
    - group: """"
      resources: [""pods/exec"", ""pods/portforward"", ""pods/proxy"", ""services/proxy""]

apiVersion: audit.k8s.io/v1 # This is required.
kind: Policy
# Don't generate audit events for all requests in RequestReceived stage.
omitStages:
  - ""RequestReceived""
rules:
  - level: Metadata
    resources:
    - group: """"
      resources: [""secrets"",""configmaps"",""tokenreviews""]
  - level: Metadata
    resources:
    - group: """"
      resources: [""pods""]
  - level: RequestResponse
    resources:
    - group: """"
      resources: [""pods/exec"", ""pods/portforward"", ""pods/proxy"", ""services/proxy""]","[[6], [4], [6]]"
678,192fe40b-b1c3-448a-aba2-6cc19a300fe3,CronJob Deadline Not Configured,Kubernetes,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cronjob_deadline_not_configured,kubernetes-queries,"Cronjobs must have a configured deadline, which means the attribute 'startingDeadlineSeconds' must be defined<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/)","apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""*/1 * * * *""
  startingDeadlineSeconds: 100
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            args:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy: OnFailure","#this is a problematic code where the query should report a result(s)
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""*/1 * * * *""
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            args:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy: OnFailure",[[6]]
679,19ebaa28-fc86-4a58-bcfa-015c9e22fe40,Containers With Added Capabilities,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/containers_with_added_capabilities,kubernetes-queries,"Containers should not have extra capabilities allowed<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: pod1
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: pod4
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
        add:
          - NET_BIND_SERVICE
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: pod2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
           add: [""NET_ADMIN"", ""SYS_TIME""]
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: v1
kind: Pod
metadata:
  name: pod3
spec:
  initContainers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
           add: [""NET_ADMIN"", ""SYS_TIME""]
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
  containers:
  - name: app
    image: images.my-company.example/app:v4","[[43, 12]]"
680,1a07a446-8e61-4e4d-bc16-b0781fcb8211,Kubelet Event QPS Not Properly Set,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_event_qps_not_properly_set,kubernetes-queries,"When using the kubelet command, the '--event-qps' should be set to 0<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--event-qps=0""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
eventRecordQPS: 0
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
evictionHard:
    memory.available:  ""200Mi""","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--event-qps=1""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"",""--event-qps=3""]
      args: []
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
eventRecordQPS: 2
serializeImagePulls: false
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
evictionHard:
    memory.available:  ""200Mi""","[[11], [11], [5]]"
681,1aa4a1ae-5dbb-48a1-9aa2-630ea4be208e,Authorization Mode RBAC Not Set,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/authorization_mode_rbac_not_set,kubernetes-queries,"When using kube-apiserver command, the 'authorization-mode' flag should have 'RBAC' mode<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=RBAC,Node""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--authorization-mode=RBAC,Node""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=AlwaysAllow""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=Node""]
  restartPolicy: OnFailure","[[11], [11]]"
682,1acd93f1-5a37-45c0-aaac-82ece818be7d,Use Service Account Credentials Not Set To True,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/use_service_account_credentials_not_set_to_true,kubernetes-queries,"When using kube-controller-manager commands, the '--use-service-account-credentials' should be set to true<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--use-service-account-credentials=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--use-service-account-credentials=true""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--use-service-account-credentials=false""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: []
  restartPolicy: OnFailure","[[11], [11]]"
683,1c621b8e-2c6a-44f5-bd6a-fb0fb7ba33e2,Rotate Kubelet Server Certificate Not Active,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rotate_kubelet_server_certificate_not_active,kubernetes-queries,"The RotateKubeletServerCertificate argument should be true<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
featureGates:
    RotateKubeletServerCertificate: true

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--feature-gates=RotateKubeletServerCertificate=true""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""","apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
featureGates:
    RotateKubeletServerCertificate: false

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--feature-gates=RotateKubeletServerCertificate=false""]
  restartPolicy: OnFailure","[[8], [11]]"
684,1db3a5a5-bf75-44e5-9e44-c56cfc8b1ac5,StatefulSet Without PodDisruptionBudget,Kubernetes,Low,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/statefulset_without_pod_disruption_budget,kubernetes-queries,"StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability<br>
[Documentation](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)","apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  name: nginx-pdb
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: nginx33
      run: test
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
spec:
  selector:
    matchLabels:
      app: nginx123
      run: test
  serviceName: ""nginx""
  replicas: 3
  template:
    metadata:
      labels:
        app: nginx
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html","apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  name: nginx-pdb
spec:
  maxUnavailable: 1
  selector:
    matchLabels:
      app: xpto
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
spec:
  requiredDropCapabilities:
    - ALL
  selector:
    matchLabels:
      app: nginx
  serviceName: ""nginx""
  replicas: 3
  template:
    metadata:
      labels:
        app: nginx
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html",[[19]]
685,1de5cc51-f376-4638-a940-20f2e85ae238,Anonymous Auth Is Not Set To False,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/1390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/anonymous_auth_is_not_set_to_false,kubernetes-queries,"When using the kubelet or kube-apiserver command, the 'anonymous-auth' flag should be set to false (--anonymous-auth=false)<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--anonymous-auth=false""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--anonymous-auth=false""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--anonymous-auth=false""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--anonymous-auth=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--anonymous-auth=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"", ""--anonymous-auth=true""]
  restartPolicy: OnFailure","[[11], [11], [11]]"
686,1e749bc9-fde8-471c-af0c-8254efd2dee5,Role Binding To Default Service Account,Kubernetes,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/role_binding_to_default_service_account,kubernetes-queries,"No role nor cluster role should bind to a default service account<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/)","apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: default
subjects:
- kind: User
  name: jane
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io","apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: default
subjects:
- kind: User
  name: jane
  apiGroup: rbac.authorization.k8s.io
- kind: ServiceAccount
  name: default
  namespace: kube-system
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io",[[11]]
687,1ffe7bf7-563b-4b3d-a71d-ba6bd8d49b37,Namespace Lifecycle Admission Control Plugin Disabled,Kubernetes,Low,Build Process,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/namespace_lifecycle_admission_control_plugin_disabled,kubernetes-queries,"When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'NamespaceLifecycle' plugin<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=NamespaceLifecycle"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--disable-admission-plugins=NamespaceLifecycle""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--disable-admission-plugins=NamespaceLifecycle""]
      args: []
  restartPolicy: OnFailure","[[11], [11]]"
688,2270987f-bb51-479f-b8be-3ca73e5ad648,NET_RAW Capabilities Disabled for PSP,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/net_raw_capabilities_disabled_for_psp,kubernetes-queries,"Containers need to have NET_RAW or All as drop capabilities<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  readOnlyRootFilesystem: false","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - SYS_TIME
    - SYS_ADMIN
    - KILL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  readOnlyRootFilesystem: false

---

apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted2
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - KILL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  readOnlyRootFilesystem: false","[[57, 13]]"
689,229588ef-8fde-40c8-8756-f4f2b5825ded,Memory Requests Not Defined,Kubernetes,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/memory_requests_not_defined,kubernetes-queries,"Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/)","apiVersion: v1
kind: Pod
metadata:
  name: memory-demo
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    resources:
      limits:
        memory: ""200Mi""
      requests:
        memory: ""100Mi""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-deployment-ctr-neg
  labels:
    app: test-neg
spec:
  replicas: 3
  selector:
    matchLabels:
      app: test-ctr-neg
  template:
    metadata:
      labels:
        app: test-ctr-neg
    spec:
      containers:
        - name:  pause
          image: k8s.gcr.io/pause
          resources:
            limits:
              cpu: 0.5
              memory: 512Mi
            requests:
              cpu: 0.5
              memory: 512Mi","apiVersion: v1
kind: Pod
metadata:
  name: memory-demo
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr-1
    image: polinux/stress
    resources:
      limits:
        memory: ""200Mi""
      requests:
        cpu: ""0.5""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-1
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr-2
    image: polinux/stress
    resources:
      limits:
        memory: ""200Mi""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-2
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr-3
    image: polinux/stress
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-3
  namespace: mem-example
spec:
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
  - name: memory-demo-ctr-4
    image: polinux/stress
    command: [""stress""]

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-deployment2
  labels:
    app: test2
spec:
  replicas: 3
  selector:
    matchLabels:
      app: test2
  template:
    metadata:
      labels:
        app: test2
    spec:
      containers:
        - name:  pause
          image: k8s.gcr.io/pause
          resources:
            limits:
              cpu: 0.5
              memory: 512Mi","[[40, 25, 59, 13], [18]]"
690,235236ee-ad78-4065-bd29-61b061f28ce0,Containers With Sys Admin Capabilities,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/containers_with_sys_admin_capabilities,kubernetes-queries,"Containers should not have CAP_SYS_ADMIN Linux capability<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: pod1
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: pod4
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
           add: [""SYS_ADMIN""]
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""",[[12]]
691,249328b8-5f0f-409f-b1dd-029f07882e11,Cluster Admin Rolebinding With Superuser Permissions,Kubernetes,Low,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cluster_admin_role_binding_with_super_user_permissions,kubernetes-queries,"Ensure that the cluster-admin role is only used where required (RBAC)<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#user-facing-roles)","kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: tiller-clusterrolebinding
subjects:
- kind: ServiceAccount
  name: tiller
  namespace: kube-system
roleRef:
  kind: ClusterRole
  name: view
  apiGroup: """"
# trigger validation","kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: tiller-clusterrolebinding
subjects:
  - kind: ServiceAccount
    name: tiller
    namespace: kube-system
roleRef:
  kind: ClusterRole
  name: cluster-admin
  apiGroup: """"",[[11]]
692,26763a1c-5dda-4772-b507-5fca7fb5f165,Service With External Load Balancer,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/552.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_with_external_load_balancer,kubernetes-queries,"Service has an external load balancer, which may cause accessibility from other networks and the Internet<br>
[Documentation](https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/)","apiVersion: v1
kind: Service
metadata:
  name: sample-service 01
  annotations:
    cloud.google.com/load-balancer-type: 'Internal'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 02
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-internal: 'true'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 03
  annotations:
    service.beta.kubernetes.io/azure-load-balancer-internal: 'true'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 04
  annotations:
    networking.gke.io/load-balancer-type: 'Internal'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx","apiVersion: v1
kind: Service
metadata:
  name: sample-service 05
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 05334443
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-internal: 'false'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 07
  annotations:
    service.beta.kubernetes.io/azure-load-balancer-internal: 'false'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 08
  annotations:
    networking.gke.io/load-balancer-type: 'External'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx
---
apiVersion: v1
kind: Service
metadata:
  name: sample-service 09
  annotations:
    cloud.google.com/load-balancer-type: 'External'
spec:
  ports:
    - port: 80
      targetPort: 80
      protocol: TCP
  type: LoadBalancer
  selector:
    app: nginx","[[33, 4, 48, 18, 63]]"
693,268ca686-7fb7-4ae9-b129-955a2a89064e,No Drop Capabilities for Containers,Kubernetes,Low,Best Practices,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/no_drop_capabilities_for_containers,kubernetes-queries,"Sees if Kubernetes Drop Capabilities exists to ensure containers security context<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/pods/init-containers/)","apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: payment
        image: nginx
        securityContext:
          capabilities:
            drop:
              - all
            add:
              - NET_BIND_SERVICE","apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: payment
        image: nginx
        securityContext:
          capabilities:
            add:
              - NET_BIND_SERVICE
      - name: payment2
        image: nginx
        securityContext:
          allowPrivilegeEscalation: false
      - name: payment3
        image: nginx","[[26, 28, 21]]"
694,2940d48a-dc5e-4178-a3f8-bfbd80720b41,Kubelet Read Only Port Is Not Set To Zero,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_read_only_port_is_not_set_to_zero,kubernetes-queries,"When using the kubelet command, the read-only port should be set to zero (--read-only-port=0)<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: kubelet-demo
  labels:
    purpose: kubelet-demo
spec:
  containers:
    - name: kubelet-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--read-only-port=0""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"", ""--read-only-port=0""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
  memory.available: ""200Mi""
readOnlyPort: 0","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--read-only-port=1""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"", ""--read-only-port=1""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
  memory.available: ""200Mi""
readOnlyPort: 1","[[11], [11], [8]]"
695,2b1836f1-dcce-416e-8e16-da8c71920633,Workload Host Port Not Specified,Kubernetes,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/workload_host_port_not_specified,kubernetes-queries,"Verifies if Kubernetes workload's host port is specified<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/connect-applications-service/#exposing-the-service)","apiVersion: v1
kind: Pod
metadata:
  name: firstpod
spec:
  containers:
  - name: container
    image: nginx
    ports:
    - containerPort: 80
      hostIP: 10.0.0.1","apiVersion: v1
kind: Pod
metadata:
  name: firstpod
spec:
  containers:
  - name: container
    image: nginx
    ports:
    - containerPort: 80
      hostIP: 10.0.0.1
      hostPort: 8080
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: secondpod
spec:
  template:
    spec:
      containers:
      - name: container2
        image: nginx
        ports:
        - containerPort: 81
          hostIP: 10.0.0.2
          hostPort: 8081
    metadata:
      labels:
        app: nginx
  selector:
    matchLabels:
      app: nginx","[[24, 9]]"
696,2f491173-6375-4a84-b28e-a4e2b9a58a69,Profiling Not Set To False,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/profiling_not_set_to_false,kubernetes-queries,"When using kube-apiserver or kube-controller-manager or kube-scheduler command, the '--profiling' flag should be defined and set to false<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--profiling=false""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-controller-manager
    tier: control-plane
  name: kube-controller-manager-master-1
  namespace: kube-system
spec:
  selector:
    matchLabels:
      app: kube-controller-manager
  template:
    metadata:
      labels:
        app: kube-controller-manager
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-master-1
      command: [""kube-controller-manager"",""--profiling=false""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler-master-3
  namespace: kube-system
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-scheduler-master-1
      command: [""kube-scheduler"",""--profiling=false""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--profiling=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo-1
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-controller-manager
    tier: control-plane
  name: kube-controller-manager-master-3
  namespace: kube-system
spec:
  selector:
    matchLabels:
      app: kube-controller-manager
  template:
    metadata:
      labels:
        app: kube-controller-manager
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-master-3
      command: [""kube-controller-manager"",""--profiling=true""]
      args: []
  restartPolicy: OnFailure","[[11], [11], [21]]"
697,2f652c42-619d-4361-b361-9f599688f8ca,HPA Targets Invalid Object,Kubernetes,Low,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/hpa_targets_invalid_object,kubernetes-queries,"The Horizontal Pod Autoscaler must target a valid object<br>
[Documentation](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/)","apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: php-apache
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: php-apache
  minReplicas: 1
  maxReplicas: 10
  metrics:
  - type: Object
    object:
      metric:
        name: requests-per-second
      describedObject:
        apiVersion: networking.k8s.io/v1beta1
        kind: Ingress
        name: main-route
      target:
        type: Value
        value: 10k

apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: matching-svc
  namespace: default
spec:
  metrics:
    - resource:
        name: cpu
        target:
          averageUtilization: 50
          type: Utilization
      type: Resource
  minReplicas: 1
  maxReplicas: 5
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: matching-svc","apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: php-apache
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: php-apache
  minReplicas: 1
  maxReplicas: 10
  metrics:
  - type: Object
    object:
      metric:
        name: requests-per-second
      target:
        type: Value
        value: 10k
      describedObject:
        apiVersion: networking.k8s.io/v1beta1
        kind: Ingress",[[12]]
698,302736f4-b16c-41b8-befe-c0baffa0bd9d,Shared Host PID Namespace,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/shared_host_pid_namespace,kubernetes-queries,"Container should not share the host process ID namespace<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  hostPID: false
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostPID: false
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  hostPID: true
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostPID: true
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","[[6], [9]]"
699,32ecd76e-7bbf-402e-bf48-8b9485749558,Token Auth File Is Set,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/token_auth_file_is_set,kubernetes-queries,"When using kube-apiserver command, the 'token-auth-file' flag should not be set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--token-auth-file=/path/to/any/file""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--token-auth-file=/path/to/any/file""]
  restartPolicy: OnFailure","[[11], [11]]"
700,33fc6923-6553-4fe6-9d3a-4efa51eb874b,Node Restriction Admission Control Plugin Not Set,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/node_restriction_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the --enable-admission-plugins flag should have 'NodeRestriction' plugin and the plugin should be correctly configured in AdmissionControl Config file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=NodeRestriction"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=NodeRestriction"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
701,35c0a471-f7c8-4993-aa2c-503a3c712a66,Audit Log Maxsize Not Properly Set,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_log_maxsize_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--audit-log-maxsize' flag should be defined and set to 100 or more MegaBytes<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxsize=150""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-log-maxsize=100""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxsize=50""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
      - name: command-demo-container
        image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
        command: [""kube-apiserver""]
        args: [""--audit-log-maxsize=50""]
    restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: [""--audit-log-maxsize=50""]
      restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Revision
metadata:
  name: dummy-rev
  namespace: knative-sequence
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxsize=50""]
  restartPolicy: OnFailure
---
apiVersion: sources.knative.dev/v1
kind: ContainerSource
metadata:
  name: dummy-cs
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: [""--audit-log-maxsize=50""]
      restartPolicy: OnFailure","[[11], [11], [40, 27, 12, 55]]"
702,36a27826-1bf5-49da-aeb0-a60a30c0e834,Kubelet Client Certificate Or Key Not Set,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_client_certificate_or_key_not_set,kubernetes-queries,"When using kube-apiserver command, the 'kubelet-client-key' and 'kubelet-client-certificate' flags should be set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--kubelet-client-certificate=/path/to/any/file.pem"", ""--kubelet-client-key=/path/to/any/file2.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-client-certificate=/path/to/any/file.pem"", ""--kubelet-client-key=/path/to/any/file2""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-client-certificate=/path/to/any/file.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-client-key=/path/to/any/file""]
  restartPolicy: OnFailure","[[11], [11], [11]]"
703,3878dc92-8e5d-47cf-9cdd-7590f71d21b9,Incorrect Volume Claim Access Mode ReadWriteOnce,Kubernetes,Medium,Build Process,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/incorrect_volume_claim_access_mode_read_write_once,kubernetes-queries,"Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce'<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/)","#this code is a correct code for which the query should not find any result
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
spec:
  selector:
    matchLabels:
      app: nginx # has to match .spec.template.metadata.labels
  serviceName: ""nginx""
  replicas: 3 # by default is 1
  template:
    metadata:
      labels:
        app: nginx # has to match .spec.selector.matchLabels
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi","#this is a problematic code where the query should report a result(s)
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
spec:
  selector:
    matchLabels:
      app: nginx # has to match .spec.template.metadata.labels
  serviceName: ""nginx""
  replicas: 3 # by default is 1
  template:
    metadata:
      labels:
        app: nginx # has to match .spec.selector.matchLabels
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi
  - metadata:
      name: aaa
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi

---

apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web2
spec:
  selector:
    matchLabels:
      app: nginx # has to match .spec.template.metadata.labels
  serviceName: ""nginx""
  replicas: 3 # by default is 1
  template:
    metadata:
      labels:
        app: nginx # has to match .spec.selector.matchLabels
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWrite"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi
  - metadata:
      name: aaa
    spec:
      accessModes: [ ""ReadWrite"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi","[[72, 27]]"
704,38fa11ef-dbcc-4da8-9680-7e1fd855b6fb,RBAC Roles with Port-Forwarding Permission,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_with_portforwarding_permissions,kubernetes-queries,"Roles or ClusterRoles with RBAC permissions to port-forward into pods can open socket-level communication channels to containers. In case of compromise, attackers may abuse this for direct communication that bypasses network security restrictions<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-port-forward-neg
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-port-forward-neg
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-port-forward-neg
  apiGroup: """"","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-port-forward
rules:
- apiGroups: [""""]
  resources: [""pods"", ""pods/portforward""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-port-forward
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-port-forward
  apiGroup: """"",[[8]]
705,3ca03a61-3249-4c16-8427-6f8e47dda729,Service Does Not Target Pod,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_does_not_target_pod,kubernetes-queries,"Service should Target a Pod<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/service/)","apiVersion: v1
kind: Service
metadata:
  name: helloworld
spec:
  type: NodePort
  selector:
    app: helloworld
  ports:
    - name: http
      nodePort: 30475
      port: 8089
      protocol: TCP
      targetPort: 8089

---

apiVersion: v1
kind: Pod
metadata:
  name: nginx
  labels:
    app: helloworld
spec:
  containers:
  - name: nginx
    image: nginx
    ports:
      - containerPort: 8089

apiVersion: v1
kind: Service
metadata:
  name: negative2
spec:
  type: ClusterIP
  ports:
    - name: http
      port: 80
      protocol: TCP
      targetPort: 8080
    - name: health
      port: 8081
      protocol: TCP
      targetPort: 8082
  selector:
    app: negative2
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: negative2
  labels:
    app: negative2
spec:
  selector:
    matchLabels:
      app: negative2
  template:
    metadata:
      labels:
        app: negative2
    spec:
      containers:
        - name: webserver
          image: nginx:latest
          ports:
            - containerPort: 8080
            - containerPort: 8082

apiVersion: v1
kind: Service
metadata:
  name: negative3
spec:
  type: NodePort
  selector:
    app: negative3
  ports:
    - name: http
      nodePort: 30475
      port: 9377
      protocol: TCP
      targetPort: web
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: negative3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: negative3
  template:
    metadata:
      labels:
        app: negative3
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - name: web
              containerPort: 80","apiVersion: v1
kind: Service
metadata:
  name: helloworld2
spec:
  type: NodePort
  selector:
    app: helloworld2
  ports:
    - name: http
      nodePort: 30475
      port: 9377
      protocol: TCP
      targetPort: 9377
---
apiVersion: v1
kind: Pod
metadata:
  name: nginx2
  labels:
    app: hellowwwworld
spec:
  containers:
    - name: nginx
      image: nginx
      ports:
        - containerPort: 9377

apiVersion: v1
kind: Service
metadata:
  name: helloworld3
spec:
  type: NodePort
  selector:
    app: helloworld3
  ports:
    - name: http
      nodePort: 30475
      port: 9377
      protocol: TCP
      targetPort: 9377
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: helloworld3
spec:
  replicas: 3
  selector:
    matchLabels:
      app: helloworld3
  template:
    metadata:
      labels:
        app: helloworld3
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80","[[7], [12]]"
706,3d24b204-b73d-42cb-b0bf-1a5438c5f71e,Secure Port Set To Zero,Kubernetes,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/secure_port_set_to_zero,kubernetes-queries,"When using kube-apiserver command, the --secure-port flag should not be 0<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--secure-port=6443""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--secure-port=0""]
  restartPolicy: OnFailure",[[11]]
707,3d658f8b-d988-41a0-a841-40043121de1e,Secrets As Environment Variables,Kubernetes,Low,Secret Management,https://cwe.mitre.org/data/definitions/526.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/secrets_as_environment_variables,kubernetes-queries,"Container should not use secrets as environment variables<br>
[Documentation](https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-environment-variables)","apiVersion: v1
kind: Pod
metadata:
  name: secret-env-pod
spec:
  containers:
  - name: mycontainer
    image: redis
  restartPolicy: Never","apiVersion: v1
kind: Pod
metadata:
  name: secret-env-pod
spec:
  containers:
  - name: mycontainer
    image: redis
    env:
      - name: SECRET_USERNAME
        valueFrom:
          secretKeyRef:
            name: mysecret
            key: username
      - name: SECRET_PASSWORD
        valueFrom:
          secretKeyRef:
            name: mysecret
            key: password
  restartPolicy: Never
---
apiVersion: v1
kind: Pod
metadata:
  name: envfrom-secret
spec:
  containers:
  - name: envars-test-container
    image: nginx
    envFrom:
    - secretRef:
        name: test-secret","[[17, 12, 30]]"
708,3f5ff8a7-5ad6-4d02-86f5-666307da1b20,Etcd Client Certificate File Not Defined,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_client_certificate_file_not_defined,kubernetes-queries,"When using kube-apiserver commands, the '--etcd-cafile' flag should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--etcd-cafile=/path/to/ca/file.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--etcd-cafile=/path/to/ca/file.pem""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure",[[11]]
709,46a2e9ec-6a5f-4faa-9d39-4ea44d5d87a2,Bind Address Not Properly Set,Kubernetes,Info,Networking and Firewall,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/bind_address_not_properly_set,kubernetes-queries,"When using kube-controller-manager or kube-scheduler commands, the '--bind-address' should be set to 127.0.0.1<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--bind-address=127.0.0.1""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--bind-address=127.0.0.1""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler
  namespace: kube-system
spec:
  selector:
    matchLabels:
      app: kube-controller-manager
  template:
    metadata:
      labels:
        app: kube-controller-manager
  containers:
    - name: command-demo-container
      image: k8s.gcr.io/kube-scheduler:v1.19.0
      command: [""kube-scheduler""]
      args: [""--bind-address=127.0.0.1""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--bind-address=0.0.0.0""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  labels:
    component: kube-scheduler
    tier: control-plane
  name: kube-scheduler
  namespace: kube-system
spec:
  selector:
    matchLabels:
      app: kube-controller-manager
  template:
    metadata:
      labels:
        app: kube-controller-manager
  containers:
    - name: command-demo-container
      image: k8s.gcr.io/kube-scheduler:v1.19.0
      command: [""kube-scheduler""]
      args: []
  restartPolicy: OnFailure","[[11], [11], [20]]"
710,48471392-d4d0-47c0-b135-cdec95eb3eef,Service Account Token Automount Not Disabled,Kubernetes,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_token_automount_not_disabled,kubernetes-queries,"Service Account Tokens are automatically mounted even if not necessary<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#use-the-default-service-account-to-access-the-api-server)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  automountServiceAccountToken: false
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: v1
kind: ServiceAccount
metadata:
  name: redistest-sa
automountServiceAccountToken: false
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: demoenv
  labels:
    app: redis
spec:
  selector:
    matchLabels:
      app: redis
  template:
    metadata:      
      labels:
        app: redis
    spec:
      serviceAccountName: redistest-sa
      containers:
      - name: redis
        image: redis:latest","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false
---
apiVersion: v1
kind: Pod
metadata:
  name: security.context.demo
spec:
  automountServiceAccountToken: true
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      automountServiceAccountToken: true
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false

apiVersion: v1
kind: ServiceAccount
metadata:
  name: redistest-sa
automountServiceAccountToken: true
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: demoenv
  labels:
    app: redis
spec:
  selector:
    matchLabels:
      app: redis
  template:
    metadata:      
      labels:
        app: redis
    spec:
      serviceAccountName: redistest-sa
      containers:
      - name: redis
        image: redis:latest","[[28, 5, 54], [5]]"
711,48a5beba-e4c0-4584-a2aa-e6894e4cf424,Pod or Container Without ResourceQuota,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/pod_or_container_without_resource_quota,kubernetes-queries,"Each namespace should have a ResourceQuota policy associated to limit the total amount of resources Pods, Containers and PersistentVolumeClaims can consume<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/resource-quotas/)","apiVersion: v1
kind: Pod
metadata:
  name: pod2
  namespace: myNewPod2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: v1
kind: ResourceQuota
metadata:
    name: pods-high
    namespace: myNewPod2
spec:
    hard:
      cpu: ""1000""
      memory: 200Gi
      pods: ""10""
    scopeSelector:
      matchExpressions:
      - operator : In
        scopeName: PriorityClass
        values: [""high""]

apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: my-kube-system2
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
      containers:
      - name: fluentd-elasticsearch
        image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers
---
apiVersion: v1
kind: ResourceQuota
metadata:
    name: pods-high
    namespace:  my-kube-system2
spec:
    hard:
      cpu: ""1000""
      memory: 200Gi
      pods: ""10""
    scopeSelector:
      matchExpressions:
      - operator : In
        scopeName: PriorityClass
        values: [""high""]","apiVersion: v1
kind: Pod
metadata:
  name: pod1
  namespace: myNewPod
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: pod2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: my-kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
      containers:
      - name: fluentd-elasticsearch
        image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers","[[5], [4], [5]]"
712,49113af4-29ca-458e-b8d4-724c01a4a24f,Terminated Pod Garbage Collector Threshold Not Properly Set,Kubernetes,Medium,Availability,https://cwe.mitre.org/data/definitions/460.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/terminated_pod_garbage_collector_threshold_not_properly_set,kubernetes-queries,"When using kube-controller-manager commands, the '--terminated-pod-gc-threshold' should be set between 0 and 12501<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--terminated-pod-gc-threshold=10""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--terminated-pod-gc-threshold=10""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--terminated-pod-gc-threshold=0""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--terminated-pod-gc-threshold=12501""]
  restartPolicy: OnFailure","[[11], [11]]"
713,4a20ebac-1060-4c81-95d1-1f7f620e983b,Pod or Container Without LimitRange,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/pod_or_container_without_limit_range,kubernetes-queries,"Each namespace should have a LimitRange policy associated to ensure that resource allocations of Pods, Containers and PersistentVolumeClaims do not exceed the defined boundaries<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/limit-range/)","apiVersion: v1
kind: Pod
metadata:
  name: frontend
  namespace: myPod2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: v1
kind: LimitRange
metadata:
  name: cpu-min-max-demo-lr
  namespace: myPod2
spec:
  limits:
  - max:
      cpu: ""800m""
    min:
      cpu: ""200m""
    type: Container

apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system2
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
      containers:
      - name: fluentd-elasticsearch
        image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers
---
apiVersion: v1
kind: LimitRange
metadata:
  name: cpu-min-max-demo-lr
  namespace: kube-system2
spec:
  limits:
  - max:
      cpu: ""800m""
    min:
      cpu: ""200m""
    type: Container","apiVersion: v1
kind: Pod
metadata:
  name: frontend1
  namespace: myPod
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: frontend2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
      - key: node-role.kubernetes.io/master
        operator: Exists
        effect: NoSchedule
      containers:
      - name: fluentd-elasticsearch
        image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
        resources:
          limits:
            memory: 200Mi
          requests:
            cpu: 100m
            memory: 200Mi
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers","[[5], [4], [5]]"
714,4ac0e2b7-d2d2-4af7-8799-e8de6721ccda,CPU Limits Not Set,Kubernetes,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cpu_limits_not_set,kubernetes-queries,"CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests<br>
[Documentation](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/)","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    resources:
      limits:
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
    - name: app
      image: images.my-company.example/app:v4
      resources:
        limits:
          memory: ""64Mi""
    - name: log-aggregator
      image: images.my-company.example/log-aggregator:v6
      resources:
        requests:
          memory: ""64Mi""
          cpu: ""250m""
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          resources:
            limits:
              memory: ""64Mi""
        - name: log-aggregator
          image: images.my-company.example/log-aggregator:v6
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""","[[10, 35, 14, 31]]"
715,4d7ee40f-fc5d-427d-8cac-dffbe22d42d1,Authorization Mode Node Not Set,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/authorization_mode_node_not_set,kubernetes-queries,"When using kube-apiserver command, the 'authorization-mode' flag should have 'Node' mode<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=RBAC,Node""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--authorization-mode=RBAC,Node""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=AlwaysAllow""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=RBAC""]
  restartPolicy: OnFailure","[[11], [11]]"
716,510d5810-9a30-443a-817d-5c1fa527b110,Weak TLS Cipher Suites,Kubernetes,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/weak_tls_cipher_suites,kubernetes-queries,"TLS Connection should use strong Cipher Suites<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--tls-cipher-suites=TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--tls-cipher-suites=TLS_RSA_WITH_RC4_128_SHA""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
protectKernelDefaults: false
serializeImagePulls: false
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
tlsCipherSuites: [""TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256"",""TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256""]
evictionHard:
    memory.available:  ""200Mi""","[[11], [11], [9]]"
717,52d70f2e-3257-474c-b3dc-8ad9ba6a061a,Kubelet Client Periodic Certificate Switch Disabled,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_client_periodic_certificate_switch_disabled,kubernetes-queries,"Kubelet argument --rotate-certificates should be true<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--rotate-certificates""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
rotateCertificates: true","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--rotate-certificates=false""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
rotateCertificates: false","[[11], [8]]"
718,5308a7a8-06f8-45ac-bf10-791fe21de46e,Workload Mounting With Sensitive OS Directory,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/workload_mounting_with_sensitive_os_directory,kubernetes-queries,"Workload is mounting a volume with sensitive OS Directory<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: optmount
              mountPath: /opt
      terminationGracePeriodSeconds: 30
      volumes:
        - name: optmount
          hostPath:
            path: /opt
---
apiVersion: v1
kind: Pod
metadata:
  name: redis-empty-dir
  namespace: kube-system
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      emptyDir: {}
---
apiVersion: v1
kind: Pod
metadata:
  name: redis-tmp-dir
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage-tmp
          mountPath: /data/redis
  volumes:
    - name: redis-storage-tmp
      hostPath:
        path: /tmp/redis-storage
        type: DirectoryOrCreate
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /tmp/static
            type: DirectoryOrCreate","apiVersion: apps/v1
kind: DaemonSet
metadata:
  labels:
    app: prometheus
    chart: prometheus-11.1.2
    component: node-exporter
    heritage: Helm
    release: exporter
  name: exporter-prometheus-node-exporter
  namespace: monitoring
spec:
  selector:
    matchLabels:
      app: prometheus
      component: node-exporter
      release: exporter
  template:
    metadata:
      labels:
        app: prometheus
        chart: prometheus-11.1.2
        component: node-exporter
        heritage: Helm
        release: exporter
    spec:
      containers:
        - args:
            - --path.procfs=/host/proc
            - --path.sysfs=/host/sys
          image: prom/node-exporter:v0.18.1
          imagePullPolicy: IfNotPresent
          name: prometheus-node-exporter
          ports:
            - containerPort: 9100
              hostPort: 9100
              name: metrics
              protocol: TCP
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
            - mountPath: /host/proc
              name: proc
              readOnly: true
            - mountPath: /host/sys
              name: sys
              readOnly: true
      dnsPolicy: ClusterFirst
      hostNetwork: true
      hostPID: true
      restartPolicy: Always
      schedulerName: default-scheduler
      serviceAccount: exporter-prometheus-node-exporter
      serviceAccountName: exporter-prometheus-node-exporter
      terminationGracePeriodSeconds: 30
      volumes:
        - name: proc
          hostPath:
            path: /proc
            type: """"
        - name: sys
          hostPath:
            path: /sys
            type: """"
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: logs
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: varlog
              mountPath: /var/log
            - name: varlibdockercontainers
              mountPath: /var/lib/docker/containers
              readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
        - name: varlog
          hostPath:
            path: /var/log
        - name: varlibdockercontainers
          hostPath:
            path: /var/lib/docker/containers
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: default
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /var/local/static
            type: DirectoryOrCreate
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment-undefined-ns
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /root/local/static
            type: DirectoryOrCreate
---
apiVersion: v1
kind: Pod
metadata:
  name: redis-memcache
  namespace: memcache
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      hostPath:
        path: /var/redis/data
---
kind: Pod
apiVersion: v1
metadata:
  name: web-server-pod
spec:
  volumes:
    - name: nginx-host-config
      hostPath:
        path: ""/etc/nginx""
  containers:
    - name: nginx-container
      image: nginx
      ports:
        - containerPort: 80
          name: ""http-server""
      volumeMounts:
        - mountPath: ""/etc/nginx""
          name: nginx-host-config
---
apiVersion: v1
kind: Pod
metadata:
  name: malicious-pod
  namespace: default
spec:
  containers:
    - name: evil-container
      image: alpine
      volumeMounts:
        - name: rootdir
          mountPath: /
  volumes:
    - name: rootdir
      hostPath:
        path: /
---
apiVersion: v1
kind: Pod
metadata:
  name: dood
spec:
  containers:
    - name: docker-cmds
      image: docker:1.12.6
      command: [""docker"", ""run"", ""-p"", ""80:80"", ""httpd:latest""]
      resources:
        requests:
          cpu: 10m
          memory: 256Mi
      volumeMounts:
        - mountPath: /var/run
          name: docker-sock
  volumes:
    - name: docker-sock
      hostPath:
        path: /var/run
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: pv-001
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: ""/dev/tty1""
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: pv-002
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: ""/boot""
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: default
spec:
  template:
    spec:
      containers:
        - name: evil-container
          image: alpine
          volumeMounts:
            - name: rootdir
              mountPath: /
      volumes:
        - name: rootdir
          hostPath:
            path: /","[[193, 66, 229, 70, 265, 203, 299, 175, 112, 145, 115, 280, 250]]"
719,5572cc5e-1e4c-4113-92a6-7a8a3bd25e6d,Privilege Escalation Allowed,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/privilege_escalation_allowed,kubernetes-queries,"Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: pod1
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: pod2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: true
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      runAsUser: 2000
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: example-priv
spec:
  containers:
      - name: payment
        image: nginx
        securityContext:
          capabilities:
          drop:
            - SYS_ADMIN
      - name: payment2
        image: nginx
      - name: payment4
        image: nginx
        securityContext:
          capabilities:
            add:
              - NET_BIND_SERVICE
      - name: payment3
        image: nginx
        securityContext:
          allowPrivilegeEscalation: false","[[10, 21], [9, 13, 17]]"
720,5744cbb8-5946-4b75-a196-ade44449525b,HPA Targeted Deployments With Configured Replica Count,Kubernetes,Info,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/hpa_targeted_deployments_with_configured_replica_count,kubernetes-queries,"Deployments targeted by HorizontalPodAutoscaler should not have a statically configured replica count set<br>
[Documentation](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/)","#this code is a correct code for which the query should not find any result
apiVersion: apps/v1
kind: Deployment
metadata:
  name: php-apache
spec:
  selector:
    matchLabels:
      run: php-apache
  template:
    metadata:
      labels:
        run: php-apache
    spec:
      containers:
      - name: php-apache
        image: k8s.gcr.io/hpa-example
        ports:
        - containerPort: 80
        resources:
          limits:
            cpu: 500m
          requests:
            cpu: 200m","#this is a problematic code where the query should report a result(s)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: php-apache-1
spec:
  selector:
    matchLabels:
      run: php-apache
  replicas: 1
  template:
    metadata:
      labels:
        run: php-apache
    spec:
      containers:
      - name: php-apache
        image: k8s.gcr.io/hpa-example
        ports:
        - containerPort: 80
        resources:
          limits:
            cpu: 500m
          requests:
            cpu: 200m
---
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: php-apache
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: php-apache-1
  minReplicas: 1
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 50",[[10]]
721,583053b7-e632-46f0-b989-f81ff8045385,Invalid Image Tag,Kubernetes,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/invalid_image,kubernetes-queries,"Image tag must be defined and not be empty or equal to latest.<br>
[Documentation](https://kubernetes.io/docs/concepts/containers/images/#updating-images)","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-1
spec:
  containers:
    - name: uses-private-image
      image: nginx:1.21
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-3
spec:
  containers:
    - name: uses-private-image-container
      image: nginx
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]
---
apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-33
spec:
  containers:
    - name: uses-private-image-container
      image: nginx:latest
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]","[[8, 19]]"
722,591ade62-d6b0-4580-b1ae-209f80ba1cd9,Service Account Name Undefined Or Empty,Kubernetes,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_name_undefined_or_empty,kubernetes-queries,"A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'serviceAccountName' should be defined and not empty.<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/)","#this code is a correct code for which the query should not find any result
apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
  - image: nginx
    name: nginx
    volumeMounts:
    - mountPath: /var/run/secrets/tokens
      name: vault-token
  serviceAccountName: build-robot
  volumes:
  - name: vault-token
    projected:
      sources:
      - serviceAccountToken:
          path: vault-token
          expirationSeconds: 7200
          audience: vault","#this is a problematic code where the query should report a result(s)
apiVersion: v1
kind: Pod
metadata:
  name: nginx.container
spec:
  containers:
  - image: nginx
    name: nginx
    volumeMounts:
    - mountPath: /var/run/secrets/tokens
      name: vault-token
  volumes:
  - name: vault-token
    projected:
      sources:
      - serviceAccountToken:
          path: vault-token
          expirationSeconds: 7200
          audience: vault

---

apiVersion: v1
kind: Pod
metadata:
  name: nginx2.container.group
spec:
  containers:
  - image: nginx2
    name: nginx2
    volumeMounts:
    - mountPath: /var/run/secrets/tokens
      name: vault-token
  serviceAccountName:
  volumes:
  - name: vault-token
    projected:
      sources:
      - serviceAccountToken:
          path: vault-token
          expirationSeconds: 7200
          audience: vault

---

apiVersion: v1
kind: Pod
metadata:
  name: nginx3
spec:
  containers:
  - image: nginx3
    name: nginx3
    volumeMounts:
    - mountPath: /var/run/secrets/tokens
      name: vault-token
  serviceAccountName: """"
  volumes:
  - name: vault-token
    projected:
      sources:
      - serviceAccountToken:
          path: vault-token
          expirationSeconds: 7200
          audience: vault","[[58, 28, 6]]"
723,592ad21d-ad9b-46c6-8d2d-fad09d62a942,Permissive Access to Create Pods,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/permissive_access_to_create_pods,kubernetes-queries,"The permission to create pods in a cluster should be restricted because it allows privilege escalation.<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping)","#this code is a correct code for which the query should not find any result
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
- apiGroups: [""""]

  resources: [""pods""]
  verbs: [""get"", ""watch"", ""list""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader2
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader4
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs:
    - ""get""
    - ""watch""

apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
  - apiGroups:
      - apiextensions.k8s.io
    resources:
      - ""*""
    verbs:
      - create
      - delete","#this is a problematic code where the query should report a result(s)
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs:
    - ""get""
    - ""watch""
    - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: secret-reader2
rules:
- apiGroups: [""""]
  resources: [""*""]
  verbs: [""get"", ""watch"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader3
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs: [""get"", ""watch"", ""*""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: secret-reader4
rules:
- apiGroups: [""""]
  resources: [""*""]
  verbs: [""get"", ""watch"", ""*""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader5
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs:
    - ""get""
    - ""watch""
    - ""c*e""
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader6
rules:
- apiGroups: [""""]
  resources: [""p*ds""]
  verbs: [""get"", ""watch"", ""create""]

#this is a problematic code where the query should report a result(s)
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: secret-reader
rules:
  - apiGroups:
      - ""*""
    resources:
      - ""*""
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - apiextensions.k8s.io
    resources:
      - custom
    verbs:
      - create
      - delete
  - apiGroups:
      - ""*""
    resources:
      - ""*""
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch","[[39, 9, 48, 21, 60, 30], [26]]"
724,5da47109-f8d6-4585-9e2b-96a8958a12f5,Basic Auth File Is Set,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/1390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/basic_auth_file_is_set,kubernetes-queries,"When using kube-apiserver command, the 'basic-auth-file' flag should not be set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--basic-auth-file=/path/to/any/file""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--basic-auth-file=/path/to/any/file""]
  restartPolicy: OnFailure","[[11], [11]]"
725,5f89001f-6dd9-49ff-9b15-d8cd71b617f4,Kubelet Not Managing Ip Tables,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/924.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_not_managing_ip_tables,kubernetes-queries,"Kubelet argument --make-iptables-util-chains should be true<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--make-iptables-util-chains=true""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
makeIPTablesUtilChains: true

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--make-iptables-util-chains=false""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
makeIPTablesUtilChains: false","[[11], [8]]"
726,611ab018-c4aa-4ba2-b0f6-a448337509a6,Using Unrecommended Namespace,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/using_unrecommended_namespace,kubernetes-queries,"Namespaces like 'default', 'kube-system' or 'kube-public' should not be used<br>
[Documentation](https://kubernetes.io/docs/concepts/overview/working-with-objects/kubernetes-objects/)","apiVersion: v1
kind: Pod
metadata:
  name: frontend
  namespace: cosmicPod
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

---
apiVersion: v1
kind: CustomResourceDefinition
metadata:
  name: mongo.db.collection.com","apiVersion: v1
kind: Pod
metadata:
  name: frontend
  namespace: default
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: frontend2
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

apiVersion: v1
kind: Pod
metadata:
  name: mongo.db.collection.com
  namespace: kube-public","[[5], [4], [5]]"
727,69bbc5e3-0818-4150-89cc-1e989b48f23b,Ingress Controller Exposes Workload,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/ingress_controller_exposes_workload,kubernetes-queries,"Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/)","apiVersion: v1
kind: Service
metadata:
  name: app
  labels:
    app: app
spec:
  type: ClusterIP
  ports:
  - port: 3000
    targetPort: 3000
  selector:
    app: app


---

apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: app-ingress
  annotations:
    kubernetes.io/ingress.class: ""nginx""
  labels:
    app: app
spec:
  rules:
  - host: app.acme.org
    http:
      paths:
      - backend:
          serviceName: app2
          servicePort: 3000","apiVersion: v1
kind: Service
metadata:
  name: app
  labels:
    app: app
spec:
  type: ClusterIP
  ports:
  - port: 3000
    targetPort: 3000
  selector:
    app: app


---

apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: app-ingress
  annotations:
    kubernetes.io/ingress.class: ""nginx""
  labels:
    app: app
spec:
  rules:
  - host: app.acme.org
    http:
      paths:
      - backend:
          serviceName: app
          servicePort: 3000",[[31]]
728,6a68bebe-c021-492e-8ddb-55b0567fb768,Security Context Deny Admission Control Plugin Not Set,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/security_context_deny_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'SecurityContextDeny' plugin and the plugin should be correctly configured in AdmissionControl Config file when 'PodSecurityPolicy' plugin is not set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=SecurityContextDeny"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=SecurityContextDeny"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=PodSecurityPolicy"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
729,6b6bdfb3-c3ae-44cb-88e4-7405c1ba2c8a,Shared Host Network Namespace,Kubernetes,Medium,Resource Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/shared_host_network_namespace,kubernetes-queries,"Container should not share the host network namespace<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostNetwork: false
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  hostNetwork: true
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostNetwork: true
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","[[6], [9]]"
730,6b896afb-ca07-467a-b256-1a0077a1c08e,RBAC Wildcard In Rule,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_wildcard_in_rule,kubernetes-queries,"Roles and ClusterRoles with wildcard RBAC permissions provide excessive rights to the Kubernetes API and should be avoided. The principle of least privilege recommends to specify only the set of needed objects and actions<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: opa
  name: configmap-modifier
rules:
- apiGroups: [""""]
  resources: [""configmaps""]
  verbs: [""update"", ""patch""]
---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: opa
  name: configmap-modifier
rules:
- apiGroups: [""""]
  resources: [""searchmaps""]
  verbs: [""create"", ""patch""]","kind: ClusterRole
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: rbac1
  name: configmap-modifier
rules:
- apiGroups: [""*""]
  resources: [""configmaps""]
  verbs: [""*""]
---
# Define role for OPA/kube-mgmt to update configmaps with policy status.
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: rbac2
  name: configmap-modifier1
rules:
- apiGroups: [""*""]
  resources: [""*""]
  verbs: [""*""]
---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  namespace: rbac3
  name: configmap-modifier2
rules:
- operations: [""CREATE"", ""UPDATE""]
  apiGroups: [""*""]
  apiVersions: [""*""]
  resources: [""*""]
  verbs: [""POST""]","[[7, 9, 18, 19, 20, 29, 31]]"
731,6cf42c97-facd-4fda-b8af-ea4529123355,Kubelet Protect Kernel Defaults Set To False,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_protect_kernel_defaults_set_to_false,kubernetes-queries,"--protect-kernel-defaults should be set to true<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--protect-kernel-defaults=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
protectKernelDefaults: true
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
evictionHard:
    memory.available:  ""200Mi""","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--protect-kernel-defaults=false""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"",""--protect-kernel-defaults=false""]
      args: []
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
protectKernelDefaults: false
serializeImagePulls: false
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
evictionHard:
    memory.available:  ""200Mi""","[[11], [11], [5]]"
732,6d173be7-545a-46c6-a81d-2ae52ed1605d,Tiller (Helm v2) Is Deployed,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/tiller_is_deployed,kubernetes-queries,"Check if Tiller is deployed.<br>
[Documentation](https://kubernetes.io/docs/concepts/containers/images/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false","--- 
apiVersion: extensions/v1beta1
kind: Deployment
metadata: 
  labels: 
    app: helm
    name: tiller
  name: tiller-deploy
spec: 
  containers: 
    - 
      image: tiller-image
      name: tiller-v1
  template: 
    metadata: 
      labels: 
        app: helm
        name: tiller
    spec: 
      containers: 
        - 
          args: 
            - ""--listen=10.7.2.8:44134""
          image: tiller-image
          name: tiller-v2
          ports: 
            - 
              containerPort: 44134
              name: tiller
              protocol: TCP
            - 
              containerPort: 44135
              name: http
              protocol: TCP
      serviceAccountName: tiller","[[8, 10, 20, 15]]"
733,7307579a-3abb-46ad-9ce5-2a915634d5c8,PSP With Added Capabilities,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_with_added_capabilities,kubernetes-queries,"PodSecurityPolicy should not have added capabilities<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  volumes:
  - '*'
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  allowedCapabilities:
  - '*'
  volumes:
  - '*'
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'",[[10]]
734,73e251f0-363d-4e53-86e2-0a93592437eb,Audit Log Path Not Set,Kubernetes,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_log_path_not_set,kubernetes-queries,"When using kube-apiserver command, the 'audit-log-path' flag should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-path=path/to/log""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-log-path=path/to/log""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""""]
  restartPolicy: OnFailure

apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
      - name: command-demo-container
        image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
        command: [""kube-apiserver""]
        args: []
    restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: []
      restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Revision
metadata:
  name: dummy-rev
  namespace: knative-sequence
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure
---
apiVersion: sources.knative.dev/v1
kind: ContainerSource
metadata:
  name: dummy-cs
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: []
      restartPolicy: OnFailure","[[11], [40, 27, 12, 55]]"
735,768aab52-2504-4a2f-a3e3-329d5a679848,Audit Log Maxbackup Not Properly Set,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_log_maxbackup_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--audit-log-maxbackup' flag should be defined and set to 10 or more files<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxbackup=10""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-log-maxbackup=15""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxbackup=5""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
      - name: command-demo-container
        image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
        command: [""kube-apiserver""]
        args: [""--audit-log-maxbackup=5""]
    restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: [""--audit-log-maxbackup=5""]
      restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Revision
metadata:
  name: dummy-rev
  namespace: knative-sequence
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxbackup=5""]
  restartPolicy: OnFailure
---
apiVersion: sources.knative.dev/v1
kind: ContainerSource
metadata:
  name: dummy-cs
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: [""--audit-log-maxbackup=5""]
      restartPolicy: OnFailure","[[11], [11], [40, 27, 12, 55]]"
736,7c81d34c-8e5a-402b-9798-9f442630e678,Image Without Digest,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/image_without_digest,kubernetes-queries,"Images should be specified together with their digests to ensure integrity<br>
[Documentation](https://kubernetes.io/docs/concepts/containers/images/#updating-images)","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-1
spec:
  containers:
    - name: uses-private-image
      image: image@sha256:45b23dee08af5e43a7fea6c4cf9c25ccf269ee113168c19722f87876677c5cb
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-1
spec:
  containers:
    - name: uses-private-image
      image: $PRIVATE_IMAGE_NAME
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]",[[8]]
737,80f93444-b240-4ebb-a4c6-5c40b76c04ea,PSP Allows Sharing Host IPC,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_allows_sharing_host_ipc,kubernetes-queries,"Pod Security Policy allows containers to share the host IPC namespace<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: false
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: true
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny",[[6]]
738,8320826e-7a9c-4b0b-9535-578333193432,RBAC Roles Allow Privilege Escalation,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/288.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_allow_privilege_escalation,kubernetes-queries,"Roles or ClusterRoles with RBAC permissions 'bind' or 'escalate' allow subjects to create new bindings with other roles. This is dangerous, as users with these privileges can bind to roles that may exceed their own privileges<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#restrictions-on-role-binding-creation-or-update)","apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: not-rbac-binder
rules:
- apiGroups: [""rbac.authorization.k8s.io""]
  resources: [""clusterrolebindings""]
  verbs: [""create""]","apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: rbac-binder
rules:
- apiGroups: [""rbac.authorization.k8s.io""]
  resources: [""clusterroles""]
  verbs: [""bind""]
- apiGroups: [""rbac.authorization.k8s.io""]
  resources: [""clusterrolebindings""]
  verbs: [""create""]",[[8]]
739,845acfbe-3e10-4b8e-b656-3b404d36dfb2,Service Type is NodePort,Kubernetes,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_type_is_nodeport,kubernetes-queries,"Service type should not be NodePort<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/service/)","apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  selector:
    app: MyApp
  ports:
    - protocol: TCP
      port: 80
      targetPort: 9376
  clusterIP: 10.0.171.239
  type: LoadBalancer
status:
  loadBalancer:
    ingress:
    - ip: 192.0.2.127","apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  type: NodePort
  selector:
    app: MyApp
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30007",[[6]]
740,85ab1c5b-014e-4352-b5f8-d7dea3bb4fd3,Network Policy Is Not Targeting Any Pod,Kubernetes,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/network_policy_is_not_targeting_any_pod,kubernetes-queries,"Check if any network policy is not targeting any pod.<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/network-policies/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: test-network-policy
  namespace: default
spec:
  podSelector:
    matchLabels:
      app: nginx
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - ipBlock:
        cidr: 172.17.0.0/16
        except:
        - 172.17.1.0/24
    - namespaceSelector:
        matchLabels:
          project: myproject
    - podSelector:
        matchLabels:
          role: frontend
    ports:
    - protocol: TCP
      port: 6379
  egress:
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
    ports:
    - protocol: TCP
      port: 5978","apiVersion: v1
kind: Pod
metadata:
  name: nopolicy
  labels:
    app: easy
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
    ports:
    - containerPort: 80
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: test-network-policy
  namespace: default
spec:
  podSelector:
    matchLabels:
      app: rarelabel
  policyTypes:
  - Ingress
  ingress:
  - from:
    - ipBlock:
        cidr: 172.17.0.0/16
        except:
        - 172.17.1.0/24
    - namespaceSelector:
        matchLabels:
          project: myproject
    - podSelector:
        matchLabels:
          role: frontend
    ports:
    - protocol: TCP
      port: 6379
  egress:
  - to:
    - ipBlock:
        cidr: 10.0.0.0/24
    ports:
    - protocol: TCP
      port: 5978
---
apiVersion: v1
kind: Pod
metadata:
  name: partialpolicy
  labels:
    app: easy
spec:
  containers:
  - name: nginx
    image: nginx:1.14.2
    ports:
    - containerPort: 80",[[22]]
741,87554eef-154d-411d-bdce-9dbd91e56851,PSP Allows Privilege Escalation,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_allows_privilege_escalation,kubernetes-queries,"PodSecurityPolicy should not allow privilege escalation<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: false
  volumes:
  - '*'
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'

---
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged2
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","[[32, 9]]"
742,895a5a95-3756-4b04-9924-2f3bc93181bd,Etcd TLS Certificate Not Properly Configured,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_tls_certificate_not_properly_configured,kubernetes-queries,"When using kube-apiserver commands, the '--etcd-certfile' and '--etcd-keyfile' flags should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--etcd-keyfile=/path/to/key/file.key"",""--etcd-certfile=/path/to/cert/file.crt""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--etcd-keyfile=/path/to/key/file.key"",""--etcd-certfile=/path/to/cert/file.crt""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--etcd-keyfile=/path/to/key/file.key""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--etcd-certfile=/path/to/cert/file.crt""]
  restartPolicy: OnFailure","[[11], [11]]"
743,8b36775e-183d-4d46-b0f7-96a6f34a723f,Missing AppArmor Profile,Kubernetes,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/missing_app_armor_config,kubernetes-queries,"Containers should be configured with an AppArmor profile to enforce fine-grained access control over low-level system resources<br>
[Documentation](https://kubernetes.io/docs/tutorials/clusters/apparmor/)","apiVersion: v1
kind: Pod
metadata:
  name: hello-apparmor-2positive
  annotations:
    container.apparmor.security.beta.kubernetes.io/hello: localhost/k8s-apparmor-example-allow-write
spec:
  containers:
  - name: hello
    image: busybox
    command: [ ""sh"", ""-c"", ""echo 'Hello AppArmor!' && sleep 1h"" ]","apiVersion: v1
kind: Pod
metadata:
  name: hello-apparmor-1
  annotations:
    container.apparmor.security.beta.kubernetes.io/hello1: dummy
    container.apparmor.security.beta.kubernetes.io/hello2: dummy
spec:
  containers:
  - name: hello1
    image: busybox
    command: [ ""sh"", ""-c"", ""echo 'Hello AppArmor!' && sleep 1h"" ]
  - name: hello2
    image: busybox
    command: [ ""sh"", ""-c"", ""echo 'Hello AppArmor!' && sleep 1h"" ]
  - name: hello3
    image: busybox
    command: [ ""sh"", ""-c"", ""echo 'Hello AppArmor!' && sleep 1h"" ]
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ubuntu-test1
  namespace: testns
  labels:
    deployment: ubuntu-1
spec:
  replicas: 1
  selector:
    matchLabels:
      container: ubuntu-1
  template:
    metadata:
      labels:
        container: ubuntu-1
      annotations:
        container.apparmor.security.beta.kubernetes.io/ubuntu-1-container: dummy
    spec:
      containers:
      - name: ubuntu-1-container
        image: 0x010/ubuntu-w-utils:latest","[[4, 5, 36]]"
744,8b862ca9-0fbd-4959-ad72-b6609bdaa22d,Tiller Service Is Not Deleted,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/tiller_service_is_not_deleted,kubernetes-queries,"Check if there is any Tiller Service present<br>
[Documentation](https://kubernetes.io/docs/concepts/services-networking/service)","apiVersion: v1
kind: Service
metadata:
  name: some-service
  labels:
    name: some-label
spec:
  ports:
    - protocol: TCP
      port: 80
      targetPort: 9376","apiVersion: v1
kind: Service
metadata:
  name: tiller-deploy
  labels:
    app: helm
    name: tiller
spec:
  type: ClusterIP
  selector:
    app: helm
    name: tiller
  ports:
  - name: tiller
    port: 44134
    protocol: TCP
    targetPort: tiller","[[4, 12]]"
745,8cf4671a-cf3d-46fc-8389-21e7405063a2,StatefulSet Requests Storage,Kubernetes,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/statefulset_requests_storage,kubernetes-queries,"A StatefulSet requests volume storage.<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/)","#this code is a correct code for which the query should not find any result
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web2
spec:
  serviceName: ""nginx""
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]","#this is a problematic code where the query should report a result(s)
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
spec:
  serviceName: ""nginx""
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      resources:
        requests:
          storage: 1Gi
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web2
spec:
  serviceName: ""nginx""
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      resources:
        requests:
          storage: 1Gi
  - metadata:
      name: www2
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      resources:
        requests:
          storage: 2Gi","[[73, 33, 66]]"
746,9127f0d9-2310-42e7-866f-5fd9d20dcbad,Cluster Allows Unsafe Sysctls,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cluster_allows_unsafe_sysctls,kubernetes-queries,"A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means 'spec.securityContext.sysctls' must not specify unsafe sysctls and the attribute 'allowedUnsafeSysctls' must be undefined.<br>
[Documentation](https://kubernetes.io/docs/tasks/administer-cluster/sysctl-cluster/)","#this code is a correct code for which the query should not find any result
apiVersion: v1
kind: Pod
metadata:
  name: sysctl-example
spec:
  securityContext:
    sysctls:
    - name: kernel.shm_rmid_forced
      value: ""0""
    - name: net.ipv4.ip_local_port_range
      value: ""0""
  containers:
    - name: test1
      image: nginx
---
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: sysctl-psp
spec:
  forbiddenSysctls:
  - kernel.shm_rmid_forced
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-app-neg
  labels:
    app: test-app-neg
spec:
  selector:
    matchLabels:
      app: test-app-neg
  template:
    metadata:
      labels:
        app: test-app-neg
    spec:
      securityContext:
        sysctls:
        - name: kernel.shm_rmid_forced
          value: ""0""
        - name: net/ipv4/tcp_syncookies
          value: ""1""
      containers:
      - name: test-ubuntu
        image: ubuntu","#this is a problematic code where the query should report a result(s)
apiVersion: v1
kind: Pod
metadata:
  name: sysctl-example
spec:
  securityContext:
    sysctls:
    - name: kernel.shm_rmid_forced
      value: ""0""
    - name: net.core.somaxconn
      value: ""1024""
    - name: kernel.msgmax
      value: ""65536""
  containers:
    - name: test1
      image: nginx
---
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: sysctl-psp
spec:
  allowedUnsafeSysctls:
  - kernel.msg*
  forbiddenSysctls:
  - kernel.shm_rmid_forced
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-app
  labels:
    app: test-app
spec:
  selector:
    matchLabels:
      app: test-app
  template:
    metadata:
      labels:
        app: test-app
    spec:
      securityContext:
        sysctls:
        - name: kernel.sem
          value: ""128 32768 128 4096""
      containers:
      - name: test-ubuntu
        image: ubuntu","[[24, 11, 13], [18]]"
747,91dacd0e-d189-4a9c-8272-5999a3cc32d9,PSP Allows Sharing Host PID,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_allows_sharing_host_pid,kubernetes-queries,"Pod Security Policy allows containers to share the host process ID namespace<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostPID: false
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostPID: true
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny",[[6]]
748,9391103a-d8d7-4671-ac5d-606ba7ccb0ac,Etcd Client Certificate Authentication Set To False,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_client_certificate_authentication_set_to_false,kubernetes-queries,"When using etcd commands, the '--client-cert-auth' flag should be defined<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--client-cert-auth=true""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--client-cert-auth=false""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","[[21], [21]]"
749,94b76ea5-e074-4ca2-8a03-c5a606e30645,Object Is Using A Deprecated API Version,Kubernetes,Low,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/object_is_using_a_deprecated_api_version,kubernetes-queries,"Kubernetes APIs evolve over time and are sometimes removed with newer releases. To prevent incompatibilities when upgrading Kubernetes, deprecated APIs should be replaced with newer and more stable API versions.<br>
[Documentation](https://kubernetes.io/docs/reference/using-api/deprecation-guide/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: optmount
              mountPath: /opt
      terminationGracePeriodSeconds: 30
      volumes:
        - name: optmount
          hostPath:
            path: /opt","apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80
---
apiVersion: apps/v1beta2
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: optmount
              mountPath: /opt
      terminationGracePeriodSeconds: 30
      volumes:
        - name: optmount
          hostPath:
            path: /opt
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: minimal-ingress
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /testpath
        pathType: Prefix
        backend:
          service:
            name: test
            port:
              number: 80
---
apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: minimal-ingress1
  annotations:
    nginx.ingress.kubernetes.io/rewrite-target: /
spec:
  rules:
  - http:
      paths:
      - path: /testpath
        pathType: Prefix
        backend:
          service:
            name: test
            port:
              number: 80
---
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""* * * * *""
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            imagePullPolicy: IfNotPresent
            command:
            - /bin/sh
            - -c
            - date; echo Hello from kics
          restartPolicy: OnFailure","[[1, 76, 23, 58, 94]]"
750,9587c890-0524-40c2-9ce2-663af7c2f063,Service Account Admission Control Plugin Disabled,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_admission_control_plugin_disabled,kubernetes-queries,"When using kube-apiserver command, the '--disable-admission-plugins' flag should not have 'ServiceAccount' plugin<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=ServiceAccount"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--disable-admission-plugins=ServiceAccount""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--disable-admission-plugins=ServiceAccount""]
      args: []
  restartPolicy: OnFailure","[[11], [11]]"
751,98ce8b81-7707-4734-aa39-627c6db3d84b,Auto TLS Set To True,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/auto_tls_set_to_true,kubernetes-queries,"When using etcd commands, the '--auto-tls' should be set to false<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd"", ""--auto-tls=false""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--auto-tls=true""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure",[[21]]
752,9f85c3f6-26fd-4007-938a-2e0cb0100980,RBAC Roles with Impersonate Permission,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_with_impersonate_permission,kubernetes-queries,"Roles or ClusterRoles with the permission 'impersonate' allow subjects to assume the rights of other users, groups, or service accounts. In case of compromise, attackers may abuse this sudo-like functionality to achieve privilege escalation<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/authentication/#user-impersonation)","apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: impersonator-role-neg
  namespace: default
rules:
- apiGroups: [""""]
  resources: [""users"", ""groups"", ""serviceaccounts""]
  verbs: [""get""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: rbac-impersonate-binding
subjects:
- kind: ServiceAccount
  name: impersonator-sa-neg
  namespace: default
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: impersonator-role-neg
  apiGroup: """"","apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: impersonator-role
  namespace: default
rules:
- apiGroups: [""""]
  resources: [""users"", ""groups"", ""serviceaccounts""]
  verbs: [""impersonate""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: rbac-impersonate-binding
subjects:
- kind: ServiceAccount
  name: impersonator-sa
  namespace: default
  apiGroup: """"
roleRef:
  kind: ClusterRole
  name: impersonator-role
  apiGroup: """"",[[9]]
753,a31b7b82-d994-48c4-bd21-3bab6c31827a,Deployment Has No PodAntiAffinity,Kubernetes,Low,Resource Management,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/deployment_has_no_pod_anti_affinity,kubernetes-queries,"Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node.<br>
[Documentation](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-server
spec:
  selector:
    matchLabels:
      app: web-store
  replicas: 3
  template:
    metadata:
      labels:
        app: web-store
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: app
                operator: In
                values:
                - web-store
            topologyKey: ""kubernetes.io/hostname""
      containers:
      - name: web-app
        image: nginx:1.16-alpine","apiVersion: apps/v1
kind: Deployment
metadata:
  name: label-mismatch
spec:
  selector:
    matchLabels:
      app: web-store
  replicas: 3
  template:
    metadata:
      labels:
        app: web-shore
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchLabels:
                app: web-store
            topologyKey: ""kubernetes.io/hostname""
      containers:
      - name: web-app
        image: nginx:1.16-alpine
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: no-affinity
spec:
  selector:
    matchLabels:
      app: web-store
  replicas: 3
  template:
    metadata:
      labels:
        app: web-store
    spec:
      containers:
      - name: web-app
        image: nginx:1.16-alpine","[[19, 39]]"
754,a33e9173-b674-4dfb-9d82-cf3754816e4b,PSP Allows Containers To Share The Host Network Namespace,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_containers_share_host_network_namespace,kubernetes-queries,"Check if Pod Security Policies allow containers to share the host network namespace.<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  allowedCapabilities:
  - '*'
  volumes:
  - '*'
  hostNetwork: false
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: privileged
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: '*'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  allowedCapabilities:
  - '*'
  volumes:
  - '*'
  hostNetwork: true
  hostPorts:
  - min: 0
    max: 65535
  hostIPC: true
  hostPID: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'",[[14]]
755,a5530bd7-225a-48f9-91bb-f40b04200165,Service Account Lookup Set To False,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_lookup_set_to_false,kubernetes-queries,"When using kube-apiserver command, the '--service-account-lookup' flag should be set to true<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--service-account-lookup=true""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--service-account-lookup=false""]
  restartPolicy: OnFailure",[[11]]
756,a659f3b5-9bf0-438a-bd9a-7d3a6427f1e3,Readiness Probe Is Not Configured,Kubernetes,Medium,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/readiness_probe_is_not_configured,kubernetes-queries,"Check if Readiness Probe is not configured.<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-readiness-probes)","apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: goproxy
spec:
  containers:
  - name: goproxy
    image: k8s.gcr.io/goproxy:0.1
    ports:
    - containerPort: 8080
    readinessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 5
      periodSeconds: 10
    livenessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 20","apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: goproxy
spec:
  containers:
  - name: goproxy
    image: k8s.gcr.io/goproxy:0.1
    ports:
    - containerPort: 8080
    livenessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 20",[[9]]
757,a6f34658-fdfb-4154-9536-56d516f65828,Docker Daemon Socket is Exposed to Containers,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/docker_daemon_socket_is_exposed_to_containers,kubernetes-queries,"Sees if Docker Daemon Socket is not exposed to Containers<br>
[Documentation](https://kubernetes.io/docs/concepts/storage/volumes/)","apiVersion: v1
kind: Pod
metadata:
  name: test-pd
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    volumeMounts:
    - mountPath: /test-pd
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /data
      type: Directory","apiVersion: v1
kind: Pod
metadata:
  name: test-pd
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    volumeMounts:
    - mountPath: /test-pd
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /var/run/docker.sock
      type: Directory

---

apiVersion: v1
kind: ReplicationController
metadata:
  name: node-manager
  labels:
    name: node-manager
spec:
    selector:
      name: node-manager
    template:
      metadata:
        labels:
          name: node-manager
      spec:
          containers:
          - image: k8s.gcr.io/test-webserver
            name: test-container
            volumeMounts:
            - mountPath: /test-pd
              name: test-volume
          volumes:
          - name: test-volume
            hostPath:
              path: /var/run/docker.sock
              type: Directory

---

apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""*/1 * * * *""
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - image: k8s.gcr.io/test-webserver
            name: test-container
            volumeMounts:
            - mountPath: /test-pd
              name: test-volume
          volumes:
          - name: test-volume
            hostPath:
              path: /var/run/docker.sock
              type: Directory","[[67, 43, 15]]"
758,a77f4d07-c6e0-4a48-8b35-0eeb51576f4f,Always Pull Images Admission Control Plugin Not Set,Kubernetes,Medium,Build Process,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/always_pull_images_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'AlwaysPullImages' plugin and the plugin should be correctly configured in AdmissionControl Config file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysPullImages"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=AlwaysPullImages"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
759,a97a340a-0063-418e-b3a1-3028941d0995,Pod or Container Without Security Context,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/pod_or_container_without_security_context,kubernetes-queries,"A security context defines privilege and access control settings for a Pod or Container<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  securityContext:
    runAsUser: 1000
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""","[[19, 5]]"
760,a9c2f49d-0671-4fc9-9ece-f4e261e128d0,Root Container Not Mounted Read-only,Kubernetes,Low,Build Process,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/root_container_not_mounted_as_read_only,kubernetes-queries,"Check if the root container filesystem is not being mounted as read-only.<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: goproxy
spec:
  containers:
  - name: goproxy
    image: k8s.gcr.io/goproxy:0.1
    securityContext:
      readOnlyRootFilesystem: true","apiVersion: v1
kind: Pod
metadata:
  name: rootfalse
  labels:
    app: goproxy
spec:
  containers:
  - name: contain1_1
    image: k8s.gcr.io/goproxy:0.1
    securityContext:
      readOnlyRootFilesystem: false
---
apiVersion: v1
kind: Pod
metadata:
  name: noroot
  labels:
    app: goproxy
spec:
  containers:
  - name: contain1_2
    image: k8s.gcr.io/goproxy:0.1
    securityContext:
      someotherthing: true","[[24, 12]]"
761,aa8f7a35-9923-4cad-bd61-a19b7f6aac91,Non Kube System Pod With Host Mount,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/non_kube_system_pod_with_host_mount,kubernetes-queries,"A non kube-system workload should not have hostPath mounted<br>
[Documentation](https://kubernetes.io/docs/concepts/storage/volumes/)","apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: kube-system
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: varlog
              mountPath: /var/log
            - name: varlibdockercontainers
              mountPath: /var/lib/docker/containers
              readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
        - name: varlog
          hostPath:
            path: /var/log
        - name: varlibdockercontainers
          hostPath:
            path: /var/lib/docker/containers
---
apiVersion: v1
kind: Pod
metadata:
  name: redis
  namespace: kube-system
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      hostPath:
        path: /var/redis/data
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: kube-system
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /var/local/static
            type: DirectoryOrCreate
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: pv-001
  namespace: kube-system
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: ""/sys""","apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd-elasticsearch
  namespace: logs
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd-elasticsearch
  template:
    metadata:
      labels:
        name: fluentd-elasticsearch
    spec:
      tolerations:
        - key: node-role.kubernetes.io/master
          effect: NoSchedule
      containers:
        - name: fluentd-elasticsearch
          image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2
          resources:
            limits:
              cpu: 500m
              memory: 200Mi
            requests:
              cpu: 100m
              memory: 200Mi
          volumeMounts:
            - name: varlog
              mountPath: /var/log
            - name: varlibdockercontainers
              mountPath: /var/lib/docker/containers
              readOnly: true
      terminationGracePeriodSeconds: 30
      volumes:
        - name: varlog
          hostPath:
            path: /var/log
        - name: varlibdockercontainers
          hostPath:
            path: /var/lib/docker/containers
---
apiVersion: v1
kind: Pod
metadata:
  name: redis
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      hostPath:
        path: /var/redis/data
---
apiVersion: v1
kind: Pod
metadata:
  name: redis-memcache
  namespace: memcache
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      hostPath:
        path: /var/redis/data
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  namespace: default
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /var/local/static
            type: DirectoryOrCreate
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment-undefined-ns
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: nginx:1.14.2
          ports:
            - containerPort: 80
          volumeMounts:
            - name: static-page-dir
              mountPath: /var/www/app/static
      volumes:
        - name: static-page-dir
          hostPath:
            path: /var/local/static
            type: DirectoryOrCreate
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: pv-001
  namespace: default
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: ""/""
---
kind: PersistentVolume
apiVersion: v1
metadata:
  name: pv-002
  labels:
    type: local
spec:
  storageClassName: manual
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: ""/boot""
---
apiVersion: serving.knative.dev/v1
kind: Revision
metadata:
  name: dummy-rev
  namespace: knative-sequence
spec:
  containers:
    - name: redis
      image: redis
      volumeMounts:
        - name: redis-storage
          mountPath: /data/redis
  volumes:
    - name: redis-storage
      hostPath:
        path: /var/redis/data","[[185, 40, 136, 106, 43, 76, 168, 153, 59]]"
762,ade74944-a674-4e00-859e-c6eab5bde441,Liveness Probe Is Not Defined,Kubernetes,Info,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/liveness_probe_is_not_defined,kubernetes-queries,"In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#when-should-you-use-a-liveness-probe)","apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-exec
spec:
  containers:
  - name: liveness
    image: k8s.gcr.io/busybox
    args:
    - /bin/sh
    - -c
    - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600
    livenessProbe:
      exec:
        command:
        - cat
        - /tmp/healthy
      initialDelaySeconds: 5
      periodSeconds: 5

---

apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""*/1 * * * *""
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: hello
            image: busybox
            imagePullPolicy: IfNotPresent
            args:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-exec
spec:
  containers:
  - name: liveness
    image: k8s.gcr.io/busybox
    args:
    - /bin/sh
    - -c
    - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600",[[9]]
763,ae8827e2-4af9-4baa-9998-87539ae0d6f0,Peer Auto TLS Set To True,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/peer_auto_tls_set_to_true,kubernetes-queries,"When using etcd commands, the '--peer-auto-tls' should be set to false<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd"", ""--peer-auto-tls=false""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-auto-tls=true""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure",[[21]]
764,afa36afb-39fe-4d94-b9b6-afb236f7a03d,Pod Security Policy Admission Control Plugin Not Set,Kubernetes,High,Build Process,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/pod_security_policy_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the '--enable-admission-plugins' flag should have 'PodSecurityPolicy' plugin and the plugin should be correctly configured in AdmissionControl Config file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=PodSecurityPolicy"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=PodSecurityPolicy"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
765,b14d1bc4-a208-45db-92f0-e21f8e2588e9,Memory Limits Not Defined,Kubernetes,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/memory_limits_not_defined,kubernetes-queries,"Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/assign-memory-resource/)","apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-negative
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    resources:
      limits:
        memory: ""200Mi""
      requests:
        memory: ""100Mi""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-deployment-neg
  labels:
    app: test-neg
spec:
  replicas: 3
  selector:
    matchLabels:
      app: test-neg
  template:
    metadata:
      labels:
        app: test-neg
    spec:
      containers:
        - name:  pause
          image: k8s.gcr.io/pause
          resources:
            limits:
              cpu: 0.5
              memory: 512Mi
            requests:
              cpu: 0.5
              memory: 512Mi","apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-1
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    resources:
      requests:
        cpu: ""0.5""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-2
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    resources:
      requests:
        cpu: ""0.5""
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-3
  namespace: mem-example
spec:
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    command: [""stress""]
    args: [""--vm"", ""1"", ""--vm-bytes"", ""150M"", ""--vm-hang"", ""1""]
---
apiVersion: v1
kind: Pod
metadata:
  name: memory-demo-4
  namespace: mem-example
spec:
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
  - name: memory-demo-ctr
    image: polinux/stress
    command: [""stress""]

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-deployment
  labels:
    app: test
spec:
  replicas: 3
  selector:
    matchLabels:
      app: test
  template:
    metadata:
      labels:
        app: test
    spec:
      containers:
        - name:  pause
          image: k8s.gcr.io/pause
          resources:
            limits:
              cpu: 1
            requests:
              cpu: 0.5
              memory: 512Mi","[[8, 57, 38, 23], [21]]"
766,b23e9b98-0cb6-4fc9-b257-1f3270442678,Deployment Without PodDisruptionBudget,Kubernetes,Low,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/deployment_without_pod_disruption_budget,kubernetes-queries,"Deployments should be assigned with a PodDisruptionBudget to ensure high availability<br>
[Documentation](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)","apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  name: nginx-pdb
spec:
  minAvailable: 2
  selector:
    matchLabels:
      app: nginx32
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx32
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80","apiVersion: policy/v1beta1
kind: PodDisruptionBudget
metadata:
  name: nginx-pdb
spec:
  minAvailable: 2
  selector:
    matchLabels:
      app: xpto
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
  labels:
    app: nginx
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:1.14.2
        ports:
        - containerPort: 80",[[20]]
767,b7652612-de4e-4466-a0bf-1cd81f0c6063,Volume Mount With OS Directory Write Permissions,Kubernetes,High,Resource Management,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/volume_mount_with_os_directory_write_permissions,kubernetes-queries,"Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries.<br>
[Documentation](https://kubernetes.io/docs/concepts/storage/volumes/)","apiVersion: v1
kind: Pod
metadata:
  name: pod-0
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: pod-0
    volumeMounts:
    - mountPath: /bin
      name: vol-0
      readOnly: true
      recursiveReadOnly: Enabled
  volumes:
  - name: vol-0
    scaleIO:
      gateway: https://localhost:443/api
      system: scaleio
      protectionDomain: sd0
      storagePool: sp1
      volumeName: vol-0
      secretRef:
        name: sio-secret
      fsType: xfs

---
apiVersion: v1
kind: Pod
metadata:
  name: pod-1
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: pod-0
    volumeMounts:
    - mountPath: /project-mount
      name: vol-0
  volumes:
  - name: vol-0
    scaleIO:
      gateway: https://localhost:443/api
      system: scaleio
      protectionDomain: sd0
      storagePool: sp1
      volumeName: vol-0
      secretRef:
        name: sio-secret
      fsType: xfs

---
apiVersion: v1
kind: Pod
metadata:
  name: pod-2
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: pod-0
    volumeMounts:
    - mountPath: /var/run
      name: vol-0
      readOnly: true
      recursiveReadOnly: Enabled
  volumes:
  - name: vol-0
    scaleIO:
      gateway: https://localhost:443/api
      system: scaleio
      protectionDomain: sd0
      storagePool: sp1
      volumeName: vol-0
      secretRef:
        name: sio-secret
      fsType: xfs

apiVersion: v1
kind: ConfigMap
metadata:
  name: log-config
data:
  log_level: ""INFO""
---
apiVersion: v1
kind: Pod
metadata:
  name: configmap-pod
spec:
  volumes:
    - name: config-vol
      configMap:
        name: log-config
        items:
          - key: log_level
            path: log_level.conf
  containers:
    - name: test
      image: busybox:1.28
      volumeMounts:
        - name: config-vol
          mountPath: /etc/config

apiVersion: v1
kind: Secret
metadata:
  name: my-secret
type: Opaque
data:
  password: cGFzc3dvcmQxMjM=  # base64 for ""password123""
---
apiVersion: v1
kind: Pod
metadata:
  name: secret-pod
spec:
  containers:
    - name: test
      image: busybox:1.28
      command: ['sh', '-c', 'echo ""Secret volume mounted"" && tail -f /dev/null']
      volumeMounts:
        - name: secret-vol
          mountPath: /etc/secret
  volumes:
    - name: secret-vol
      secret:
        secretName: my-secret","apiVersion: v1
kind: Pod
metadata:
  name: pod-0
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: pod-0
    volumeMounts:
    - mountPath: /bin
      name: vol-0
    - mountPath: /var
      name: vol-1
      recursiveReadOnly: Disabled
  volumes:
  - name: vol-0
    scaleIO:
      gateway: https://localhost:443/api
      system: scaleio
      protectionDomain: sd0
      storagePool: sp1
      volumeName: vol-0
      secretRef:
        name: sio-secret
      fsType: xfs
---
apiVersion: v1
kind: Pod
metadata:
  name: pod-1
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: pod-1
    volumeMounts:
    - mountPath: /var
      name: vol-0
      recursiveReadOnly: Enabled
    - mountPath: /bin
      name: vol-1
      readOnly: false
  volumes:
  - name: vol-0
    scaleIO:
      gateway: https://localhost:443/api
      system: scaleio
      protectionDomain: sd0
      storagePool: sp1
      volumeName: vol-0
      secretRef:
        name: sio-secret
      fsType: xfs

apiVersion: v1
kind: Pod
metadata:
  name: pod-0
spec:
  containers:
    - name: pod-0
      image: k8s.gcr.io/test-webserver
      volumeMounts:
        - mountPath: /bin
          name: vol-0
          readOnly: false
          recursiveReadOnly: Disabled
        - mountPath: /var
          name: vol-1
          readOnly: false
          recursiveReadOnly: Enabled
  volumes:
    - name: vol-0
      emptyDir: {}
    - name: vol-1
      emptyDir: {}
---
apiVersion: v1
kind: Pod
metadata:
  name: pod-1
spec:
  containers:
    - name: pod-1
      image: k8s.gcr.io/test-webserver
      volumeMounts:
        - mountPath: /var
          name: vol-0
          readOnly: true
        - mountPath: /bin
          name: vol-1
          readOnly: true
          recursiveReadOnly: Disabled
  volumes:
    - name: vol-0
      emptyDir: {}
    - name: vol-1
      emptyDir: {}","[[37, 40, 11, 13], [34, 11, 37, 15]]"
768,b7bca5c4-1dab-4c2c-8cbe-3050b9d59b14,RBAC Roles with Read Secrets Permissions,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_with_read_secrets_permissions,kubernetes-queries,"Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: default
  name: role-pod-and-logs-reader
rules:
- apiGroups: [""""]
  resources: [""pods"", ""pods/logs""]
  verbs: [""get"", ""watch"", ""list""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cluster-role-pod-and-pod-logs-reader
rules:
- apiGroups: [""""]
  resources: [""pods"", ""pods/log""]
  verbs: [""get"", ""list""]","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: default
  name: role-secret-reader
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: cluster-role-secret-reader
rules:
- apiGroups: [""""]
  resources: [""secrets""]
  verbs: [""get"", ""watch"", ""list""]","[[9, 18]]"
769,b7d0181d-0a9b-4611-9d1c-1ad4f0b620ff,Etcd Peer Client Certificate Authentication Set To False,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/etcd_peer_client_certificate_authentication_set_to_false,kubernetes-queries,"When using etcd commands, the '--peer-client-cert-auth' flag should be set to true<br>
[Documentation](https://etcd.io/docs/v3.4/op-guide/security/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-client-cert-auth=true""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--peer-client-cert-auth=false""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-etcd-deployment
spec:
  selector:
    matchLabels:
      app: app
  replicas: 1
  template:
    metadata:
      labels:
        app: app
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/etcd:v3.2.18
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: []
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","[[21], [21]]"
770,b9380fd3-5ffe-4d10-9290-13e18e71eee1,Insecure Bind Address Set,Kubernetes,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/insecure_bind_address_set,kubernetes-queries,"When using kube-apiserver command, the '--insecure-bind-address' flag should not be set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--insecure-bind-address=127.0.0.1""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--insecure-bind-address=127.0.0.1""]
  restartPolicy: OnFailure","[[11], [11]]"
771,b9c83569-459b-4110-8f79-6305aa33cb37,Using Kubernetes Native Secret Management,Kubernetes,Info,Secret Management,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/using_kubernetes_native_secret_management,kubernetes-queries,"Kubernetes External Secret Storage and Management System usage should be considered if you have more complex secret management needs, rather than using Kubernetes Secrets directly. Additionally, ensure that access to secrets is carefully limited<br>
[Documentation](https://kubernetes.io/docs/concepts/configuration/secret/)","apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-kvname
  namespace: myNameSpace
spec:
  provider: azure
  parameters:
    usePodIdentity: ""true""              
    keyvaultName: ""<key Vault Name>""               
    objects:  |
      array:
        - |
          objectName: secret1          
          objectType: secret                                      
        - |
          objectName: key1               
          objectType: key
    tenantId: ""<tenant ID which the Key Vault sits under""            
  secretObjects:                             
  - secretName: appsecrets   
    data:
    - key: secret1                          
      objectName: secret1                                        
    type: Opaque

apiVersion: v1
kind: Secret
metadata:
  name: cluster-secrets
data:
  # Fill with your encoded base64 CA
  certificate-authority-data: Cg==
stringData:
  # Fill with your string Token
  bearerToken: ""my-token""
---
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-kvname
  namespace: myNameSpace
spec:
  provider: azure
  parameters:
    usePodIdentity: ""true""              
    keyvaultName: ""<key Vault Name>""               
    objects:  
      array:
        - {objectName: secret1, objectType: secret}
        - {objectName: key1 , objectType: key}                                      
    tenantId: ""<tenant ID which the Key Vault sits under""            
  secretObjects:                             
  - secretName: appsecrets   
    data:
    - key: secret1                          
      objectName: secret1                                        
    type: Opaque","apiVersion: v1
kind: Secret
metadata:
  name: cluster-secrets
data:
  # Fill with your encoded base64 CA
  certificate-authority-data: Cg==
stringData:
  # Fill with your string Token
  bearerToken: ""my-token""",[[4]]
772,bb241e61-77c3-4b97-9575-c0f8a1e008d0,StatefulSet Without Service Name,Kubernetes,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/statefulset_without_service_name,kubernetes-queries,"StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels.<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/)","#this is a problematic code where the query should report a result(s)
apiVersion: v1
kind: Service
metadata:
  name: nginx2
  namespace: nginx2
  labels:
    app: nginx2
spec:
  ports:
  - port: 80
    name: web
  clusterIP: None
  selector:
    app: nginx2
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web2
  namespace: nginx2
spec:
  selector:
    matchLabels:
      app: nginx2
  serviceName: ""nginx2""
  replicas: 3
  template:
    metadata:
      labels:
        app: nginx2
        foo: bar
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx2
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi","#this is a problematic code where the query should report a result(s)
apiVersion: v1
kind: Service
metadata:
  name: nginx
  namespace: nginx
  labels:
    app: nginx2
spec:
  ports:
  - port: 80
    name: web
  clusterIP: All
  selector:
    app: nginx
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: web
  namespace: nginx
spec:
  selector:
    matchLabels:
      app: nginx
  serviceName: ""nginx""
  replicas: 3
  template:
    metadata:
      labels:
        app: nginx
    spec:
      terminationGracePeriodSeconds: 10
      containers:
      - name: nginx
        image: k8s.gcr.io/nginx-slim:0.8
        ports:
        - containerPort: 80
          name: web
        volumeMounts:
        - name: www
          mountPath: /usr/share/nginx/html
  volumeClaimTemplates:
  - metadata:
      name: www
    spec:
      accessModes: [ ""ReadWriteOnce"" ]
      storageClassName: ""my-storage-class""
      resources:
        requests:
          storage: 1Gi",[[26]]
773,bf36b900-b5ef-4828-adb7-70eb543b7cfb,Kubelet Hostname Override Is Set,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_hostname_override_is_set,kubernetes-queries,"Hostnames should not be overrided<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--hostname-override=host""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet"",""--hostname-override=host""]
      args: []
  restartPolicy: OnFailure","[[11], [11]]"
774,c1032cf7-3628-44e2-bd53-38c17cf31b6b,Shared Service Account,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/shared_service_account,kubernetes-queries,"A Service Account token is shared between workloads<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/)","apiVersion: v1
kind: Pod
metadata:
  name: pod1
spec:
  serviceAccountName : service1
  containers:
  - name: mycontainer
    image: redis
---
apiVersion: v1
kind: Pod
metadata:
  name: pod2
spec:
  serviceAccountName : service2
  containers:
  - name: envars-test-container
    image: nginx","apiVersion: v1
kind: Pod
metadata:
  name: pod1
spec:
  serviceAccountName : service1
  containers:
  - name: mycontainer
    image: redis
---
apiVersion: v1
kind: Pod
metadata:
  name: pod2
spec:
  serviceAccountName : service1
  containers:
  - name: envars-test-container
    image: nginx","[[16, 6]]"
775,c48e57d3-d642-4e0b-90db-37f807b41b91,PSP Set To Privileged,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_set_to_privileged,kubernetes-queries,"Do not allow pod to request execution as privileged.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#privileged)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  privileged: false
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny
  volumes:
  - '*'","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  privileged: true 
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny
  volumes:
  - '*'",[[6]]
776,c589f42c-7924-4871-aee2-1cede9bc7cbc,RBAC Roles with Exec Permission,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_with_exec_permission,kubernetes-queries,"Roles or ClusterRoles with RBAC permissions to run commands in containers via 'kubectl exec' could be abused by attackers to execute malicious code in case of compromise. To prevent this, the 'pods/exec' verb should not be used in production environments<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-exec-neg
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-exec-neg
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-exec-neg
  apiGroup: """"","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-exec
rules:
- apiGroups: [""""]
  resources: [""pods"", ""pods/exec""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-exec
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-exec
  apiGroup: """"",[[8]]
777,ca469dd4-c736-448f-8ac1-30a642705e0a,CPU Requests Not Set,Kubernetes,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/cpu_requests_not_set,kubernetes-queries,"CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node<br>
[Documentation](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#)","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
    - name: app
      image: images.my-company.example/app:v4
      resources:
        requests:
          memory: ""64Mi""
          cpu: ""250m""
        limits:
          memory: ""128Mi""
          cpu: ""500m""
    - name: log-aggregator
      image: images.my-company.example/log-aggregator:v6
      resources:
        requests:
          memory: ""64Mi""
          cpu: ""250m""
        limits:
          memory: ""128Mi""
          cpu: ""500m""
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""
            limits:
              memory: ""128Mi""
              cpu: ""500m""
        - name: log-aggregator
          image: images.my-company.example/log-aggregator:v6
          resources:
            requests:
              memory: ""64Mi""
              cpu: ""250m""
            limits:
              memory: ""128Mi""
              cpu: ""500m""","apiVersion: v1
kind: Pod
metadata:
  name: frontend
spec:
  containers:
    - name: app
      image: images.my-company.example/app:v4
      resources:
        requests:
          memory: ""64Mi""
        limits:
          memory: ""128Mi""
          cpu: ""500m""
    - name: log-aggregator
      image: images.my-company.example/log-aggregator:v6
      resources:
        limits:
          memory: ""128Mi""
          cpu: ""500m""
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: app
          image: images.my-company.example/app:v4
          resources:
            requests:
              memory: ""64Mi""
            limits:
              memory: ""128Mi""
              cpu: ""500m""
        - name: log-aggregator
          image: images.my-company.example/log-aggregator:v6
          resources:
            limits:
              memory: ""128Mi""
              cpu: ""500m""","[[17, 10, 34, 41]]"
778,caa3479d-885d-4882-9aac-95e5e78ef5c2,Image Pull Policy Of The Container Is Not Set To Always,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/image_pull_policy_of_container_is_not_always,kubernetes-queries,"Image Pull Policy of the container must be defined and set to Always<br>
[Documentation](https://kubernetes.io/docs/concepts/containers/images/#updating-images)","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-1
spec:
  containers:
    - name: uses-private-image
      image: $PRIVATE_IMAGE_NAME
      imagePullPolicy: Always
      command: [ ""echo"", ""SUCCESS"" ]","apiVersion: v1
kind: Pod
metadata:
  name: private-image-test-always
spec:
  containers:
    - name: uses-private-image
      image: $PRIVATE_IMAGE_NAME:1.2
      imagePullPolicy: Never
      command: [ ""echo"", ""SUCCESS"" ]

apiVersion: apps/v1
kind: Deployment
metadata:
  name: deployment-with-image-pull-policy
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: library/nginx:1.20.0
          imagePullPolicy: IfNotPresent

apiVersion: apps/v1
kind: Deployment
metadata:
  name: deployment-with-image-pull-policy1
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
        - name: nginx
          image: library/nginx:1.20.0","[[9], [18], [16]]"
779,caa93370-791f-4fc6-814b-ba6ce0cb4032,Not Limited Capabilities For Pod Security Policy,Kubernetes,Info,Insecure Configurations,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/not_limited_capabilities_for_pod_security_policy,kubernetes-queries,"Limit capabilities for a Pod Security Policy<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  # Required to prevent escalations to root.
  allowPrivilegeEscalation: false
  # This is redundant with non-root + disallow privilege escalation,
  # but we can provide it for defense in depth.
  requiredDropCapabilities:
    - ALL
  # Allow core volume types.
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    # Assume that persistentVolumes set up by the cluster admin are safe to use.
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    # Require the container to run without root privileges.
    rule: 'MustRunAsNonRoot'
  seLinux:
    # This policy assumes the nodes are using AppArmor rather than SELinux.
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  readOnlyRootFilesystem: false","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  # Required to prevent escalations to root.
  allowPrivilegeEscalation: false
  # Allow core volume types.
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    # Assume that persistentVolumes set up by the cluster admin are safe to use.
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    # Require the container to run without root privileges.
    rule: 'MustRunAsNonRoot'
  seLinux:
    # This policy assumes the nodes are using AppArmor rather than SELinux.
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  readOnlyRootFilesystem: false",[[10]]
780,cb7e695d-6a85-495c-b15f-23aed2519303,Not Unique Certificate Authority,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/not_unique_certificate_authority,kubernetes-queries,"Certificate Authority should be unique for etcd<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--client-ca-file=/etc/env/valid.pem""]
  restartPolicy: OnFailure
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: database
spec:
  selector:
    matchLabels:
      app: database
      version: v1
  replicas: 1
  template:
    metadata:
      labels:
        app: database
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/kube-apiserver:certification
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--trusted-ca-file=/etc/env/valid2.pem""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure","apiVersion: apps/v1
kind: Deployment
metadata:
  name: database
spec:
  selector:
    matchLabels:
      app: database
      version: v1
  replicas: 1
  template:
    metadata:
      labels:
        app: database
        version: v1
    spec:
      serviceAccountName: database
      containers:
      - name: database
        image: gcr.io/google_containers/kube-apiserver:certification
        imagePullPolicy: IfNotPresent
        command: [""etcd""]
        args: [""--trusted-ca-file=/etc/env/valid3.pem""]
      nodeSelector:
        kubernetes.io/hostname: worker02  
    restartPolicy: OnFailure
---
apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--client-ca-file=/etc/env/valid3.pem""]
  restartPolicy: OnFailure",[[22]]
781,cbd2db69-0b21-4c14-8a40-7710a50571a9,Encryption Provider Config Is Not Defined,Kubernetes,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/encryption_provider_config_is_not_defined,kubernetes-queries,"When using kube-apiserver commands, the '--encryption-provider-config' flag should be defined and the encryption should be correctly configured in Encryption Configuration file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--encryption-provider-config=/path/to/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--encryption-provider-config=/path/to/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure",[[11]]
782,ccc98ff7-68a7-436e-9218-185cb0b0b780,Service Account Private Key File Not Defined,Kubernetes,Medium,Encryption,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_private_key_file_not_defined,kubernetes-queries,"When using kube-controller-manager commands, the '--service-account-private-key-file' should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: [""--service-account-private-key-file=/path/to/key/file.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager"",""--service-account-private-key-file=/path/to/key/file.pem""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      command: [""kube-controller-manager""]
      args: []
  restartPolicy: OnFailure",[[11]]
783,cd290efd-6c82-4e9d-a698-be12ae31d536,Shared Host IPC Namespace,Kubernetes,Medium,Resource Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/shared_host_ipc_namespace,kubernetes-queries,"Container should not share the host IPC namespace<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  hostIPC: false
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostIPC: false      
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo
spec:
  hostIPC: true
  securityContext:
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
  volumes:
    - name: sec-ctx-vol
      emptyDir: { }
  containers:
    - name: sec-ctx-demo
      image: busybox
      command: [ ""sh"", ""-c"", ""sleep 1h"" ]
      volumeMounts:
        - name: sec-ctx-vol
          mountPath: /data/demo
      securityContext:
        allowPrivilegeEscalation: false

apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      hostIPC: true
      securityContext:
        runAsUser: 1000
        runAsGroup: 3000
        fsGroup: 2000
      volumes:
        - name: sec-ctx-vol
          emptyDir: { }
      containers:
        - name: sec-ctx-demo
          image: busybox
          command: [ ""sh"", ""-c"", ""sleep 1h"" ]
          volumeMounts:
            - name: sec-ctx-vol
              mountPath: /data/demo
          securityContext:
            allowPrivilegeEscalation: false","[[6], [9]]"
784,cdc8b54e-6b16-4538-a1b0-35849dbe29cf,Kubelet HTTPS Set To False,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_https_set_to_false,kubernetes-queries,"When using kube-apiserver command, the '--kubelet-https' flag should not be set to false<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-https=true""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-https=false""]
  restartPolicy: OnFailure",[[11]]
785,ce30e584-b33f-4c7d-b418-a3d7027f8f60,Always Admit Admission Control Plugin Set,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/always_admit_admission_control_plugin_set,kubernetes-queries,"When using kube-apiserver command, the '--enable-admission-plugins' flag should not have 'AlwaysAdmit' plugin<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=EventRateLimit"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure",[[11]]
786,cf34805e-3872-4c08-bf92-6ff7bb0cfadb,Container Running As Root,Kubernetes,Medium,Best Practices,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/containers_running_as_root,kubernetes-queries,"Containers should only run as non-root user. This limits the exploitability of security misconfigurations and restricts an attacker's possibilities in case of compromise<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 10000
    runAsNonRoot: true
  containers:
  - name: sec-ctx-demo-2
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 10100
      allowPrivilegeEscalation: false
      runAsNonRoot: true

apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-1
spec:
  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
  containers:
  - name: sec-ctx-demo-100
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 1000
      runAsNonRoot: false
  - name: sec-ctx-demo-200
    image: gcr.io/google-samples/node-hedwfwllo:1.0
    securityContext:
      runAsUser: 2000
      runAsNonRoot: true

apiVersion: v1
kind: Pod
metadata:
  name: containers-runs-as-root
spec:
  securityContext:
    runAsUser: 0
    runAsNonRoot: false
  containers:
  - name: sec-ctx-demo-100
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 1000
      runAsNonRoot: false","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 1000
    runAsNonRoot: false
  containers:
  - name: sec-ctx-demo-2
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 0
      allowPrivilegeEscalation: false
      runAsNonRoot: false
---
apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-3
spec:
  securityContext:
    runAsUser: 1000
    runAsNonRoot: false
  containers:
  - name: sec-ctx-demo-2
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      allowPrivilegeEscalation: false
      runAsNonRoot: false
---
apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-4
spec:
  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
  containers:
  - name: sec-ctx-demo-2
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 0
      allowPrivilegeEscalation: false
      runAsNonRoot: false

apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-2
spec:
  securityContext:
    runAsUser: 10
    runAsNonRoot: false
  containers:
  - name: sec-ctx-demo-100
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 0
      runAsNonRoot: false
  - name: sec-ctx-demo-200
    image: gcr.io/google-samples/node-hedwfwllo:1.0
    securityContext:
      runAsUser: 0
      runAsNonRoot: false

apiVersion: v1
kind: Pod
metadata:
  name: containers-runs-as-root
spec:
  securityContext:
    runAsUser: 0
    runAsNonRoot: false
  containers:
  - name: sec-ctx-demo-100
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      runAsUser: 0
      runAsNonRoot: false","[[44, 13, 38], [18, 13], [13]]"
787,d2ad057f-0928-41ef-a83c-f59203bb855b,Dashboard Is Enabled,Kubernetes,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/dashboard_is_enabled,kubernetes-queries,"If not needed, disabling the dashboard can prevent from being used as an attack vector<br>
[Documentation](https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/)","apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/name: mysql
  name: kubernetes-dashboard-certs
  namespace: kube-system
type: Opaque","kind: Deployment
apiVersion: apps/v1
metadata:
  labels:
    k8s-app: kubernetes-dashboard
  name: kubernetes-dashboard-1
  namespace: kube-system
spec:
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      k8s-app: kubernetes-dashboard
  template:
    metadata:
      labels:
        k8s-app: kubernetes-dashboard
    spec:
      containers:
      - name: kubernetes-dashboard
        image: k8s.gcr.io/kubernetes-dashboard-amd64:v1.10.1
        ports:
        - containerPort: 8443
          protocol: TCP
        args:
          - --auto-generate-certificates
        volumeMounts:
        - name: kubernetes-dashboard-certs
          mountPath: /certs
        - mountPath: /tmp
          name: tmp-volume
        livenessProbe:
          httpGet:
            scheme: HTTPS
            path: /
            port: 8443
          initialDelaySeconds: 30
          timeoutSeconds: 30
      volumes:
      - name: kubernetes-dashboard-certs
        secret:
          secretName: kubernetes-dashboard-certs
      - name: tmp-volume
        emptyDir: {}
      serviceAccountName: kubernetes-dashboard
      # Comment the following tolerations if Dashboard must not be deployed on master
      tolerations:
      - key: node-role.kubernetes.io/master
        effect: NoSchedule

---

apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app: myapp
spec:
  containers:
  - name: myapp-container
    image: busybox:1.28
    command: ['sh', '-c', 'echo The app is running! && sleep 3600']
  initContainers:
  - name: init-myservice
    image: k8s.gcr.io/kubernetesui:v1.10.1
    command: ['sh', '-c', ""until nslookup myservice.$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace).svc.cluster.local; do echo waiting for myservice; sleep 2; done""]
  - name: init-mydb
    image: busybox:1.28
    command: ['sh', '-c', ""until nslookup mydb.$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace).svc.cluster.local; do echo waiting for mydb; sleep 2; done""]","[[67, 22]]"
788,d45330fd-f58d-45fb-a682-6481477a0f84,RBAC Roles with Attach Permission,Kubernetes,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/rbac_roles_with_attach_permission,kubernetes-queries,"Roles or ClusterRoles with RBAC permissions to attach to containers via 'kubectl attach' could be abused by attackers to read log output (stdout, stderr) and send input data (stdin) to running processes. Additionally, it would allow a malicious user to attach to a privileged container resulting in a privilege escalation attack. To prevent this, the 'pods/attach' verb should not be used in production environments<br>
[Documentation](https://kubernetes.io/docs/reference/access-authn-authz/rbac/)","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-attach-neg
rules:
- apiGroups: [""""]
  resources: [""pods""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-attach-neg
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-attach-neg
  apiGroup: """"","apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: my-namespace
  name: allow-attach
rules:
- apiGroups: [""""]
  resources: [""pods"", ""pods/attach""]
  verbs: [""get"", ""list"", ""create""]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: allow-attach
  namespace: my-namespace
subjects:
- kind: User
  name: bob
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: allow-attach
  apiGroup: """"",[[8]]
789,d740d048-8ed3-49d3-b77b-6f072f3b669e,StatefulSet Has No PodAntiAffinity,Kubernetes,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/statefulset_has_no_pod_anti_affinity,kubernetes-queries,"Check if StatefulSet resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node.<br>
[Documentation](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/)","apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: zk
spec:
  selector:
    matchLabels:
      app: zk
  serviceName: zk-hs
  replicas: 3
  updateStrategy:
    type: RollingUpdate
  podManagementPolicy: OrderedReady
  template:
    metadata:
      labels:
        app: zk
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchLabels:
                  app: zk
              topologyKey: ""kubernetes.io/hostname""
      containers:
      - name: kubernetes-zookeeper
        imagePullPolicy: Always
        image: ""k8s.gcr.io/kubernetes-zookeeper:1.0-3.4.10""
        resources:
          requests:
            memory: ""1Gi""
            cpu: ""0.5""","apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: zk-mismatch
spec:
  selector:
    matchLabels:
      app: zk
  serviceName: zk-hs
  replicas: 3
  updateStrategy:
    type: RollingUpdate
  podManagementPolicy: OrderedReady
  template:
    metadata:
      labels:
        app: abc
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchLabels:
                  app: zk
              topologyKey: ""kubernetes.io/hostname""
      containers:
      - name: kubernetes-zookeeper
        imagePullPolicy: Always
        image: ""k8s.gcr.io/kubernetes-zookeeper:1.0-3.4.10""
        resources:
          requests:
            memory: ""1Gi""
            cpu: ""0.5""
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: zk-noaffinity
spec:
  selector:
    matchLabels:
      app: zk
  serviceName: zk-hs
  replicas: 3
  updateStrategy:
    type: RollingUpdate
  podManagementPolicy: OrderedReady
  template:
    metadata:
      labels:
        app: zk
    spec:
      affinity:
        podAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
          - labelSelector:
              matchExpressions:
              - key: app
                operator: In
                values:
                - store
            topologyKey: ""kubernetes.io/hostname""
      containers:
      - name: kubernetes-zookeeper
        imagePullPolicy: Always
        image: ""k8s.gcr.io/kubernetes-zookeeper:1.0-3.4.10""
        resources:
          requests:
            memory: ""1Gi""
            cpu: ""0.5""","[[53, 23]]"
790,d89a15bb-8dba-4c71-9529-bef6729b9c09,Request Timeout Not Properly Set,Kubernetes,Medium,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/request_timeout_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--request-timeout' flag value should not be too long<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--request-timeout=300s""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--request-timeout=6m""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--request-timeout=1h0s""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--request-timeout=6m10s""]
  restartPolicy: OnFailure","[[11], [11], [11]]"
791,da9f3aa8-fbfb-472f-b5a1-576127944218,Audit Log Maxage Not Properly Set,Kubernetes,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/audit_log_maxage_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--audit-log-maxage' flag should be defined and set to 30 or more days<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxage=30""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--audit-log-maxage=35""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--audit-log-maxage=26""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: dummy
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: []
      restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Configuration
metadata:
  name: dummy-config
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: []
      restartPolicy: OnFailure
---
apiVersion: serving.knative.dev/v1
kind: Revision
metadata:
  name: dummy-rev
  namespace: knative-sequence
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure
---
apiVersion: sources.knative.dev/v1
kind: ContainerSource
metadata:
  name: dummy-cs
  namespace: knative-sequence
spec:
  template:
    spec:
      containers:
        - name: command-demo-container
          image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
          command: [""kube-apiserver""]
          args: []
      restartPolicy: OnFailure","[[11], [11], [40, 27, 12, 55]]"
792,dab4ec72-ce2e-4732-b7c3-1757dcce01a1,Service Account Key File Not Properly Set,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/service_account_key_file_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--service-account-key-file' flag should be defined<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--service-account-key-file=/path/to/file.pem""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure",[[11]]
793,dbbc6705-d541-43b0-b166-dd4be8208b54,NET_RAW Capabilities Not Being Dropped,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/net_raw_capabilities_not_being_dropped,kubernetes-queries,"Containers should drop 'ALL' or at least 'NET_RAW' capabilities<br>
[Documentation](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  containers:
      - name: payment
        image: nginx
        securityContext:
          capabilities:
            drop:
              - ALL
            add:
              - NET_BIND_SERVICE
  privileged: false
  seLinux:
    rule: RunAsAny
  supplementalGroups:
    rule: RunAsAny
  runAsUser:
    rule: RunAsAny
  fsGroup:
    rule: RunAsAny
  volumes:
  - '*'","apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
      - name: payment
        image: nginx
        securityContext:
          capabilities:
            drop:
              - SYS_ADMIN
      - name: payment2
        image: nginx
      - name: payment4
        image: nginx
        securityContext:
          capabilities:
            add:
              - NET_BIND_SERVICE
      - name: payment3
        image: nginx
        securityContext:
          allowPrivilegeEscalation: false

apiVersion: apps/v1
kind: Deployment
metadata:
  name: redis-unhealthy-deployment
  labels:
    app: redis
spec:
  replicas: 3
  selector:
    matchLabels:
      app: redis
  template:
    metadata:      
      labels:
        app: redis
    spec:
      hostNetwork: true
      hostPID: true 
      hostIPC: true
      containers:
      - name: redis
        image: redis:latest
        ports:
        - containerPort: 9001
          hostPort: 9001
        securityContext:
          privileged: true
          readOnlyRootFilesystem: false
          allowPrivilegeEscalation: true
          runAsUser: 0
          capabilities:
            add:
              - NET_ADMIN","[[13, 18, 11, 21], [31]]"
794,dd29336b-fe57-445b-a26e-e6aa867ae609,Container Is Privileged,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/container_is_privileged,kubernetes-queries,"Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false<br>
[Documentation](https://kubernetes.io/docs/concepts/workloads/pods/#privileged-mode-for-containers)","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-4
spec:
  containers:
  - name: sec-ctx-4
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      privileged: false
      capabilities:
        add: [""NET_ADMIN"", ""SYS_TIME""]","apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-4
spec:
  containers:
  - name: sec-ctx-4
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      privileged: true
      capabilities:
        add: [""NET_ADMIN"", ""SYS_TIME""]
---
apiVersion: v1
kind: Pod
metadata:
  name: security-context-demo-5
spec:
  initContainers:
  - name: sec-ctx-4
    image: gcr.io/google-samples/node-hello:1.0
    securityContext:
      privileged: true
      capabilities:
        add: [""NET_ADMIN"", ""SYS_TIME""]
  containers:
  - name: sec-ctx-4
    image: gcr.io/google-samples/node-hello:1.0

apiVersion: apps/v1
kind: Deployment
metadata:
  name: test-deployment
  labels:
    app: test
spec:
  replicas: 3
  selector:
    matchLabels:
      app: test
  template:
    metadata:
      labels:
        app: test
    spec:
      containers:
        - name:  pause
          image: k8s.gcr.io/pause
          securityContext:
            privileged: true","[[10, 23], [21]]"
795,de4421f1-4e35-43b4-9783-737dd4e4a47e,PSP With Unrestricted Access to Host Path,Kubernetes,High,Resource Management,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/psp_with_unrestricted_access_to_host_path,kubernetes-queries,"PodSecurityPolicy should set 'readOnly' to true in every host path allowed<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems)","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: false
  allowedHostPaths:
    - pathPrefix: ""/foo""
      readOnly: true
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: false
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'

apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: false
  allowedHostPaths:
  - pathPrefix: /dev
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'

apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example
spec:
  hostIPC: false
  allowedHostPaths:
  - pathPrefix: /dev
    readOnly: false
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'RunAsAny'","[[5], [8], [9]]"
796,e0099af2-fe17-411f-9991-0de28fe15f3c,Event Rate Limit Admission Control Plugin Not Set,Kubernetes,Low,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/event_rate_limit_admission_control_plugin_not_set,kubernetes-queries,"When using kube-apiserver command, the --enable-admission-plugins flag should have 'EventRateLimit' plugin and the plugin should be correctly configured in AdmissionControl Config file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=EventRateLimit"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--enable-admission-plugins=EventRateLimit"", ""--admission-control-config-file=path/to/plugin/config/file.yaml""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--enable-admission-plugins=AlwaysAdmit""]
  restartPolicy: OnFailure",[[11]]
797,e0e00aba-5f1c-4981-a542-9a9563c0ee20,Client Certificate Authentication Not Setup Properly,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/1390.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/client_certificate_authentication_not_setup_properly,kubernetes-queries,"Client Certificate Authentication should be Setup with a .pem or .crt file<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--client-ca-file=/var/lib/ca.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--client-ca-file=/var/lib/ca.pem""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--client-ca-file=/var/lib/ca.txt""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--client-ca-file=/var/lib/ca.txt""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","[[11], [11], [11]]"
798,e17fa86a-6222-4584-a914-56e8f6c87e06,Tiller Deployment Is Accessible From Within The Cluster,Kubernetes,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/286.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/tiller_deployment_is_accessible_from_within_the_cluster,kubernetes-queries,"Check if any Tiller Deployment container allows access from within the cluster.<br>
[Documentation](https://kubernetes.io/docs/concepts/containers/images/)","apiVersion: apps/v1
kind: Deployment
metadata:
  name: tiller-deploy
  labels:
    app: helm
    name: tiller
spec:
  selector:
    matchLabels:
      app: helm
      name: tiller
  template:
    metadata:
      labels:
        app: helm
        name: tiller
    spec:
      serviceAccountName: tiller
      containers:
        - name: tiller
          image: ""tiller-image""
          args: [""--listen=127.0.0.1:44134""]
          ports:
          - containerPort: 44134
            name: tiller
            protocol: TCP
          - containerPort: 44135
            name: http
            protocol: TCP","---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: helm
    name: tiller
  name: tiller-bad-args
spec:
  selector:
    matchLabels:
      name: tiller
  template:
    metadata:
      labels:
        app: helm
        name: tiller
    spec:
      containers:
        -
          args:
            - ""--listen=10.7.2.8:44134""
          image: tiller-image
          name: tiller-v2
          ports:
            -
              containerPort: 44134
              name: tiller
              protocol: TCP
            -
              containerPort: 44135
              name: http
              protocol: TCP
      serviceAccountName: tiller
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: helm
    name: tiller
  name: tiller-deploy-no-args
spec:
  selector:
    matchLabels:
      name: tiller
  template:
    metadata:
      labels:
        app: helm
        name: tiller
    spec:
      containers:
        -
          name: tiller-v2
          image: tiller-image
      serviceAccountName: tiller","[[53, 21]]"
799,e3aa0612-4351-4a0d-983f-aefea25cf203,Root Containers Admitted,Kubernetes,Medium,Best Practices,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/root_containers_admitted,kubernetes-queries,"Containers must not be allowed to run with root privileges, which means the attributes 'privileged','allowPrivilegeEscalation' and 'readOnlyRootFilesystem' must be set to false, 'runAsUser.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/)","#this code is a correct code for which the query should not find any result
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: false
  # Required to prevent escalations to root.
  allowPrivilegeEscalation: false
  # This is redundant with non-root + disallow privilege escalation,
  # but we can provide it for defense in depth.
  requiredDropCapabilities:
    - ALL
  # Allow core volume types.
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    # Assume that persistentVolumes set up by the cluster admin are safe to use.
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    # Require the container to run without root privileges.
    rule: 'MustRunAsNonRoot'
  seLinux:
    # This policy assumes the nodes are using AppArmor rather than SELinux.
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      # Forbid adding the root group.
      - min: 1
        max: 65535
  readOnlyRootFilesystem: true","#this is a problematic code where the query should report a result(s)
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
  annotations:
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: 'docker/default,runtime/default'
    apparmor.security.beta.kubernetes.io/allowedProfileNames: 'runtime/default'
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
    apparmor.security.beta.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  privileged: true
  allowPrivilegeEscalation: true
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
    - 'persistentVolumeClaim'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'RunAsAny'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'RunAsAny'
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 0
        max: 65535","[[32, 12, 13, 27, 31]]"
800,e84eaf4d-2f45-47b2-abe8-e581b06deb66,Ensure Administrative Boundaries Between Resources,Kubernetes,Info,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/ensure_administrative_boundaries_between_resources,kubernetes-queries,"As a best practice, ensure that is made the correct use of namespaces to adequately administer your resources. Kubernetes Authorization plugins can also be used to create policies that segregate user access to namespaces.<br>
[Documentation](https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/)",,"apiVersion: v1
kind: Pod
metadata:
  name: frontend
  namespace: cosmic-namespace
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""
---
apiVersion: v1
kind: Pod
metadata:
  name: frontend2
  namespace: cosmic-namespace
spec:
  containers:
  - name: app
    image: images.my-company.example/app:v4
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""

  - name: log-aggregator
    image: images.my-company.example/log-aggregator:v6
    securityContext:
      allowPrivilegeEscalation: false
    resources:
      requests:
        memory: ""64Mi""
        cpu: ""250m""
      limits:
        memory: ""128Mi""
        cpu: ""500m""",[[5]]
801,ec18a0d3-0069-4a58-a7fb-fbfe0b4bbbe0,Kubelet Certificate Authority Not Set,Kubernetes,Medium,Secret Management,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_certificate_authority_not_set,kubernetes-queries,"When using kube-apiserver command, the 'kubelet-certificate-authority' flag should be set<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--kubelet-certificate-authority=/path/to/any/cert/file.pem""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--kubelet-certificate-authority=/path/to/any/cert/file.crt""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
  restartPolicy: OnFailure",[[11]]
802,ed89b97d-04e9-4fd4-919f-ee5b27e555e9,Kubelet Streaming Connection Timeout Disabled,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/kubelet_streaming_connection_timeout_disabled,kubernetes-queries,"The flag --streaming-connection-idle-timeout should not be set to 0<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--streaming-connection-idle-timeout=0""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""
streamingConnectionIdleTimeout: 0s","[[11], [8]]"
803,f1f4d8da-1ac4-47d0-b1aa-91e69d33f7d5,Authorization Mode Set To Always Allow,Kubernetes,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/authorization_mode_set_to_always_allow,kubernetes-queries,"When using the kubelet command, the authorization-mode flag should not have 'AlwaysAllow' mode<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--authorization-mode=MyMode""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--authorization-mode=MyMode""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: [""--authorization-mode=MyMode""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args:
        [""--anonymous-auth=false"", ""--authorization-mode=MyMode,AlwaysAllow""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--authorization-mode=MyMode,AlwaysAllow""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args:
        [""--anonymous-auth=false"", ""--authorization-mode=MyMode,AlwaysAllow""]
  restartPolicy: OnFailure","[[11], [11], [11]]"
804,f377b83e-bd07-4f48-a591-60c82b14a78b,Seccomp Profile Is Not Configured,Kubernetes,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/seccomp_profile_is_not_configured,kubernetes-queries,"Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls<br>
[Documentation](https://kubernetes.io/docs/tutorials/security/seccomp/#create-pod-that-uses-the-container-runtime-default-seccomp-profile)","apiVersion: v1
kind: Pod
metadata:
  name: pod-test-1
  annotations:
    seccomp.security.alpha.kubernetes.io/defaultProfileName:  'runtime/default'
spec:
  containers:
  - name: foobar
    image: foo/bar:latest

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 19000
        seccompProfile:
            type: RuntimeDefault
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            allowPrivilegeEscalation: false
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080
          securityContext:
            allowPrivilegeEscalation: false

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 19000
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            allowPrivilegeEscalation: false
            seccompProfile:
                type: RuntimeDefault
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080
          securityContext:
            allowPrivilegeEscalation: false
            seccompProfile:
                type: RuntimeDefault","apiVersion: v1
kind: Pod
metadata:
  name: pod-test-1
spec:
  containers:
  - name: foobar
    image: foo/bar:latest
---
apiVersion: v1
kind: Pod
metadata:
  name: pod-test-2
  annotations:
    some-annotation: myannotation
spec:
  containers:
  - name: foobar
    image: foo/bar:latest
---
apiVersion: v1
kind: Pod
metadata:
  name: pod-test-3
  annotations:
    seccomp.security.alpha.kubernetes.io/defaultProfileName: 'rntim/dfl'
spec:
  containers:
  - name: foobar
    image: foo/bar:latest
---
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: hello
spec:
  schedule: ""*/1 * * * *""
  jobTemplate:
    spec:
      template:
        metadata:
          annotations:
            seccomp.security.alpha.kubernetes.io/defaultProfileName: 'rntim/dfl'
        spec:
          containers:
          - name: hello
            image: busybox
            imagePullPolicy: IfNotPresent
            args:
            - /bin/sh
            - -c
            - date; echo Hello from the Kubernetes cluster
          restartPolicy: OnFailure

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 19000
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            allowPrivilegeEscalation: false
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080
          securityContext:
            allowPrivilegeEscalation: false
            seccompProfile:
                type: RuntimeDefault

apiVersion: apps/v1
kind: Deployment
metadata:
  name: securitydemo
  labels:
    app: web
spec:
  replicas: 2
  selector:
    matchLabels:
      app: web
  template:
    metadata:
      labels:
        app: web
    spec:
      securityContext:
        runAsUser: 19000
      containers:
        - name: frontend
          image: nginx
          ports:
            - containerPort: 80
          securityContext:
            allowPrivilegeEscalation: false
        - name: echoserver
          image: k8s.gcr.io/echoserver:1.4
          ports:
            - containerPort: 8080
          securityContext:
            allowPrivilegeEscalation: false
            seccompProfile:
                type: Unconfined","[[43, 18, 26, 7], [24], [24, 33]]"
805,f922827f-aab6-447c-832a-e1ff63312bd3,Container Runs Unmasked,Kubernetes,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/container_runs_unmasked,kubernetes-queries,"Check if a container has full access (unmasked) to the host's /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime.<br>
[Documentation](https://kubernetes.io/docs/concepts/policy/pod-security-policy/#allowedprocmounttypes)","#this code is a correct code for which the query should not find any result
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  annotations:
    kubernetes.io/description: 'restricted psp for all standard use-cases'
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default
    seccomp.security.alpha.kubernetes.io/defaultProfileName: docker/default
  name: restricted
spec:
  allowPrivilegeEscalation: false                   # Disallow privilege escalation to any special capabilities
  allowedProcMountTypes:
    - Default                                       # Disallow full /proc mounts, only allow the ""default"" masked /proc
  fsGroup:                                          # disallow root fsGroups for volume mounts
    rule: MustRunAs
    ranges:
      - max: 65535
        min: 1
  hostIPC: false                                    # disallow sharing the host IPC namespace
  hostNetwork: false                                # disallow host networking
  hostPID: false                                    # disallow sharing the host process ID namespace
  hostPorts:                                        # disallow low host ports (this seems to only apply to eth0 on EKS)
    - max: 65535
      min: 1025
  privileged: false                                 # disallow privileged pods
  readOnlyRootFilesystem: true                      # change default from 'false' to 'true'
  requiredDropCapabilities:                         # Drop all privileges in the Linux kernel
    - AUDIT_CONTROL
    - CHOWN
  runAsGroup:                                       # disallow GID 0 for pods (block root group)
    rule: MustRunAs
    ranges:
      - max: 65535
        min: 1
  runAsUser:                                        # disallow UID 0 for pods
    rule: MustRunAsNonRoot
  seLinux:                                          # Harness for SELinux
    rule: RunAsAny
  supplementalGroups:                               # restrict supplemental GIDs to be non-zero (non-root)
    rule: MustRunAs
    ranges:
    - max: 65535
      min: 1
  volumes:                                          # allow only these volume types
  - configMap
  - downwardAPI
  - emptyDir
  - projected
  - secret","#this is a problematic code where the query should report a result(s)
apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  annotations:
    kubernetes.io/description: 'restricted psp for all standard use-cases'
    seccomp.security.alpha.kubernetes.io/allowedProfileNames: docker/default
    seccomp.security.alpha.kubernetes.io/defaultProfileName: docker/default
  name: restricted
spec:
  allowPrivilegeEscalation: false                   # Disallow privilege escalation to any special capabilities
  allowedProcMountTypes:
    - Unmasked
  fsGroup:                                          # disallow root fsGroups for volume mounts
    rule: MustRunAs
    ranges:
      - max: 65535
        min: 1
  hostIPC: false                                    # disallow sharing the host IPC namespace
  hostNetwork: false                                # disallow host networking
  hostPID: false                                    # disallow sharing the host process ID namespace
  hostPorts:                                        # disallow low host ports (this seems to only apply to eth0 on EKS)
    - max: 65535
      min: 1025
  privileged: false                                 # disallow privileged pods
  readOnlyRootFilesystem: true                      # change default from 'false' to 'true'
  requiredDropCapabilities:                         # Drop all privileges in the Linux kernel
    - AUDIT_CONTROL
    - CHOWN
  runAsGroup:                                       # disallow GID 0 for pods (block root group)
    rule: MustRunAs
    ranges:
      - max: 65535
        min: 1
  runAsUser:                                        # disallow UID 0 for pods
    rule: MustRunAsNonRoot
  seLinux:                                          # Harness for SELinux
    rule: RunAsAny
  supplementalGroups:                               # restrict supplemental GIDs to be non-zero (non-root)
    rule: MustRunAs
    ranges:
    - max: 65535
      min: 1
  volumes:                                          # allow only these volume types
  - configMap
  - downwardAPI
  - emptyDir
  - projected
  - secret",[[12]]
806,fa4def8c-1898-4a35-a139-7b76b1acdef0,Insecure Port Not Properly Set,Kubernetes,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/insecure_port_not_properly_set,kubernetes-queries,"When using kube-apiserver command, the '--insecure-port' flag should be defined and set to 0<br>
[Documentation](https://kubernetes.io/docs/reference/command-line-tools-reference/kube-apiserver/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"",""--insecure-port=0""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--insecure-port=0""]
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver"", ""--insecure-port=1143""]
  restartPolicy: OnFailure

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure","[[11], [11]]"
807,fa750c81-93c2-4fab-9c6d-d3fd3ce3b89f,TSL Connection Certificate Not Setup,Kubernetes,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/k8s/tls_connection_certificate_not_setup,kubernetes-queries,"TSL Connection Certificate files should be Setup<br>
[Documentation](https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/)","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: [""--tls-cert-file=someFile.txt"",""--tls-private-key-file=someFile.txt""]
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
tlsCertFile: ""someFile.txt""
tlsPrivateKeyFile: ""someFile.txt""
evictionHard:
    memory.available:  ""200Mi""

apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: foo/bar
      command: [""kubelet""]
      args: []
  restartPolicy: OnFailure","apiVersion: v1
kind: Pod
metadata:
  name: command-demo
  labels:
    purpose: demonstrate-command
spec:
  containers:
    - name: command-demo-container
      image: gcr.io/google_containers/kube-apiserver-amd64:v1.6.0
      command: [""kube-apiserver""]
      args: []
  restartPolicy: OnFailure

apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: ""192.168.0.8""
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  ""200Mi""","[[11], [2]]"
808,00b78adf-b83f-419c-8ed8-c6018441dd3a,Pattern Undefined (v3),OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/pattern_undefined,openapi-queries,"String schema should have 'pattern' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            discriminator: petType
            additionalProperties: false
            properties:
              code:
                type: string
                maxLength: 15
                enum:
                  - brown
                  - grey
                  - black
                  - white
              message:
                type: string
                format: date
              extra:
                type: string
                format: date-time","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          maxLength: 15
          format: int32
        message:
          type: string
          maxLength: 15
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[49, 34, 38]]"
809,013bdb4b-9246-4248-b0c3-7fb0fee42a29,Required Property With Default Value (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/required_property_default_value,openapi-queries,"Required properties receive value from requests, which makes unnecessary declare a default value<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      required:
      - id
      properties:
        id:
          type: string
        name:
          type: string
          default: guest","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      required:
      - id
      properties:
        id:
          type: string
          default: 4056684e4e1347579362617ad82e5b4e
        name:
          type: string
          default: guest","[[12, 22]]"
810,015eac96-6313-43c0-84e5-81b1374fa637,Schema JSON Reference Does Not Exist (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_schema,openapi-queries,"Schema reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string","---
openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyWrongObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string",[[13]]
811,0220e1c5-65d1-49dd-b7c2-cef6d6cb5283,Schema Object Incorrect Ref (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/schema_object_incorrect_ref,openapi-queries,"Schema Object reference must always point to '#/definitions'<br>
[Documentation](https://swagger.io/specification/v2/#schema-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/responses/Success""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/definitions/User""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/responses/Success""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/responses/Success""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[19]]
812,03856cb2-e46c-4daf-bfbf-214ec93c882b,Schema Enum Invalid (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_enum_invalid,openapi-queries,"The field 'enum' of Schema Object should be consistent with the schema's type<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""201"":
          description: 201 response
          content:
            ""text/html"":
              schema:
                type: number
                enum:
                  - 1
                  - 2
                  - 3
                  - 4
                  - 5","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""201"":
          description: 201 response
          content:
            ""text/html"":
              schema:
                type: number
                enum:
                  - black",[[18]]
813,05505192-ba2c-4a81-9b25-dcdbcc973746,Parameter Objects Headers With Duplicated Name (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/parameter_objects_headers_dup_name,openapi-queries,"Parameter Objects should not have duplicate names for 'header' location, since HTTP headers are not case sensitive.<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: token
        in: header
        description: token to be passed as a header
        required: true
        schema:
          type: array
          items:
            type: integer
            format: int64
        style: simple
      - name: username
        in: header
        description: username to fetch
        required: true
        schema:
          type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
        - name: id
          in: header
          description: id to be passed as a header
          required: true
          schema:
            type: array
            items:
              type: integer
              format: int64
          style: simple
        - name: ID
          in: header
          description: ID to fetch
          required: true
          schema:
            type: string
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: token
        in: header
        description: token to be passed as a header
        required: true
        schema:
          type: array
          items:
            type: integer
            format: int64
        style: simple
      - name: Token
        in: header
        description: token to fetch
        required: true
        schema:
          type: string","[[11, 21, 43, 53]]"
814,06764426-3c56-407e-981f-caa25db1c149,Security Scheme HTTP Unknown Scheme,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_schemes_http_unknown_scheme,openapi-queries,"Security Scheme HTTP scheme should be registered in the IANA Authentication Scheme registry<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: basic","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: test",[[33]]
815,0b76d993-ee52-43e0-8b39-3787d2ddabf1,Global Responses Definition Not Being Used,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/unused_response_definition,openapi-queries,"All global responses definitions should be in use<br>
[Documentation](https://swagger.io/specification/v2/#responsesDefinitionsObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/responses/Success""
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: string
          desc:
            type: string
responses:
  Success:
    description: ""200 response""","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/responses/Success""
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: string
          desc:
            type: string
responses:
  Success:
    description: ""200 response""
  IllegalInput:
    description: Illegal input for operation.
  GeneralError:
    description: General Error","[[25, 27]]"
816,0c79e50e-b3cf-490c-b8f6-587c644d4d0c,Operation Object Without 'consumes',OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_object_without_consumes,openapi-queries,"Operation Object should have 'consumes' field defined for 'POST', 'PUT' and 'PATCH' operations<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    put:
      operationId: updateVersionsv2
      summary: Update API versions
      produces:
        - application/json
        - application/xml
      consumes:
        - application/x-www-form-urlencoded
      parameters: []","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    put:
      operationId: updateVersionsv2
      summary: Update API versions
      produces:
        - application/json
        - application/xml
      parameters: []",[[7]]
817,0de50145-e845-47f4-9a15-23bcf2125710,Path Parameter Not Required (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/path_parameter_not_required,openapi-queries,"The property 'required' determines whether the parameter is mandatory. If the parameter location is 'path', this property is required and its value must be true.<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: false
        schema:
          type: integer",[[26]]
818,0f6cd0ab-c366-4595-84fc-fbd8b9901e4d,Request Body With Incorrect Ref,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/request_body_incorrect_ref,openapi-queries,"Request Body reference must always point to '#/components/RequestBodies'<br>
[Documentation](https://swagger.io/specification/#request-body-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
components:
  requestBodies:
    List:
      description: id of api version
      required: true
      content:
        text/plain:
          schema:
            type: array
            items:
              type: integer
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      requestBody:
        $ref: ""#/components/requestBodies/List""
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
components:
  requestBodies:
    List:
      description: id of api version
      required: true
      content:
        text/plain:
          schema:
            type: array
            items:
              type: integer
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      requestBody:
        $ref: ""#/components/schemas/List""
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[22]]
819,105e20dd-8449-4d71-95c6-d5dac96639af,Success Response Code Undefined for Trace Operation,OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/success_response_code_undefined_trace_operation,openapi-queries,"Trace should define the '200' successful code<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    trace:
      operationId: traceItem
      summary: Trace item
      responses:
        ""200"":
          description: success
        default:
          description: Success
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        default:
          description: Error
          schema:
            ""$ref"": ""#/components/schemas/Error""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    trace:
      operationId: traceItem
      summary: Trace item
      responses:
        default:
          description: Error
          schema:
            ""$ref"": ""#/components/schemas/Error""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message",[[10]]
820,10c61e4b-eed5-49cf-9c7d-d4bf02e9edfa,Schema Object Properties With Duplicated Keys (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_object_properties_with_duplicated_keys,openapi-queries,"Schema Object Property key should be unique through out the fields 'properties', 'allOf', 'additionalProperties'<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.c
paths: {}
components:
  schemas:
    ErrorModel:
      type: object
      required:
        - message
        - code
      properties:
        message:
          type: string
        code:
          type: integer
          minimum: 100
          maximum: 600
      allOf:
        - ""$ref"": ""#/components/schemas/ErrorModel""
        - type: object
          required:
            - rootCause
          properties:
            rootCause:
              type: string
    ErrorModel_2:
      type: object
      required:
        - message2
        - code2
      properties:
        message2:
          type: string
        code2:
          type: integer
          minimum: 100
          maximum: 600
      allOf:
        - ""$ref"": ""#/components/schemas/ErrorModel""
        - type: object
          required:
            - rootCause2
          properties:
            rootCause2:
              type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.c
paths: {}
components:
  schemas:
    ErrorModel:
      type: object
      required:
        - message
        - code
      properties:
        message:
          type: string
        code:
          type: integer
          minimum: 100
          maximum: 600
      allOf:
        - ""$ref"": ""#/components/schemas/ErrorModel""
        - type: object
          required:
            - code
          properties:
            code:
              type: integer
              minimum: 100
              maximum: 600
      additionalProperties:
        - type: object
          required:
            - code
          properties:
            code:
              type: string","[[16, 28, 37]]"
821,12a7210b-f4b4-47d0-acac-0a819e2a0ca3,Response on operations that should not have a body has declared content (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/response_operations_body_schema_incorrect_defined,openapi-queries,"If a response is head or its code is 204 or 304, it shouldn't have a content defined<br>
[Documentation](https://swagger.io/docs/specification/describing-responses/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    delete:
      operationId: deleteVersion
      summary: Deletes API versions
      responses:
        ""204"":
          description: no content
    head:
      operationId: headers
      summary: headers
      responses:
        ""200"":
          description: no content","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
    delete:
      operationId: deleteVersion
      summary: Deletes API versions
      responses:
        ""204"":
          description: wrong example
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/ApiVersion""
components:
  schemas:
    ApiVersion:
      type: object
      discriminator:
        propertyName: ApiVersion
      properties:
        code:
          type: integer
          format: int32
        version:
          type: string",[[23]]
822,151331e2-11f4-4bb6-bd35-9a005e695087,Components Object Fixed Field Key Improperly Named,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_object_fixed_field_key_improperly_named,openapi-queries,"Components object fixed fields (schemas, responses, parameters, examples, requestBodies, headers, securitySchemes, links, and callbacks) should use keys that match the following REGEX: `^[a-zA-Z0-9\.\-_]+$`<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    General Error:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType",[[27]]
823,181bd815-767e-4e95-a24d-bb3c87328e19,Numeric Schema Without Minimum (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/numeric_schema_without_minimum,openapi-queries,"Numeric schema (type set to 'integer' or 'number') should have 'minimum' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 0
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[34, 45]]"
824,1908a8ee-927d-4166-8f18-241152170cc1,Success Response Code Undefined for Patch Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_patch_operation,openapi-queries,"Patch should define at least one success response (200, 201, 202 or 204)<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        default:
          description: Error
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        ""204"":
          description: Item updated successfully
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    patch:
      operationId: updateItem
      summary: Updated item
      responses:
        default:
          description: Error",[[10]]
825,1a1aea94-745b-40a7-b860-0702ea6ee636,Schema Object With Circular Ref (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_object_with_circular_ref,openapi-queries,"Schema Object should not reference it self in 'allOf', 'oneOf', 'anyOf' and 'not' properties<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    ErrorModel:
      type: object
      required:
        - message
        - code
      properties:
        message:
          type: string
        code:
          type: integer
          minimum: 100
          maximum: 600
    ExtendedErrorModel:
      allOf:
        - ""$ref"": ""#/components/schemas/ErrorModel""
        - type: object
          required:
            - rootCause
          properties:
            rootCause:
              type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    ErrorModel:
      type: object
      required:
        - message
        - code
      properties:
        message:
          type: string
        code:
          type: integer
          minimum: 100
          maximum: 600
    ExtendedErrorModel:
      allOf:
        - $ref: ""#/components/schemas/ExtendedErrorModel""
        - type: object
          required:
            - rootCause
          properties:
            rootCause:
              type: string",[[45]]
826,1bc3205c-0d60-44e6-84f3-44fbf4dac5b3,Security Scheme Using Oauth 1.0,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_schemes_using_oauth,openapi-queries,"Oauth 1.0 is deprecated, OAuth2 should be used instead<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          tokenUrl: https://example.com/api/oauth/token
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: oauth",[[31]]
827,20a482d5-c5d9-4a7a-b7a4-60d0805047b4,Security Operation Field Undefined,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_operation_field_undefined,openapi-queries,"Security operation field should be defined in '#/components/securitySchemes'<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - petstore_auth:
            - write:pets
            - read:pets
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - petstore_auth:
            - write:pets
            - read:pets
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[11]]
828,20cb3159-b219-496b-8dac-54ae3ab2021a,Non-Array Schema With Items (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/non_array_schema_with_items,openapi-queries,"Non-Array Schema should not have 'items' defined<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: array
      items:
        type: string
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      items:
        type: string
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name",[[29]]
829,221015a8-aa2a-43f5-b00b-ad7d2b1d47a8,Security Definitions Using Basic Auth,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/security_definitions_using_basic_auth,openapi-queries,"Security Definition Object should not use basic authentication<br>
[Documentation](https://swagger.io/specification/v2/#securitySchemeObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: basic
    description: For more information, see https://api.my.company.com/docs/oauth",[[17]]
830,237402e2-c2f0-46c9-9cf5-286160cf7bfc,Path Is Ambiguous (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/path_ambiguous,openapi-queries,"All path should be unique, if has more than one operation, all operations should be part of same Path Object<br>
[Documentation](https://swagger.io/specification/#path-item-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/users/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response
  ""/user/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/users/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          type: string
      responses:
        ""200"":
          description: 200 response
  ""/user/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          type: string
      responses:
        ""200"":
          description: 200 response","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/users/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response
  ""/users/{ids}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/users/{id}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          type: string
      responses:
        ""200"":
          description: 200 response
  ""/users/{ids}"":
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          type: string
      responses:
        ""200"":
          description: 200 response","[[19, 6], [10, 21]]"
831,23a9e2d9-8738-4556-a71c-2802b6ffa022,Undefined Scope 'securityScheme' On Global 'security' Field,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/undefined_security_scope_global_security,openapi-queries,"Using a scope on global security field that is undefined on 'securityScheme' can be defined by an attacker<br>
[Documentation](https://swagger.io/specification/#oauth-flow-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
security:
- oAuth2AuthCodeNeg2:
  - read:api
  - write:api
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            read:api: read your apis
            admin:api: admin scope
        password:
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            write:api: write your apis","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
security:
  oAuth2AuthCodeNeg2:
  - read:api
  - error:api
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            read:api: read your apis
            admin:api: admin scope
        password:
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            write:api: write your apis",[[16]]
832,2596545e-1757-4ff7-a15a-8a9a180a42f3,Parameter Object With Incorrect Ref (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/parameter_object_incorrect_ref,openapi-queries,"Parameter Object reference must always point to '#/parameters'<br>
[Documentation](https://swagger.io/specification/v2/#parameter-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: A list of users
          schema:
            ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: A list of users
          schema:
            ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/definitions/User""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[16]]
833,26f06397-36d8-4ce7-b993-17711261d777,Invalid Content Type For Multiple Files Upload,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/invalid_content_type_for_multiple_files_upload,openapi-queries,"Content Type should be set to 'multipart/form-data' in case of uploading an arbitrary number of files (array)<br>
[Documentation](https://swagger.io/docs/specification/describing-request-body/file-upload/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    email: ""user@gmail.com""
paths:
  ""/"":
    get:
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                filename:
                  type: array
                  items:
                    type: string
                    format: binary","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    email: ""user@gmail.com""
paths:
  ""/"":
    get:
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                filename:
                  type: array
                  items:
                    type: string
                    format: binary",[[13]]
834,274f910a-0665-4f08-b66d-7058fe927dba,Invalid OAuth2 Token URL (v2),OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/invalid_oauth2_token_url,openapi-queries,"OAuth2 security definition flow requires a valid URL in the tokenUrl field<br>
[Documentation](https://swagger.io/specification/v2/#security-scheme-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg3:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg3:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: http://example.com#@evil.com/
    scopes:
      read:api: read your apis",[[22]]
835,281b8071-6226-4a43-911d-fec246d422c2,API Key Exposed In Operation Security (v3),OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/api_key_exposed_in_operation_security,openapi-queries,"API Keys should be transported using a secure method such as HTTPS. Define a security scheme that uses a secure method to transport the API key.<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  /pets:
    post:
      description: Creates a new pet in the store
      operationId: addPet
      security:
        - OAuth2:
            - write
            - read
      responses:
        ""200"":
          description: 200 response
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          scopes:
            write: modify objects in your account
            read: read objects in your account
          authorizationUrl: https://example.com/oauth/authorize
          tokenUrl: https://example.com/oauth/token","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  /pets:
    post:
      description: Creates a new pet in the store
      operationId: addPet
      security:
        - apiKey1: []
          apiKey2: []
          apiKey3: []
      responses:
        ""200"":
          description: 200 response
components:
  securitySchemes:
    apiKey1:
      type: apiKey
      name: X-API-Key
      in: header
    apiKey2:
      type: apiKey
      name: X-API-Key
      in: cookie
    apiKey3:
      type: apiKey
      name: X-API-Key
      in: query","[[11, 12, 13]]"
836,2bd608ae-8a1f-457f-b710-c237883cb313,Schema Has A Required Property Undefined (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_required_property_undefined,openapi-queries,"Schema Object should not be have a required property that is not defined on properties<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
      required:
      - code
      - message","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: integer
          format: int32
      required:
        - code
        - message",[[31]]
837,2cf35b40-ded3-43d6-9633-c8dcc8bcc822,Operation Example Mismatch Produces MimeType,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_example_mismatch_produces_mediatype,openapi-queries,"Example should match one of MimeTypes on 'produces'. It is important to know that, if a 'produces' is declared on operation it will override global 'produces'<br>
[Documentation](https://swagger.io/specification/v2/#exampleObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      operationId: listVersionsv2
      summary: List API versions
      produces:
      - application/json
      - text/csv
      responses:
        '200':
          description: OK
          examples:
            application/json:
              id: 38
              title: Versions
            text/csv: id,title 38,Versions
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer","---
swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      operationId: listVersionsv2
      summary: List API versions
      produces:
      - application/json
      responses:
        '200':
          description: OK
          examples:
            application/json:
              id: 38
              title: Versions
            text/csv: id,title 38,Versions
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer",[[27]]
838,2d6646f4-2946-420f-8c14-3232d49ae0cb,Header Object With Incorrect Ref,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/header_object_with_incorrect_ref,openapi-queries,"Header Object reference must always point to '#/components/headers'<br>
[Documentation](https://swagger.io/specification/#responses-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              headers:
                X-Rate-Limit-Limit:
                  $ref: ""#/components/headers/""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              headers:
                X-Rate-Limit-Limit:
                  $ref: ""#components/h""",[[45]]
839,2d8c175a-6d90-412b-8b0e-e034ea49a1fe,Global Server Object Uses HTTP,OpenAPI,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/global_server_uses_http,openapi-queries,"Global server object URL should use 'https' protocol instead of 'http'<br>
[Documentation](https://swagger.io/specification/#server-object)","---
openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
servers:
  - url: https://development.gigantic-server.com/v1
    description: Development server
  - url: https://staging.gigantic-server.com/v1
    description: Staging server
  - url: https://api.gigantic-server.com/v1
    description: Production server
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  exampleSecurity:
    type: https
# trigger validation","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
servers:
  - url: https://development.gigantic-server.com/v1
    description: Development server
  - url: http://staging.gigantic-server.com/v1
    description: Staging server
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self

openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security: []","[[8], [1]]"
840,2da46be4-4317-4650-9285-56d7103c4f93,Global Security Using Password Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/global_security_using_password_flow,openapi-queries,"Security should not use 'password' Flow in OAuth2 authentication<br>
[Documentation](https://swagger.io/specification/v2/#securityRequirementObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis
security:
  - oAuth2AuthCodeNeg2:
      - write
      - read","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: password
    tokenUrl: https://api.my.company.com/oauth/token
security:
  - oAuth2AuthCodeNeg2:
      - write
      - read",[[22]]
841,2e275f16-b627-4d3f-ae73-a6153a23ae8f,Parameter JSON Reference Does Not Exist (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_parameter,openapi-queries,"Parameter reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
      parameters:
      - ""$ref"": ""#/components/parameters/limitParam""
components:
  parameters:
    limitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
      parameters:
      - ""$ref"": ""#/components/parameters/wrongParameter""
components:
  parameters:
    limitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer",[[14]]
842,2e44e632-d617-43cb-b294-6bfe72a08938,Operation Using Password Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_using_password_flow,openapi-queries,"Operation Object should not use 'password' Flow in OAuth2 authentication<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2:
            - write
            - read
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2:
            - write
            - read
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: password
    tokenUrl: https://api.my.company.com/oauth/token",[[16]]
843,2e9b6612-8f69-42e0-a5b8-ed17739c2f3a,Object Using Enum With Keyword (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/object_using_enum_with_keyword,openapi-queries,"Schema Object properties should not contain 'enum' and schema keywords<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths: {}
components:
  schemas:
    Pet:
      type: object
      discriminator:
        propertyName: petType
      properties:
        name:
          type: string
        petType:
          type: string
      required:
        - name
        - petType
    Cat:
      description:
        A representation of a cat. Note that `Cat` will be used as the
        discriminator value.
      allOf:
        - ""$ref"": ""#/components/schemas/Pet""
        - type: object
          properties:
            huntingSkill:
              type: string
              description: The measured skill for hunting
              default: lazy
              enum:
                - clueless
                - lazy
                - adventurous
                - aggressive
          required:
            - huntingSkill
    Dog:
      description:
        A representation of a dog. Note that `Dog` will be used as the
        discriminator value.
      allOf:
        - ""$ref"": ""#/components/schemas/Pet""
        - type: object
          properties:
            packSize:
              type: integer
              format: int32
              description: the size of the pack the dog is from
              default: 0
              minimum: 0
          required:
            - packSize","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths: {}
components:
  schemas:
    Pet:
      type: object
      discriminator:
        propertyName: petType
      properties:
        name:
          type: string
        petType:
          type: string
      required:
        - name
        - petType
    Cat:
      description:
        A representation of a cat. Note that `Cat` will be used as the
        discriminator value.
      allOf:
        - ""$ref"": ""#/components/schemas/Pet""
        - type: object
          properties:
            huntingSkill:
              type: string
              description: The measured skill for hunting
              default: lazy
              enum:
                - clueless
                - lazy
                - adventurous
                - aggressive
              minLength: 4
          required:
            - huntingSkill
    Dog:
      description:
        A representation of a dog. Note that `Dog` will be used as the
        discriminator value.
      allOf:
        - ""$ref"": ""#/components/schemas/Pet""
        - type: object
          properties:
            packSize:
              type: integer
              format: int32
              description: the size of the pack the dog is from
              default: 0
              minimum: 0
          required:
            - packSize",[[32]]
844,2ea04bef-c769-409e-9179-ee3a50b5c0ac,Numeric Schema Without Maximum (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/numeric_schema_without_maximum,openapi-queries,"Numeric schema (type set to 'integer' or 'number') should have 'maximum' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 0
          maximum: 50
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 0
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[34, 46]]"
845,31dd6fc0-f274-493b-9614-e063086c19fc,Parameter Object With Schema And Content,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/parameter_object_schema_content,openapi-queries,"A Parameter Object must contain either a 'schema' property, or a 'content' property, but not both since they are mutually exclusive<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
          content:
            application/json:
              schema:
                type: integer","[[26, 45]]"
846,332cf2ad-380d-4b90-b436-46f8e635cf38,Invalid Contact URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_contact_url,openapi-queries,"Contact Object URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#contact-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    url: ""https://www.google.com/""
    email: ""user@gmail.com""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    url: ""/""
    email: ""user@gmail.com""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[7]]
847,33d96c65-977d-4c33-943f-440baca49185,Invalid OAuth2 Authorization URL (v2),OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/invalid_oauth_authorization_url,openapi-queries,"The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL<br>
[Documentation](https://swagger.io/specification/v2/#securitySchemeObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  api_key:
    type: oauth2
    authorizationUrl: http://swagger.io/api/oauth/apikey
    flow: accessCode
  petstore_auth:
    type: oauth2
    authorizationUrl: http://swagger.io/api/oauth/dialog
    flow: implicit
    scopes:
      write:pets: modify pets in your account
      read:pets: read your pets","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  api_key:
    type: oauth2
    authorizationUrl: https://api.invalid.comp@#any.com/oauth/authorize
    flow: accessCode
  petstore_auth:
    type: oauth2
    authorizationUrl: https://api.invalid.comp@#any.com/oauth/authorize
    flow: implicit
    scopes:
      write:pets: modify pets in your account
      read:pets: read your pets","[[19, 23]]"
848,37140f7f-724a-4c87-a536-e9cee1d61533,Security Requirement Object With Wrong Scopes,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_requirement_object_with_wrong_scopes,openapi-queries,"Security Requirement Object should only have scopes defined for security schemes of type 'oauth2' and 'openIdConnect'<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
security:
  - api_key: []
  - petstore_auth:
      - write:pets
      - read:pets
paths: {}
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
security:
  - api_key:
      - write:pets
      - read:pets
  - petstore_auth:
      - write:pets
      - read:pets
paths: {}
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets",[[6]]
849,376c9390-7e9e-4cb8-a067-fd31c05451fd,Header JSON Reference Does Not Exist,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_header,openapi-queries,"Header reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","---
openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
              headers:
                X-Pages:
                  ""$ref"": ""#/components/headers/xPages""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  headers:
    xPages:
      schema:
        type: integer
        description: number of pages","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
              headers:
                X-Pages:
                  ""$ref"": ""#/components/headers/wPages""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  headers:
    xPages:
      schema:
        type: integer
        description: number of pages",[[21]]
850,3847280c-9193-40bc-8009-76168e822ce2,Undefined Scope 'securityDefinition' On 'security' Field On Operations,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/undefined_security_scope_security_operations,openapi-queries,"Using an scope on security of operations that is undefined on 'securityDefinitions' can be defined by an attacker<br>
[Documentation](https://swagger.io/specification/v2/#security-scheme-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  /:
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - oAuth2AuthCodeNeg2:
            - read:api
      responses:
        ""200"":
          description: Success
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: authorizationCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  /:
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - oAuth2AuthCodeNeg2:
            - read:api
            - error:api
      responses:
        ""200"":
          description: Success
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: authorizationCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      read:api: read your apis",[[11]]
851,3979b0a4-532c-4ea7-86e4-34c090eaa4f2,OAuth2 With Password Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/oauth2_with_password_flow,openapi-queries,"OAuth2 password flow insecurely exposes the credentials of the resource owner to the client<br>
[Documentation](https://swagger.io/specification/#oauth-flows-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          tokenUrl: https://example.com/api/oauth/token
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        password:
          tokenUrl: https://example.com/api/oauth/token
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets",[[34]]
852,39cb32f2-3a42-4af0-8037-82a7a9654b6c,OAuth2 With Implicit Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/oauth2_with_implicit_flow,openapi-queries,"OAuth2 implicit flow is vulnerable to access token leakage and access token replay<br>
[Documentation](https://swagger.io/specification/#oauth-flows-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          tokenUrl: https://example.com/api/oauth/token
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets",[[34]]
853,3a01790c-ebee-4da6-8fd3-e78657383b75,Schema with 'additionalProperties' set as Boolean,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/schema_with_additional_properties_set_as_boolean,openapi-queries,"The value of 'additionalProperties' should be set as object instead of boolean, since swagger 2.0 does not support boolean value for it<br>
[Documentation](https://swagger.io/specification/v2/#schema-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              name:
                type: string
              tag:
                type: string
            required:
              - name
            additionalProperties:
              $ref: ""#/definitions/User""
definitions:
  User:
    type: object
    properties:
      name:
        type: string
      tag:
        type: string
    required:
      - name","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              name:
                type: string
              tag:
                type: string
            required:
              - name
            additionalProperties: false
definitions:
  User:
    type: object
    properties:
      name:
        type: string
      tag:
        type: string
    required:
      - name",[[22]]
854,3b066059-f411-4554-ac8d-96f32bff90da,Success Response Code Undefined for Head Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_head_operation,openapi-queries,"Head should define at least one success response (200 or 202)<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    head:
      operationId: headItem
      summary: Head item
      responses:
        ""200"":
          description: success
        default:
          description: Success
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    head:
      operationId: headItem
      summary: Head item
      responses:
        default:
          description: Error",[[10]]
855,3b497874-ae59-46dd-8d72-1868a3b8f150,Success Response Code Undefined for Delete Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_delete_operation,openapi-queries,"Delete should define at least one success response (200, 201, 202 or 204)<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        ""204"":
          description: Item deleted successfully
        default:
          description: Error
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        default:
          description: Error",[[10]]
856,3b615f00-c443-4ba9-acc4-7c308716917d,Unknown Prefix (v2),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/unknown_prefix,openapi-queries,"The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video'<br>
[Documentation](https://swagger.io/specification/v2/#swagger-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      produces:
      - application/json
      responses:
        '200':
          schema:
            ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      produces:
      - aplication/json
      responses:
        '200':
          schema:
            ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[10]]
857,3ba0cca1-b815-47bf-ac62-1e584eb64a05,Invalid OAuth2 Token URL (v3),OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/invalid_oauth2_token_url,openapi-queries,"OAuth2 security scheme flow requires a valid URL in the tokenUrl field<br>
[Documentation](https://swagger.io/specification/#oauth-flow-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodeNeg1:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: http://localhost.com:8080

openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodeNeg3:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            read:api: read your apis","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodePos1:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: http://example.com#@evil.com/
          scopes:
            read:api: read your apis

openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  securitySchemes:
    oAuth2AuthCodePos2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        password:
          tokenUrl: inval`id
          scopes:
            read:api: read your apis
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:

openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodePos3:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        clientCredentials:
          tokenUrl: httxps//|api
          scopes:
            read:api: read your apis","[[23], [12], [22]]"
858,3d7d7b6c-fb0a-475e-8a28-c125e30d15f0,Host With Invalid Pattern,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/host_with_invalid_pattern,openapi-queries,"Host field should be an IP or a valid host name<br>
[Documentation](https://swagger.io/specification/v2/#swagger-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
host: 127.0.0.1
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer","---
swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
host: kics.io/test
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer",[[6]]
859,3fb03214-25d4-4bd4-867c-c2d8d708a483,Properties Missing Required Property (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/properties_missing_required_property,openapi-queries,"Schema Object should have all required properties defined<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
                        status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            properties:
              code:
                type: object
                required:
                  - name
                properties:
                  name:
                    type: string
                  age:
                    type: integer
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
                        status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            properties:
              code:
                type: object
                required:
                  - name
                properties:
                  age:
                    type: integer
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true",[[38]]
860,40d3df21-c170-4dbe-9c02-4289b51f994f,Schema Discriminator Mismatch Defined Properties (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_discriminator_mismatch_defined_properties,openapi-queries,"Schema discriminator values should match defined properties.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
        petType:
          type: string
      required:
        - petType","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType",[[32]]
861,40e1d1bf-11a9-4f63-a3a2-a8b84c602839,API Key Exposed In Global Security Scheme,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/api_key_exposed_in_global_security_scheme,openapi-queries,"API Keys should not be transported over network<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          scopes:
            write: modify objects in your account
            read: read objects in your account
          authorizationUrl: https://example.com/oauth/authorize
          tokenUrl: https://example.com/oauth/token
security:
  - OAuth2:
      - write
      - read","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - apiKey1: []
    apiKey2: []
    apiKey3: []
components:
  securitySchemes:
    apiKey1:
      type: apiKey
      name: X-API-Key
      in: header
    apiKey2:
      type: apiKey
      name: X-API-Key
      in: cookie
    apiKey3:
      type: apiKey
      name: X-API-Key
      in: query","[[35, 39, 31]]"
862,4190dda7-af03-4cf0-a128-70ac1661ca09,Property 'allowReserved' of Encoding Object Ignored,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/property_allow_reserved_encoding_object_ignored,openapi-queries,"Property 'allowReserved' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#encoding-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true",[[31]]
863,429b2106-ba37-43ba-9727-7f699cc611e1,Unknown Property (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/unknown_property,openapi-queries,"All properties defined in OpenAPI objects should be known<br>
[Documentation](https://swagger.io/specification/v2/)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: OK
    parameters:
      - name: id
        in: path
        description: ID of pet to use
        required: true
        type: array
        items:
          type: string
        collectionFormat: csv
definitions:
  ErrorModel:
    type: object
    required:
      - message
      - code
    properties:
      message:
        type: string
      code:
        type: integer
        minimum: 100
        maximum: 600","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: OK
    parameters:
      - name: id
        in: path
        descripption: ID of pet to use
        required: true
        type: array
        items:
          type: string
        collectionFormat: csv
definitions:
  ErrorModel:
    type: object
    required:
      - message
      - code
    propppperties:
      message:
        type: string
      code:
        type: integer
        minimum: 100
        maximum: 600","[[16, 28]]"
864,462d6a1d-fed9-4d75-bb9e-3de902f35e6e,Undefined Scope 'securityScheme' On 'security' Field On Operations,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/undefined_security_scope_security_operations,openapi-queries,"Using a scope on security of operations that is undefined on 'securityScheme' can be defined by an attacker<br>
[Documentation](https://swagger.io/specification/#oauth-flow-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
      - oAuth2AuthCodeNeg2:
        - read:api
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            read:api: read your apis","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        oAuth2AuthCodeNeg2:
        - read:api
        - error:api
      responses:
        '200':
          description: 200 response
          content:
            application/json:
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            read:api: read your apis
            admin:api: admin scope
        password:
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            write:api: write your apis",[[11]]
865,46facedc-f243-4108-ab33-583b807d50b0,Parameter Object With Undefined Type,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/parameter_object_undefined_type,openapi-queries,"A Parameter Object must contain either a 'schema' property, or a 'content' property<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
      - name: name
        in: path
        description: Name of the API version
        required: true
        schema:
          type: string
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID","[[40, 26]]"
866,48e9e1fe-cf79-45b5-93e6-8b55ae5dadfd,Operation Without Successful HTTP Status Code (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/operation_without_successful_http_status_code,openapi-queries,"Operation Object should have at least one successful HTTP status code defined<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""300"":
          description: 300 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[10]]
867,4bcbcd52-3028-469f-bc14-02c7dbba2df2,Property 'allowEmptyValue' Improperly Defined (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/property_allow_empty_value_improperly_defined,openapi-queries,"Property 'allowEmptyValue' should be only defined for query parameters and formData parameters<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: query
        description: ID of the API version
        required: true
        allowEmptyValue: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: query
          name: id
          required: true
          allowEmptyValue: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        allowEmptyValue: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          allowEmptyValue: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","[[26, 37]]"
868,4cac7ace-b0fb-477d-830d-65395d9109d9,Schema Object Incorrect Ref (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/schema_object_incorrect_ref,openapi-queries,"Schema Object reference must always point to '#/components/schemas'<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemads/GeneralError""
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""",[[46]]
869,4cd8de87-b595-48b6-ab3c-1904567135ab,Encoding Header 'Content-Type' Improperly Defined,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/encoding_header_content_type_improperly_defined,openapi-queries,"Encoding Map Key should not define a 'Content-Type' in the 'headers' field. If so, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              contentType: image/png, image/jpeg","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            profileImage:
              headers:
                Content-Type:
                  contentType: image/png, image/jpeg",[[42]]
870,500ce696-d501-41dd-86eb-eceb011a386f,Schema Object is Empty (v3),OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_object_empty,openapi-queries,"The Schema Object should not be empty to avoid accepting any JSON values<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError: {}",[[27]]
871,50de3b5b-6465-4e06-a9b0-b4c2ba34326b,Header Object Without Schema,OpenAPI,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/header_object_without_schema,openapi-queries,"The header object should have schema defined<br>
[Documentation](https://swagger.io/specification/#header-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              headers:
                X-Rate-Limit-Limit:
                  description: The number of allowed requests in the current period
                  schema:
                    type: integer","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              headers:
                X-Rate-Limit-Limit:
                  description: The number of allowed requests in the current period",[[44]]
872,52c0d841-60d6-4a81-88dd-c35fef36d315,Invalid OAuth2 Authorization URL (v3),OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/invalid_oauth_authorization_url,openapi-queries,"The field authorizationUrl on implicit or authorizationCode fields from OAuth must be a valid URL<br>
[Documentation](https://swagger.io/specification/#oauth-flow-object)","---
openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.my.company.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            write:api: modify apis in your account
            read:api: read your apis","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
components:
  securitySchemes:
    oAuth2AuthCodeNeg2:
      type: oauth2
      description: For more information, see https://api.my.company.com/docs/oauth
      flows:
        authorizationCode:
          authorizationUrl: https://api.invalid.comp@#any.com/oauth/authorize
          tokenUrl: https://api.my.company.com/oauth/token
          scopes:
            write:api: modify apis in your account
            read:api: read your apis",[[32]]
873,543e38f4-1eee-479e-8eb0-15257013aa0a,Global security field has an empty object (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/security_empty_object_definition,openapi-queries,"Global security definition must not have empty objects<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
- exampleSecurity: []
components:
  exampleSecurity:
    type: http
    scheme: basic

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message
          examples:
            foo:
              value:
                versions:
                  - status: CURRENT
                    updated: ""2011-01-21T11:33:21Z""
                    id: v2.0
                    links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
  - exampleSecurity: []","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message
          examples:
            foo:
              value:
                versions:
                  - status: CURRENT
                    updated: ""2011-01-21T11:33:21Z""
                    id: v2.0
                    links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security: {}",[[38]]
874,561710b1-b845-4562-95ce-2397a05ccef4,Template Path With No Corresponding Path Parameter (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/template_path_parameter_with_no_corresponding_path_parameter,openapi-queries,"The template path must have a corresponding path parameter for a given operation<br>
[Documentation](https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.2.md#pathTemplating)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        type: string
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          type: string
      responses:
        ""200"":
          description: 200 response","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  /users/{test-id}:
    get:
      parameters:
        - in: header
          name: test-id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer

openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /people/{id}:
    get:
      parameters: {}
      responses:
        ""200"":
          description: 200 response
  /users/{id}:
    get:
      parameters: {}
      responses:
        ""200"":
          description: 200 response","[[10], [40, 34]]"
875,58f06434-a88c-4f74-826c-db7e10cc7def,Request Body Object With Incorrect Media Type,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/request_body_object_with_incorrect_media_type,openapi-queries,"The field 'content' of the request body object should be set to 'multipart' or 'application/x-www-form-urlencoded' when field 'encoding' is set.<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg",[[41]]
876,5915c20f-dffa-4cee-b5d4-f457ddc0151a,Empty Array,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/empty_array,openapi-queries,"All array fields should not be empty<br>
[Documentation](https://swagger.io/specification/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - OAuth2:
      - scope1
      - scope2
components:
  securitySchemes:
    - exampleSecurity:
        type: http
        scheme: basic","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security: []",[[25]]
877,59c2f769-7cc2-49c8-a3de-4e211135cfab,Property 'allowEmptyValue' Ignored,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/property_allow_empty_value_ignored,openapi-queries,"Property 'allowEmptyValue' is ignored in the following cases: {sytle: simple, explode: false}, {sytle: simple, explode: true}, {sytle: spaceDelimited, explode: false}, {sytle: pipeDelimited, explode: false}, and {sytle: deepObject, explode: true}<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        style: label
        description: ID of the API version
        required: true
        allowEmptyValue: true
        schema:
          type: integer","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        allowEmptyValue: true
        schema:
          type: integer",[[30]]
878,5aea1d7e-b834-4749-b143-2c7ec3bd5922,Invalid Tag External Documentation URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_tag_external_documentation_url,openapi-queries,"Tag External Documentation URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#external-documentation-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
tags:
  - name: pets
    description: Everything about your Pets
    externalDocs:
      url: http://docs.my-api.com/pet-operations.htm
  - name: store
    description: Access to Petstore orders
    externalDocs:
      url: http://docs.my-api.com/store-orders.htm","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
tags:
  - name: pets
    description: Everything about your Pets
    externalDocs:
      url: /
  - name: store
    description: Access to Petstore orders
    externalDocs:
      url: /","[[26, 30]]"
879,5e5ecb9d-04b5-4e4f-b5a5-6ee04279b275,Object Without Required Property (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/object_without_required_property,openapi-queries,"OpenAPI Object should contain all of its required fields<br>
[Documentation](https://swagger.io/specification/v2/)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    type: string","swagger: ""2.0""
info:
  title: Simple API Overview
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true","[[2, 13]]"
880,5ea61624-3733-4a3a-8ca4-b96fec9c5aeb,Invalid Operation External Documentation URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_operation_external_documentation_url,openapi-queries,"Operation External Documentation URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#external-documentation-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      externalDocs:
        url: http://docs.my-api.com/store-orders.htm
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      externalDocs:
        url: /
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  exampleSecurity:
    type: http
    scheme: basic",[[11]]
881,60b5f56b-66ff-4e1c-9b62-5753e16825bc,Success Response Code Undefined for Put Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_put_operation,openapi-queries,"Put should define at least one success response (200, 201, 202 or 204)<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        default:
          description: Error
    put:
      operationId: updateItem
      summary: Update item
      responses:
        ""201"":
          description: Item created successfully
        ""204"":
          description: Item updated successfully
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    put:
      operationId: updateItem
      summary: Updated item
      responses:
        default:
          description: Error",[[10]]
882,60fb6621-9f02-473b-9424-ba9a825747d3,Link Object With Both 'operationId' And 'operationRef',OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/link_object_with_both_operation_id_and_operation_ref,openapi-queries,"Link object 'OperationId' should not have both 'operationId' and 'operationRef' defined since they are mutually exclusive.<br>
[Documentation](https://swagger.io/specification/#link-object)",,,[]
883,663c442d-f918-4f62-b096-0bf5dcbeb655,Security Field On Operations Has An Empty Array (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/security_operations_empty_array,openapi-queries,"Security object for operations, if defined, must define a security scheme, otherwise it should be considered an error<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - OAuth2:
            - write
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - OAuth2:
      - read

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - OAuth2:
            - write
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message",,[]
884,68e5fcac-390c-4939-a373-6074b7be7c71,Security Scheme Using HTTP Basic,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_scheme_using_http_basic,openapi-queries,"Security Scheme HTTP should not be using basic authentication<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://example.com/api/oauth/dialog
          tokenUrl: https://example.com/api/oauth/token
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: basic",[[33]]
885,6952a7e0-6e48-4285-bbc1-27c64e60f888,Invalid Schema External Documentation URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_schema_external_documentation_url,openapi-queries,"Schema External Documentation URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#external-documentation-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
      externalDocs:
        url: http://docs.my-api.com/store-orders.htm","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
      externalDocs:
        url: /",[[35]]
886,698a464e-bb3e-4ba8-ab5e-e6599b7644a0,Components Parameter Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_parameter_definition_unused,openapi-queries,"Components parameters definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
      parameters:
      - ""$ref"": ""#/components/parameters/limitParam""
components:
  parameters:
    limitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
components:
  parameters:
    limitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer",[[15]]
887,6998389e-66b2-473d-8d05-c8d71ac4d04d,Array Without Maximum Number of Items (v3),OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/array_without_maximum_number_items,openapi-queries,"Array schema should have the field 'maxItems' set<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      properties:
        code:
          type: string
          format: int32
        message:
          type: array
          maxItems: 5
          items:
            type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      properties:
        code:
          type: string
          format: int32
        message:
          type: array
          items:
            type: string",[[32]]
888,69d7aefd-149d-47b8-8d89-1c2181a8067b,Path Parameter With No Corresponding Template Path (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/path_parameter_with_no_corresponding_template_path,openapi-queries,"The path parameter must have a corresponding template path for a given operation<br>
[Documentation](https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.0.2.md#pathTemplating)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.c
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
  /people/{id}:
    get:
      parameters:
        - name: id
          in: path
          description: ID of pet to use
          required: true
          type: array
          items:
            type: string
          collectionFormat: csv","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  /users/:
    get:
      parameters:
        - in: header
          name: test-id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
  ""/yada/foo"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.c
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
  /people/foo:
    get:
      parameters:
        - name: id
          in: path
          description: ID of pet to use
          required: true
          type: array
          items:
            type: string
          collectionFormat: csv","[[16], [29]]"
889,6a2c219f-da5e-4745-941e-5ea8cde23356,Example JSON Reference Does Not Exist,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_example,openapi-queries,"Example reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
              examples:
                objectExample:
                  ""$ref"": ""#/components/examples/objectExample""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  examples:
    objectExample:
      value:
        id: '1'
        name: new object
      summary: A sample object","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
              examples:
                objectExample:
                  ""$ref"": ""#/components/examples/wrongExample""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  examples:
    objectExample:
      value:
        id: '1'
        name: new object
      summary: A sample object",[[19]]
890,6b76f589-9713-44ab-97f5-59a3dba1a285,Components Request Body Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_request_body_definition_unused,openapi-queries,"Components request bodies definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
      requestBody:
        ""$ref"": ""#/components/requestBodies/MyObjectBody""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  requestBodies:
    MyObjectBody:
      description: A JSON object containing my object information
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/MyObject""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  requestBodies:
    MyObjectBody:
      description: A JSON object containing my object information
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/MyObject""",[[23]]
891,6c35d2c6-09f2-4e5c-a094-e0e91327071d,Response Code Missing (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/response_code_missing,openapi-queries,"500, 429 and 400 responses should be defined for all operations, except head operation. 415 response should be defined for the post, put, and patch operations. 404 response should be defined for the get, put, head, delete operations. 200 response should be defined for options operation. 401 and 403 response should be defined for all operations when the security field is defined.<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    put:
      operationId: putItem
      summary: Put item
      responses:
        ""500"":
          description: 500 response
        ""429"":
          description: 429 response
        ""400"":
          description: 400 response
        ""404"":
          description: 404 response
        ""415"":
          description: 415 response
    options:
      operationId: optionsItem
      summary: Options item
      responses:
        ""200"":
          description: 200 response
        ""500"":
          description: 500 response
        ""429"":
          description: 429 response
        ""400"":
          description: 400 response

components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    put:
      operationId: putItem
      summary: Put item
      responses:
        default:
          description: Error
    options:
      operationId: optionsItem
      summary: Options item
      responses:
        default:
          description: Error
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
        - code
        - message","[[16, 10]]"
892,6d2e0790-cc3d-4c74-b973-d4e8b09f4455,Global Schema Definition Not Being Used,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/unused_schema_definition,openapi-queries,"All global schemas definitions should be in use<br>
[Documentation](https://swagger.io/specification/v2/#definitionsObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: category
          in: body
          description: max records to return
          required: true
          schema:
            $ref: ""#/definitions/Category""
definitions:
  Category:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: category
          in: body
          description: max records to return
          required: true
          schema:
            $ref: ""#/definitions/Category""
definitions:
  Category:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string
  Tag:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[29]]
893,72d259ca-9741-48dd-9f62-eb11f2936b37,Header Parameter Named as 'Content-Type' (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/header_parameter_named_as_content_type,openapi-queries,"The header Parameter should not be named as 'Content-Type'. If so, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Content-Type
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: Content-Type
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","[[26, 36]]"
894,73c3bc54-3cc6-4c0a-b30a-e19f2abfc951,Non Body Parameter Without Schema,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/non_body_parameter_with_schema,openapi-queries,"The Body Parameter Object should have the attribute 'schema' defined<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: query
        description: max records to return
        required: true
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: path
    description: max records to return
    required: true","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: query
        description: max records to return
        required: true
        schema:
          type: integer
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: path
    description: max records to return
    required: true
    schema:
      type: integer","[[26, 13]]"
895,750b40be-4bac-4f59-bdc4-1ca0e6c3450e,Property Not Unique,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/property_not_unique,openapi-queries,"Every defined property must be unique throughout the whole API<br>
[Documentation](https://swagger.io/specification/v2/#schemaObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
basePath: ""/api""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
              address:
                $ref: ""#/definitions/Address""
              age:
                type: integer
                format: int32
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object
    properties:
      name_2:
        type: string
      address_2:
        $ref: ""#/definitions/Address""
      age_2:
        type: integer
        format: int32","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
basePath: ""/api""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
            properties:
              name:
                type: string
              address:
                $ref: ""#/definitions/Address""
              age:
                type: integer
                format: int32
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object
    properties:
      name:
        type: string
      address:
        $ref: ""#/definitions/Address""
      age:
        type: integer
        format: int32","[[38, 40, 42, 22, 24, 26]]"
896,750f6448-27c0-49f8-a153-b81735c1e19c,Multi 'collectionformat' Not Valid For 'in' Parameter,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/multi_collectionformat_not_valid_in_parameter,openapi-queries,"When 'collectionformat' is defined as 'multi', 'in' field must be 'query' or 'formData'<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: query
        description: max records to return
        required: true
        type: array
        items:
          type: integer
          format: int64
        collectionFormat: multi
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: path
    description: max records to return
    required: true
    type: array
    items:
      type: integer
      format: int64
    collectionFormat: csv","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: path
        description: max records to return
        required: true
        type: array
        items:
          type: integer
          format: int64
        collectionFormat: multi
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: path
    description: max records to return
    required: true
    type: array
    items:
      type: integer
      format: int64
    collectionFormat: multi","[[10, 26]]"
897,77276d82-4f45-4cf1-8e2b-4d345b936228,Global Security Scheme Using Basic Authentication,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/global_security_scheme_using_basic_authentication,openapi-queries,"A security scheme is allowing basic authentication credentials to be transported over network<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple KICS API
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersions
      summary: List versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
servers:
  - url: https://kicsapi.server.com/
    description: API server
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          scopes:
            write: modify objects in your account
            read: read objects in your account
          authorizationUrl: https://kicsauthenticator.com/oauth/authorize
          tokenUrl: https://kicsauthenticator.com/oauth/token
security:
  - OAuth2:
      - write
      - read","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersions
      summary: List versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
servers:
  - url: http://kicsapi.server.com/
    description: API server
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic",[[30]]
898,773116aa-2e6d-416f-bd85-f0301cc05d76,Security Definitions Allows Password Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/security_definitions_allows_password_flow,openapi-queries,"Security Definition Object should not allow 'password' Flow in OAuth2 authentication<br>
[Documentation](https://swagger.io/specification/v2/#securitySchemeObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: password
    tokenUrl: https://api.my.company.com/oauth/token",[[19]]
899,7a01dfbd-da62-4165-aed7-71349ad42ab4,Response JSON Reference Does Not Exist (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_response,openapi-queries,"Response reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '404':
          ""$ref"": ""#/components/responses/NotFound""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        required:
        - code
        - message
  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/Error""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '404':
          ""$ref"": ""#/components/responses/NotRight""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        required:
        - code
        - message
  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/Error""",[[12]]
900,7f203940-39c4-4ea7-91ee-7aba16bca9e2,Property 'allowReserved' Improperly Defined,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/property_allow_reserved_improperly_defined,openapi-queries,"Property 'allowReserved' should be only defined for query parameters<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: query
        description: ID of the API version
        required: true
        allowReserved: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: query
          name: id
          required: true
          allowReserved: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        allowReserved: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          allowReserved: true
          description: The user ID
          schema:
            type: integer
            minimum: 1","[[26, 37]]"
901,7f91992f-b4c8-43bf-9bf9-fae9ecdb6e3a,File Parameter With Wrong Consumes Property,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/file_parameter_with_wrong_consumes_property,openapi-queries,"Operations file parameters consumes must be 'multipart/form-data', 'application/x-www-form-urlencoded' or both<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
      - name: File
        type: file
        in: formData
      consumes:
      - multipart/form-data
      responses:
        '200':
          description: 200 response
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
      - name: File
        type: file
        in: formData
      consumes:
      - application/json
      responses:
        '200':
          description: 200 response
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[10]]
902,801f0c6a-a834-4467-89c6-ddecffb46b5a,Link JSON Reference Does Not Exist,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_link,openapi-queries,"Link reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
          links:
            ""$ref"": ""#/components/links/APIRepository""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  links:
    APIRepository:
      operationId: listVersionsv2","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
          links:
            ""$ref"": ""#/components/links/APIWrongRepository""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  links:
    APIRepository:
      operationId: listVersionsv2",[[20]]
903,815021c8-a50c-46d9-b192-24f71072c400,Paths Object is Empty (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/paths_object_empty,openapi-queries,"Paths object may be empty due to ACL constraints, meaning they are not exposed<br>
[Documentation](https://swagger.io/specification/#paths-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths: {}",[[5]]
904,84c826c9-1893-4b34-8cdd-db97645b4bf3,Path Without Operation (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/path_without_operation,openapi-queries,"Path object should have at least one operation object defined<br>
[Documentation](https://swagger.io/specification/#path-item-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      servers:
        - url: https://development.gigantic-server.com/v1
          description: Development server
        - url: https://staging.gigantic-server.com/v1
          description: Staging server
        - url: https://api.gigantic-server.com/v1
          description: Production server
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"": {}",[[6]]
905,86b1fa30-9790-4980-994d-a27e0f6f27c1,Cleartext Credentials With Basic Authentication For Operation,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/cleartext_credentials_with_basic_auth_for_operation,openapi-queries,"Cleartext credentials over unencrypted channel should not be accepted for the operation<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          scopes:
            write: modify objects
            read: read objects
          authorizationUrl: https://myapi.com/oauth/authorize
          tokenUrl: https://myapi.com/oauth/token
paths:
  ""/"":
    get:
      operationId: listVersions
      summary: List versions
      servers:
        - url: http://myapi.com/
          description: server URL
      security:
        - OAuth2:
            - write
            - read
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic
paths:
  ""/"":
    get:
      operationId: listVersions
      summary: List versions
      servers:
        - url: http://myapi.com/
          description: server URL
      security:
        - regularSecurity: []
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[19]]
906,86e3702f-c868-44b2-b61d-ea5316c18110,Default Response Undefined On Operations (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/default_response_undefined_operations,openapi-queries,"Operations responses should have a default response defined<br>
[Documentation](https://swagger.io/specification/#responses-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        ""204"":
          description: Item deleted successfully
        default:
          description: Error
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        ""204"":
          description: Item updated successfully
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    patch:
      operationId: updateItem
      summary: Updated item
      responses:
        '204':
          description: Item deleted successfully
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
      required:
      - code
      - message",[[10]]
907,881a6e71-c2a7-4fe2-b9c3-dfcf08895331,Example Not Compliant With Schema Type (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/example_not_compliant_with_schema_type,openapi-queries,"Examples values and fields should be compliant with the schema type<br>
[Documentation](https://swagger.io/specification/#example-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: number
            example: 132
definitions:
  Tag:
    type: object
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string
    example:
      name: ""Puma""
      id: 1","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: string
            example: 132",[[20]]
908,8aee4754-970d-4c5f-8142-a49dfe388b1a,Server Object Variable Not Used,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/server_object_variable_not_used,openapi-queries,"Every defined Server Variable Object should be used in a Service URL.<br>
[Documentation](https://swagger.io/specification/#server-variable-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: https://development.{server}.com/{base}
                variables:
                  base:
                    default: v2
                  server:
                    default: gigant-server","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: https://development.{server}.com/{base}
                variables:
                  base:
                    default: v2
                  server:
                    default: gigant-server
                  another:
                    default: another",[[30]]
909,8af270ce-298b-4405-9922-82a10aee7a4f,Global Security Field Is Undefined (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/global_security_field_undefined,openapi-queries,"Global security field should be defined to prevent API to have insecure paths and have this rules defined on securitySchemes<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - petstore_auth:
      - write:pets
      - read:pets","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self",[[1]]
910,8bfed1c6-2d59-4924-bc7f-9b9d793ed0df,Parameter Object Content With Multiple Entries,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/parameter_object_content_with_multiple_entries,openapi-queries,"The map content property of the parameter object should only contain one entry<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
        - name: id
          in: path
          description: ID of the API version
          required: true
          schema:
            type: integer
          content:
            ""application/json"":
              schema:
                $ref: ""#/components/schemas/User""
              examples:
                user:
                  summary: User Example
                  externalValue: ""http://foo.bar/examples/user-example.json""
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
  /user/{id}:
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer
        content:
          ""application/json"":
            schema:
              $ref: ""#/components/schemas/User""
            examples:
              user:
                summary: User Example
                externalValue: ""http://foo.bar/examples/user-example.json""","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
        - name: id
          in: path
          description: ID of the API version
          required: true
          schema:
            type: integer
          content:
            ""application/json"":
              schema:
                $ref: ""#/components/schemas/User""
              examples:
                user:
                  summary: User Example
                  externalValue: ""http://foo.bar/examples/user-example.json""
            ""application/xml"":
              schema:
                $ref: ""#/components/schemas/User""
              examples:
                user:
                  summary: User Example in XML
                  externalValue: ""http://foo.bar/examples/user-example.xml""
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
  /user/{id}:
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        schema:
          type: integer
        content:
          ""application/json"":
            schema:
              $ref: ""#/components/schemas/User""
            examples:
              user:
                summary: User Example
                externalValue: ""http://foo.bar/examples/user-example.json""
          ""application/xml"":
            schema:
              $ref: ""#/components/schemas/User""
            examples:
              user:
                summary: User Example in XML
                externalValue: ""http://foo.bar/examples/user-example.xml""","[[48, 10]]"
911,8c81d6c0-716b-49ec-afa5-2d62da4e3f3c,String Schema with Broad Pattern (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/string_schema_with_broad_pattern,openapi-queries,"String schema should restrict the pattern<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          maxLength: 15
          format: int32
          pattern: ^[0-9a-z]{15}$
        message:
          type: string
          maxLength: 15
          pattern: ^[0-9a-z]{15}$
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          maxLength: 15
          format: int32
          pattern: .*
        message:
          type: string
          maxLength: 15
          pattern: ^[0-9a-z]{15}$
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""","[[51, 37]]"
912,8c8261c2-19a9-4ef7-ad37-b8bc7bdd4d85,Maximum Length Undefined (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/maximum_length_undefined,openapi-queries,"String schema should have 'maxLength' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          enum:
            - brown
            - grey
            - black
            - white
        message:
          type: string
          format: date
        extra:
          type: string
          format: date-time
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[34, 37, 47]]"
913,8c84f75e-5048-4926-a4cb-33e7b3431300,Header Parameter Named as 'Authorization' (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/header_parameter_named_as_authorization,openapi-queries,"The header Parameter should not be named as 'Authorization'. If so, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: Authorization
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","[[26, 36]]"
914,8d0921d6-4131-461f-a253-99e873f8f77e,Server URL Uses Undefined Variables,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/server_url_uses_undefined_variables,openapi-queries,"Any variable used in the Service URL should be defined in the Service Object through 'variables'.<br>
[Documentation](https://swagger.io/specification/#server-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: https://development.{server}.com/{base}
                variables:
                  base:
                    default: v2
                  server:
                    default: gigant-server","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: https://development.{server}.com/{base}",[[24]]
915,8db5544e-4874-4baa-9322-e9f75a2d219e,Field 'securityScheme' On Components Is Undefined,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_scheme_undefined,openapi-queries,"Components' securityScheme field must have a valid scheme<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
- exampleSecurity: []
components:
  securitySchemes:
    exampleSecurity:
      type: http
      scheme: basic",,[]
916,8fe1846f-52cc-4413-ace9-1933d7d23672,Parameter Object Without Schema,OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/parameter_object_without_schema,openapi-queries,"The Parameter Object should have the attribute 'schema' defined<br>
[Documentation](https://swagger.io/specification/#parameter-object)",,"openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      parameters:
        - name: id
          in: path
          description: ID of the API version
          required: true
          content:
            ""application/json"":
              schema:
                $ref: ""#/components/schemas/User""
              examples:
                user:
                  summary: User Example
                  externalValue: ""http://foo.bar/examples/user-example.json""
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
  /user/:
    parameters:
      - name: id
        in: path
        description: ID of the API version
        required: true
        content:
          ""application/json"":
            schema:
              $ref: ""#/components/schemas/User""
            examples:
              user:
                summary: User Example
                externalValue: ""http://foo.bar/examples/user-example.json""","[[10, 39]]"
917,9239c289-9e4c-4d92-8be1-9d506057c971,Invalid License URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_license_url,openapi-queries,"License Object URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#license-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  license:
    name: ""Apache 2.0""
    url: ""https://www.apache.org/licenses/ LICENSE-2.0.html""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[7]]
918,962fa01e-b791-4dcc-b04a-4a3e7389be5e,Components Schema Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_schema_definition_unused,openapi-queries,"Components schemas definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
    MyObject2:
      type: object
      properties:
        id:
          type: string
        name:
          type: string",[[22]]
919,9670f240-7b4d-4955-bd93-edaa9fa38b58,Path Server Object Uses HTTP (v3),OpenAPI,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/path_server_uses_http,openapi-queries,"The property 'url' in the Path Server Object should only allow 'HTTPS' protocols to ensure an encrypted connection<br>
[Documentation](https://swagger.io/specification/#server-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      servers:
        - url: https://development.gigantic-server.com/v1
          description: Development server
        - url: https://staging.gigantic-server.com/v1
          description: Staging server
        - url: https://api.gigantic-server.com/v1
          description: Production server
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      servers:
        - url: https://development.gigantic-server.com/v1
          description: Development server
        - url: https://staging.gigantic-server.com/v1
          description: Staging server
        - url: http://api.gigantic-server.com/v1
          description: Production server
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[15]]
920,96729c6b-7400-4d9e-9807-17f00cdde4d2,No Global And Operation Security Defined (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/no_global_and_operation_security_defined,openapi-queries,"All paths should have security scheme, if it is omitted, global security field should be defined<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
- exampleSecurity: []
components:
  exampleSecurity:
    type: http
    scheme: basic","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self",[[7]]
921,96beb800-566f-49a9-a0ea-dbdf4bc80429,JSON '$ref' alongside other properties (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/json_ref_alongside_properties,openapi-queries,"Each field on Open API specification which accepts '$ref', infers that field is using a reference object, which has only '$ref' key<br>
[Documentation](https://swagger.io/specification/#reference-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              schema:
                type: integer
                ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string",[[15]]
922,98295b32-ec09-4b5b-89a9-39853197f914,Schema JSON Reference Does Not Exist (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/json_reference_does_not_exists_schema,openapi-queries,"Schema reference should exist on definitions field<br>
[Documentation](https://swagger.io/specification/v2/#definitionsObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","---
swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            ""$ref"": ""#/definitions/Use""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[14]]
923,990eaf09-d6f1-4c3c-b174-a517b1de8917,Responses Object Is Empty (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/responses_object_is_empty,openapi-queries,"Responses Object should not be empty<br>
[Documentation](https://swagger.io/specification/#responses-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
        ""3xx"":
          description: ""[300-399] response""
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:",[[10]]
924,9aa6e95c-d964-4239-a3a8-9f37a3c5a31f,Undefined Scope 'securityDefinition' On Global 'security' Field,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/undefined_security_scope_global_security,openapi-queries,"Using a scope on global security field that is undefined on 'securityDefinitions' can be defined by an attacker<br>
[Documentation](https://swagger.io/specification/v2/#security-scheme-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  /:
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: Success
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: authorizationCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      read:api: read your apis
security:
  oAuth2AuthCodeNeg2:
    - read:api","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  /:
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: Success
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: authorizationCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      read:api: read your apis
security:
  oAuth2AuthCodeNeg2:
    - read:api
    - error:api",[[23]]
925,9c3ea128-7e9a-4b4c-8a32-75ad17a2d3ae,Components Response Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_response_definition_unused,openapi-queries,"Components responses definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '404':
          ""$ref"": ""#/components/responses/NotFound""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        required:
        - code
        - message
  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/Error""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        required:
        - code
        - message
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  responses:
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/Error""",[[33]]
926,9d967a2b-9d64-41a6-abea-dfc4960299bd,JSON Object Schema Without Properties (v3),OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/json_object_schema_without_properties,openapi-queries,"Schema of the JSON object should have properties defined and 'additionalProperties' set to false.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""",[[40]]
927,9f88c88d-824d-4d9a-b985-e22977046042,Additional Properties Too Permissive,OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/additional_properties_too_permissive,openapi-queries,"Objects should not accept 'additionalProperties' if it is possible<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
            additionalProperties: 'false'
components:
  schemas:
    MyObject:
      oneOf:
      - type: object
        properties:
          id:
            type: string
          name:
            type: string
        additionalProperties: 'true'
      - type: string
        additionalProperties: 'false'","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            type: object
            properties:
              id:
                type: string
              name:
                type: string
            additionalProperties: 'true'
components:
  schemas:
    MyObject:
      oneOf:
      - type: object
        properties:
          id:
            type: string
          name:
            type: string
        additionalProperties: 'true'
      - type: string
        additionalProperties: 'false'",[[19]]
928,a0bf7382-5d5a-4224-924c-3db8466026c9,Server URL Not Absolute,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/server_url_not_absolute,openapi-queries,"The Server URL should be an absolute URL<br>
[Documentation](https://swagger.io/specification/#server-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: https://development.gigantic-server.com/v1","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid: # the unique user id
                    type: string
                    format: uuid
          links:
            address:
              server:
                url: /development.gigantic-server.com/v1",[[24]]
929,a19c3bbd-c056-40d7-9e1c-eeb0634e320d,Additional Properties Too Restrictive,OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/additional_properties_too_restrective,openapi-queries,"Objects should accept 'additionalProperties' if it is allOf or an object with anyOf or oneOf<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            allOf:
            - type: object
              properties:
                id:
                  type: string
                name:
                  type: string
              additionalProperties: 'true'
            - type: string
components:
  schemas:
    MyObject:
      oneOf:
      - type: object
        properties:
          id:
            type: string
          name:
            type: string
        additionalProperties: 'true'
      - type: string
        additionalProperties: 'false'","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          schema:
            allOf:
            - type: object
              properties:
                id:
                  type: string
                name:
                  type: string
              additionalProperties: 'true'
            - type: string
components:
  schemas:
    MyObject:
      oneOf:
      - type: object
        properties:
          id:
            type: string
          name:
            type: string
        additionalProperties: 'false'
      - type: string
        additionalProperties: 'false'",[[25]]
930,a4247b11-890b-45df-bf42-350a7a3af9be,Security Scheme Using HTTP Digest,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_scheme_using_http_digest,openapi-queries,"Security Scheme HTTP should not be using digest authentication<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://example.com/api/oauth/dialog
          tokenUrl: https://example.com/api/oauth/token
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: digest",[[33]]
931,a46928f1-43d7-4671-94e0-2dd99746f389,Schemes Uses HTTP,OpenAPI,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/schemes_uses_http copy,openapi-queries,"Schemes should use 'https' protocol instead of 'http'. Scheme using 'http' allows for clear text credentials<br>
[Documentation](https://swagger.io/specification/v2/#swaggerObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      schemes:
        - https
      responses:
        ""200"":
          description: 200 response","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      schemes:
        - http
      responses:
        ""200"":
          description: 200 response",[[11]]
932,a4dd69b8-49fa-45d2-a060-c76655405b05,Property 'explode' of Encoding Object Ignored,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/property_explode_encoding_object_ignored,openapi-queries,"Property 'explode' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#encoding-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              explode: true","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              explode: true",[[31]]
933,a5375be3-521c-43bb-9eab-e2432e368ee4,Unknown Prefix (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/unknown_prefix,openapi-queries,"The media type prefix should be set as 'application', 'audio', 'font', 'example', 'image', 'message', 'model', 'multipart', 'text' or 'video'<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              contentType: image/png, image/jpeg","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        sssssss/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            profileImage:
              contentType: image/png, image/jpeg",[[30]]
934,a599b0d1-ff89-4cb8-9ece-9951854c06f6,Security Requirement Not Defined In Security Definition,OpenAPI,High,Structure and Semantics,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/security_requirement_not_defined_in_security_definition,openapi-queries,"All security requirement objects must be defined in 'securityDefinitions'<br>
[Documentation](https://swagger.io/specification/v2/#securityRequirementObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
security:
  - petstore_auth:
      - write:pets
      - read:pets
securityDefinitions:
  api_key:
    type: apiKey
    name: api_key
    in: header
  petstore_auth:
    type: oauth2
    authorizationUrl: http://swagger.io/api/oauth/dialog
    flow: implicit
    scopes:
      write:pets: modify pets in your account
      read:pets: read your pets","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
security:
  - petstore_auth:
      - write:pets
      - read:pets
securityDefinitions:
  api_key:
    type: apiKey
    name: api_key
    in: header",[[21]]
935,a6847dc6-f4ea-45ac-a81f-93291ae6c573,Path Scheme Accepts HTTP (v2),OpenAPI,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/path_scheme_accepts_http,openapi-queries,"The Scheme list of Operation Object should only allow 'HTTPS' protocol to ensure an encrypted connection<br>
[Documentation](https://swagger.io/specification/v2/#operationObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      schemes:
        - https
      responses:
        ""200"":
          description: 200 response","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      schemes:
        - http
      responses:
        ""200"":
          description: 200 response",[[11]]
936,a68da022-e95a-4bc2-97d3-481e0bd6d446,Components Header Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_header_definition_unused,openapi-queries,"Components headers definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
              headers:
                X-Pages:
                  ""$ref"": ""#/components/headers/xPages""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  headers:
    xPages:
      schema:
        type: integer
        description: number of pages","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  headers:
    xPages:
      schema:
        type: integer
        description: number of pages",[[29]]
937,a8e859da-4a43-4e7f-94b8-25d6e3bf8e90,Items Undefined (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/items_undefined,openapi-queries,"Schema/Parameter items should be defined when the schema/parameter is set to an array.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: array
      items:
        type: string
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: array
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name",[[27]]
938,a9228976-10cf-4b5f-b902-9e962aad037a,Type Has Invalid Keyword (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/type_has_invalid_keyword,openapi-queries,"Schema Object define type should not use a keyword of another type<br>
[Documentation](https://swagger.io/specification/#schema-object)","---
openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
              examples:
                objectExample:
                  ""$ref"": ""#/components/examples/objectExample""
components:
  schemas:
    MyObject:
      type: object
      required:
      - id
      properties:
        id:
          type: integer
          minimum: 1
        name:
          type: string
          minLength: 3
        phones:
          type: array
          items:
            type: string
            pattern: ""\\(\\d{3}\\) ?\\d{3}-\\d{4}""
          minItems: 1
  examples:
    objectExample:
      value:
        id: '1'
        name: new object
      summary: A sample object","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  /:
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: Success
          headers:
            X-Rate-Limit-Limit:
              description: The number of allowed requests in the current period
              type: integer
              minLength: 3

openapi: ""3.0.2""
info:
  title: POI Search
  version: ""1.0.1""
servers:
  - url: https://api.server.test/v1
paths:
  /test:
    summary: test test
components:
  schemas:
    PointGenre:
      type: string
      minimum: 13
      maximum: 13","[[17], [14, 15]]"
939,a92be1d5-d762-484a-86d6-8cd0907ba100,Response on operations that should have a body has undefined schema (v3),OpenAPI,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/response_operations_body_schema_undefined,openapi-queries,"If a response is not head or its code is not 204 or 304, it should have a schema defined<br>
[Documentation](https://swagger.io/docs/specification/describing-responses/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/ApiVersion""
    delete:
      operationId: deleteVersion
      summary: Deletes API versions
      responses:
        ""204"":
          description: no content
components:
  schemas:
    ApiVersion:
      type: object
      discriminator:
        propertyName: ApiVersion
      properties:
        code:
          type: integer
          format: int32
        version:
          type: string","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
    delete:
      operationId: deleteVersion
      summary: Deletes API versions
      responses:
        ""204"":
          description: no content",[[15]]
940,a96bbc06-8cde-4295-ad3c-ee343a7f658e,Default Invalid (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/default_invalid,openapi-queries,"The field 'default' of Schema Object should be consistent with the schema's type<br>
[Documentation](https://swagger.io/specification/#schema-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: array
            items:
              type: string
            default:
              - a","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: array
            items:
              type: string
            default: { ""a"": ""b"" }",[[17]]
941,ab1263c2-81df-46f0-9f2c-0b62fdb68419,Security Field Undefined,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_field_undefined,openapi-queries,"Security field should be defined in '#/components/securitySchemes'<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - petstore_auth:
      - write:pets
      - read:pets
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic
    petstore_auth:
      type: oauth2
      flows:
        implicit:
          authorizationUrl: http://example.org/api/oauth/dialog
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - petstore_auth:
      - write:pets
      - read:pets",[[26]]
942,ab2af219-cd08-4233-b5a1-a788aac88b51,Property Defining Minimum Greater Than Maximum (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/property_defining_maximum_not_greater_than_minimum,openapi-queries,"Property defining minimum has greater value than maximum defined<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 1
          maximum: 3
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 3
          maximum: 1
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[33, 47]]"
943,ae13a37d-943b-47a7-a970-83c8598bcca3,Path Template is Empty (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/path_template_empty,openapi-queries,"All path templates should not be empty<br>
[Documentation](https://swagger.io/specification/#paths-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/users/{id}"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
definitions:
  ErrorModel:
    type: object
    required:
      - message
      - code
    properties:
      message:
        type: string
      code:
        type: integer
        minimum: 100
        maximum: 600","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Authorization
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{}:
    get:
      parameters:
        - in: path
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/users/{}"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
definitions:
  ErrorModel:
    type: object
    required:
      - message
      - code
    properties:
      message:
        type: string
      code:
        type: integer
        minimum: 100
        maximum: 600","[[32], [10]]"
944,aecee30b-8ea1-4776-a99c-d6d600f0862f,API Key Exposed In Global Security (v3),OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/api_key_exposed_in_global_security,openapi-queries,"API Keys should be transported using a secure method such as HTTPS. Define a security scheme that uses a secure method to transport the API key.<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          scopes:
            write: modify objects in your account
            read: read objects in your account
          authorizationUrl: https://example.com/oauth/authorize
          tokenUrl: https://example.com/oauth/token
security:
  - OAuth2:
      - write
      - read","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - apiKey1: []
    apiKey2: []
    apiKey3: []
components:
  securitySchemes:
    apiKey1:
      type: apiKey
      name: X-API-Key
      in: header
    apiKey2:
      type: apiKey
      name: X-API-Key
      in: cookie
    apiKey3:
      type: apiKey
      name: X-API-Key
      in: query","[[26, 27, 28]]"
945,b05bb927-2df5-43cc-8d7b-6825c0e71625,Components Example Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_example_definition_unused,openapi-queries,"Components examples definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
              examples:
                objectExample:
                  ""$ref"": ""#/components/examples/objectExample""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  examples:
    objectExample:
      value:
        id: '1'
        name: new object
      summary: A sample object","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  examples:
    objectExample:
      value:
        id: '1'
        name: new object
      summary: A sample object",[[27]]
946,b1a7fcb0-2afe-4d5c-a6a1-4e6311fc29e7,Invalid Contact Email (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_contact_email,openapi-queries,"Contact Object Email should be a valid email<br>
[Documentation](https://swagger.io/specification/#contact-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    url: ""https://www.google.com/""
    email: ""user@gmail.com""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: ""contact""
    url: ""https://www.google.com/""
    email: ""user@gmail.c""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[8]]
947,b2d9dbf6-539c-4374-a1fd-210ddf5563a8,Invalid Global External Documentation URL (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_global_external_documentation_url,openapi-queries,"Global External Documentation URL should be a valid URL<br>
[Documentation](https://swagger.io/specification/#external-documentation-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
externalDocs:
  url: http://docs.my-api.com/store-orders.htm","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
externalDocs:
  url: /",[[26]]
948,b2f275be-7d64-4064-b418-be6b431363a7,Success Response Code Undefined for Get Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_get_operation,openapi-queries,"Get should define at least one success response (200 or 202)<br>
[Documentation](https://swagger.io/specification/#operation-object)","swagger: ""2.0""
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    get:
      operationId: getItem
      summary: Get item
      responses:
        ""200"":
          description: success
        default:
          description: Success
    patch:
      operationId: updateItem
      summary: Update item
      responses:
        default:
          description: Error","swagger: ""2.0""
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    get:
      operationId: getItem
      summary: Get item
      responses:
        default:
          description: Error",[[10]]
949,b30981fa-a12e-49c7-a5bb-eeafb61d0f0f,Global Parameter Definition Not Being Used,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/unused_parameter_definition,openapi-queries,"All global parameters definitions should be in use<br>
[Documentation](https://swagger.io/specification/v2/#parametersDefinitionsObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: string","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - ""$ref"": ""#/parameters/limitParame""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: string",[[16]]
950,b3871dd8-9333-4d6c-bd52-67eb898b71ab,Response Object With Incorrect Ref (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/response_object_incorrect_ref,openapi-queries,"Response Object reference must always point to '#/components/responses'<br>
[Documentation](https://swagger.io/specification/#responses-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  responses:
    Success:
      description: 200 response
      content:
        application/json:
          examples:
            foo:
              value:
                versions:
                  - status: CURRENT
                    updated: ""2011-01-21T11:33:21Z""
                    id: v2.0
                    links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/components/responses/Success""","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  Success:
    description: 200 response
    content:
      application/json:
        examples:
          foo:
            value:
              versions:
                - status: CURRENT
                  updated: ""2011-01-21T11:33:21Z""
                  id: v2.0
                  links:
                    - href: http://127.0.0.1:8774/v2/
                      rel: self
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/components/schemas/Success""",[[27]]
951,b4803607-ed72-4d60-99e2-3fa6edf471c6,BasePath With Wrong Format,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/basepath_with_wrong_format,openapi-queries,"The 'basePath' value format must match the pattern '^/'<br>
[Documentation](https://swagger.io/specification/v2/#schema)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
basePath: ""/api""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
basePath: ""api/incorrect""
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object",[[5]]
952,b481d46c-9c61-480f-86d9-af07146dc4a4,Schema Discriminator Not Required (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_discriminator_not_required,openapi-queries,"The discriminator property in the Schema Object should be a required property<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        petType:
          type: string
      required:
        - petType","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        petType:
          type: string
      required:
        - name",[[32]]
953,b90033cf-ad9f-4fb9-acd1-1b9d6d278c87,Multiple Body Parameters In The Same Operation,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/multi_body_parameters_same_operation,openapi-queries,"Only one body parameter is allowed on operation's parameters type field<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      - name: pageCount
        in: query
        description: records per page
        required: true
        schema:
          type: integer
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit
        in: body
        description: max records to return
        required: true
        schema:
          type: integer
      - name: limit2
        in: body
        description: max records to return
        required: true
        schema:
          type: string
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response",[[8]]
954,b9db8a10-020c-49ca-88c6-780e5fdb4328,Link Object Incorrect Ref,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/link_object_incorrect_ref,openapi-queries,"Link object reference must always point to '#/components/links'<br>
[Documentation](https://swagger.io/specification/#link-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid:
                    type: string
                    format: uuid
components:
  schemas:
    Pet:
      $ref: ""../models/pet.yaml""
    User:
      $ref: ""https://api.example.com/v2/openapi.yaml#/components/schemas/User""
  responses:
    NotFound:
      description: The specified resource was not found
      content:
        application/json:
          schema:
            $ref: ""#/components/schemas/Error""
      links:
        l:
          $ref: ""#/components/links/address""
  links:
    address:
      operationId: getUssssserAddress
      parameters:
        userId: $request.path.id","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      responses:
        ""200"":
          description: the user being returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  uuid:
                    type: string
                    format: uuid
components:
  schemas:
    Pet:
      $ref: ""../models/pet.yaml""
    User:
      $ref: ""https://api.example.com/v2/openapi.yaml#/components/schemas/User""
  responses:
    NotFound:
      description: The specified resource was not found
      content:
        application/json:
          schema:
            $ref: ""#/components/schemas/Error""
      links:
        l:
          $ref: ""#components/linfks/address""
  links:
    address:
      operationId: getUssssserAddress
      parameters:
        userId: $request.path.id",[[34]]
955,ba066cda-e808-450d-92b6-f29109754d45,Callback Object With Incorrect Ref,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/callback_object_incorrect_ref,openapi-queries,"Callback Object reference must always point to '#/components/callbacks'<br>
[Documentation](https://swagger.io/specification/#callback-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/components/schemas/Success""
      callbacks:
        myEvent:
          $ref: ""#/components/callbacks/inProgress""
components:
  callbacks:
    inProgress:
      ""{$request.body#/inProgressUrl}"":
        post:
          requestBody:
            $ref: ""#/components/requestBodies/callbackMessage1""
          responses:
            ""200"":
              description: OK","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/components/schemas/Success""
      callbacks:
        myEvent:
          $ref: ""#/components/callbaccgcks/inProgress""
components:
  callbacks:
    inProgress:
      ""{$request.body#/inProgressUrl}"":
        post:
          requestBody:
            $ref: ""#/components/requestBodies/callbackMessage1""
          responses:
            ""200"":
              description: OK",[[15]]
956,ba239cb9-f342-4c20-812d-7b5a2aa6969e,Non OAuth2 Security Requirement Defining OAuth2 Scopes,OpenAPI,Medium,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/non_oauth2_security_requirement_defining_oauth2_scopes,openapi-queries,"If the security scheme is not of type 'oauth2', the array value must be empty<br>
[Documentation](https://swagger.io/specification/v2/#securityRequirementObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
security:
  - petstore_auth: []
securityDefinitions:
  petstore_auth:
    type: basic","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
security:
  - petstore_auth:
      - write:pets
      - read:pets
securityDefinitions:
  petstore_auth:
    type: basic",[[21]]
957,baade968-7467-41e4-bf22-83ca222f5800,Security Field On Operations Has An Empty Object Definition (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/security_operations_empty_object_definition,openapi-queries,"Security object for operations should not be empty object or has any empty object definition<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
      - OAuth2:
        - write
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
- OAuth2:
  - read

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      security:
        - OAuth2:
            - write
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message",,[]
958,bac56e3c-1f71-4a74-8ae6-2fba07efcddb,Example JSON Reference Outside Components Examples,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/example_json_reference_outside_components_examples,openapi-queries,"Reference to examples should point to #/components/examples<br>
[Documentation](https://swagger.io/specification/#reference-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic
  schemas:
    ErrorModel:
      type: object
      properties:
        code:
          type: string
    Address:
      type: object
      properties:
        street:
          type: string
      required:
        - street
  examples:
    Address:
      summary: user address
      value: { ""street"": ""my street"" }
paths:
  ""/"":
    post:
      operationId: updateAddress
      summary: updateAddress
      servers:
        - url: http://kicsapi.com/
          description: server URL
      responses:
        '200':
          description: a pet to be returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorModel'
      requestBody:
        content:
          'application/json':
            schema:
              $ref: '#/components/schemas/Address'
            examples:
              Address:
                $ref: '#/components/examples/Address'","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  securitySchemes:
    regularSecurity:
      type: http
      scheme: basic
  schemas:
    ErrorModel:
      type: object
      properties:
        code:
          type: string
    Address:
      type: object
      properties:
        street:
          type: string
      required:
        - street
paths:
  ""/"":
    post:
      operationId: updateAddress
      summary: updateAddress
      servers:
        - url: http://kicsapi.com/
          description: server URL
      responses:
        '200':
          description: a pet to be returned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Address'
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorModel'
      requestBody:
        content:
          'application/json':
            schema:
              $ref: '#/components/schemas/Address'
            examples:
              Address:
                $ref: '#/components/schemas/Address'",[[51]]
959,bccfa089-89e4-47e0-a0e5-185fe6902220,Response Object With Incorrect Ref (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/response_object_incorrect_ref,openapi-queries,"Response Object reference must always point to '#/responses'<br>
[Documentation](https://swagger.io/specification/v2/#responses-object)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/responses/Success""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/definitions/User""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/definitions/User""
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[12]]
960,be0e0df7-f3d9-42a1-9b6f-d425f94872c4,Array Items Has No Type (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/array_items_has_no_type,openapi-queries,"Schema array items type should be defined<br>
[Documentation](https://swagger.io/docs/specification/data-models/data-types/#string)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          ""$ref"": ""#/components/schemas/MyObject""
        ""201"":
          description: 201 response
          content:
            ""application/x-www-form-urlencoded"":
              schema:
                type: array
                items:
                  oneOf:
                    - ""$ref"": ""#/components/schemas/MyObject""
                    - type: integer
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: integer
          format: int64
        quantity:
          type: integer
          format: int32
        percentage:
          type: number
          format: float
        result:
          type: number
          format: double
    MyIntArray:
      type: array
      items:
        type: integer",,[]
961,be1d8733-3731-40c7-a845-734741c6871d,Constraining Enum Property,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/constraining_enum_property,openapi-queries,"There is a constraining keyword in a property which is already restricted by enum values<br>
[Documentation](https://swagger.io/specification/v2/#schemaObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
      parameters:
      - name: category
        in: body
        description: max records to return
        required: true
        schema:
          ""$ref"": ""#/definitions/Category""
definitions:
  Category:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
      name:
        type: string
        enum:
        - Foo
        - Bar","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
      parameters:
      - name: category
        in: body
        description: max records to return
        required: true
        schema:
          ""$ref"": ""#/definitions/Category""
definitions:
  Category:
    type: object
    properties:
      id:
        type: integer
        format: int64
        minimum: 1
        enum:
        - 2
        - 3
        - 4
        - 5
        - 6
      name:
        type: string
        maxLength: 10
        enum:
        - Foo
        - Bar","[[19, 27, 36]]"
962,be3e170e-1572-461e-a8b6-d963def581ec,Operation Object Without 'produces',OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_object_without_produces,openapi-queries,"Operation Object should have 'produces' field defined for 'GET'operation<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      produces:
        - application/json
      responses:
        ""200"":
          ""$ref"": ""#/definitions/User""
      parameters:
        - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
      - id
      - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          ""$ref"": ""#/definitions/User""
      parameters:
        - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
      - id
      - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[7]]
963,c19779a9-5774-4d2f-a3a1-a99831730375,Components Link Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_link_definition_unused,openapi-queries,"Components links definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
          links:
            ""$ref"": ""#/components/links/APIRepository""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  links:
    APIRepository:
      operationId: listVersionsv2","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: success
          content:
            application/json:
              schema:
                type: array
                items:
                  ""$ref"": ""#/components/schemas/MyObject""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  links:
    APIRepository:
      operationId: listVersionsv2",[[29]]
964,c254adc4-ef25-46e1-8270-b7944adb4198,OperationId Not Unique (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/operation_id_not_unique,openapi-queries,"OperationId should be unique when defined<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: op_id3
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    post:
      operationId: op_id4
      responses:
        ""201"":
          description: Created","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: op_id
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    post:
      operationId: op_id
      responses:
        ""201"":
          description: Created","[[8, 25]]"
965,c38d630d-a415-4e3e-bac2-65475979ba88,Body Parameter With Wrong Property,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/body_parameter_with_wrong_property,openapi-queries,"The Body Parameter Object should only have the following properties defined - 'name', 'in', 'description', 'required', and 'schema'<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: string
          desc:
            type: string
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: string
    desc:
      type: string","[[20, 30]]"
966,c3cab8c4-6c52-47a9-942b-c27f26fbd7d2,Parameter File Type Not In 'formData',OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/parameter_file_type_not_in_formdata,openapi-queries,"The In field of Parameter Object must be 'formData' when type is 'file'<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: formData
        description: return a file with limit info
        required: true
        type: file
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: formData
    description: return a file with limit info
    required: true
    type: file","---
swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      parameters:
      - name: limit2
        in: query
        description: return a file with limit info
        required: true
        type: file
      operationId: listVersionsV2
      summary: List API versions
      responses:
        '200':
          description: 200 response
parameters:
  limitParam:
    name: limit
    in: query
    description: return a file with limit info
    required: true
    type: file","[[10, 22]]"
967,c5bb7461-aa57-470b-a714-3bc3d74f4669,Link Object OperationId Does Not Target Operation Object,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/link_object_operation_id_does_not_target_an_operation_object,openapi-queries,"Link object 'OperationId' should target an existing operation object in the OpenAPI definition<br>
[Documentation](https://swagger.io/specification/#link-object)",,,[]
968,c66ebeaa-676c-40dc-a3ff-3e49395dcd5e,Servers Array Undefined,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/servers_undefined,openapi-queries,"The Servers array should have at least one server defined. If not, the default value would be a Server Object with a URL value of '/'.<br>
[Documentation](https://swagger.io/specification/#server-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
servers:
  url: https://my.api.server.com/
  description: My API server","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self",[[1]]
969,ca02f4e8-d3ae-4832-b7db-bb037516d9e7,Request Body JSON Reference Does Not Exist,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_request_body,openapi-queries,"Request Body reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
      requestBody:
        ""$ref"": ""#/components/requestBodies/MyObjectBody""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  requestBodies:
    MyObjectBody:
      description: A JSON object containing my object information
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/MyObject""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/MyObject""
      requestBody:
        ""$ref"": ""#/components/requestBodies/MyWrongObjectBody""
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
  requestBodies:
    MyObjectBody:
      description: A JSON object containing my object information
      content:
        application/json:
          schema:
            ""$ref"": ""#/components/schemas/MyObject""",[[14]]
970,cd7a52cf-8d7f-4cfe-bbeb-6306d23f576b,Encoding Map Key Mismatch Schema Defined Properties,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/encoding_map_key_mismatch_schema_defined_properties,openapi-queries,"Encoding Map Key should be set in schema defined properties<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            code:
              contentType: image/png, image/jpeg","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  responses:
    ResponseExample:
      description: 200 response
      content:
        application/json:
          schema:
            type: object
            discriminator:
              propertyName: petType
            properties:
              code:
                type: string
                format: binary
              message:
                type: string
          encoding:
            profileImage:
              contentType: image/png, image/jpeg",[[42]]
971,ceefb058-8065-418f-9c4c-584a78c7e104,Operation Using Basic Auth,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_using_basic_auth,openapi-queries,"Operation Object should not use basic authentication<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2:
            - write
            - read
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2: []
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: basic
    description: For more information, see https://api.my.company.com/docs/oauth",[[16]]
972,cf4a5f45-a27b-49df-843a-9911dbfe71d4,Invalid Media Type Value (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/invalid_media_type_value,openapi-queries,"The Media Type value should match the following format: `<type>/<subtype>[+suffix][;parameters]`<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              schema:
                type: object
                discriminator:
                  propertyName: petType
                properties:
                  code:
                    type: string
                    format: binary
                  message:
                    type: string
              encoding:
                code:
                  contentType: image/png, image/jpeg
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: string
              format: binary
              properties:
                code:
                  type: string
                  format: binary
            encoding:
              code:
                contentType: image/png, image/jpeg

openapi: 3.0.0
info:
  title: Pet Store API
  version: 1.0.0
servers:
  - url: https://api.example.com/v1
paths:
  /pets:
    get:
      summary: Get a list of pets
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              example: { ""pets"": [""dog"", ""cat""] }
    post:
      summary: Add a new pet
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: ""Fido""
                  pattern: ""^[A-Za-z]{1,20}$""
                species:
                  type: string
                  example: ""dog""
                color:
                  type: string
                  enum:
                    - brown
                    - grey
                    - black
                    - white
                birthDate:
                  type: string
                  format: date
                weight:
                  type: integer
                  format: int32
                someSubType:
                  type: 'object'
                  properties:
                    content:
                      type: string
      responses:
        '201':
          description: Pet added successfully
  /pets/{petId}:
    get:
      summary: Get details of a specific pet
      parameters:
        - name: petId
          in: path
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              example: { ""name"": ""Fido"", ""species"": ""dog"" }","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              encoding:
                code:
                  contentType: image/png, image/jpeg
      requestBody:
        content:
          multipart/form- data:
            encoding:
              code:
                contentType: image/png, image/jpeg",[[20]]
973,d15db953-a553-4b8a-9a14-a3d62ea3d79d,Components Callback Definition Is Unused,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/components_callback_definition_unused,openapi-queries,"Components callbacks definitions should be referenced or removed from Open API definition<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          $ref: ""#/components/schemas/Success""
      callbacks:
        myEvent:
          $ref: ""#/components/callbacks/inProgress""
components:
  callbacks:
    inProgress:
      ""{$request.body#/inProgressUrl}"":
        post:
          requestBody:
            $ref: ""#/components/requestBodies/callbackMessage1""
          responses:
            ""200"":
              description: OK","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
components:
  callbacks:
    inProgress:
      ""{$request.body#/inProgressUrl}"":
        post:
          requestBody:
            ""$ref"": ""#/components/requestBodies/callbackMessage1""
          responses:
            '200':
              description: OK",[[15]]
974,d172a060-8569-4412-8045-3560ebd477e8,Object Without Required Property (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/object_without_required_property,openapi-queries,"OpenAPI Object should contain all of its required fields<br>
[Documentation](https://swagger.io/specification/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: ""/""
    email: user@gmail.com
paths: {}","openapi: 3.0.0
info:
  title: Simple API Overview
  contact:
    name: contact
    url: ""/""
    email: user@gmail.com
paths: {}",[[2]]
975,d2361d58-361c-49f0-9e50-b957fd608b29,Schema With Both ReadOnly And WriteOnly,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/schema_with_both_read_only_and_write_only,openapi-queries,"Schema should not have both 'writeOnly' and 'readOnly' set to true<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: array
      items:
        type: string
      properties:
        id:
          type: integer
          readOnly: true
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: array
      items:
        type: string
      properties:
        id:
          type: integer
          readOnly: true
          writeOnly: true
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - name",[[27]]
976,d3ea644a-9a5c-4fee-941f-f8a6786c0470,Property 'style' of Encoding Object Ignored,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/property_type_encoding_object_ignored,openapi-queries,"Property 'style' of the encoding object should be defined when the media type of the request body is 'application/x-www-form-urlencoded'. If not, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#encoding-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        application/x-www-form-urlencoded:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true
              style: simple","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/data:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg
              allowReserved: true
              style: simple",[[31]]
977,d40f27e6-15fb-4b56-90f8-fc0ff0291c51,Parameter Object With Incorrect Ref (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/parameter_object_incorrect_ref,openapi-queries,"Parameter Object reference must always point to '#/components/parameters'<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  parameters:
    idParam:
      name: id
      in: path
      description: ID of the API version
      required: true
      schema:
        type: int
    nameParam:
      in: path
      description: Name of the API version
      required: true
      schema:
        type: string
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - $ref: ""#/components/parameters/idParam""","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
components:
  parameters:
    idParam:
      name: id
      in: path
      description: ID of the API version
      required: true
      schema:
        type: int
    nameParam:
      in: path
      description: Name of the API version
      required: true
      schema:
        type: string
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - $ref: ""#path/parameters/idParam""
      - $ref: ""#components/schemas/idParam""
  /user/id:
    get:
      parameters:
        - $ref: ""#path/parameters/idParam""","[[41, 42, 46]]"
978,d47940ca-5970-45cc-bdd1-4d81398cee1f,Operation Summary Too Long,OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_summary_too_long,openapi-queries,"Operation summary should be short (less than 120 characters)<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      produces:
        - application/json
      responses:
        ""200"":
          description: 200 response","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versionssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss
      responses:
        ""200"":
          description: ""200 response""",[[9]]
979,d4e43db5-54d8-4dda-b3c2-0dc6f31a46bd,Header Response Name Is Invalid (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/header_response_name_is_invalid,openapi-queries,"The Header Response should not be named as 'Content-Type', 'Authorization' or 'Accept'. If so, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#response-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""50"":
          description: Server error response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
        ""6xx"":
          description: ""[600-699] response""
          headers:
            Pet:
              application/json:
                schema:
                  $ref: ""#/components/schemas/Pet""
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""50"":
          description: Server error response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
        ""6xx"":
          description: ""[600-699] response""
          headers:
            Content-Type:
              application/json:
                schema:
                  $ref: ""#/components/schemas/Pet""
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self",[[28]]
980,d674aea4-ba8b-454b-bb97-88a772ea33f0,Global Security Field Has An Empty Array (v3),OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/security_empty_array,openapi-queries,"Security object need to have defined rules in its array and rules should be defined on securityScheme<br>
[Documentation](https://swagger.io/specification/#security-requirement-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
- exampleSecurity: []
components:
  securitySchemes:
  - exampleSecurity:
      type: http
      scheme: basic

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message
          examples:
            foo:
              value:
                versions:
                  - status: CURRENT
                    updated: ""2011-01-21T11:33:21Z""
                    id: v2.0
                    links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security:
  - exampleSecurity: []","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                    - status: CURRENT
                      updated: '2011-01-21T11:33:21Z'
                      id: v2.0
                      links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security: []

swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
  contact:
    name: contact
    url: https://www.google.com/
    email: user@gmail.com
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          schema:
            type: object
            properties:
              code:
                type: integer
                format: int32
              message:
                type: string
            required:
              - code
              - message
          examples:
            foo:
              value:
                versions:
                  - status: CURRENT
                    updated: ""2011-01-21T11:33:21Z""
                    id: v2.0
                    links:
                      - href: http://127.0.0.1:8774/v2/
                        rel: self
security: []","[[25], [38]]"
981,d86655c0-92f6-4ffc-b4d5-5b5775804c27,Responses With Wrong HTTP Status Code (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/responses_wrong_http_status_code,openapi-queries,"HTTP Responses status code should be in range of [200-599]<br>
[Documentation](https://swagger.io/specification/#responses-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
        ""310"":
          description: ""[300-399] response""
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
         # Definition of all error statuses
        default:
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""50"":
          description: Server error response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
        ""6xx"":
          description: ""[600-699] response""
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self","[[25, 11]]"
982,d929c031-078f-4241-b802-e224656ad890,Invalid Format (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/invalid_format,openapi-queries,"The format should be valid for the type defined. For integer type must be int32 or int64 and number type must be float or double<br>
[Documentation](https://swagger.io/docs/specification/data-models/data-types/)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          ""$ref"": ""#/components/schemas/MyObject""
        ""201"":
          description: 201 response
    parameters:
      - name: id
        in: path
        description: ID of pet to use
        required: true
        schema:
          type: array
          items:
            type: object
            properties:
              myObject:
                ""$ref"": ""#/components/schemas/MyObject""
              length:
                type: integer
                format: int32
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: integer
          format: int64
        quantity:
          type: integer
          format: int32
        percentage:
          type: number
          format: float
        result:
          type: number
          format: double","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          ""$ref"": ""#/components/schemas/MyObject""
        ""201"":
          description: 201 response
    parameters:
      - name: id
        in: path
        description: ID of pet to use
        required: true
        schema:
          type: array
          items:
            type: object
            properties:
              myObject:
                ""$ref"": ""#/components/schemas/MyObject""
              length:
                type: integer
                format: float
components:
  schemas:
    MyObject:
      type: object
      properties:
        id:
          type: integer
          format: double
        quantity:
          type: integer
          format: int32
        percentage:
          type: number
          format: int32
        result:
          type: number
          format: double","[[37, 43, 12, 26, 29]]"
983,dadc2f36-1f5a-46c0-8289-75e626583123,Schema Discriminator Property Not String (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/schema_discriminator_property_not_string,openapi-queries,"Schema discriminator property should be a string<br>
[Documentation](https://swagger.io/specification/#discriminator-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
        petType:
          type: string
      required:
        - petType","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
security:
  - exampleSecurity: []
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
        petType:
          type: integer
      required:
        - petType",[[32]]
984,e2ffa504-d22a-4c94-b6c5-f661849d2db7,JSON Object Schema Without Type (v3),OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/json_object_schema_without_type,openapi-queries,"Schema of the JSON object should have 'type' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      discriminator:
        propertyName: petType
      properties:
        code:
          type: string
          format: int32
        message:
          type: string
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""",[[45]]
985,e3f026e8-fdb4-4d5a-bcfd-bd94452073fe,Security Definitions Undefined or Empty,OpenAPI,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/security_definitions_undefined_or_empty,openapi-queries,"Security Definitions Object should be set and not empty<br>
[Documentation](https://swagger.io/specification/v2/#securityDefinitionsObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  BasicAuth:
    type: basic
  ApiKeyAuth:
    type: apiKey
    in: header
    name: X-API-Key
  OAuth2:
    type: oauth2
    flow: accessCode
    authorizationUrl: https://example.com/oauth/authorize
    tokenUrl: https://example.com/oauth/token
    scopes:
      read: Grants read access
      write: Grants write access
      admin: Grants read and write access to administrative information","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions: {}",[[1]]
986,e9817ad8-a8c9-4038-8a2f-db0e6e7b284b,Implicit Flow in OAuth2 (v2),OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/implicit_flow_oauth2,openapi-queries,"There is a 'securityDefinition' using implicit flow on OAuth2, which is deprecated<br>
[Documentation](https://swagger.io/specification/v2/#securitySchemeObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: implicit
    authorizationUrl: https://api.my.company.com/oauth/authorize
    scopes:
      write:api: modify apis in your account
      read:api: read your apis",[[19]]
987,e9db5fb4-6a84-4abb-b4af-3b94fbdace6d,Responses JSON Reference Does Not Exists (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/json_reference_does_not_exists_response,openapi-queries,"Responses reference should exist on responses definition field<br>
[Documentation](https://swagger.io/specification/v2/#responsesDefinitionsObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/responses/Success""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/definitions/User""
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/responses/Succes""
responses:
  Success:
    description: An array with users
    schema:
      ""$ref"": ""#/definitions/User""
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[12]]
988,eb3f9744-d24e-4614-b1ff-2a9514eca21c,Operation Object Parameters With 'body' And 'formatData' locations,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_object_parameters_with_body_and_formatdata,openapi-queries,"Operation object parameters should not have both 'body' and 'formatData' locations<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
        - name: minlimit
          in: body
          description: min records to return
          required: true
          schema:
            type: object
parameters:
  limitParam:
    name: limit
    in: formatData
    description: max records to return
    required: true","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
        - name: minlimit
          in: formatData
          description: min records to return
          required: true
parameters:
  limitParam:
    name: limit
    in: formatData
    description: max records to return
    required: true",[[13]]
989,ed48229d-d43e-4da7-b453-5f98d964a57a,Body Parameter Without Schema,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/body_parameter_without_schema,openapi-queries,"The Body Parameter Object should have the attribute 'schema' defined<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
          schema:
            type: object
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true
    schema:
      type: object","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - name: limit2
          in: body
          description: max records to return
          required: true
parameters:
  limitParam:
    name: limit
    in: body
    description: max records to return
    required: true","[[20, 14]]"
990,f2702af5-6016-46cb-bbc8-84c766032095,Header Parameter Named as 'Accept' (v3),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/header_parameter_named_as_accept,openapi-queries,"The header Parameter should not be named as 'Accept'. If so, it will be ignored.<br>
[Documentation](https://swagger.io/specification/#parameter-object)","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: id
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: id
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","openapi: 3.0.0
info:
  title: Simple API overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
    parameters:
      - name: Accept
        in: header
        description: ID of the API version
        required: true
        schema:
          type: integer
  /users/{id}:
    get:
      parameters:
        - in: header
          name: Accept
          required: true
          description: The user ID
          schema:
            type: integer
            minimum: 1
      responses:
        ""200"":
          description: 200 response","[[26, 36]]"
991,f29904c8-6041-4bca-b043-dfa0546b8079,Callback JSON Reference Does Not Exist,OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/json_reference_does_not_exists_callback,openapi-queries,"Callback reference should exist on components field<br>
[Documentation](https://swagger.io/specification/#components-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
      callbacks:
        myEvent:
          ""$ref"": ""#/components/callbacks/inProgress""
components:
  callbacks:
    inProgress:
      ""{$request.body#/inProgressUrl}"":
        delete:
          responses:
            '204':
              description: Deleted","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/components/schemas/Success""
      callbacks:
        myEvent:
          ""$ref"": ""#/components/callbacks/inProgress""
components:
  callbacks:
    onProgress:
      ""{$request.body#/onProgressUrl}"":
        delete:
          responses:
            '204':
              description: Deleted",[[15]]
992,f30ee711-0082-4480-85ab-31d922d9a2b2,Global Schemes Uses HTTP,OpenAPI,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/global_schemes_uses_http,openapi-queries,"Global Schemes should use 'https' protocol instead of 'http'<br>
[Documentation](https://swagger.io/specification/v2/#swaggerObject)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - http
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response",[[6]]
993,f368dd2d-9344-4146-a05b-7c6faa1269ad,Success Response Code Undefined for Post Operation (v3),OpenAPI,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/success_response_code_undefined_post_operation,openapi-queries,"Post should define at least one success response (200, 201, 202 or 204)<br>
[Documentation](https://swagger.io/specification/#operation-object)","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    delete:
      operationId: deleteItem
      summary: Delete item
      responses:
        default:
          description: Error
    post:
      operationId: updateItem
      summary: Create item
      responses:
        ""200"":
          description: OK
        default:
          description: Error","openapi: 3.0.0
info:
  title: Simple API
  version: 1.0.0
paths:
  ""/item"":
    post:
      operationId: createItem
      summary: Create item
      responses:
        default:
          description: Error",[[10]]
994,f42dfe7e-787d-4478-a75e-a5f3d8a2269e,Operation Using Implicit Flow,OpenAPI,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/operation_using_implicit_flow,openapi-queries,"Operation Object should not use implicit flow<br>
[Documentation](https://swagger.io/specification/v2/#operation-object)","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2:
            - write
            - read
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: accessCode
    authorizationUrl: https://api.my.company.com/oauth/authorize
    tokenUrl: https://api.my.company.com/oauth/token
    scopes:
      write:api: modify apis in your account
      read:api: read your apis","swagger: ""2.0""
info:
  title: Simple API overview
  version: 1.0.0
schemes:
  - https
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      security:
        - oAuth2AuthCodeNeg2: []
securityDefinitions:
  oAuth2AuthCodeNeg2:
    type: oauth2
    description: For more information, see https://api.my.company.com/docs/oauth
    flow: implicit
    authorizationUrl: https://api.my.company.com/oauth/authorize
    scopes:
      write:api: modify apis in your account
      read:api: read your apis",[[16]]
995,f525cc92-9050-4c41-a75c-890dc6f64449,Security Scheme Using HTTP Negotiate,OpenAPI,Low,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/security_scheme_using_http_negotiate,openapi-queries,"Security Scheme HTTP should not be using negotiate authentication<br>
[Documentation](https://swagger.io/specification/#security-scheme-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://example.com/api/oauth/dialog
          tokenUrl: https://example.com/api/oauth/token
          scopes:
            write:pets: modify pets in your account
            read:pets: read your pets","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  securitySchemes:
    api_key:
      type: apiKey
      name: api_key
      in: header
    petstore_auth:
      type: http
      scheme: negotiate",[[33]]
996,f5b2e6af-76f5-496d-8482-8f898c5fdb4a,Parameters Name In Combination Not Unique (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/parameters_name_in_not_unique,openapi-queries,"Parameters properties 'name' and 'in' should have unique combinations<br>
[Documentation](https://swagger.io/specification/#parameters-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - ""$ref"": ""#/components/parameters/negativeLimitParam""
components:
  parameters:
    negativeLimitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer
    negativeOtherParam:
      name: other
      in: header
      description: max records to return
      required: true
      schema:
        type: integer","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      parameters:
        - ""$ref"": ""#/components/parameters/limitParam""
components:
  parameters:
    limitParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer
    otherParam:
      name: limit
      in: query
      description: max records to return
      required: true
      schema:
        type: integer","[[25, 18]]"
997,f79b9d26-e945-44e7-98a1-b93f0f7a68a0,Media Type Object Without Schema,OpenAPI,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/media_type_object_without_schema,openapi-queries,"The Media Type Object should have the attribute 'schema' defined<br>
[Documentation](https://swagger.io/specification/#media-type-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: string
                    format: binary
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              code:
                type: string
                format: binary
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          examples:
            tshirt:
              $ref: ""#/components/examples/tshirt""
          encoding:
            code:
              contentType: image/png, image/jpeg","[[13, 30]]"
998,f985a7d2-d404-4a7f-9814-f645f791e46e,Invalid Media Type Value (v2),OpenAPI,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/invalid_media_type_value,openapi-queries,"The Media Type value should match the following format: `<type>/<subtype>[+suffix][;parameters]`<br>
[Documentation](https://swagger.io/specification/#media-type-object)","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      produces:
        - image/png
        - image/gif
        - image/jpeg
      consumes:
        - application/x-www-form-urlencoded","swagger: ""2.0""
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
      produces:
        - image/ png
        - image/gif
        - image/jpeg
      consumes:
        - application/ x-www-form-urlencoded","[[18, 14]]"
999,fb7d81e7-4150-48c4-b914-92fc05da6a2f,Unknown Property (v3),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/3.0/unknown_property,openapi-queries,"All properties defined in OpenAPI objects should be known<br>
[Documentation](https://swagger.io/specification/)",,,[]
1000,fb889ae9-2d16-40b5-b41f-9da716c5abc1,Parameter JSON Reference Does Not Exist (v2),OpenAPI,Info,Structure and Semantics,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/2.0/json_reference_does_not_exists_parameter,openapi-queries,"Parameter reference should exist on parameters definition field<br>
[Documentation](https://swagger.io/specification/v2/#parameterObject)","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string","swagger: '2.0'
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        '200':
          ""$ref"": ""#/definitions/User""
      parameters:
      - ""$ref"": ""#/parameters/maxParam""
      - ""$ref"": ""#/parameters/limitParam""
parameters:
  limitParam:
    name: limit
    in: query
    description: max records to return
    required: true
    schema:
      type: integer
definitions:
  User:
    type: object
    required:
    - id
    - name
    properties:
      id:
        type: integer
        format: int64
      name:
        type: string",[[14]]
1001,fbf699b5-ef74-4542-9cf1-f6eeac379373,Numeric Schema Without Format (v3),OpenAPI,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/openAPI/general/numeric_schema_without_format,openapi-queries,"Numeric schema (type set to 'integer' or 'number') should have 'format' defined.<br>
[Documentation](https://swagger.io/specification/#schema-object)","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          format: int32
          minimum: 0
          maximum: 50
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","openapi: 3.0.0
info:
  title: Simple API Overview
  version: 1.0.0
paths:
  ""/"":
    get:
      operationId: listVersionsv2
      summary: List API versions
      responses:
        ""200"":
          description: 200 response
          content:
            application/json:
              examples:
                foo:
                  value:
                    versions:
                      - status: CURRENT
                        updated: ""2011-01-21T11:33:21Z""
                        id: v2.0
                        links:
                          - href: http://127.0.0.1:8774/v2/
                            rel: self
components:
  schemas:
    GeneralError:
      type: object
      discriminator:
        propertyName: petType
      additionalProperties: false
      properties:
        code:
          type: integer
          minimum: 0
          maximum: 50
      required:
        - petType
  requestBodies:
    NewItem:
      description: A JSON object containing item data
      required: true
      content:
        multipart/form-data:
          schema:
            $ref: ""#/components/schemas/GeneralError""","[[34, 46]]"
1002,95588189-1abd-4df1-9588-b0a5034f9e87,Missing App Armor Config,Pulumi,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/kubernetes/missing_app_armor_config,pulumi-queries,"Containers should be configured with AppArmor for any application to reduce its potential attack<br>
[Documentation](https://www.pulumi.com/registry/packages/kubernetes/api-docs/core/v1/pod/#objectmeta)","name: yaml-example
description: Create a Pod with auto-naming
runtime: yaml
resources:
  pod:
    type: kubernetes:core/v1:Pod
    properties:
      metadata:
        annotations:
          container.apparmor.security.beta.kubernetes.io: localhost/k8s-apparmor-example-allow-write
          container.apparmor.security.beta.kubernetes.io2: localhost/k8s-apparmor-example-allow-write
      spec:
        containers:
          - image: nginx:1.14.2
            name: nginx
            ports:
             - containerPort: 80
        type: kubernetes:core/v1:Pod","name: yaml-example
description: Create a Pod with auto-naming
runtime: yaml
resources:
  pod:
    type: kubernetes:core/v1:Pod
    properties:
      metadata:
        annotations:
      spec:
        containers:
          - image: nginx:1.14.2
            name: nginx
            ports:
             - containerPort: 80
        type: kubernetes:core/v1:Pod
---
name: yaml-example
description: Create a Pod with auto-naming
runtime: yaml
resources:
  pod:
    type: kubernetes:core/v1:Pod
    properties:
      metadata:
      spec:
        containers:
          - image: nginx:1.14.2
            name: nginx
            ports:
             - containerPort: 80
        type: kubernetes:core/v1:Pod
---
name: yaml-example
description: Create a Pod with auto-naming
runtime: yaml
resources:
  pod:
    type: kubernetes:core/v1:Pod
    properties:
      metadata:
        annotations:
          container.notapparmor.security.beta.kubernetes.io: localhost/k8s-apparmor-example-allow-write
      spec:
        containers:
          - image: nginx:1.14.2
            name: nginx
            ports:
             - containerPort: 80
        type: kubernetes:core/v1:Pod","[[8, 25, 42]]"
1003,ee305555-6b1d-4055-94cf-e22131143c34,PSP Set To Privileged,Pulumi,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/kubernetes/psp_set_to_privileged,pulumi-queries,"Do not allow pod to request execution as privileged.<br>
[Documentation](https://www.pulumi.com/registry/packages/kubernetes/api-docs/policy/v1beta1/podsecuritypolicy/#privileged_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: kubernetes:policy/v1beta1:PodSecurityPolicy
    properties:
      metadata:
        name: example
      spec:
        privileged: false","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: kubernetes:policy/v1beta1:PodSecurityPolicy
    properties:
      metadata:
        name: example
      spec:
        privileged: true",[[11]]
1004,00603add-7f72-448f-a6c0-9e456a7a3f94,Elasticsearch with HTTPS disabled,Pulumi,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/elasticsearch_with_https_disabled,Unknown,"Amazon Elasticsearch does not have encryption for its domains enabled. To prevent such a scenario, update the attribute 'EnforceHTTPS' to true.<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/elasticsearch/domain/#enforcehttps_yaml)","name: aws
runtime: yaml
description: desc
resources:
  - type: aws.elasticsearch.Domain
    name: my-elasticsearch-domain
    properties:
      elasticsearchVersion: ""7.9""
      elasticsearchClusterConfig:
        instanceType: ""m5.large.elasticsearch""
        instanceCount: 1
      ebsOptions:
        ebsEnabled: true
        volumeType: ""gp2""
        volumeSize: 10
      domainEndpointOptions:
        enforceHTTPS: true
        tlsSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""","name: aws
runtime: yaml
description: desc
resources:
  - type: aws.elasticsearch.Domain
    name: my-elasticsearch-domain
    properties:
      elasticsearchVersion: ""7.9""
      elasticsearchClusterConfig:
        instanceType: ""m5.large.elasticsearch""
        instanceCount: 1
      ebsOptions:
        ebsEnabled: true
        volumeType: ""gp2""
        volumeSize: 10
      accessPolicies: |
        {
          ""Version"": ""2012-10-17"",
          ""Statement"": [
            {
              ""Effect"": ""Allow"",
              ""Principal"": {
                ""AWS"": ""*""
              },
              ""Action"": ""es:*"",
              ""Resource"": ""arn:aws:es:${config.aws:region}:${aws:accountId}:domain/my-elasticsearch-domain/*""
            }
          ]
        }
      domainEndpointOptions:
        enforceHTTPS: false
        tlsSecurityPolicy: ""Policy-Min-TLS-1-2-2019-07""",[[31]]
1005,2ca87964-fe7e-4cdc-899c-427f0f3525f8,DocDB Logging Is Disabled,Pulumi,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/docdb_logging_disabled,Unknown,"DocDB logging should be enabled<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/docdb/cluster/#enabledcloudwatchlogsexports_yaml)","name: my-pulumi-project
runtime: nodejs

config:
  aws:region: us-east-1
  
resources:
  aws:docdb/cluster:
    type: aws:docdb:Cluster
    properties:
      backupRetentionPeriod: 5
      clusterIdentifier: my-docdb-cluster
      engine: docdb
      masterPassword: mustbeeightchars
      masterUsername: foo
      preferredBackupWindow: 07:00-09:00
      skipFinalSnapshot: true
      enabledCloudwatchLogsExports:
        - audit
        - profiler","name: my-pulumi-project
runtime: nodejs

config:
  aws:region: us-east-1
  
resources:
  aws:docdb/cluster:
    type: aws:docdb:Cluster
    properties:
      backupRetentionPeriod: 5
      clusterIdentifier: my-docdb-cluster
      engine: docdb
      masterPassword: mustbeeightchars
      masterUsername: foo
      preferredBackupWindow: 07:00-09:00
      skipFinalSnapshot: true

name: my-pulumi-project
runtime: nodejs

config:
  aws:region: us-east-1
  
resources:
  aws:docdb/cluster:
    type: aws:docdb:Cluster
    properties:
      backupRetentionPeriod: 5
      clusterIdentifier: my-docdb-cluster
      engine: docdb
      masterPassword: mustbeeightchars
      masterUsername: foo
      preferredBackupWindow: 07:00-09:00
      skipFinalSnapshot: true
      enabledCloudwatchLogsExports: []

name: my-pulumi-project
runtime: nodejs

config:
  aws:region: us-east-1
  
resources:
  aws:docdb/cluster:
    type: aws:docdb:Cluster
    properties:
      backupRetentionPeriod: 5
      clusterIdentifier: my-docdb-cluster
      engine: docdb
      masterPassword: mustbeeightchars
      masterUsername: foo
      preferredBackupWindow: 07:00-09:00
      skipFinalSnapshot: true
      enabledCloudwatchLogsExports:
        - audit","[[10], [18], [18]]"
1006,327b0729-4c5c-4c44-8b5c-e476cd9c7290,DynamoDB Table Point In Time Recovery Disabled,Pulumi,Info,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/dynamodb_table_point_in_time_recovery_disabled,Unknown,"It's considered a best practice to have point in time recovery enabled for DynamoDB Table<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/dynamodb/table/#pointintimerecovery_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
      serverSideEncryption:
        enabled: true
      pointInTimeRecovery:
        enabled: true","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
      serverSideEncryption:
        enabled: true
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
      serverSideEncryption:
        enabled: true
      pointInTimeRecovery:
        enabled: false","[[21, 7]]"
1007,647de8aa-5a42-41b5-9faf-22136f117380,RDS DB Instance Publicly Accessible,Pulumi,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/rds_db_instance_publicly_accessible,Unknown,"RDS must not be defined with public interface, which means the attribute 'PubliclyAccessible' must be set to false.<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/rds/instance/#publiclyaccessible_yaml)","name: aws-rds
runtime: yaml
description: An RDS cluster
resources:
  default:
    type: aws:rds:Instance
    properties:
      allocatedStorage: 10
      dbName: mydb
      engine: mysql
      engineVersion: '5.7'
      instanceClass: db.t3.micro
      parameterGroupName: default.mysql5.7
      password: foobarbaz
      skipFinalSnapshot: true
      username: foo

name: aws-rds
runtime: yaml
description: An RDS Instance
resources:
  default:
    type: aws:rds:Instance
    properties:
      allocatedStorage: 10
      dbName: mydb
      engine: mysql
      engineVersion: '5.7'
      instanceClass: db.t3.micro
      parameterGroupName: default.mysql5.7
      password: foobarbaz
      skipFinalSnapshot: true
      username: foo
      publiclyAccessible: false","name: aws-rds
runtime: yaml
description: An RDS Instance
resources:
  default:
    type: aws:rds:Instance
    properties:
      allocatedStorage: 10
      dbName: mydb
      engine: mysql
      engineVersion: '5.7'
      instanceClass: db.t3.micro
      parameterGroupName: default.mysql5.7
      password: foobarbaz
      skipFinalSnapshot: true
      username: foo
      publiclyAccessible: true",[[17]]
1008,9850d621-7485-44f7-8bdd-b3cf426315cf,IAM Password Without Minimum Length,Pulumi,Low,Best Practices,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/iam_password_without_minimum_length,Unknown,"IAM password should have the required minimum length<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/iam/accountpasswordpolicy/#minimumpasswordlength_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:iam:AccountPasswordPolicy
    properties:
      minimumPasswordLength: 14","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:iam:AccountPasswordPolicy
    properties:
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:iam:AccountPasswordPolicy
    properties:
      minimumPasswordLength: 10","[[16, 7]]"
1009,9b18fc19-7fb8-49b1-8452-9c757c70f926,ElastiCache Nodes Not Created Across Multi AZ,Pulumi,Medium,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/elasticache_nodes_not_created_across_multi_az,Unknown,"ElastiCache Nodes should be created across multi az, which means 'AZMode' should be set to 'cross-az' in multi nodes cluster<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/elasticache/cluster/#azmode_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: memcached
      numCacheNodes: 2
      azMode: cross-az
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: memcached
      numCacheNodes: 1","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: memcached
      numCacheNodes: 2
      azMode: single-az
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: memcached
      numCacheNodes: 2","[[10, 18]]"
1010,a1120ee4-a712-42d9-8fb5-22595fed643b,Elasticsearch Logs Disabled,Pulumi,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/elasticsearch_logs_disabled,Unknown,"AWS Elasticsearch should have logs enabled<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/elasticsearch/domain/#logpublishingoptions_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  exampleLogGroup:
    type: aws:cloudwatch:LogGroup
  exampleLogResourcePolicy:
    type: aws:cloudwatch:LogResourcePolicy
    properties:
      policyName: example
      policyDocument: ${examplePolicyDocument.json}
  exampleDomain:
    type: aws:elasticsearch:Domain
    properties:
      logPublishingOptions:
        - cloudwatchLogGroupArn: ${exampleLogGroup.arn}
          logType: INDEX_SLOW_LOGS
          enabled: true
variables:
  examplePolicyDocument:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - effect: Allow
            principals:
              - type: Service
                identifiers:
                  - es.amazonaws.com
            actions:
              - logs:PutLogEvents
              - logs:PutLogEventsBatch
              - logs:CreateLogStream
            resources:
              - arn:aws:logs:*","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  exampleLogGroup:
    type: aws:cloudwatch:LogGroup
  exampleLogResourcePolicy:
    type: aws:cloudwatch:LogResourcePolicy
    properties:
      policyName: example
      policyDocument: ${examplePolicyDocument.json}
  exampleDomain:
    type: aws:elasticsearch:Domain
    properties:
      elasticsearchVersion: ""7.10""
      elasticsearchClusterConfig:
        instanceType: ""t2.small.elasticsearch""
        instanceCount: 1
      ebsOptions:
        ebsEnabled: true
        volumeType: ""gp2""
        volumeSize: 10
variables:
  examplePolicyDocument:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - effect: Allow
            principals:
              - type: Service
                identifiers:
                  - es.amazonaws.com
            actions:
              - logs:PutLogEvents
              - logs:PutLogEventsBatch
              - logs:CreateLogStream
            resources:
              - arn:aws:logs:*

name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  exampleLogGroup:
    type: aws:cloudwatch:LogGroup
  exampleLogResourcePolicy:
    type: aws:cloudwatch:LogResourcePolicy
    properties:
      policyName: example
      policyDocument: ${examplePolicyDocument.json}
  exampleDomain:
    type: aws:elasticsearch:Domain
    properties:
      logPublishingOptions:
        - cloudwatchLogGroupArn: ${exampleLogGroup.arn}
          logType: INDEX_SLOW_LOGS
        - cloudwatchLogGroupArn: ${exampleLogGroup.arn}
          logType: SEARCH_SLOW_LOGS
          enabled: true
variables:
  examplePolicyDocument:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - effect: Allow
            principals:
              - type: Service
                identifiers:
                  - es.amazonaws.com
            actions:
              - logs:PutLogEvents
              - logs:PutLogEventsBatch
              - logs:CreateLogStream
            resources:
              - arn:aws:logs:*

name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  exampleLogGroup:
    type: aws:cloudwatch:LogGroup
  exampleLogResourcePolicy:
    type: aws:cloudwatch:LogResourcePolicy
    properties:
      policyName: example
      policyDocument: ${examplePolicyDocument.json}
  exampleDomain:
    type: aws:elasticsearch:Domain
    properties:
      logPublishingOptions:
        - cloudwatchLogGroupArn: ${exampleLogGroup.arn}
          logType: INDEX_SLOW_LOGS
          enabled: false
variables:
  examplePolicyDocument:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - effect: Allow
            principals:
              - type: Service
                identifiers:
                  - es.amazonaws.com
            actions:
              - logs:PutLogEvents
              - logs:PutLogEventsBatch
              - logs:CreateLogStream
            resources:
              - arn:aws:logs:*","[[14], [17], [18]]"
1011,abcefee4-a0c1-4245-9f82-a473f79a9e2f,ECS Cluster with Container Insights Disabled,Pulumi,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/ecs_cluster_container_insights_disabled,Unknown,"ECS Cluster should enable container insights<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/ecs/cluster/#settings_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  foo:
    type: aws:ecs:Cluster
    properties:
      settings:
        - name: containerInsights
          value: enabled","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  foo:
    type: aws:ecs:Cluster
    properties:
      settings:
        - name: containerInsights
          value: disabled

name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  foo:
    type: aws:ecs:Cluster
    properties:
      settings: []

name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  foo:
    type: aws:ecs:Cluster
    properties:
      description: example","[[8], [8], [7]]"
1012,b6a7e0ae-aed8-4a19-a993-a95760bf8836,DynamoDB Table Not Encrypted,Pulumi,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/dynamodb_table_not_encrypted,Unknown,"AWS DynamoDB Tables should have serverSideEncryption enabled<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/dynamodb/table/#serversideencryption_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
      serverSideEncryption:
        enabled: true","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:dynamodb:Table
    properties:
      serverSideEncryption:
        enabled: false","[[17, 7]]"
1013,bccb296f-362c-4b05-9221-86d1437a1016,Amazon DMS Replication Instance Is Publicly Accessible,Pulumi,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/amazon_dms_replication_instance_is_publicly_accessible,Unknown,"Amazon DMS is publicly accessible, therefore exposing possible sensitive information. To prevent such a scenario, update the attribute 'PubliclyAccessible' to false.<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/dms/replicationinstance/)","name: aws-dms
runtime: yaml
description: amazon dms replication instance
resources:
  dms-access-for-endpoint:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-access-for-endpoint-AmazonDMSRedshiftS3Role:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSRedshiftS3Role
      role: ${[""dms-access-for-endpoint""].name}
  dms-cloudwatch-logs-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSCloudWatchLogsRole
      role: ${[""dms-cloudwatch-logs-role""].name}
  dms-vpc-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-vpc-role-AmazonDMSVPCManagementRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSVPCManagementRole
      role: ${[""dms-vpc-role""].name}
  # Create a new replication instance
  test:
    type: aws:dms:ReplicationInstance
    properties:
      allocatedStorage: 20
      applyImmediately: true
      autoMinorVersionUpgrade: true
      availabilityZone: us-west-2c
      engineVersion: 3.1.4
      kmsKeyArn: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012
      multiAz: false
      preferredMaintenanceWindow: sun:10:30-sun:14:30
      publiclyAccessible: false
      replicationInstanceClass: dms.t2.micro
      replicationInstanceId: test-dms-replication-instance-tf
      replicationSubnetGroupId: ${aws_dms_replication_subnet_group""test-dms-replication-subnet-group-tf""[%!s(MISSING)].id}
      tags:
        Name: test
      vpcSecurityGroupIds:
        - sg-12345678
    options:
      dependson:
        - ${[""dms-access-for-endpoint-AmazonDMSRedshiftS3Role""]}
        - ${[""dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole""]}
        - ${[""dms-vpc-role-AmazonDMSVPCManagementRole""]}
variables:
  dmsAssumeRole:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - actions:
              - sts:AssumeRole
            principals:
              - identifiers:
                  - dms.amazonaws.com
                type: Service","name: aws-dms
runtime: yaml
description: amazon dms replication instance
resources:
  dms-access-for-endpoint:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-access-for-endpoint-AmazonDMSRedshiftS3Role:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSRedshiftS3Role
      role: ${[""dms-access-for-endpoint""].name}
  dms-cloudwatch-logs-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSCloudWatchLogsRole
      role: ${[""dms-cloudwatch-logs-role""].name}
  dms-vpc-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-vpc-role-AmazonDMSVPCManagementRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSVPCManagementRole
      role: ${[""dms-vpc-role""].name}
  # Create a new replication instance
  test:
    type: aws:dms:ReplicationInstance
    properties:
      allocatedStorage: 20
      applyImmediately: true
      autoMinorVersionUpgrade: true
      availabilityZone: us-west-2c
      engineVersion: 3.1.4
      kmsKeyArn: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012
      multiAz: false
      preferredMaintenanceWindow: sun:10:30-sun:14:30
      publiclyAccessible: true
      replicationInstanceClass: dms.t2.micro
      replicationInstanceId: test-dms-replication-instance-tf
      replicationSubnetGroupId: ${aws_dms_replication_subnet_group""test-dms-replication-subnet-group-tf""[%!s(MISSING)].id}
      tags:
        Name: test
      vpcSecurityGroupIds:
        - sg-12345678
    options:
      dependson:
        - ${[""dms-access-for-endpoint-AmazonDMSRedshiftS3Role""]}
        - ${[""dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole""]}
        - ${[""dms-vpc-role-AmazonDMSVPCManagementRole""]}
variables:
  dmsAssumeRole:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - actions:
              - sts:AssumeRole
            principals:
              - identifiers:
                  - dms.amazonaws.com
                type: Service

name: aws-dms
runtime: yaml
description: amazon dms replication instance
resources:
  dms-access-for-endpoint:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-access-for-endpoint-AmazonDMSRedshiftS3Role:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSRedshiftS3Role
      role: ${[""dms-access-for-endpoint""].name}
  dms-cloudwatch-logs-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSCloudWatchLogsRole
      role: ${[""dms-cloudwatch-logs-role""].name}
  dms-vpc-role:
    type: aws:iam:Role
    properties:
      assumeRolePolicy: ${dmsAssumeRole.json}
  dms-vpc-role-AmazonDMSVPCManagementRole:
    type: aws:iam:RolePolicyAttachment
    properties:
      policyArn: arn:aws:iam::aws:policy/service-role/AmazonDMSVPCManagementRole
      role: ${[""dms-vpc-role""].name}
  # Create a new replication instance
  test:
    type: aws:dms:ReplicationInstance
    properties:
      allocatedStorage: 20
      applyImmediately: true
      autoMinorVersionUpgrade: true
      availabilityZone: us-west-2c
      engineVersion: 3.1.4
      kmsKeyArn: arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012
      multiAz: false
      preferredMaintenanceWindow: sun:10:30-sun:14:30
      replicationInstanceClass: dms.t2.micro
      replicationInstanceId: test-dms-replication-instance-tf
      replicationSubnetGroupId: ${aws_dms_replication_subnet_group""test-dms-replication-subnet-group-tf""[%!s(MISSING)].id}
      tags:
        Name: test
      vpcSecurityGroupIds:
        - sg-12345678
    options:
      dependson:
        - ${[""dms-access-for-endpoint-AmazonDMSRedshiftS3Role""]}
        - ${[""dms-cloudwatch-logs-role-AmazonDMSCloudWatchLogsRole""]}
        - ${[""dms-vpc-role-AmazonDMSVPCManagementRole""]}
variables:
  dmsAssumeRole:
    fn::invoke:
      Function: aws:iam:getPolicyDocument
      Arguments:
        statements:
          - actions:
              - sts:AssumeRole
            principals:
              - identifiers:
                  - dms.amazonaws.com
                type: Service","[[44], [35]]"
1014,bf4b48b9-fc1f-4552-984a-4becdb5bf503,API Gateway Access Logging Disabled,Pulumi,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/api_gateway_access_logging_disabled,Unknown,"API Gateway should have Access Log Settings defined<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/apigatewayv2/stage/#accesslogsettings_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:apigatewayv2:Stage
    properties:
      apiId: ${aws_apigatewayv2_api.example.id}
      accessLogSettings:
        destinationArn: sampleArn
        format: CLF","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:apigatewayv2:Stage
    properties:
      apiId: ${aws_apigatewayv2_api.example.id}",[[7]]
1015,d991e4ae-42ab-429b-ab43-d5e5fa9ca633,EC2 Not EBS Optimized,Pulumi,Info,Best Practices,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/ec2_not_ebs_optimized,Unknown,"It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/ec2/instance/#ebsoptimized_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      instanceType: t2.micro
      monitoring: true
      ebsOptimized: true
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      instanceType: t3.nano
      monitoring: true","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      instanceType: t2.micro
      monitoring: true
      ebsOptimized: false
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      instanceType: t2.micro
      monitoring: true","[[10, 18]]"
1016,daa581ef-731c-4121-832d-cf078f67759d,EC2 Instance Monitoring Disabled,Pulumi,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/ec2_instance_monitoring_disabled,Unknown,"EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/ec2/instance/#monitoring_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      monitoring: true","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:ec2:Instance
    properties:
      monitoring: false","[[16, 7]]"
1017,e93bbe63-a631-4c0f-b6ef-700d48441ff2,ElastiCache Redis Cluster Without Backup,Pulumi,Medium,Backup,https://cwe.mitre.org/data/definitions/459.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/elasticache_redis_cluster_without_backup,Unknown,"ElastiCache Redis cluster should have 'snapshotRetentionLimit' higher than 0<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/elasticache/cluster/#snapshotretentionlimit_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: redis
      snapshotRetentionLimit: 5
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: memcached","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: redis
      snapshotRetentionLimit: 0
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:elasticache:Cluster
    properties:
      engine: redis","[[9, 17]]"
1018,f27791a5-e2ae-4905-8910-6f995c576d09,API Gateway Without SSL Certificate,Pulumi,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/aws/api_gateway_without_ssl_certificate,Unknown,"SSL Client Certificate should be defined<br>
[Documentation](https://www.pulumi.com/registry/packages/aws/api-docs/apigatewayv2/stage/#clientcertificateid_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:apigatewayv2:Stage
    properties:
      apiId: ${aws_apigatewayv2_api.example.id}
      clientCertificateId: 12131323a","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: aws:apigatewayv2:Stage
    properties:
      apiId: ${aws_apigatewayv2_api.example.id}",[[7]]
1019,49e30ac8-f58e-4222-b488-3dcb90158ec1,Redis Cache Allows Non SSL Connections,Pulumi,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/azure/redis_cache_allows_non_ssl_connections,Unknown,"Redis Cache resource should not allow non-SSL connections.<br>
[Documentation](https://www.pulumi.com/registry/packages/azure-native/api-docs/cache/redis/#enablenonsslport_yaml)","name: azure-aks
runtime: yaml
description: An Aks cluster
resources:
  redis:
    type: azure-native:cache:Redis
    properties:
      enableNonSslPort: false
      location: West US
      minimumTlsVersion: 1.2
      name: cache1
      redisConfiguration:
        maxmemoryPolicy: allkeys-lru
      replicasPerMaster: 2
      resourceGroupName: rg1
      shardCount: 2
      sku:
        capacity: 1
        family: P
        name: Premium
      staticIP: 192.168.0.5
      subnetId: /subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Network/virtualNetworks/network1/subnets/subnet1
      zones:
        - 1","name: azure-aks
runtime: yaml
description: An Aks cluster
resources:
  redis:
    type: azure-native:cache:Redis
    properties:
      enableNonSslPort: true
      location: West US
      minimumTlsVersion: 1.2
      name: cache1
      redisConfiguration:
        maxmemoryPolicy: allkeys-lru
      replicasPerMaster: 2
      resourceGroupName: rg1
      shardCount: 2
      sku:
        capacity: 1
        family: P
        name: Premium
      staticIP: 192.168.0.5
      subnetId: /subscriptions/subid/resourceGroups/rg2/providers/Microsoft.Network/virtualNetworks/network1/subnets/subnet1
      zones:
        - 1",[[8]]
1020,cb8e4bf0-903d-45c6-a278-9a947d82a27b,Storage Account Not Forcing HTTPS,Pulumi,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/azure/storage_account_not_forcing_https,Unknown,"Storage Accounts should enforce the use of HTTPS<br>
[Documentation](https://www.pulumi.com/registry/packages/azure-native/api-docs/storage/storageaccount/#enablehttpstrafficonly_yaml)","name: azure-aks
runtime: yaml
description: An Aks cluster
resources:
  storageAccount:
    type: azure-native:storage:StorageAccount
    properties:
      accountName: sto4445
      enableHttpsTrafficOnly: true
      enableNfsV3: true
      isHnsEnabled: true
      kind: BlockBlobStorage
      location: eastus
      networkRuleSet:
        bypass: AzureServices
        defaultAction: Allow
        ipRules: []
        virtualNetworkRules:
          - virtualNetworkResourceId: /subscriptions/{subscription-id}/resourceGroups/res9101/providers/Microsoft.Network/virtualNetworks/net123/subnets/subnet12
      resourceGroupName: res9101
      sku:
        name: Premium_LRS","name: azure-aks
runtime: yaml
description: An Aks cluster
resources:
  storageAccount:
    type: azure-native:storage:StorageAccount
    properties:
      accountName: sto4445
      enableHttpsTrafficOnly: false
      enableNfsV3: true
      isHnsEnabled: true
      kind: BlockBlobStorage
      location: eastus
      networkRuleSet:
        bypass: AzureServices
        defaultAction: Allow
        ipRules: []
        virtualNetworkRules:
          - virtualNetworkResourceId: /subscriptions/{subscription-id}/resourceGroups/res9101/providers/Microsoft.Network/virtualNetworks/net123/subnets/subnet12
      resourceGroupName: res9101
      sku:
        name: Premium_LRS",[[9]]
1021,48f7e44d-d1d1-44c2-b336-9f11b65c4fb0,Cloud Storage Bucket Logging Not Enabled,Pulumi,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/gcp/cloud_storage_bucket_logging_not_enabled,Unknown,"Cloud storage bucket should have logging enabled<br>
[Documentation](https://www.pulumi.com/registry/packages/gcp/api-docs/storage/bucket/#logging_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: gcp:storage:Bucket
    properties:
      location: US-CENTRAL1
      logging:
        logObjectPrefix: some_obj_prefix","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: gcp:storage:Bucket
    properties:
      location: US-CENTRAL1",[[7]]
1022,965e8830-2bec-4b9b-a7f0-24dbc200a68f,Google Compute SSL Policy Weak Cipher In Use,Pulumi,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/pulumi/gcp/google_compute_ssl_policy_weak_cipher_in_use,Unknown,"This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers<br>
[Documentation](https://www.pulumi.com/registry/packages/gcp/api-docs/compute/sslpolicy/#mintlsversion_yaml)","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: gcp:compute:SSLPolicy
    properties:
      minTlsVersion: TLS_1_2","name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: gcp:compute:SSLPolicy
    properties:
---
name: aws-eks
runtime: yaml
description: An EKS cluster
resources:
  example:
    type: gcp:compute:SSLPolicy
    properties:
      minTlsVersion: TLS_1_1","[[16, 7]]"
1023,0d7ef70f-e176-44e6-bdba-add3e429788d,Serverless Function Without X-Ray Tracing,ServerlessFW,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_function_without_x-ray_tracing,serverlessfw-queries,"Serverless Function should have Tracing enabled. For this, property 'tracing' should have the value 'Active'<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/functions#aws-x-ray-tracing)",,,[]
1024,165aae3b-a56a-48f3-b76d-d2b5083f5b8f,Serverless Function Without Unique IAM Role,ServerlessFW,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_function_without_unique_iam_role,serverlessfw-queries,"Serverless Function should not share IAM Role to ensure it will have the minimum privileges needed to perform the required tasks<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml#functions)",,,[]
1025,434945e5-4dfd-41b1-aba1-47075ccd9265,Serverless API X-Ray Tracing Disabled,ServerlessFW,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_api_xray_tracing_disabled,serverlessfw-queries,"Serverless API Gateway should have X-Ray Tracing enabled<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/events/apigateway#aws-x-ray-tracing)",,,[]
1026,4495bc5d-4d1e-4a26-ae92-152d18195648,Serverless Function Environment Variables Not Encrypted,ServerlessFW,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_function_environment_variables_not_encrypted,serverlessfw-queries,"Serverless Function should encrypt environment variables<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/functions#kms-keys)",,,[]
1027,4d424558-c6d1-453c-be98-9a7f877abd9a,Serverless API Endpoint Config Not Private,ServerlessFW,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_api_endpoint_config_not_private,serverlessfw-queries,"Serverless should have endpointType set to 'PRIVATE'. This way, it's not exposed to the public internet<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/events/apigateway#configuring-endpoint-types)",,,[]
1028,59ebb4f3-2a6c-46dc-b4f0-cc5418dcddcd,Serverless Role With Full Privileges,ServerlessFW,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_role_with_full_privileges,serverlessfw-queries,"Roles defined in Serverless files should not have policies granting full administrative privileges.<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/iam)",,,[]
1029,a4d32883-aac7-42e1-b403-9415af0f3846,Serverless API Access Logging Setting Undefined,ServerlessFW,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_api_access_logging_setting_undefined,serverlessfw-queries,"Serverless FW API should have HTTP Access Logging enabled<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/serverless.yml#logs)",,,[]
1030,d5d1fe08-89db-440c-8725-b93223387309,Serverless API Without Content Encoding,ServerlessFW,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_api_without_content_encoding,serverlessfw-queries,"Serverless should have API Gateway with Content Encoding enabled through the attribute 'minimumCompressionSize'. This value should be greater than -1 and smaller than 10485760<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/events/apigateway#compression)",,,[]
1031,dec7bc85-d156-4f64-9a33-96ed3d9f3fed,Serverless Function Without Dead Letter Queue,ServerlessFW,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_function_without_dead_letter_queue,serverlessfw-queries,"Serverless Function should be configured for a Dead Letter Queue(DLQ). A Dead Letter Queue(DLQ) can be set up in 'onError' config parameter<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/functions#dead-letter-queue-dlq)",,,[]
1032,f99d3482-fa8c-4f79-bad9-35212dded164,Serverless Function Without Tags,ServerlessFW,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/800.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/serverlessFW/serverless_function_without_tags,serverlessfw-queries,"Serverless Function should have associated tags<br>
[Documentation](https://www.serverless.com/framework/docs/providers/aws/guide/functions#tags)",,,[]
1033,07fc3413-e572-42f7-9877-5c8fc6fccfb5,Service Account Allows Access Secrets,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/service_account_allows_access_secrets,terraform-queries,"Kubernetes_role and Kubernetes_cluster_role when binded, should not use get, list or watch as verbs<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/role_binding#subject)",,,[]
1034,0ad60203-c050-4115-83b6-b94bde92541d,Container Runs Unmasked,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/container_runs_unmasked,terraform-queries,"Check if a container has full access (unmasked) to the host's /proc command, which would allow to retrieve sensitive information and possibly change the kernel parameters in runtime.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#allowed_proc_mount_types)",,,[]
1035,15d8a7fd-465a-4d15-a868-add86552f17b,GitHub Repository Set To Public,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/github/github_repository_set_to_public,terraform-queries,"Repositories must be set to private, which means the attribute 'visibility' must be set to 'private' and/or the attribute 'private' must be set to true (the attribute 'visibility' overrides 'private')<br>
[Documentation](https://www.terraform.io/docs/providers/github/r/repository.html)",,,[]
1036,17172bc2-56fb-4f17-916f-a014147706cd,Cluster Admin Rolebinding With Superuser Permissions,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/cluster_admin_role_binding_with_super_user_permissions,terraform-queries,"Ensure that the cluster-admin role is only used where required (RBAC)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/cluster_role_binding#name)",,,[]
1037,17e52ca3-ddd0-4610-9d56-ce107442e110,HPA Targets Invalid Object,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/hpa_targets_invalid_object,terraform-queries,"The Horizontal Pod Autoscaler must target a valid object<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/horizontal_pod_autoscaler#metric)",,,[]
1038,1e434b25-8763-4b00-a5ca-ca03b7abbb66,Name Is Not Snake Case,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/general/name_is_not_snake_case,terraform-queries,"All names should follow snake case pattern.<br>
[Documentation](https://www.terraform.io/docs/extend/best-practices/naming.html#naming)",,,[]
1039,21719347-d02b-497d-bda4-04a03c8e5b61,Memory Requests Not Defined,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/memory_requests_not_defined,terraform-queries,"Memory requests should be defined for each container. This allows the kubelet to reserve the requested amount of system resources and prevents over-provisioning on individual nodes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#requests)",,,[]
1040,21cef75f-289f-470e-8038-c7cee0664164,No Drop Capabilities for Containers,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/no_drop_capabilities_for_containers,terraform-queries,"Sees if Kubernetes Drop Capabilities exists to ensure containers security context<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#drop)",,,[]
1041,228c4c19-feeb-4c18-848c-800ac70fdfb7,Image Without Digest,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/image_without_digest,terraform-queries,"Images should be specified together with their digests to ensure integrity<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#image)",,,[]
1042,23c3067a-8cc9-480c-b645-7c1e0ad4bf60,Beta - Databricks Group Without User Or Instance Profile,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/group_without_user_or_instance_profile,terraform-queries,"Databricks Group should have at least one user or one instance profile associated<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/group)",,,[]
1043,23e1f5f0-12b7-4d7e-9087-f60f42ccd514,Beta - Indefinitely Databricks OBO Token Lifetime,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/307.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/indefinitely_obo_token,terraform-queries,"OBO Token has an indefinitely lifetime<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/obo_token)",,,[]
1044,24b132df-5cc7-4823-8029-f898e1c50b72,Service Account Name Undefined Or Empty,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/service_account_name_undefined_or_empty,terraform-queries,"A Kubernetes Pod should have a Service Account defined so to restrict Kubernetes API access, which means the attribute 'service_account_name' should be defined and not empty.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#service_account_name)",,,[]
1045,26b047a9-0329-48fd-8fb7-05bbe5ba80ee,Incorrect Volume Claim Access Mode ReadWriteOnce,Terraform,Medium,Build Process,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/incorrect_volume_claim_access_mode_read_write_once,terraform-queries,"Kubernetes Stateful Sets must have one Volume Claim template with the access mode 'ReadWriteOnce'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/stateful_set#volume_claim_template)",,,[]
1046,2a153952-2544-4687-bcc9-cc8fea814a9b,Variable Without Description,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/general/variable_without_description,terraform-queries,"All variables should contain a valid description.<br>
[Documentation](https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation)",,,[]
1047,2a52567c-abb8-4651-a038-52fa27c77aed,Service With External Load Balancer,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/552.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/service_with_external_load_balancer,terraform-queries,"Service has an external load balancer, which may cause accessibility from other networks and the Internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service)",,,[]
1048,2bff9906-4e9b-4f71-9346-8ebedfdf43ef,PSP Allows Privilege Escalation,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/288.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/psp_allows_privilege_escalation,terraform-queries,"PodSecurityPolicy should not allow privilege escalation<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#allow_privilege_escalation)",,,[]
1049,2c4fe4a9-f44b-4c70-b09b-5b75cd251805,Beta - Unrestricted Databricks ACL,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/unrestricted_acl,terraform-queries,"ACL allow ingress from 0.0.0.0/0 and/or ::/0<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/ip_access_list)",,,[]
1050,3360c01e-c8c0-4812-96a2-a6329b9b7f9f,Role Binding To Default Service Account,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/role_binding_to_default_service_account,terraform-queries,"No role nor cluster role should bind to a default service account<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/role_binding#subject)",,,[]
1051,375cdab9-3f94-4ae0-b1e3-8fbdf9cdf4d7,Beta - Job's Task is Legacy (spark_submit_task),Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/477.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/use_spark_submit_task,terraform-queries,"Job's Task Is spark_submit_task<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/job#spark_submit_task-configuration-block)",,,[]
1052,38028698-e663-4ef7-aa92-773fef0ca86f,Beta - Check Databricks Cluster Azure Attribute Best Practices,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/cluster_azure_attributes,terraform-queries,"One or some Databricks Cluster Azure Attribute Best Practices are not respected<br>
[Documentation](https://docs.databricks.com/clusters/cluster-config-best-practices.html)",,,[]
1053,3a81fc06-566f-492a-91dd-7448e409e2cd,Generic Git Module Without Revision,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/general/generic_git_module_without_revision,terraform-queries,"All generic git repositories should reference a revision.<br>
[Documentation](https://www.terraform.io/docs/language/modules/sources.html#selecting-a-revision)",,,[]
1054,3f55386d-75cd-4e9a-ac47-167b26c04724,Containers With Sys Admin Capabilities,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/containers_with_sys_admin_capabilities,terraform-queries,"Containers should not have CAP_SYS_ADMIN Linux capability<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#capabilities-1)",,,[]
1055,420e6360-47bb-46f6-9072-b20ed22c842d,StatefulSet Without Service Name,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/statefulset_without_service_name,terraform-queries,"StatefulSets should have an existing headless 'serviceName'. The headless service labels should also be implemented on StatefulSets labels.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/stateful_set#selector)",,,[]
1056,455f2e0c-686d-4fcb-8b5f-3f953f12c43c,Seccomp Profile Is Not Configured,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/secoomp_profile_is_not_configured,terraform-queries,"Containers should be configured with a secure Seccomp profile to restrict potentially dangerous syscalls<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#annotations)",,,[]
1057,461ed7e4-f8d5-4bc1-b3c6-64ddb4fd00a3,Deployment Has No PodAntiAffinity,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/deployment_has_no_pod_anti_affinity,terraform-queries,"Check if Deployment resources don't have a podAntiAffinity policy, which prevents multiple pods from being scheduled on the same node.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment#affinity)",,,[]
1058,48388bd2-7201-4dcc-b56d-e8a9efa58fad,PSP With Added Capabilities,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/psp_with_added_capabilities,terraform-queries,"PodSecurityPolicy should not have added capabilities<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#allowed_capabilities)",,,[]
1059,4950837c-0ce5-4e42-9bee-a25eae73740b,PSP Allows Containers To Share The Host Network Namespace,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/psp_allows_containers_to_share_the_host_network_namespace,terraform-queries,"Check if Pod Security Policies allow containers to share the host network namespace.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#host_network)",,,[]
1060,4c415497-7410-4559-90e8-f2c8ac64ee38,Root Containers Admitted,Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/root_containers_admitted,terraform-queries,"Containers must not be allowed to run with root privileges, which means the attributes 'privileged' and 'allow_privilege_escalation' must be set to false, 'run_as_user.rule' must be set to 'MustRunAsNonRoot', and adding the root group must be forbidden<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#run_as_user)",,,[]
1061,4e203a65-c8d8-49a2-b749-b124d43c9dc1,Docker Daemon Socket is Exposed to Containers,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/docker_daemon_socket_is_exposed_to_containers,terraform-queries,"Sees if Docker Daemon Socket is not exposed to Containers<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_path)",,,[]
1062,4e74cf4f-ff65-4c1a-885c-67ab608206ce,Workload Host Port Not Specified,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/workload_host_port_not_specified,terraform-queries,"Verifies if Kubernetes workload's host port is specified<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_port)",,,[]
1063,51bed0ac-a8ae-407a-895e-90c6cb0610ce,PSP Allows Sharing Host IPC,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/psp_allows_sharing_host_ipc,terraform-queries,"Pod Security Policy allows containers to share the host IPC namespace<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#host_ipc)",,,[]
1064,522d4a64-4dc9-44bd-9240-7d8a0d5cb5ba,Permissive Access to Create Pods,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/permissive_access_to_create_pods,terraform-queries,"The permission to create pods in a cluster should be restricted because it allows privilege escalation.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/role#rule)",,,[]
1065,539e4557-d2b5-4d57-a001-cb01140a4e2d,Beta - Check Databricks Cluster GCP Attribute Best Practices,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/cluster_gcp_attributes,terraform-queries,"One or some Databricks Cluster GCP Attribute Best Practices are not respected<br>
[Documentation](https://docs.databricks.com/clusters/cluster-config-best-practices.html)",,,[]
1066,577ac19c-6a77-46d7-9f14-e049cdd15ec2,CPU Requests Not Set,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/cpu_requests_not_set,terraform-queries,"CPU requests should be set to ensure the sum of the resource requests of the scheduled Containers is less than the capacity of the node<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#requests)",,,[]
1067,587d5d82-70cf-449b-9817-f60f9bccb88c,Container Host Pid Is True,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/container_host_pid_is_true,terraform-queries,"Minimize the admission of containers wishing to share the host process ID namespace<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_pid)",,,[]
1068,58876b44-a690-4e9f-9214-7735fa0dd15d,CronJob Deadline Not Configured,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/cronjob_deadline_not_configured,terraform-queries,"Cronjobs must have a configured deadline, which means the attribute 'starting_deadline_seconds' must be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/cron_job#starting_deadline_seconds)",,,[]
1069,59312e8a-a64e-41e7-a252-618533dd1ea8,Output Without Description,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/general/output_without_description,terraform-queries,"All outputs should contain a valid description.<br>
[Documentation](https://www.terraform.io/docs/language/values/outputs.html#description-output-value-documentation)",,,[]
1070,5a627dfa-a4dd-4020-a4c6-5f3caf4abcd6,Beta - Check use no LTS Spark Version,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/807.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/use_lts_spark_version,terraform-queries,"Spark Version is not a Long-term Support<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/data-sources/spark_version)",,,[]
1071,5b6d53dd-3ba3-4269-b4d7-f82e880e43c3,Liveness Probe Is Not Defined,Terraform,Info,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/liveness_probe_is_not_defined,terraform-queries,"In case of an unresponsive container, a Liveness Probe can help your application become more available since it restarts the container. However, it can lead to cascading failures. Define one if you really need it<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#liveness_probe)",,,[]
1072,5c281bf8-d9bb-47f2-b909-3f6bb11874ad,Service Type is NodePort,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/service_type_is_nodeport,terraform-queries,"Service type should not be NodePort<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service#type)",,,[]
1073,5f4735ce-b9ba-4d95-a089-a37a767b716f,CPU Limits Not Set,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/cpu_limits_not_set,terraform-queries,"CPU limits should be set because if the system has CPU time free, a container is guaranteed to be allocated as much CPU as it requests<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#limits)",,,[]
1074,60af03ff-a421-45c8-b214-6741035476fa,Container Resources Limits Undefined,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/container_resources_limits_undefined,terraform-queries,"Kubernetes container should have resource limitations defined such as CPU and memory<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod)",,,[]
1075,6d8f1a10-b6cd-48f0-b960-f7c535d5cdb8,Secrets As Environment Variables,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/526.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/secrets_as_environment_variables,terraform-queries,"Container should not use secrets as environment variables<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#secret_key_ref)",,,[]
1076,7249e3b0-9231-4af3-bc5f-5daf4988ecbf,StatefulSet Without PodDisruptionBudget,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/statefulset_without_pod_disruption_budget,terraform-queries,"StatefulSets should be assigned with a PodDisruptionBudget to ensure high availability<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/stateful_set#selector)",,,[]
1077,737a0dd9-0aaa-4145-8118-f01778262b8a,Default Service Account In Use,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/default_service_account_in_use,terraform-queries,"Default service accounts should not be actively used<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/service_account#automount_service_account_token)",,,[]
1078,7d05ca25-91b4-42ee-b6f6-b06611a87ce8,Beta - Indefinitely Databricks Token Lifetime,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/307.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/indefinitely_token,terraform-queries,"Token has an indefinitely lifetime<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/token)",,,[]
1079,826abb30-3cd5-4e0b-a93b-67729b4f7e63,RBAC Roles with Read Secrets Permissions,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/rbac_roles_with_read_secrets_permissions,terraform-queries,"Roles and ClusterRoles with get/watch/list RBAC permissions on Kubernetes secrets are dangerous and should be avoided. In case of compromise, attackers could abuse these roles to access sensitive data, such as passwords, tokens and keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/role#rule)",,,[]
1080,8657197e-3f87-4694-892b-8144701d83c1,Readiness Probe Is Not Configured,Terraform,Medium,Availability,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/readiness_probe_is_not_configured,terraform-queries,"Check if Readiness Probe is not configured.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#readiness_probe)",,,[]
1081,86a947ea-f577-4efb-a8b0-5fc00257d521,Non Kube System Pod With Host Mount,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/non_kube_system_pod_with_host_mount,terraform-queries,"A non kube-system workload should not have hostPath mounted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod)",,,[]
1082,87065ef8-de9b-40d8-9753-f4a4303e27a4,Container Is Privileged,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/container_is_privileged,terraform-queries,"Privileged containers lack essential security restrictions and should be avoided by removing the 'privileged' flag or by changing its value to false<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#privileged)",,,[]
1083,953c0cc6-5f30-44cb-a803-bf4ef2571be8,Beta - Databricks Autoscale Badly Setup,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/autoscale_badly_setup,terraform-queries,"Databricks should have min and max worker setup for autoscale<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/cluster)",,,[]
1084,9aa32890-ac1a-45ee-81ca-5164e2098556,NET_RAW Capabilities Disabled for PSP,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/net_raw_capabilities_disabled_for_psp,terraform-queries,"Containers need to have NET_RAW or All as drop capabilities<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#required_drop_capabilities)",,,[]
1085,a05331ee-1653-45cb-91e6-13637a76e4f0,Deployment Without PodDisruptionBudget,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/deployment_without_pod_disruption_budget,terraform-queries,"Deployments should be assigned with a PodDisruptionBudget to ensure high availability<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/deployment#selector)",,,[]
1086,a4edb7e1-c0e0-4f7f-9d7c-d1b603e81ad5,Beta - Databricks Cluster or Job With None Or Insecure Permission(s),Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/databricks_permissions,terraform-queries,"Databricks Cluster and Job must have restricted permissions<br>
[Documentation](https://registry.terraform.io/providers/databricks/databricks/latest/docs/resources/permissions)",,,[]
1087,a62a99d1-8196-432f-8f80-3c100b05d62a,Volume Mount With OS Directory Write Permissions,Terraform,High,Resource Management,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/volume_mount_with_os_directory_write_permissions,terraform-queries,"Containers can mount sensitive folders from the hosts, giving them potentially dangerous access to critical host configurations and binaries.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#volume_mount)",,,[]
1088,a6a4d4fc-4e8f-47d1-969f-e9d4a084f3b9,PSP Set To Privileged,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/psp_set_to_privileged,terraform-queries,"Do not allow pod to request execution as privileged.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#privileged)",,,[]
1089,a737be28-37d8-4bff-aa6d-1be8aa0a0015,Workload Mounting With Sensitive OS Directory,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/workload_mounting_with_sensitive_os_directory,terraform-queries,"Workload is mounting a volume with sensitive OS Directory<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_path)",,,[]
1090,a9174d31-d526-4ad9-ace4-ce7ddbf52e03,Cluster Allows Unsafe Sysctls,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/cluster_allows_unsafe_sysctls,terraform-queries,"A Kubernetes Cluster must not allow unsafe sysctls, to prevent a pod from having any influence on any other pod on the node, harming the node's health or gaining CPU or memory resources outside of the resource limits of a pod. This means the 'spec.security_context.sysctl' must not have an unsafe sysctls and that the attribute 'allowed_unsafe_sysctls' must be undefined.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod_security_policy#allowed_unsafe_sysctls)",,,[]
1091,a9a13d4f-f17a-491b-b074-f54bffffcb4a,Service Account Token Automount Not Disabled,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/service_account_token_automount_not_disabled,terraform-queries,"Service Account Tokens are automatically mounted even if not necessary<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#automount_service_account_token)",,,[]
1092,aa737abf-6b1d-4aba-95aa-5c160bd7f96e,Image Pull Policy Of The Container Is Not Set To Always,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/image_pull_policy_of_container_is_not_always,terraform-queries,"Image Pull Policy of the container must be defined and set to Always<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#image_pull_policy)",,,[]
1093,abcb818b-5af7-4d72-aba9-6dd84956b451,Using Default Namespace,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/using_default_namespace,terraform-queries,"The default namespace should not be used<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#namespace)",,,[]
1094,ac1564a3-c324-4747-9fa1-9dfc234dace0,Shared Host Network Namespace,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/shared_host_network_namespace,terraform-queries,"Container should not share the host network namespace<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_network)",,,[]
1095,ad69e38a-d92e-4357-a8da-f2f29d545883,Pod or Container Without Security Context,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/pod_or_container_without_security_context,terraform-queries,"A security context defines privilege and access control settings for a Pod or Container<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#security_context)",,,[]
1096,b0749c53-e3ff-4d09-bbe4-dca94e2e7a38,Beta - Check Databricks Cluster AWS Attribute Best Practices,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/databricks/cluster_aws_attributes,terraform-queries,"One or some Databricks Cluster AWS Attribute Best Practices are not respected<br>
[Documentation](https://docs.databricks.com/clusters/cluster-config-best-practices.html)",,,[]
1097,b80b14c6-aaa2-4876-b651-8a48b6c32fbf,Network Policy Is Not Targeting Any Pod,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/network_policy_is_not_targeting_any_pod,terraform-queries,"Check if any network policy is not targeting any pod.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/network_policy#match_labels)",,,[]
1098,bc3dabb6-fd50-40f8-b9ba-7429c9f1fb0e,Metadata Label Is Invalid,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/metadata_label_is_invalid,terraform-queries,"Check if any label in the metadata is invalid.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#labels)",,,[]
1099,bd6bd46c-57db-4887-956d-d372f21291b6,Missing App Armor Config,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/missing_app_armor_config,terraform-queries,"Containers should be configured with AppArmor for any application to reduce its potential attack<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#annotations)",,,[]
1100,c878abb4-cca5-4724-92b9-289be68bd47c,Privilege Escalation Allowed,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/privilege_escalation_allowed,terraform-queries,"Containers should not run with allowPrivilegeEscalation in order to prevent them from gaining more privileges than their parent process<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#allow_privilege_escalation)",,,[]
1101,ca2fba76-c1a7-4afd-be67-5249f861cb0e,Tiller (Helm v2) Is Deployed,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/tiller_is_deployed,terraform-queries,"Check if Tiller is deployed.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#image)",,,[]
1102,ce7c874e-1b88-450b-a5e4-cb76ada3c8a9,Github Organization Webhook With SSL Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/github/github_organization_webhook_with_ssl_disabled,terraform-queries,"Check if insecure SSL is being used in the GitHub organization webhooks<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/github/latest/docs/resources/organization_webhook)",,,[]
1103,d532566b-8d9d-4f3b-80bd-361fe802f9c2,Root Container Not Mounted As Read-only,Terraform,Low,Build Process,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/root_container_not_mounted_as_read_only,terraform-queries,"Check if the root container filesystem is not being mounted as read-only.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#read_only_root_filesystem)",,,[]
1104,e2c83c1f-84d7-4467-966c-ed41fd015bb9,Ingress Controller Exposes Workload,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/ingress_controller_exposes_workload,terraform-queries,"Ingress Controllers should not expose workload in order to avoid vulnerabilities and DoS attacks<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/ingress#http)",,,[]
1105,e5587d53-a673-4a6b-b3f2-ba07ec274def,NET_RAW Capabilities Not Being Dropped,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/net_raw_capabilities_not_being_dropped,terraform-queries,"Containers should drop 'ALL' or at least 'NET_RAW' capabilities<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#drop)",,,[]
1106,e76cca7c-c3f9-4fc9-884c-b2831168ebd8,Invalid Image,Terraform,Low,Supply-Chain,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/invalid_image,terraform-queries,"Image must be defined and not be empty or equal to latest.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#image)",,,[]
1107,e94d3121-c2d1-4e34-a295-139bfeb73ea3,Shared Host IPC Namespace,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/shared_host_ipc_namespace,terraform-queries,"Container should not share the host IPC namespace<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#host_ipc)",,,[]
1108,f74b9c43-161a-4799-bc95-0b0ec81801b9,Shared Service Account,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/shared_service_account,terraform-queries,"A Service Account token is shared between workloads<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#service_account_name)",,,[]
1109,fc5109bf-01fd-49fb-8bde-4492b543c34a,Variable Without Type,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/general/variable_without_type,terraform-queries,"All variables should contain a valid type.<br>
[Documentation](https://www.terraform.io/docs/language/values/variables.html#input-variable-documentation)",,,[]
1110,fcc2612a-1dfe-46e4-8ce6-0320959f0040,StatefulSet Requests Storage,Terraform,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/statefulset_requests_storage,terraform-queries,"A StatefulSet requests volume storage.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/stateful_set#volume_claim_template)",,,[]
1111,fd097ed0-7fe6-4f58-8b71-fef9f0820a21,Memory Limits Not Defined,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/memory_limits_not_defined,terraform-queries,"Memory limits should be defined for each container. This prevents potential resource exhaustion by ensuring that containers consume not more than the designated amount of memory<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#limits)",,,[]
1112,fe771ff7-ba15-4f8f-ad7a-8aa232b49a28,Containers With Added Capabilities,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/kubernetes/container_with_added_capabilities,terraform-queries,"Containers should not have extra capabilities allowed<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/kubernetes/latest/docs/resources/pod#capabilities-1)",,,[]
1113,05db341e-de7d-4972-a106-3e2bd5ee53e1,OSS Bucket Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_logging_disabled,Unknown,"OSS Bucket should have logging enabled, for better visibility of resources and objects.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#logging)",,,[]
1114,063234c0-91c0-4ab5-bbd0-47ddb5f23786,Ram Account Password Policy Not Required Numbers,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_not_required_numbers,Unknown,"Ram Account Password Policy should have 'require_numbers' set to true<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#require_numbers)",,,[]
1115,140869ea-25f2-40d4-a595-0c0da135114e,RDS Instance Log Connections Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_log_connections_disabled,Unknown,"'log_connections' parameter should be set to ON for RDS instances<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#parameters)",,,[]
1116,1455cb21-1d48-46d6-8ae3-cef911b71fd5,Launch Template Is Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/launch_template_is_not_encrypted,Unknown,"ECS Launch Template should have the data in the disk encrypted. To encrypt the data, the 'encrypted' argument should be set to true.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/launch_template#encrypted)",,,[]
1117,1b4565c0-4877-49ac-ab03-adebbccd42ae,RDS DB Instance Publicly Accessible,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_publicly_accessible,Unknown,"'0.0.0.0' or '0.0.0.0/0' should not be in 'security_ips' list<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#security_ips)",,,[]
1118,1bcdf9f0-b1aa-40a4-b8c6-cd7785836843,API Gateway API Protocol Not HTTPS,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/api_gateway_api_protocol_not_https,Unknown,"API Gateway API protocol should be set to HTTPS<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/api_gateway_api#protocol)",,,[]
1119,2ae9d554-23fb-4065-bfd1-fe43d5f7c419,Public Security Group Rule Sensitive Port,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/public_security_group_rule_sensitive_port,Unknown,"A sensitive port, such as port 23 or port 110, is open to the public in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/security_group_rule#port_range)",,,[]
1120,2b13c6ff-b87a-484d-86fd-21ef6e97d426,OSS Bucket Has Static Website,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_has_static_website,Unknown,"Checks if any static websites are hosted on buckets. Be aware of any website you are running.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#website)",,,[]
1121,2bb13841-7575-439e-8e0a-cccd9ede2fa8,Ram Account Password Policy Max Password Age Unrecommended,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_max_password_age_unrecommended,Unknown,"Ram Account Password Policy Password 'max_password_age' should be higher than 0 and lower than 91<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#max_password_age)",,,[]
1122,39750e32-3fe9-453b-8c33-dd277acdb2cc,Disk Encryption Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/disk_encryption_disabled,Unknown,"Disks should have encryption enabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/disk#encrypted)",,,[]
1123,41a38329-d81b-4be4-aef4-55b2615d3282,RAM Account Password Policy Not Required Symbols,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_not_required_symbols,Unknown,"RAM account password security should require at least one symbol<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#require_symbols)",,,[]
1124,44d434ca-a9bf-4203-8828-4c81a8d5a598,RDS Instance TDE Status Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_tde_status_disabled,Unknown,"tde_status parameter should be Enabled for supported RDS instances<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#tde_status)",,,[]
1125,4bb06fa1-2114-4a00-b7b5-6aeab8b896f0,ROS Stack Retention Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/788.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ros_stack_retention_disabled,Unknown,"The retain_stacks should be enabled to keep the Stack upon deleting the stack instance from the stack group<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ros_stack_instance#retain_stacks)",,,[]
1126,5e0fb613-ba9b-44c3-88f0-b44188466bfd,RAM Account Password Policy Not Require at Least one Uppercase Character,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_password_security_policy_not_require_at_least_one_uppercase_character,Unknown,"Ram Account Password Policy should have 'require_uppercase_characters' set to true<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#require_uppercase_characters)",,,[]
1127,5f670f9d-b1b4-4c90-8618-2288f1ab9676,NAS File System Without KMS,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/nas_file_system_without_kms,Unknown,"NAS File System should have encryption provided by user KMS <br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/nas_file_system#kms_key_id)",,,[]
1128,60587dbd-6b67-432e-90f7-a8cf1892d968,Public Security Group Rule All Ports or Protocols,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/public_security_group_rule_all_ports_or_protocols,Unknown,"Alicloud Security Group Rule should not allow all ports or all protocols to the public<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/security_group_rule#cidr_ip)",,,[]
1129,6107c530-7178-464a-88bc-df9cdd364ac8,OSS Bucket Ip Restriction Disabled,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_ip_restriction_disabled,Unknown,"OSS Bucket should have ip restricted access<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1130,62232513-b16f-4010-83d7-51d0e1d45426,OSS Bucket Public Access Enabled,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_public_access_enabled,Unknown,"OSS Bucket should have public access disabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#acl)",,,[]
1131,66505003-7aba-45a1-8d83-5162d5706ef5,Ram Policy Attached to User,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_policy_attached_to_user,Unknown,"Ram policies should not be attached to users<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_user_policy_attachment)",,,[]
1132,67bfdff1-31ce-4525-b564-e94368735360,NAS File System Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/nas_file_system_not_encrypted,Unknown,"NAS File System must be encrypted<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/nas_file_system#encrypt_type)",,,[]
1133,69b5d7da-a5db-4db9-a42e-90b65d0efb0b,ActionTrail Trail OSS Bucket is Publicly Accessible,Terraform,High,Observability,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/actiontrail_trail_oss_bucket_is_publicly_accessible,Unknown,"ActionTrail Trail OSS Bucket should not be publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/actiontrail_trail)",,,[]
1134,70919c0b-2548-4e6b-8d7a-3d84ab6dabba,OSS Bucket Versioning Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_versioning_disabled,Unknown,"OSS Bucket should have versioning enabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#versioning)",,,[]
1135,72ceb736-0aee-43ea-a191-3a69ab135681,No ROS Stack Policy,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/no_ros_stack_policy,Unknown,"ROS Stack should have a stack policy in order to protect stack resources from and during update actions<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ros_stack)",,,[]
1136,7a1ee8a9-71be-4b11-bb70-efb62d16863b,RDS Instance SSL Action Disabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_ssl_action_disabled,Unknown,"ssl_action parameter should be set to Open for RDS instances<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#ssl_action)",,,[]
1137,7db8bd7e-9772-478c-9ec5-4bc202c5686f,OSS Bucket Lifecycle Rule Disabled,Terraform,Low,Backup,https://cwe.mitre.org/data/definitions/664.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_lifecycle_disabled,Unknown,"OSS Bucket should have lifecycle rule enabled and set to true<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#lifecycle_rule)",,,[]
1138,81ce9394-013d-4731-8fcc-9d229b474073,CS Kubernetes Node Pool Auto Repair Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/cs_kubernetes_node_pool_auto_repair_disabled,Unknown,"Verifies if Alicloud Container Service Node Pool Auto Repair is Enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/cs_kubernetes_node_pool#auto_repair)",,,[]
1139,88541597-6f88-42c8-bac6-7e0b855e8ff6,OSS Bucket Allows List Action From All Principals,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_allows_list_action_from_all_principals,Unknown,"OSS Bucket should not allow list action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'List', for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1140,89143358-cec6-49f5-9392-920c591c669c,Ram Account Password Policy Not Require At Least one Lowercase Character,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_password_security_policy_not_require_at_least_one_lowercase_character,Unknown,"Ram Account Password Policy should have 'require_lowercase_characters' set to true<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#require_lowercase_characters)",,,[]
1141,8c0695d8-2378-4cd6-8243-7fd5894fa574,OSS Bucket Allows Delete Action From All Principals,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_allows_delete_from_all_principals,Unknown,"OSS Bucket should not allow delete action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is DeleteBucket, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1142,8f98334a-99aa-4d85-b72a-1399ca010413,OSS Bucket Transfer Acceleration Disabled,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_transfer_acceleration_disabled,Unknown,"OSS Bucket should have transfer acceleration enabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#transfer_acceleration)",,,[]
1143,9ef08939-ea40-489c-8851-667870b2ef50,ROS Stack Notifications Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ros_stack_notifications_disabled,Unknown,"The ROS Stack Notifications should be defined and populated to receive stack related events<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ros_stack#notification_urls)",,,[]
1144,a597e05a-c065-44e7-9cc8-742f572a504a,RDS Instance Log Duration Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_log_duration_disabled,Unknown,"log_duration parameter should be set to ON for RDS instances<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#parameters)",,,[]
1145,a8128dd2-89b0-464b-98e9-5d629041dfe0,RAM Account Password Policy without Reuse Prevention,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_without_reuse_prevention,Unknown,"RAM Account Password Policy 'password_reuse_prevention' should be defined and set to 24 or less<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#password_reuse_prevention)",,,[]
1146,a9dfec39-a740-4105-bbd6-721ba163c053,Ram Account Password Policy Not Required Minimum Length,Terraform,Low,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_not_required_minimum_length,Unknown,"Ram Account Password Policy should have 'minimum_password_length' defined and set to 14 or above<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#minimum_password_length)",,,[]
1147,b9b7ada8-3868-4a35-854e-6100a2bb863d,Kubernetes Cluster Without Terway as CNI Network Plugin,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/kubernetes_cluster_without_terway_as_cni_network_plugin,Unknown,"Kubernetes Cluster should have Terway as CNI Network Plugin to configure network policies<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/cs_kubernetes#cluster_network_type)",,,[]
1148,b9c524a4-fe76-4021-a6a2-cb978fb4fde1,RDS Instance Events Not Logged,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_events_not_logged,Unknown,"All RDS Instance events trackers should be 'true'<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/log_audit)",,,[]
1149,c01d10de-c468-4790-b3a0-fc887a56f289,OSS Buckets Secure Transport Disabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_buckets_securetransport_disabled,Unknown,"OSS Buckets should have secure transport enabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1150,c065b98e-1515-4991-9dca-b602bd6a2fbb,Action Trail Logging For All Regions Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/action_trail_logging_all_regions_disabled,Unknown,"Action Trail Logging for all regions should be enabled<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/actiontrail_trail#trail_region)",,,[]
1151,cb319d87-b90f-485e-a7e7-f2408380f309,High KMS Key Rotation Period,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/high_kms_key_rotation_period,Unknown,"KMS Key should have automatic rotation enabled and the rotation period should not be higher than a year<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/kms_key)",,,[]
1152,d2731f3d-a992-44ed-812e-f4f1c2747d71,VPC Flow Logs Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/vpc_flow_logs_disabled,Unknown,"Every VPC resource should have an associated Flow Log<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/vpc_flow_log)",,,[]
1153,d53f4123-f8d8-4224-8cb3-f920b151cc98,RDS Instance Log Disconnections Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_log_disconnections_disabled,Unknown,"log_disconnections parameter should be set to ON for RDS instances<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#parameters)",,,[]
1154,dbfc834a-56e5-4750-b5da-73fda8e73f70,SLB Policy With Insecure TLS Version In Use,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/slb_policy_with_insecure_tls_version_in_use,Unknown,"SLB Policy should not support insecure versions of TLS protocol<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/slb_tls_cipher_policy)",,,[]
1155,dc158941-28ce-481d-a7fa-dc80761edf46,RDS Instance Retention Period Not Recommended,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_retention_not_recommended,Unknown,"RDS Instance SQL Retention Period should be greater than 180<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#sql_collector_config_value)",,,[]
1156,dcda2d32-e482-43ee-a926-75eaabeaa4e0,RAM Security Preference Not Enforce MFA Login,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/287.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_security_preference_not_enforce_mfa,Unknown,"RAM Security preferences should enforce MFA login for RAM users<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_security_preference#enforce_mfa_for_login)",,,[]
1157,dd706080-b7a8-47dc-81fb-3e8184430ec0,Public Security Group Rule Unknown Port,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/public_security_group_rule_unknown_port,Unknown,"A unknown port, such as port 24 or port 111, is open to the public in either TCP or UDP or ALL protocol/protocols mentioned<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/security_group_rule#port_range)",,,[]
1158,e76fd7ab-7333-40c6-a2d8-ea28af4a319e,Ram Account Password Policy Max Login Attempts Unrecommended,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/307.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_account_password_policy_max_login_attempts_unrecommended,Unknown,"Ram Account Password Policy should have 'max_login_attempts' to a maximum of 5 incorrect login attempts<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_account_password_policy#max_login_attempts)",,,[]
1159,e8e62026-da63-4904-b402-65adfe3ca975,Ram Policy Admin Access Not Attached to Users Groups Roles,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ram_policy_admin_access_not_attached_to_users_groups_roles,Unknown,"Ram policies with admin access should not be associated to users, groups or roles<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ram_policy)",,,[]
1160,ec62a32c-a297-41ca-a850-cab40b42094a,OSS Bucket Allows All Actions From All Principals,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_allows_all_actions_from_all_principals,Unknown,"OSS Buckets should not allow all actions (wildcard) from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is *, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1161,ed6cf6ff-9a1f-491c-9f88-e03c0807f390,Log Retention Is Not Greater Than 90 Days,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/log_retention_is_not_greater_than_90_days,Unknown,"OSS Log Store should have logging enabled for longer than 90 days, for better visibility of resources and objects.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/log_store#retention_period)",,,[]
1162,ed6e3ba0-278f-47b6-a1f5-173576b40b7e,CMK Is Unusable,Terraform,Medium,Availability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/cmk_is_unusable,Unknown,"Alicloud KMS must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/kms_key#is_enabled)",,,[]
1163,ee3b1557-9fb5-4685-a95d-93f1edf2a0d7,ALB Listening on HTTP,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/alb_listening_on_http,Unknown,"Application Load Balancer (alb) Listener should not listen on HTTP<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/alb_listener)",,,[]
1164,f20e97f9-4919-43f1-9be9-f203cd339cdd,OSS Bucket Encryption Using CMK Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_cmk_encryption_disabled,Unknown,"OSS Bucket should have encryption enabled using Customer Master Key<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#server_side_encryption_rule)",,,[]
1165,f262118c-1ac6-4bb3-8495-cc48f1775b85,Ecs Data Disk Kms Key Id Undefined,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ecs_data_disk_kms_key_id_undefined,Unknown,"Ecs Data Disk Kms Key Id should be set<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/disk#kms_key_id)",,,[]
1166,faaefc15-51a5-419e-bb5e-51a4b5ab3485,RDS DB Instance Publicly Accessible,Terraform,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/rds_instance_address_publicly_accessible,Unknown,"The field 'address' should not be set to '0.0.0.0/0'<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/db_instance#address)",,,[]
1167,fe286195-e75c-4359-bd58-00847c4f855a,OSS Bucket Allows Put Action From All Principals,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/oss_bucket_allows_put_action_from_all_principals,Unknown,"OSS Bucket should not allow put action from all principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering/deletion. This means the 'Effect' must not be 'Allow' when the 'Action' contains 'Put', for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/oss_bucket#policy)",,,[]
1168,00e5e55e-c2ff-46b3-a757-a7a1cd802456,CloudFront Without Minimum Protocol TLS 1.2,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudfront_without_minimum_protocol_tls_1.2,Unknown,"CloudFront Minimum Protocol version should be at least TLS 1.2<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1169,01d50b14-e933-4c99-b314-6d08cd37ad35,Glue Data Catalog Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/glue_data_catalog_encryption_disabled,Unknown,"Glue Data Catalog Encryption Settings should have 'connection_password_encryption' and 'encryption_at_rest' enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_data_catalog_encryption_settings#data_catalog_encryption_settings)",,,[]
1170,030d3b18-1821-45b4-9e08-50efbe7becbb,Amazon DMS Replication Instance Is Publicly Accessible,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/amazon_dms_replication_instance_is_publicly_accessible,Unknown,"Amazon DMS is publicly accessible, therefore exposing possible sensitive information. To prevent such a scenario, update the attribute 'PubliclyAccessible' to false.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dms_replication_instance)",,,[]
1171,034d0aee-620f-4bf7-b7fb-efdf661fdb9e,Group With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PassRole_and_lambda_CreateFunction_and_lambda_InvokeFunction,Unknown,"Group with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1172,04c686f1-e0cd-4812-88e1-4e038410074c,Group With Privilege Escalation By Actions 'iam:CreateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_CreateLoginProfile,Unknown,"Group with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1173,051f2063-2517-4295-ad8e-ba88c1bf5cfc,BOM - AWS MSK,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/msk,Unknown,"A list of MSK resources specified. Amazon Managed Streaming for Apache Kafka (Amazon MSK) is a fully managed service that enables you to build and run applications that use Apache Kafka to process streaming data.<br>
[Documentation](https://kics.io)",,,[]
1174,081069cb-588b-4ce1-884c-2a1ce3029fe5,CloudWatch Metrics Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_metrics_disabled,Unknown,"Checks if CloudWatch Metrics is Enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#metrics_enabled)",,,[]
1175,084c6686-2a70-4710-91b1-000393e54c12,Shield Advanced Not In Use,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/shield_advanced_not_in_use,Unknown,"AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/shield_protection#resource_arn)",,,[]
1176,08bd0760-8752-44e1-9779-7bb369b2b4e4,DB Instance Storage Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/db_instance_storage_not_encrypted,Unknown,"AWS DB Instance should have its storage encrypted by setting the parameter to 'true'. The storage_encrypted default value is 'false'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#storage_encrypted)",,,[]
1177,09c35abf-5852-4622-ac7a-b987b331232e,Cross-Account IAM Assume Role Policy Without ExternalId or MFA,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cross_account_iam_assume_role_policy_without_external_id_or_mfa,Unknown,"Cross-Account IAM Assume Role Policy should require external ID or MFA to protect cross-account access<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role#assume_role_policy)",,,[]
1178,0a494a6a-ebe2-48a0-9d77-cf9d5125e1b3,Redshift Cluster Without VPC,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redshift_cluster_without_vpc,Unknown,"Redshift Cluster should be configured in VPC (Virtual Private Cloud)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#vpc_security_group_ids)",,,[]
1179,0a592060-8166-49f5-8e65-99ac6dce9871,Role With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PassRole_and_glue_CreateDevEndpoint,Unknown,"Role with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1180,0a8e8dc5-b6fc-44fc-b5a1-969ec950f9b0,CloudWatch Changes To NACL Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_changes_to_nacl_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for changes to NACL<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1181,0a96ce49-4163-4ee6-8169-eb3b0797d694,API Gateway Without Configured Authorizer,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_without_configured_authorizer,Unknown,"API Gateway REST API should have an API Gateway Authorizer<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_authorizer)",,,[]
1182,0afa6ab8-a047-48cf-be07-93a2f8c34cf7,ALB Is Not Integrated With WAF,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/alb_is_not_integrated_with_waf,Unknown,"All Application Load Balancers (ALB) must be protected with Web Application Firewall (WAF) service<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association)",,,[]
1183,0afbcfe9-d341-4b92-a64c-7e6de0543879,CloudWatch Log Group Without KMS,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_log_group_not_encrypted,Unknown,"AWS CloudWatch Log groups should be encrypted using KMS<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group)",,,[]
1184,0b4869fc-a842-4597-aa00-1294df425440,API Gateway Without SSL Certificate,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_without_ssl_certificate,Unknown,"SSL Client Certificate should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#client_certificate_id)",,,[]
1185,0b530315-0ea4-497f-b34c-4ff86268f59d,KMS Key With No Deletion Window,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/kms_key_with_no_deletion_window,Unknown,"AWS KMS Key should have a valid deletion window<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key)",,,[]
1186,0b93729a-d882-4803-bdc3-ac429a21f158,EC2 Instance Using API Keys,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_instance_using_api_keys,Unknown,"EC2 instances should use roles to be granted access to other AWS services<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile)",,,[]
1187,0bc534c5-13d1-4353-a7fe-b8665d5c1d7d,Dynamodb VPC Endpoint Without Route Table Association,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/dynamodb_vpc_endpoint_without_route_table_association,Unknown,"Dynamodb VPC Endpoint should be associated with Route Table Association<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc_endpoint#vpc_id)",,,[]
1188,0c10d7da-85c4-4d62-b2a8-d6c104f1bd77,User With Privilege Escalation By Actions 'iam:PutUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PutUserPolicy,Unknown,"User with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1189,0ca1017d-3b80-423e-bb9c-6cd5898d34bd,Lambda IAM InvokeFunction Misconfigured,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_iam_invokefunction_misconfigured,Unknown,"Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission)",,,[]
1190,0e32d561-4b5a-4664-a6e3-a3fa85649157,ECR Repository Not Encrypted With CMK,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecr_repository_not_encrypted,Unknown,"ECR repositories should be encrypted with customer-managed keys to meet stricter security and compliance requirements on access control, monitoring, and key rotation<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration)",,,[]
1191,0e59d33e-bba2-4037-8f88-9765647ca7ad,BOM - AWS Kinesis,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/kinesis,Unknown,"A list of Kinesis resources found. Amazon Kinesis is a real-time streaming service that provides collection, processing, and analysis of video and data streams in real-time<br>
[Documentation](https://kics.io)",,,[]
1192,0f6cbf69-41bb-47dc-93f3-3844640bf480,Cloudwatch Cloudtrail Configuration Changes Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_cloudtrail_configuration_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for CloudTrail configuration changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1193,0fd7d920-4711-46bd-aff2-d307d82cd8b7,User With Privilege Escalation By Actions 'iam:CreateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_CreateLoginProfile,Unknown,"User with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1194,113208f2-a886-4526-9ecc-f3218600e12c,User With Privilege Escalation By Actions 'iam:CreateAccessKey',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_CreateAccessKey,Unknown,"User with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1195,118281d0-6471-422e-a7c5-051bc667926e,Role With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_SetDefaultPolicyVersion,Unknown,"Role with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1196,126c1788-23c2-4a10-906c-ef179f4f96ec,ELB Using Insecure Protocols,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elb_using_insecure_protocols,Unknown,"ELB Predefined or Custom Security Policies must not use insecure protocols, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of insecure protocols.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/load_balancer_policy)",,,[]
1197,12933609-c5bf-44b4-9a41-a6467c3b685b,BOM - AWS RDS,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/rds,Unknown,"A list of RDS resources found. Amazon Relational Database Service (Amazon RDS) is a collection of managed services that makes it simple to set up, operate, and scale databases in the cloud.<br>
[Documentation](https://kics.io)",,,[]
1198,12b7e704-37f0-4d1e-911a-44bf60c48c21,IAM Role Allows All Principals To Assume,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_role_allows_all_principals_to_assume,Unknown,"IAM role allows all services or principals to assume it<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role)",,,[]
1199,132a8c31-9837-4203-9fd1-15ca210c7b73,SSO Policy with full privileges,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sso_policy_with_full_priveleges,Unknown,"SSO policies should be configured to grant limited administrative privileges, rather than full access to all resources. This approach allows for better security and control over the resources being accessed.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ssoadmin_permission_set_inline_policy)",,,[]
1200,1402afd8-a95c-4e84-8b0b-6fb43758e6ce,Hardcoded AWS Access Key In Lambda,Terraform,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/hardcoded_aws_access_key_in_lambda,Unknown,"Lambda access/secret keys should not be hardcoded<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function)",,,[]
1201,1419b4c6-6d5c-4534-9cf6-6a5266085333,CloudFront Without WAF,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudfront_without_waf,Unknown,"All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1202,151187cb-0efc-481c-babd-ad24e3c9bc22,Remote Desktop Port Open To Internet,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/remote_desktop_port_open_to_internet,Unknown,"The Remote Desktop port is open to the internet in a Security Group<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1203,15ccec05-5476-4890-ad19-53991eba1db8,API Gateway With Open Access,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_with_open_access,Unknown,"API Gateway Method should restrict the authorization type, except for the HTTP OPTIONS method.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method)",,,[]
1204,15e6ad8c-f420-49a6-bafb-074f5eb1ec74,Group With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PassRole_and_ec2_RunInstances,Unknown,"Group with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1205,15ffbacc-fa42-4f6f-a57d-2feac7365caa,Redshift Cluster Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redshift_cluster_logging_disabled,Unknown,"Make sure Logging is enabled for Redshift Cluster<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#enable)",,,[]
1206,16c4216a-50d3-4785-bfb2-4adb5144a8ba,Elasticsearch Domain With Vulnerable Policy,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_domain_with_vulnerable_policy,Unknown,"Elasticsearch Domain policy should avoid wildcard in 'Action' and 'Principal'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain_policy#access_policies)",,,[]
1207,1743f5f1-0bb0-4934-acef-c80baa5dadfa,User With Privilege Escalation By Actions 'iam:CreatePolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_CreatePolicyVersion,Unknown,"User with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1208,17b30f8f-8dfb-4597-adf6-57600b6cf25e,CloudTrail Not Integrated With CloudWatch,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_not_integrated_with_cloudwatch,Unknown,"CloudTrail should be integrated with CloudWatch<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail)",,,[]
1209,19ffbe31-9d72-4379-9768-431195eae328,User With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PassRole_and_cloudformation_CreateStack,Unknown,"User with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1210,1a4bc881-9f69-4d44-8c9a-d37d08f54c50,S3 Bucket Allows Public Policy,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_with_public_policy,Unknown,"S3 bucket allows public policy<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block)",,,[]
1211,1a690d1d-0ae7-49fa-b2db-b75ae0dd1d3e,Aurora With Disabled at Rest Encryption,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/aurora_with_disabled_at_rest_encryption,Unknown,"Amazon Aurora does not have encryption for data at rest enabled. To prevent such a scenario, update the attribute 'StorageEncrypted' to 'true'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#storage_encrypted)",,,[]
1212,1afbb3fa-cf6c-4a3d-b730-95e9f4df343e,ElastiCache Replication Group Not Encrypted At Transit,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_replication_group_not_encrypted_at_transit,Unknown,"ElastiCache Replication Group encryption should be enabled at Transit<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled)",,,[]
1213,1b3af2f9-af8c-4dfc-a0f1-a03adb70deb2,Lambda Function With Privileged Role,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_function_with_privileged_role,Unknown,"It is not advisable for AWS Lambda Functions to have privileged permissions.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function)",,,[]
1214,1b6799eb-4a7a-4b04-9001-8cceb9999326,API Gateway Access Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_access_logging_disabled,Unknown,"API Gateway Stage should have Access Logging Settings defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#access_log_settings)",,,[]
1215,1bc1c685-e593-450e-88fb-19db4c82aa1d,IAM Password Without Minimum Length,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_password_without_minimum_length,Unknown,"IAM password should have the required minimum length<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy)",,,[]
1216,1bc367f6-901d-4870-ad0c-71d79762ef52,CDN Configuration Is Missing,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cdn_configuration_is_missing,Unknown,"Content Delivery Network (CDN) service is used within an AWS account to secure and accelerate the delivery of websites. The use of a CDN can provide a layer of security between your origin content and the destination.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1217,1dc73fb4-5b51-430c-8c5f-25dcf9090b02,RDS With Backup Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_with_backup_disabled,Unknown,"Make sure the AWS RDS configuration has automatic backup configured. If the retention period is equal to 0 there is no backup<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance)",,,[]
1218,1df37f4b-7197-45ce-83f8-9994d2fcf885,S3 Bucket Allows Get Action From All Principals,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_allows_get_action_from_all_principals,Unknown,"S3 Buckets must not allow Get Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Get, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy)",,,[]
1219,1e0ef61b-ad85-4518-a3d3-85eaad164885,DB Security Group With Public Scope,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/db_security_group_with_public_scope,Unknown,"The IP address in a DB Security Group should not be '0.0.0.0/0' (IPv4) or '::/0' (IPv6). If so, any IP can access it<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_security_group)",,,[]
1220,1ec253ab-c220-4d63-b2de-5b40e0af9293,S3 Bucket Without Restriction Of Public Bucket,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_without_restriction_of_public_bucket,Unknown,"S3 bucket without restriction of public bucket<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block)",,,[]
1221,20018359-6fd7-4d05-ab26-d4dffccbdf79,ELB Access Log Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elb_access_logging_disabled,Unknown,"ELB should have logging enabled to help on error investigation<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled)",,,[]
1222,2134641d-30a4-4b16-8ffc-2cd4c4ffd15d,DOCDB Cluster Encrypted With AWS Managed Key,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/docdb_cluster_encrypted_with_aws_managed_key,Unknown,"DOCDB Cluster should be encrypted with customer-managed KMS keys instead of AWS managed keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id)",,,[]
1223,2285e608-ddbc-47f3-ba54-ce7121e31216,CloudWatch Route Table Changes Alarm Missing,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_route_table_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for route table changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1224,22fbfeac-7b5a-421a-8a27-7a2178bb910b,CMK Rotation Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cmk_rotation_disabled,Unknown,"Customer Master Keys (CMK) must have rotation enabled, which means the attribute 'enable_key_rotation' must be set to 'true' when the key is enabled.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation)",,,[]
1225,23b70e32-032e-4fa6-ba5c-82f56b9980e6,EC2 Instance Monitoring Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_instance_monitoring_disabled,Unknown,"EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring)",,,[]
1226,23edf35f-7c22-4ff9-87e6-0ca74261cfbf,BOM - AWS DynamoDB,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/dynamo,Unknown,"A list of DynamoDB resources found. Amazon DynamoDB is a fully managed, serverless, key-value NoSQL database designed to run high-performance applications at any scale.<br>
[Documentation](https://kics.io)",,,[]
1227,24e16922-4330-4e9d-be8a-caa90299466a,ElasticSearch Not Encrypted At Rest,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_not_encrypted_at_rest,Unknown,"Check if ElasticSearch encryption is disabled at Rest<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain)",,,[]
1228,254c932d-e3bf-44b2-bc9d-eb5fdb09f8d4,Redis Not Compliant,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redis_not_compliant,Unknown,"Check if the redis version is compliant with the necessary AWS PCI DSS requirements<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#engine_version)",,,[]
1229,25d251f3-f348-4f95-845c-1090e41a615c,EFS Without KMS,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/efs_without_kms,Unknown,"Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#kms_key_id)",,,[]
1230,25db74bf-fa3b-44da-934e-8c3e005c0453,Route53 Record Undefined,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/route53_record_undefined,Unknown,"Check if Record is set<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_record)",,,[]
1231,27c6a499-895a-4dc7-9617-5c485218db13,CloudWatch S3 policy Change Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_s3_policy_change_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for S3 bucket policy changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1232,28545147-2fc6-42d5-a1f9-cf226658e591,SNS Topic Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sns_topic_not_encrypted,Unknown,"SNS (Simple Notification Service) Topic should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id)",,,[]
1233,2b3c8a6d-9856-43e6-ab1d-d651094f03b4,EMR Without VPC,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/emr_without_vpc,Unknown,"Elastic MapReduce Cluster (EMR) should be launched in a Virtual Private Cloud (VPC)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_cluster#subnet_id)",,,[]
1234,2d16c3fb-35ba-4ec0-b4e4-06ee3cbd4045,BOM - AWS S3 Buckets,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/s3_bucket,Unknown,"A list of S3 resources found. Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance.<br>
[Documentation](https://kics.io)",,,[]
1235,2e9e0729-66d5-4148-9d39-5e6fb4bf2a4e,Elasticsearch with HTTPS disabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_with_https_disabled,Unknown,"Amazon Elasticsearch does not have encryption for its domains enabled. To prevent such a scenario, update the attribute 'EnforceHTTPS' to true.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https)",,,[]
1236,2f01fb2d-828a-499d-b98e-b83747305052,No Stack Policy,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/829.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/no_stack_policy,Unknown,"AWS CloudFormation Stack should have a stack policy in order to protect stack resources from update actions<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudformation_stack)",,,[]
1237,2f37c4a3-58b9-4afe-8a87-d7f1d2286f84,IAM Policies With Full Privileges,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_policies_with_full_privileges,Unknown,"IAM policies shouldn't allow full administrative privileges (for all resources)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy)",,,[]
1238,2f56b7ab-7fba-4e93-82f0-247e5ddeb239,MSK Cluster Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/msk_cluster_logging_disabled,Unknown,"Ensure MSK Cluster Logging is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#broker_logs)",,,[]
1239,2f737336-b18a-4602-8ea0-b200312e1ac1,RDS Associated with Public Subnet,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_associated_with_public_subnet,Unknown,"RDS should not run in public subnet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#db_subnet_group_name)",,,[]
1240,30b88745-eebe-4ecb-a3a9-5cf886e96204,Role With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PassRole_and_ec2_RunInstances,Unknown,"Role with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1241,31245f98-a6a9-4182-9fc1-45482b9d030a,MQ Broker Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/mq_broker_logging_disabled,Unknown,"Check if MQ Brokers don't have logging enabled in any of the two options possible (audit and general).<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker)",,,[]
1242,3199c26c-7871-4cb3-99c2-10a59244ce7f,RDS Storage Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_storage_not_encrypted,Unknown,"RDS Storage should be encrypted, which means the attribute 'storage_encrypted' should be set to 'true'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#storage_encrypted)",,,[]
1243,3206240f-2e87-4e58-8d24-3e19e7c83d7c,ECS Service Admin Role Is Present,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecs_service_admin_role_is_present,Unknown,"ECS Services must not have Admin roles, which means the attribute 'iam_role' must not be an admin role<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service)",,,[]
1244,33627268-1445-4385-988a-318fd9d1a512,User With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_UpdateAssumeRolePolicy_and_sts_AssumeRole,Unknown,"User with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1245,34b921bd-90a0-402e-a0a5-dc73371fd963,SES Policy With Allowed IAM Actions,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ses_policy_with_allowed_iam_actions,Unknown,"SES policy should not allow IAM actions to all principals<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ses_identity_policy#policy)",,,[]
1246,35113e6f-2c6b-414d-beec-7a9482d3b2d1,RDS DB Instance Publicly Accessible,Terraform,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_db_instance_publicly_accessible,Unknown,"RDS must not be defined with public interface, which means the field 'publicly_accessible' should not be set to 'true' (default is 'false').<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#publicly_accessible)",,,[]
1247,3561130e-9c5f-485b-9e16-2764c82763e5,IAM User Has Too Many Access Keys,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_user_too_many_access_keys,Unknown,"Any IAM User should not have more than one access key since it increases the risk of unauthorized access and compromise credentials<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key#user)",,,[]
1248,35ccf766-0e4d-41ed-9ec4-2dab155082b4,Role With Privilege Escalation By Actions 'iam:UpdateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_UpdateLoginProfile,Unknown,"Role with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1249,37304d3f-f852-40b8-ae3f-725e87a7cedf,EKS cluster logging is not enabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/eks_cluster_log_disabled,Unknown,"Amazon EKS control plane logging is not enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types)",,,[]
1250,381c3f2a-ef6f-4eff-99f7-b169cda3422c,Sensitive Port Is Exposed To Entire Network,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sensitive_port_is_exposed_to_entire_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1251,38b85c45-e772-4de8-a247-69619ca137b3,CloudWatch AWS Organizations Changes Missing Alarm,Terraform,Info,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_aws_organizations_changes_missing_alarm,Unknown,"Ensure a log metric filter and alarm exist for AWS organizations changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1252,38c5ee0d-7f22-4260-ab72-5073048df100,S3 Bucket ACL Allows Read Or Write to All Users,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_acl_allows_read_or_write_to_all_users,Unknown,"S3 Buckets should not be readable and writable to all users<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket)",,,[]
1253,3a1e94df-6847-4c0e-a3b6-6c6af4e128ef,Vulnerable Default SSL Certificate,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vulnerable_default_ssl_certificate,Unknown,"CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1254,3af7f2fd-06e6-4dab-b996-2912bea19ba4,Network ACL With Unrestricted Access To SSH,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/network_acl_with_unrestricted_access_to_ssh,Unknown,"'SSH' (TCP:22) should not be public in AWS Network ACL<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl)",,,[]
1255,3b6d777b-76e3-4133-80a3-0d6f667ade7f,Automatic Minor Upgrades Disabled,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/automatic_minor_upgrades_disabled,Unknown,"RDS instance should have automatic minor upgrades enabled, which means the attribute 'auto_minor_version_upgrade' must be set to true.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#auto_minor_version_upgrade)",,,[]
1256,3d3f6270-546b-443c-adb4-bb6fb2187ca6,EBS Default Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ebs_default_encryption_disabled,Unknown,"EBS Encryption should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_encryption_by_default)",,,[]
1257,3db3f534-e3a3-487f-88c7-0a9fbf64b702,AmazonMQ Broker Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/amazon_mq_broker_encryption_disabled,Unknown,"AmazonMQ Broker should have Encryption Options defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker)",,,[]
1258,3dd96caa-0b5f-4a85-b929-acfac4646cc2,Group With Privilege Escalation By Actions 'iam:AttachRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_AttachRolePolicy,Unknown,"Group with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1259,3ddfa124-6407-4845-a501-179f90c65097,Authentication Without MFA,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/authentication_without_mfa,Unknown,"Users should authenticate with MFA (Multi-factor Authentication) to ensure an extra layer of protection when authenticating<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy)",,,[]
1260,3deec14b-03d2-4d27-9670-7d79322e3340,CodeBuild Project Encrypted With AWS Managed Key,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/codebuild_project_encrypted_with_aws_managed_key,Unknown,"CodeBuild Project should be encrypted with customer-managed KMS keys instead of AWS managed keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_key)",,,[]
1261,3ef8696c-e4ae-4872-92c7-520bb44dfe77,Public Lambda via API Gateway,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/public_lambda_via_api_gateway,Unknown,"Allowing to run lambda function using public API Gateway<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission)",,,[]
1262,4003118b-046b-4640-b200-b8c7a4c8b89f,SSO Identity User Unsafe Creation,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sso_policy_with_full_priveleges_copy,Unknown,"The use of AWS SSO for creating users may pose a security risk as it does not synchronize with external Identity Providers (IdP) or Active Directory (AD). This can lead to inconsistencies and potential unauthorized access to resources. It is recommended to review and update user creation processes to ensure proper security protocols are in place.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/identitystore_user)",,,[]
1263,41abc6cc-dde1-4217-83d3-fb5f0cc09d8f,Redshift Using Default Port,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redshift_using_default_port,Unknown,"Redshift should not use the default port (5439) because an attacker can easily guess the port<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#port)",,,[]
1264,42bb6b7f-6d54-4428-b707-666f669d94fb,S3 Static Website Host Enabled,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_static_website_host_enabled,Unknown,"Checks if any static websites are hosted on buckets. Even static websites can be a liability when poorly configured.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#website)",,,[]
1265,42f4b905-3736-4213-bfe9-c0660518cda8,EKS Cluster Has Public Access,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/eks_cluster_has_public_access,Unknown,"Amazon EKS public endpoint shoud be set to false<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster)",,,[]
1266,43a41523-386a-4cb1-becb-42af6b414433,User With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_SetDefaultPolicyVersion,Unknown,"User with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1267,443488f5-c734-460b-a36d-5b3f330174dc,User Data Contains Encoded Private Key,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_data_contains_encoded_private_key,Unknown,"User Data should not contain a base64 encoded private key. If so, anyone can decode the private key easily<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data_base64)",,,[]
1268,44ceb4fa-0897-4fd2-b676-30e7a58f2933,CloudWatch Console Sign-in Without MFA Alarm Missing,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_management_console_sign_in_without_mfa_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for management console sign-in without MFA<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1269,45cff7b6-3b80-40c1-ba7b-2cf480678bb8,Neptune Logging Is Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/neptune_logging_disabled,Unknown,"Neptune logging should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports)",,,[]
1270,46883ce1-dc3e-4b17-9195-c6a601624c73,Default Security Groups With Unrestricted Traffic,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/default_security_groups_with_unrestricted_traffic,Unknown,"Check if default security group does not restrict all inbound and outbound traffic.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_security_group)",,,[]
1271,4728cd65-a20c-49da-8b31-9c08b423e4db,Unrestricted Security Group Ingress,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/unrestricted_security_group_ingress,Unknown,"Security groups allow ingress from 0.0.0.0:0 and/or ::/0<br>
[Documentation](https://www.terraform.io/docs/providers/aws/r/security_group.html)",,,[]
1272,4766d3ea-241c-4ee6-93ff-c380c996bd1a,DOCDB Cluster Without KMS,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/docdb_cluster_without_kms,Unknown,"AWS DOCDB Cluster should be encrypted with a KMS encryption key<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id)",,,[]
1273,48207659-729f-4b5c-9402-f884257d794f,EFS Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/efs_not_encrypted,Unknown,"Elastic File System (EFS) must be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#encrypted)",,,[]
1274,482b7d26-0bdb-4b5f-bf6f-545826c0a3dd,CloudTrail SNS Topic Name Undefined,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/703.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_sns_topic_name_undefined,Unknown,"Check if SNS topic name is set for CloudTrail<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail)",,,[]
1275,4849211b-ac39-479e-ae78-5694d506cb24,Security Group Not Used,Terraform,Info,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/security_groups_not_used,Unknown,"Security group must be used or not declared<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1276,4a800e14-c94a-442d-9067-5a2e9f6c0a4c,ELB Using Weak Ciphers,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elb_using_weak_ciphers,Unknown,"ELB Predefined or Custom Security Policies must not use weak ciphers, to reduce the risk of the SSL connection between the client and the load balancer being exploited. That means the 'name' of 'policy_attributes' must not coincide with any of a predefined list of weak ciphers.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/load_balancer_policy)",,,[]
1277,4bb76f17-3d63-4529-bdca-2b454529d774,CloudTrail Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_logging_disabled,Unknown,"Checks if logging is enabled for CloudTrail.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_logging)",,,[]
1278,4bc4dd4c-7d8d-405e-a0fb-57fa4c31b4d9,S3 Bucket Policy Accepts HTTP Requests,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_policy_accepts_http_requests,Unknown,"S3 Bucket policy should not accept HTTP Requests<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy#policy)",,,[]
1279,4bd15dd9-8d5e-4008-8532-27eb0c3706d3,Redis Disabled,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redis_disabled,Unknown,"ElastiCache should have Redis enabled, since it covers Compliance Certifications such as FedRAMP, HIPAA, and PCI DSS. For more information, take a look at 'https://docs.aws.amazon.com/AmazonElastiCache/latest/mem-ug/SelectEngine.html'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#engine)",,,[]
1280,4beaf898-9f8b-4237-89e2-5ffdc7ee6006,Cloudwatch Security Group Changes Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_security_group_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for security group changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1281,4c18a45b-4ab1-4790-9f83-399ac695f1e5,CloudWatch Unauthorized Access Alarm Missing,Terraform,Critical,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_unauthorized_access_defined_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for unauthorized API calls<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1282,4d46ff3b-7160-41d1-a310-71d6d370b08f,ECS Task Definition Volume Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecs_task_definition_volume_not_encrypted,Unknown,"AWS ECS Task Definition EFS data in transit between AWS ECS host and AWS EFS server should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption)",,,[]
1283,4de9de27-254e-424f-bd70-4c1e95790838,Launch Configuration Is Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/launch_configuration_is_not_encrypted,Unknown,"Launch Configurations should have the data in the volumes encrypted. To encrypt the data, the 'encrypted' parameter should be set to true in each volume<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#encrypted)",,,[]
1284,4e1cc5d3-2811-4fb2-861c-ee9b3cb7f90b,API Gateway Without Security Policy,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_without_security_policy,Unknown,"API Gateway should have a Security Policy defined and use TLS 1.2.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy)",,,[]
1285,4eb5f791-c861-4afd-9f94-f2a6a3fe49cb,MQ Broker Is Publicly Accessible,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/mq_broker_is_publicly_accessible,Unknown,"Check if any MQ Broker is not publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker)",,,[]
1286,4f615f3e-fb9c-4fad-8b70-2e9f781806ce,DB Security Group Open To Large Scope,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/db_security_group_open_to_large_scope,Unknown,"The IP address in a DB Security Group must not have more than 256 hosts.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_security_group)",,,[]
1287,4fa66806-0dd9-4f8d-9480-3174d39c7c91,S3 Bucket Without Ignore Public ACL,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_without_ignore_public_acl,Unknown,"S3 bucket without ignore public ACL<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block)",,,[]
1288,52f04a44-6bfa-4c41-b1d3-4ae99a2de05c,VPC Subnet Assigns Public IP,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vpc_subnet_assigns_public_ip,Unknown,"VPC Subnet should not assign public IP<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch)",,,[]
1289,52ffcfa6-6c70-4ea6-8376-d828d3961669,CloudTrail Log File Validation Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_log_file_validation_disabled,Unknown,"CloudTrail log file validation should be enabled to determine whether a log file has not been tampered<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation)",,,[]
1290,54229498-850b-4f78-b3a7-218d24ef2c37,BOM - AWS Elasticache,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/elasticache,Unknown,"A list of Elasticache resources found. Amazon ElastiCache is a fully managed, in-memory caching service supporting flexible, real-time use cases. You can use ElastiCache for caching, which accelerates application and database performance, or as a primary data store for use cases that don't require durability like session stores, gaming leaderboards, streaming, and analytics. ElastiCache is compatible with Redis and Memcached.<br>
[Documentation](https://kics.io)",,,[]
1291,54378d69-dd7c-4b08-a43e-80d563396857,MSK Broker Is Publicly Accessible,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/msk_broker_is_publicly_accessible,Unknown,"Public AWS MSK allows anyone to interact with the Apache Kafka broker, therefore increasing the opportunity for malicious activity. To prevent such a scenario, it is recommended for AWS MSK to not be publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#public_access)",,,[]
1292,54c417bf-c762-48b9-9d31-b3d87047e3f0,SQL Analysis Services Port 2383 (TCP) Is Publicly Accessible,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sql_analysis_services_port_2383_is_publicly_accessible,Unknown,"Check if port 2383 on TCP is publicly accessible by checking the CIDR block range that can access it.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1293,55af1353-2f62-4fa0-a8e1-a210ca2708f5,Cloudfront Viewer Protocol Policy Allows HTTP,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudfront_viewer_protocol_policy_allows_http,Unknown,"Checks if the connection between CloudFront and the viewer is encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1294,568a4d22-3517-44a6-a7ad-6a7eed88722c,S3 Bucket Without Versioning,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_without_versioning,Unknown,"S3 bucket should have versioning enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning)",,,[]
1295,56a585f5-555c-48b2-8395-e64e4740a9cf,CloudWatch Disabling Or Scheduled Deletion Of Customer Created CMK Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_disabling_or_scheduled_deletion_of_customer_created_cmk_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMK<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1296,56f6a008-1b14-4af4-b9b2-ab7cf7e27641,DocDB Logging Is Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/docdb_logging_disabled,Unknown,"DocDB logging should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports)",,,[]
1297,571254d8-aa6a-432e-9725-535d3ef04d69,Group With Privilege Escalation By Actions 'lambda:UpdateFunctionCode',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_lambda_UpdateFunctionCode,Unknown,"Group with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1298,575a2155-6af1-4026-b1af-d5bc8fe2a904,IAM Policy Grants Full Permissions,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_policy_grants_full_permissions,Unknown,"IAM policy should not grant full permissions to resources from the get-go, instead of granting permissions gradually as necessary.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy)",,,[]
1299,57b9893d-33b1-4419-bcea-a717ea87e139,S3 Bucket ACL Allows Read to Any Authenticated User,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_acl_allows_read_to_any_authenticated_user,Unknown,"S3 Buckets should not be readable to any authenticated user<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#acl)",,,[]
1300,5813ef56-fa94-406a-b35d-977d4a56ff2b,API Gateway X-Ray Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_xray_disabled,Unknown,"API Gateway should have X-Ray Tracing enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled)",,,[]
1301,5864d189-ee9a-4009-ac0c-8a582e6b7919,CloudWatch Management Console Auth Failed Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_management_console_auth_failed_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for AWS Management Console authentication failures<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1302,58b35504-0287-4154-bf69-02c0573deab8,Sagemaker Endpoint Configuration Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sagemaker_endpoint_configuration_encryption_disabled,Unknown,"Sagemaker endpoint configuration should encrypt data<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_endpoint_configuration#kms_key_arn)",,,[]
1303,590d878b-abdc-428f-895a-e2b68a0e1998,Unknown Port Exposed To Internet,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/unknown_port_exposed_to_internet,Unknown,"AWS Security Group should not have an unknown port exposed to the entire Internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1304,5a2486aa-facf-477d-a5c1-b010789459ce,EC2 Instance Has Public IP,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_instance_has_public_ip,Unknown,"EC2 Instance should not have a public IP address.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address)",,,[]
1305,5b4d4aee-ac94-4810-9611-833636e5916d,Role With Privilege Escalation By Actions 'iam:CreateAccessKey',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_CreateAccessKey,Unknown,"Role with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1306,5b8d7527-de8e-4114-b9dd-9d988f1f418f,CloudWatch AWS Config Configuration Changes Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_aws_config_configuration_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for AWS Config configuration changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1307,5ba6229c-8057-433e-91d0-21cf13569ca9,Service Control Policies Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/service_control_policies_disabled,Unknown,"Check if the Amazon Organizations ensure that all features are enabled to achieve full control over the use of AWS services and actions across multiple AWS accounts using Service Control Policies (SCPs).<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/organizations_policy)",,,[]
1308,5c0003fb-9aa0-42c1-9da3-eb0e332bef21,Secure Ciphers Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/secure_ciphers_disabled,Unknown,"Check if secure ciphers aren't used in CloudFront<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1309,5c6dd5e7-1fe0-4cae-8f81-4c122717cef3,Kinesis SSE Not Configured,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/kinesis_sse_not_configured,Unknown,"AWS Kinesis Server data at rest should have Server Side Encryption (SSE) enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_firehose_delivery_stream#server_side_encryption)",,,[]
1310,5d89db57-8b51-4b38-bb76-b9bd42bd40f0,ElastiCache Using Default Port,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_using_default_port,Unknown,"ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#port)",,,[]
1311,5d9e3164-9265-470c-9a10-57ae454ac0c7,CloudTrail Log Files Not Encrypted With KMS,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_log_files_not_encrypted_with_kms,Unknown,"Logs delivered by CloudTrail should be encrypted using KMS to increase security of your CloudTrail<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id)",,,[]
1312,5ea624e4-c8b1-4bb3-87a4-4235a776adcc,SNS Topic Publicity Has Allow and NotAction Simultaneously,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sns_topic_publicity_has_allow_and_not_action_simultaneously,Unknown,"SNS topic Publicity should not have 'Effect: Allow' and argument 'NotAction' at the same time. If it has 'Effect: Allow', the argument stated should be 'Action'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic_policy)",,,[]
1313,5fb49a69-8d46-4495-a2f8-9c8c622b2b6e,S3 Bucket Object Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_object_not_encrypted,Unknown,"S3 Bucket Object should have server-side encryption enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption)",,,[]
1314,60224630-175a-472a-9e23-133827040766,EC2 Not EBS Optimized,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_not_ebs_optimized,Unknown,"It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized)",,,[]
1315,60263b4a-6801-4587-911d-919c37ed733b,Group With Privilege Escalation By Actions 'iam:PutUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PutUserPolicy,Unknown,"Group with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1316,61cf9883-1752-4768-b18c-0d57f2737709,EKS Cluster Has Public Access CIDRs,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/eks_cluster_has_public_access_cidrs,Unknown,"Amazon EKS public endpoint is enables and accessible to all: 0.0.0.0/0""<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster)",,,[]
1317,625abc0e-f980-4ac9-a775-f7519ee34296,API Gateway Deployment Without Access Log Setting,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_deployment_without_access_log_setting,Unknown,"API Gateway Deployment should have access log setting defined when connected to an API Gateway Stage.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment)",,,[]
1318,63ebcb19-2739-4d3f-aa5c-e8bbb9b85281,EKS Cluster Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/eks_cluster_encryption_disabled,Unknown,"EKS Cluster should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config)",,,[]
1319,64a222aa-7793-4e40-915f-4b302c76e4d4,S3 Bucket ACL Grants WRITE_ACP Permission,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_acl_grants_write_acp_permission,Unknown,"S3 Buckets should not allow WRITE_ACP permission to the S3 Bucket Access Control List in order to prevent AWS accounts or IAM users to modify access control permissions to the bucket.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_acl)",,,[]
1320,656880aa-1388-488f-a6d4-8f73c23149b2,RDS Database Cluster not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_database_cluster_not_encrypted,Unknown,"RDS Database Cluster Encryption should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_cluster_snapshot)",,,[]
1321,65905cec-d691-4320-b320-2000436cb696,Security Group With Unrestricted Access To SSH,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/security_group_with_unrestricted_access_to_ssh,Unknown,"'SSH' (TCP:22) should not be public in AWS Security Group<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1322,66c6f96f-2d9e-417e-a998-9058aeeecd44,S3 Bucket Allows List Action From All Principals,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_allows_list_action_from_all_principals,Unknown,"S3 Buckets must not allow List Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is List, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy)",,,[]
1323,66cd88ac-9ddf-424a-b77e-e55e17630bee,Batch Job Definition With Privileged Container Properties,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/batch_job_definition_with_privileged_container_properties,Unknown,"Batch Job Definition should not have Privileged Container Properties<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/batch_job_definition)",,,[]
1324,66f130d9-b81d-4e8e-9b08-da74b9c891df,Missing Cluster Log Types,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/missing_cluster_log_types,Unknown,"Amazon EKS control plane logging don't enabled for all log types<br>
[Documentation](https://www.terraform.io/docs/providers/aws/r/eks_cluster.html)",,,[]
1325,671211c5-5d2a-4e97-8867-30fc28b02216,API Gateway Method Does Not Contains An API Key,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_method_does_not_contains_an_api_key,Unknown,"An API Key should be required on a method request.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method)",,,[]
1326,68eb4bf3-f9bf-463d-b5cf-e029bb446d2e,Security Group Rule Without Description,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/security_group_rules_without_description,Unknown,"It's considered a best practice for all rules in AWS Security Group to have a description<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description)",,,[]
1327,69e7c320-b65d-41bb-be02-d63ecc0bcc9d,ECR Repository Without Policy,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecr_repository_without_policy,Unknown,"ECR Repository should have Policies attached to it<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy)",,,[]
1328,6b2739db-9c49-4db7-b980-7816e0c248c1,API Gateway Endpoint Config is Not Private,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_endpoint_config_is_not_private,Unknown,"The API Endpoint type in API Gateway should be set to PRIVATE so it's not exposed to the public internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api)",,,[]
1329,6b6874fe-4c2f-4eea-8b90-7cceaa4a125e,CloudWatch Network Gateways Changes Alarm Missing,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_network_gateways_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for network gateways changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1330,6d23d87e-1c5b-4308-b224-92624300f29b,User With Privilege Escalation By Actions 'iam:AttachGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_AttachGroupPolicy,Unknown,"User with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1331,6db03a91-f933-4f13-ab38-a8b87a7de54d,ElastiCache Nodes Not Created Across Multi AZ,Terraform,Medium,Availability,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_nodes_not_created_across_multi_az,Unknown,"ElastiCache Nodes should be created across multi az, which means 'az_mode' should be set to 'cross-az' in multi nodes cluster<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster)",,,[]
1332,6db52fa6-d4da-4608-908a-89f0c59e743e,MSK Cluster Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/msk_cluster_encryption_disabled,Unknown,"Ensure MSK Cluster encryption in rest and transit is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info)",,,[]
1333,6deb34e2-5d9c-499a-801b-ea6d9eda894f,User With Privilege Escalation By Actions 'iam:UpdateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_UpdateLoginProfile,Unknown,"User with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1334,6e0e2f68-3fd9-4cd8-a5e4-e2213ef0df97,Stack Retention Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/404.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/stack_retention_disabled,Unknown,"Make sure that retain_stack is enabled to keep the Stack and it's associated resources during resource destruction<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudformation_stack_set_instance#stack_set_name)",,,[]
1335,6e3fd2ed-5c83-4c68-9679-7700d224d379,ALB Not Dropping Invalid Headers,Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/alb_not_dropping_invalid_headers,Unknown,"It's considered a best practice when using Application Load Balancers to drop invalid header fields<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields)",,,[]
1336,6e8849c1-3aa7-40e3-9063-b85ee300f29f,SQS With SSE Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sqs_with_sse_disabled,Unknown,"Amazon Simple Queue Service (SQS) queue should protect the contents of their messages using Server-Side Encryption (SSE)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue)",,,[]
1337,704dadd3-54fc-48ac-b6a0-02f170011473,GuardDuty Detector Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/guardduty_detector_disabled,Unknown,"Make sure that Amazon GuardDuty is Enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/guardduty_detector#example-usage)",,,[]
1338,7081f85c-b94d-40fd-8b45-a4f1cac75e46,IAM Access Key Is Exposed,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_access_key_is_exposed,Unknown,"IAM Access Key should not be active for root users<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key)",,,[]
1339,70b42736-efee-4bce-80d5-50358ed94990,Group With Privilege Escalation By Actions 'iam:AttachGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_AttachGroupPolicy,Unknown,"Group with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1340,70cb518c-d990-46f6-bc05-44a5041493d6,User With Privilege Escalation By Actions 'iam:AttachUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_AttachUserPolicy,Unknown,"User with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1341,730675f9-52ed-49b6-8ead-0acb5dd7df7f,SQS Policy With Public Access,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sqs_policy_with_public_access,Unknown,"Checks for dangerous permissions in Action statements in an SQS Queue Policy. This is deemed a potential security risk as it would allow various attacks to the queue<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy)",,,[]
1342,7350fa23-dcf7-4938-916d-6a60b0c73b50,CMK Is Unusable,Terraform,Medium,Availability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cmk_is_unusable,Unknown,"AWS Key Management Service (KMS) must only possess usable Customer Master Keys (CMK), which means the CMKs must have the attribute 'is_enabled' set to true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#is_enabled)",,,[]
1343,741f1291-47ac-4a85-a07b-3d32a9d6bd3e,DynamoDB Table Point In Time Recovery Disabled,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/dynamodb_table_point_in_time_recovery_disabled,Unknown,"It's considered a best practice to have point in time recovery enabled for DynamoDB Table<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery)",,,[]
1344,75ec6890-83af-4bf1-9f16-e83726df0bd0,Lambda Permission Misconfigured,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_permission_misconfigured,Unknown,"Lambda permission may be misconfigured if the action field is not filled in by 'lambda:InvokeFunction'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission)",,,[]
1345,76976de7-c7b1-4f64-a94f-90c1345914c2,ElastiCache Replication Group Not Encrypted At Rest,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_replication_group_not_encrypted_at_rest,Unknown,"ElastiCache Replication Group encryption should be enabled at Rest<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled)",,,[]
1346,7782d4b3-e23e-432b-9742-d9528432e771,Group With Privilege Escalation By Actions 'iam:SetDefaultPolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_SetDefaultPolicyVersion,Unknown,"Group with privilege escalation by actions 'iam:SetDefaultPolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1347,78f1ec6f-5659-41ea-bd48-d0a142dce4f2,Group With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_UpdateAssumeRolePolicy_and_sts_AssumeRole,Unknown,"Group with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1348,7af2f4a3-00d9-47f3-8d15-ca0888f4e5b2,ElasticSearch Encryption With KMS Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_encryption_with_kms_is_disabled,Unknown,"Check if any ElasticSearch domain isn't encrypted with KMS.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain)",,,[]
1349,7af43613-6bb9-4a0e-8c4d-1314b799425e,S3 Bucket Access to Any Principal,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_access_to_any_principal,Unknown,"S3 Buckets must not allow Actions From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when there are All Principals<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy)",,,[]
1350,7c96920c-6fd0-449d-9a52-0aa431b6beaf,Role With Privilege Escalation By Actions 'iam:AttachUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_AttachUserPolicy,Unknown,"Role with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1351,7d544dad-8a6c-431c-84c1-5f07fe9afc0e,Group With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PassRole_and_glue_CreateDevEndpoint,Unknown,"Group with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1352,7dbba512-e244-42dc-98bb-422339827967,CloudWatch Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_logging_disabled,Unknown,"Check if CloudWatch logging is disabled for Route53 hosted zones<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_query_log)",,,[]
1353,7e4a6e76-568d-43ef-8c4e-36dea481bff1,EC2 Instance Using Default VPC,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_instance_using_default_vpc,Unknown,"EC2 Instances should not be configured under a default VPC network<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#subnet_id)",,,[]
1354,7ebc9038-0bde-479a-acc4-6ed7b6758899,KMS Key With Vulnerable Policy,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/kms_key_with_full_permissions,Unknown,"Checks if the policy is vulnerable and needs updating.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key)",,,[]
1355,8055dec2-efb8-4fe6-8837-d9bed6ff202a,User With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PassRole_and_lambda_CreateFunction_and_lambda_InvokeFunction,Unknown,"User with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1356,8152e0cf-d2f0-47ad-96d5-d003a76eabd1,Lambda Functions Without X-Ray Tracing,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_functions_without_x-ray_tracing,Unknown,"AWS Lambda functions should have TracingConfig enabled. For this, property 'tracing_Config.mode' should have the value 'Active'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#tracing_config)",,,[]
1357,816ea8cf-d589-442d-a917-2dd0ce0e45e3,SQS Policy Allows All Actions,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sqs_policy_allows_all_actions,Unknown,"SQS policy allows ALL (*) actions<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy)",,,[]
1358,8173d5eb-96b5-4aa6-a71b-ecfa153c123d,CloudTrail Multi Region Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_multi_region_disabled,Unknown,"CloudTrail multi region should be enabled, which means attributes 'is_multi_region_trail' and 'include_global_service_events' should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail)",,,[]
1359,846646e3-2af1-428c-ac5d-271eccfa6faf,Group With Privilege Escalation By Actions 'iam:CreateAccessKey',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_CreateAccessKey,Unknown,"Group with privilege escalation by actions 'iam:CreateAccessKey' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1360,862fe4bf-3eec-4767-a517-40f378886b88,Kinesis Not Encrypted With KMS,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/kinesis_not_encrypted_with_kms,Unknown,"AWS Kinesis Streams and metadata should be protected with KMS<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream)",,,[]
1361,86571149-eef3-4280-a645-01e60df854b0,BOM - AWS EBS,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/ebs,Unknown,"A list of EBS resources found. Amazon Elastic Block Store (Amazon EBS) is an easy-to-use, scalable, high-performance block-storage service designed for Amazon Elastic Compute Cloud (Amazon EC2).<br>
[Documentation](https://kics.io)",,,[]
1362,874d68a3-bfbe-4a4b-aaa0-9e74d7da634b,Certificate RSA Key Bytes Lower Than 256,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/certificate_rsa_key_bytes_lower_than_256,Unknown,"The certificate should use a RSA key with a length equal to or higher than 256 bytes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api)",,,[]
1363,88fd05e0-ac0e-43d2-ba6d-fc0ba60ae1a6,IAM Database Auth Not Enabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_database_auth_not_enabled,Unknown,"IAM Database Auth Enabled should be configured to true when using compatible engine and version<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#iam_database_authentication_enabled)",,,[]
1364,89561b03-cb35-44a9-a7e9-8356e71606f4,User With Privilege Escalation By Actions 'ec2:RunInstances' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PassRole_and_ec2_RunInstances,Unknown,"User with privilege escalation by actions 'ec2:RunInstances' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1365,89806cdc-9c2e-4bd1-a0dc-53f339bcfb2a,Password Without Reuse Prevention,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/password_without_reuse_prevention,Unknown,"Check if IAM account password has the reuse password configured with 24<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy#password_reuse_prevention)",,,[]
1366,8b1b1e67-6248-4dca-bbad-93486bb181c0,CloudWatch Root Account Use Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_root_account_use_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for root acount usage<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1367,8bbb242f-6e38-4127-86d4-d8f0b2687ae2,AMI Not Encrypted,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ami_not_encrypted,Unknown,"AWS AMI Encryption is not enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ami)",,,[]
1368,8bfbf7ab-d5e8-4100-8618-798956e101e0,User With Privilege Escalation By Actions 'iam:PutGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PutGroupPolicy,Unknown,"User with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1369,8c849af7-a399-46f7-a34c-32d3dc96f1fc,ElastiCache Without VPC,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_without_vpc,Unknown,"ElastiCache should be launched in a Virtual Private Cloud (VPC)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#subnet_group_name)",,,[]
1370,8d7f7b8c-6c7c-40f8-baa6-62006c6c7b56,RDS Without Logging,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_without_logging,Unknown,"RDS does not have any kind of logger<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#enabled_cloudwatch_logs_exports)",,,[]
1371,8e94dced-9bcc-4203-8eb7-7e41202b2505,Auto Scaling Group With No Associated ELB,Terraform,Medium,Availability,https://cwe.mitre.org/data/definitions/400.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/auto_scaling_group_with_no_associated_elb,Unknown,"AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/autoscaling_group#load_balancers)",,,[]
1372,8f3c16b3-354d-45db-8ad5-5066778a9485,Group With Privilege Escalation By Actions 'glue:UpdateDevEndpoint',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_glue_UpdateDevEndpoint,Unknown,"Group with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1373,8f75840d-9ee7-42f3-b203-b40e3979eb12,Role With Privilege Escalation By Actions 'iam:PutUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PutUserPolicy,Unknown,"Role with privilege escalation by actions 'iam:PutUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1374,8fdb08a0-a868-4fdf-9c27-ccab0237f1ab,ElastiCache Redis Cluster Without Backup,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticache_redis_cluster_without_backup,Unknown,"ElastiCache Redis cluster should have 'snapshot_retention_limit' higher than 0<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit)",,,[]
1375,91bea7b8-0c31-4863-adc9-93f6177266c4,Stack Without Template,Terraform,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/stack_without_template,Unknown,"AWS CloudFormation should have a template defined through the attribute template_url or attribute template_body<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudformation_stack)",,,[]
1376,91f16d09-689e-4926-aca7-155157f634ed,ECS Service Without Running Tasks,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecs_service_without_running_tasks,Unknown,"ECS Service should have at least 1 task running<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service)",,,[]
1377,92d65c51-5d82-4507-a2a1-d252e9706855,ROS Stack Without Template,Terraform,Medium,Build Process,https://cwe.mitre.org/data/definitions/20.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/alicloud/ros_stack_without_template,Unknown,"Alicloud ROS Stack should have a template defined through the attribute template_url or attribute template_body<br>
[Documentation](https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/ros_stack)",,,[]
1378,92fe237e-074c-4262-81a4-2077acb928c1,Sensitive Port Is Exposed To Wide Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sensitive_port_is_exposed_to_wide_private_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for a wide private network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1379,94690d79-b3b0-43de-b656-84ebef5753e5,CloudFront Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudfront_logging_disabled,Unknown,"AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging_config' should be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution)",,,[]
1380,94fbe150-27e3-4eba-9ca6-af32865e4503,User With Privilege Escalation By Actions 'glue:CreateDevEndpoint' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PassRole_and_glue_CreateDevEndpoint,Unknown,"User with privilege escalation by actions 'glue:CreateDevEndpoint' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1381,9630336b-3fed-4096-8173-b9afdfe346a7,Unscanned ECR Image,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/1021.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/unscanned_ecr_image,Unknown,"Checks if the ECR Image has been scanned<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#scan_on_push)",,,[]
1382,967eb3e6-26fc-497d-8895-6428beb6e8e2,Elasticsearch Domain Not Encrypted Node To Node,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_domain_not_encrypted_node_to_node,Unknown,"Elasticsearch Domain encryption should be enabled node to node<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#node_to_node_encryption)",,,[]
1383,96e8183b-e985-457b-90cd-61c0503a3369,Global Accelerator Flow Logs Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/global_accelerator_flow_logs_disabled,Unknown,"Global Accelerator should have flow logs enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/globalaccelerator_accelerator#flow_logs_enabled)",,,[]
1384,96ed3526-0179-4c73-b1b2-372fde2e0d13,Default VPC Exists,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/default_vpc_exists,Unknown,"It isn't recommended to use resources in default VPC<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc)",,,[]
1385,970d224d-b42a-416b-81f9-8f4dfe70c4bc,Root Account Has Active Access Keys,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/root_account_has_active_access_keys,Unknown,"The AWS Root Account must not have active access keys associated, which means if there are access keys associated to the Root Account, they must be inactive.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key)",,,[]
1386,970ed7a2-0aca-4425-acf1-0453c9ecbca1,Group With Privilege Escalation By Actions 'iam:AddUserToGroup',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_AddUserToGroup,Unknown,"Group with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1387,97cb0688-369a-4d26-b1f7-86c4c91231bc,ECS Cluster with Container Insights Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecs_cluster_container_insights_disabled,Unknown,"ECS Cluster should enable container insights<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting)",,,[]
1388,982aa526-6970-4c59-8b9b-2ce7e019fe36,API Gateway With CloudWatch Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_with_cloudwatch_logging_disabled,Unknown,"AWS CloudWatch Logs for APIs should be enabled and using the naming convention described in documentation<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#managing-the-api-logging-cloudwatch-log-group)",,,[]
1389,98a8f708-121b-455b-ae2f-da3fb59d17e1,S3 Bucket with Unsecured CORS Rule,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_with_unsecured_cors_rule,Unknown,"If the CORS (Cross-Origin Resource Sharing) rule is defined in an S3 bucket, it should be secure<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#cors_rule)",,,[]
1390,98d59056-f745-4ef5-8613-32bca8d40b7e,Neptune Database Cluster Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/neptune_database_cluster_encryption_disabled,Unknown,"Neptune database cluster storage should have encryption enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted)",,,[]
1391,9a205ba3-0dd1-42eb-8d54-2ffec836b51a,Role With Privilege Escalation By Actions 'iam:CreateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_CreateLoginProfile,Unknown,"Role with privilege escalation by actions 'iam:CreateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1392,9a4ef195-74b9-4c58-b8ed-2b2fe4353a75,VPC Default Security Group Accepts All Traffic,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vpc_default_security_group_accepts_all_traffic,Unknown,"Default Security Group attached to every VPC should restrict all traffic<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_security_group)",,,[]
1393,9b0ffadc-a61f-4c2a-b1e6-68fab60f6267,Group With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PassRole_and_cloudformation_CreateStack,Unknown,"Group with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1394,9b877bd8-94b4-4c10-a060-8e0436cc09fa,User With Privilege Escalation By Actions 'glue:UpdateDevEndpoint',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_glue_UpdateDevEndpoint,Unknown,"User with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1395,9ba198e0-fef4-464a-8a4d-75ea55300de7,Neptune Cluster Instance is Publicly Accessible,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/neptune_cluster_instance_is_publicly_accessible,Unknown,"Neptune Cluster Instance should not be publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster_instance#publicly_accessible)",,,[]
1396,9d0d4512-1959-43a2-a17f-72360ff06d1b,CloudWatch VPC Changes Alarm Missing,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_vpc_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for VPC changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1397,9ec311bf-dfd9-421f-8498-0b063c8bc552,IAM User With Access To Console,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_user_with_access_to_console,Unknown,"AWS IAM Users should not have access to console<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_login_profile)",,,[]
1398,9ef7d25d-9764-4224-9968-fa321c56ef76,AWS Password Policy With Unchangeable Passwords,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/aws_password_policy_with_unchangeable_passwords,Unknown,"Unchangeable passwords in AWS password policy<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy)",,,[]
1399,9f40c07e-699e-4410-8856-3ba0f2e3a2dd,CA Certificate Identifier Is Outdated,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ca_certificate_identifier_is_outdated,Unknown,"The CA certificate Identifier must be 'rds-ca-2019'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance)",,,[]
1400,9f4a9409-9c60-4671-be96-9716dbf63db1,ECS Task Definition Network Mode Not Recommended,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecs_task_definition_network_mode_not_recommended,Unknown,"Network_Mode should be 'awsvpc' in ecs_task_definition. AWS VPCs provides the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#network_mode)",,,[]
1401,a186e82c-1078-4a7b-85d8-579561fde884,API Gateway without WAF,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_without_waf,Unknown,"API Gateway should have WAF (Web Application Firewall) enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/wafregional_web_acl_association#resource_arn)",,,[]
1402,a20be318-cac7-457b-911d-04cc6e812c25,Network ACL With Unrestricted Access To RDP,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/network_acl_with_unrestricted_access_to_rdp,Unknown,"'RDP' (TCP:3389) should not be public in AWS Network ACL<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl)",,,[]
1403,a2f548f2-188c-4fff-b172-e9a6acb216bd,Secretsmanager Secret Without KMS,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/secretsmanager_secret_without_kms,Unknown,"AWS Secretmanager should use AWS KMS customer master key (CMK) to encrypt the secret values in the versions stored in the secret<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id)",,,[]
1404,a31a5a29-718a-4ff4-8001-a69e5e4d029e,Instance With No VPC,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/instance_with_no_vpc,Unknown,"EC2 Instances should be configured under a VPC network. AWS VPCs provide the controls to facilitate a formal process for approving and testing all network connections and changes to the firewall and router configurations.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance)",,,[]
1405,a4966c4f-9141-48b8-a564-ffe9959945bc,S3 Bucket With All Permissions,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_with_all_permissions,Unknown,"S3 Buckets should not have all permissions, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is '*', for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket)",,,[]
1406,a8fc2180-b3ac-4c93-bd0d-a55b974e4b07,S3 Bucket Object Level CloudTrail Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_object_level_cloudtrail_logging_disabled,Unknown,"S3 Bucket object-level CloudTrail logging should be enabled for read and write events<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#event_selector)",,,[]
1407,abb06e5f-ef9a-4a99-98c6-376d396bfcdf,SQS Queue Exposed,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sqs_queue_exposed,Unknown,"Checks if the SQS Queue is exposed<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#policy)",,,[]
1408,abdb29d4-5ca1-4e91-800b-b3569bbd788c,Config Rule For Encrypted Volumes Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/config_rule_for_encrypted_volumes_is_disabled,Unknown,"Check if AWS config rules do not identify Encrypted Volumes as a source.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_config_rule)",,,[]
1409,ac5a0bc0-a54c-45aa-90c3-15f7703b9132,Configuration Aggregator to All Regions Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/config_configuration_aggregator_to_all_regions_disabled,Unknown,"AWS Config Configuration Aggregator All Regions must be set to True<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions)",,,[]
1410,acb6b4e2-a086-4f35-aefd-4db6ea51ada2,Elasticsearch Log Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_logs_disabled,Unknown,"AWS Elasticsearch should have logs enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options)",,,[]
1411,ad296c0d-8131-4d6b-b030-1b0e73a99ad3,Group With Privilege Escalation By Actions 'iam:UpdateLoginProfile',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_UpdateLoginProfile,Unknown,"Group with privilege escalation by actions 'iam:UpdateLoginProfile' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1412,ad5b4e97-2850-4adf-be17-1d293e0b85ee,Glue Security Configuration Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/glue_security_configuration_encryption_disabled,Unknown,"Glue Security Configuration Encryption should have 'cloudwatch_encryption', 'job_bookmarks_encryption' and 's3_encryption' enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_security_configuration#encryption_configuration)",,,[]
1413,ad9dabc7-7839-4bae-a957-aa9120013f39,Lambda With Vulnerable Policy,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_with_vulnerable_policy,Unknown,"The attribute 'action' should not have wildcard<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission#action)",,,[]
1414,af173fde-95ea-4584-b904-bb3923ac4bda,Redshift Publicly Accessible,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redshift_publicly_accessible,Unknown,"AWS Redshift Clusters must not be publicly accessible. Check if 'publicly_accessible' field is true or undefined (default is true)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster)",,,[]
1415,afecd1f1-6378-4f7e-bb3b-60c35801fdd4,ALB Deletion Protection Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/alb_deletion_protection_disabled,Unknown,"Application Load Balancer should have deletion protection enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#enable_deletion_protection)",,,[]
1416,b0d3ef3f-845d-4b1b-83d6-63a5a380375f,Secretsmanager Secret Encrypted With AWS Managed Key,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/secretsmanager_secret_encrypted_with_aws_managed_key,Unknown,"Secrets Manager secret should be encrypted with customer-managed KMS keys instead of AWS managed keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id)",,,[]
1417,b161c11b-a59b-4431-9a29-4e19f63e6b27,REST API With Vulnerable Policy,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rest_api_with_vulnerable_policy,Unknown,"REST API policy should avoid wildcard in 'Action' and 'Principal'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api_policy#policy)",,,[]
1418,b1a72f66-2236-4f3b-87ba-0da1b366956f,SNS Topic Encrypted With AWS Managed Key,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sns_topic_encrypted_with_aws_managed_key,Unknown,"SNS (Simple Notification Service) Topic should be encrypted with customer-managed KMS keys instead of AWS managed keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#kms_master_key_id)",,,[]
1419,b1ffa705-19a3-4b73-b9d0-0c97d0663842,IAM Role With Full Privileges,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_role_with_full_privileges,Unknown,"IAM role policy that allow full administrative privileges (for all resources)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role)",,,[]
1420,b2315cae-b110-4426-81e0-80bb8640cdd3,Athena Database Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/athena_database_not_encrypted,Unknown,"AWS Athena Database data in S3 should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration)",,,[]
1421,b26d2b7e-60f6-413d-a3a1-a57db24aa2b3,SNS Topic is Publicly Accessible,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sns_topic_is_publicly_accessible,Unknown,"SNS Topic Policy should not allow any principal to access<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic)",,,[]
1422,b3a41501-f712-4c4f-81e5-db9a7dc0e34e,VPC Peering Route Table with Unrestricted CIDR,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vpc_peering_route_table_with_unrestricted_cidr,Unknown,"VPC Peering Route Table should restrict CIDR<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route)",,,[]
1423,b3a59b8e-94a3-403e-b6e2-527abaf12034,API Gateway Deployment Without API Gateway UsagePlan Associated,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_deployment_without_api_gateway_usage_plan_associated,Unknown,"API Gateway Deployment should have API Gateway UsagePlan defined and associated.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_deployment)",,,[]
1424,b4378389-a9aa-44ee-91e7-ef183f11079e,IAM Policies Attached To User,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_policies_attached_to_user,Unknown,"IAM policies should be attached only to groups or roles<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_policy_attachment)",,,[]
1425,b5681959-6c09-4f55-b42b-c40fa12d03ec,IAM User Policy Without MFA,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_user_policy_without_mfa,Unknown,"Check if the root user is authenticated with MFA<br>
[Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_configure-api-require.html)",,,[]
1426,b592ffd4-0577-44b6-bd35-8c5ee81b5918,No Password Policy Enabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/no_password_policy_enabled,Unknown,"IAM password policies should be set through the password minimum length and reset password attributes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_login_profile)",,,[]
1427,b69247e5-7e73-464e-ba74-ec9b715c6e12,User With Privilege Escalation By Actions 'lambda:UpdateFunctionCode',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_lambda_UpdateFunctionCode,Unknown,"User with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1428,b72d0026-f649-4c91-a9ea-15d8f681ac09,Stack Notifications Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/stack_notifications_disabled,Unknown,"AWS CloudFormation should have stack notifications enabled to be notified when an event occurs<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudformation_stack)",,,[]
1429,b7c9a40c-23e4-4a2d-8d39-a3352f10f288,API Gateway Method Settings Cache Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_method_settings_cache_not_encrypted,Unknown,"API Gateway Method Settings Cache should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted)",,,[]
1430,b8a31292-509d-4b61-bc40-13b167db7e9c,Role With Privilege Escalation By Actions 'iam:AddUserToGroup',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_AddUserToGroup,Unknown,"Role with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1431,b9033580-6886-401a-8631-5f19f5bb24c7,Workspaces Workspace Volume Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/workspaces_workspace_volume_not_encrypted,Unknown,"AWS Workspaces Workspace data stored in volumes should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled)",,,[]
1432,ba40ace1-a047-483c-8a8d-bc2d3a67a82d,EKS node group remote access disabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/eks_node_group_remote_access_disabled,Unknown,"EKS node group remote access is disabled when 'SourceSecurityGroups' is missing<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_node_group#remote_access)",,,[]
1433,ba48df05-eaa1-4d64-905e-4a4b051e7587,Autoscaling Groups Supply Tags,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/autoscaling_groups_supply_tags,Unknown,"Autoscaling groups should supply tags to configurate<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/autoscaling_group#tag-and-tags)",,,[]
1434,ba4e0031-3e9d-4d7d-b0d6-bd8f003f8698,AMI Shared With Multiple Accounts,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ami_shared_with_multiple_accounts,Unknown,"Limits access to AWS AMIs by checking if more than one account is using the same image<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ami_launch_permission)",,,[]
1435,baecd2da-492a-4d59-b9dc-29540a1398e0,BOM - AWS SQS,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/sqs,Unknown,"A list of SQS resources specified. Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications.<br>
[Documentation](https://kics.io)",,,[]
1436,bbe3dd3d-fea9-4b68-a785-cfabe2bbbc54,Policy Without Principal,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/policy_without_principal,Unknown,"All policies, except IAM identity-based policies, should have the 'Principal' element defined<br>
[Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html)",,,[]
1437,bc1f9009-84a0-490f-ae09-3e0ea6d74ad6,DOCDB Cluster Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/docdb_cluster_not_encrypted,Unknown,"AWS DOCDB Cluster storage should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted)",,,[]
1438,bca7cc4d-b3a4-4345-9461-eb69c68fcd26,RDS Using Default Port,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_using_default_port,Unknown,"RDS should not use the default port (an attacker can easily guess the port). For engines related to Aurora, MariaDB or MySQL, the default port is 3306. PostgreSQL default port is 5432, Oracle default port is 1521 and SQL Server default port is 1433<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#port)",,,[]
1439,bcdcbdc6-a350-4855-ae7c-d1e6436f7c97,IAM Policy Grants 'AssumeRole' Permission Across All Services,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_policy_grants_assumerole_permission_across_all_services,Unknown,"IAM Policy should not grant 'AssumeRole' permission across all services.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role)",,,[]
1440,bd0088a5-c133-4b20-b129-ec9968b16ef3,CloudTrail Log Files S3 Bucket is Publicly Accessible,Terraform,High,Observability,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_log_files_s3_bucket_is_publicly_accessible,Unknown,"CloudTrail Log Files S3 Bucket should not be publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#s3_bucket_name)",,,[]
1441,be2aa235-bd93-4b68-978a-1cc65d49082f,Role With Privilege Escalation By Actions 'cloudformation:CreateStack' And 'iam:PassRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PassRole_and_cloudformation_CreateStack,Unknown,"Role with privilege escalation by actions 'cloudformation:CreateStack' and 'iam:PassRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1442,bf878b1a-7418-4de3-b13c-3a86cf894920,S3 Bucket Public ACL Overridden By Public Access Block,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_public_acl_overridden_by_public_access_block,Unknown,"S3 bucket public access is overridden by S3 bucket Public Access Block when the following attributes are set to true - 'block_public_acls', 'block_public_policy', 'ignore_public_acls', and 'restrict_public_buckets'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket)",,,[]
1443,bf9d42c7-c2f9-4dfe-942c-c8cc8249a081,User With Privilege Escalation By Actions 'iam:AddUserToGroup',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_AddUserToGroup,Unknown,"User with privilege escalation by actions 'iam:AddUserToGroup' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1444,c0c1e744-0f37-445e-924a-1846f0839f69,Group With Privilege Escalation By Actions 'iam:PutRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PutRolePolicy,Unknown,"Group with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1445,c3831315-5ae6-4fa8-b458-3d4d5ab7a3f6,Certificate Has Expired,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/298.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/certificate_has_expired,Unknown,"Expired SSL/TLS certificates should be removed<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api)","- name: upload a self-signed certificate2
  community.aws.aws_acm:
    certificate: ""{{ lookup('file', 'validCertificate.pem' ) }}""
    privateKey: ""{{ lookup('file', 'key.pem' ) }}""
    name_tag: my_cert
    region: ap-southeast-2",,[]
1446,c53c7a89-f9d7-4c7b-8b66-8a555be99593,Public and Private EC2 Share Role,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/public_and_private_ec2_share_role,Unknown,"Public and private EC2 istances should not share the same role.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#iam_instance_profile)",,,[]
1447,c583f0f9-7dfd-476b-a056-f47c62b47b46,Role With Privilege Escalation By Actions 'lambda:UpdateFunctionCode',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_lambda_UpdateFunctionCode,Unknown,"Role with privilege escalation by actions 'lambda:UpdateFunctionCode' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1448,c5b31ab9-0f26-4a49-b8aa-4cc064392f4d,S3 Bucket Without Enabled MFA Delete,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_without_enabled_mfa_delete,Unknown,"S3 bucket without MFA Delete Enabled. MFA delete cannot be enabled through Terraform, it can be done by adding a MFA device (https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html) and enabling versioning and MFA delete by using AWS CLI: 'aws s3api put-bucket-versioning --versioning-configuration=Status=Enabled,MFADelete=Enabled --bucket=<BUCKET_NAME> --mfa=<MFA_SERIAL_NUMBER>'. Please, also notice that MFA delete can not be used with lifecycle configurations<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete)",,,[]
1449,c91d7ea0-d4d1-403b-8fe1-c9961ac082c5,Neptune Cluster With IAM Database Authentication Disabled,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/neptune_cluster_with_iam_database_authentication_disabled,Unknown,"Neptune Cluster should have IAM Database Authentication enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted)",,,[]
1450,c999cf62-0920-40f8-8dda-0caccd66ed7e,API Gateway Stage Without API Gateway UsagePlan Associated,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_stage_without_api_gateway_usage_plan_associated,Unknown,"API Gateway Stage should have API Gateway UsagePlan defined and associated.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage)",,,[]
1451,cb3f5ed6-0d18-40de-a93d-b3538db31e8c,Security Group Without Description,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/security_group_without_description,Unknown,"It's considered a best practice for AWS Security Group to have a description<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description)",,,[]
1452,cc997676-481b-4e93-aa81-d19f8c5e9b12,EBS Volume Encryption Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ebs_volume_encryption_disabled,Unknown,"EBS volumes should be encrypted<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted)",,,[]
1453,ce089fd4-1406-47bd-8aad-c259772bb294,DynamoDB Table Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/dynamodb_table_not_encrypted,Unknown,"AWS DynamoDB Tables should have server-side encryption<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption)",,,[]
1454,ce60cc6b-6831-4bd7-84a2-cc7f8ee71433,SSM Session Transit Encryption Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ssm_session_transit_encryption_disabled,Unknown,"SSM Session should be encrypted in transit<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ssm_document#content)",,,[]
1455,ce60d060-efb8-4bfd-9cf7-ff8945d00d90,Misconfigured Password Policy Expiration,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/misconfigured_password_policy_expiration,Unknown,"No password expiration policy<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy)",,,[]
1456,ce9dfce0-5fc8-433b-944a-3b16153111a8,SSO Permission With Inadequate User Session Duration,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/613.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sso_permission_with_inadequate_user_session_duration,Unknown,"SSO permissions should be configured to limit user sessions to no longer than 1 hour. Allowing longer sessions can increase the risk of unauthorized access or session hijacking. This is a best practice for security and should be implemented in SSO permission settings.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ssoadmin_permission_set)",,,[]
1457,cfdcabb0-fc06-427c-865b-c59f13e898ce,Redshift Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/redshift_not_encrypted,Unknown,"AWS Redshift Cluster should be encrypted. Check if 'encrypted' field is false or undefined (default is false)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted)",,,[]
1458,d0cc8694-fcad-43ff-ac86-32331d7e867f,S3 Bucket Allows Public ACL,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_allows_public_acl,Unknown,"S3 bucket allows public ACL<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block)",,,[]
1459,d1846b12-20c5-4d45-8798-fc35b79268eb,ECR Image Tag Not Immutable,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecr_image_tag_not_immutable,Unknown,"ECR should have an image tag be immutable. This prevents image tags from being overwritten.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository)",,,[]
1460,d24c0755-c028-44b1-b503-8e719c898832,S3 Bucket Allows Put Action From All Principals,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_allows_put_action_from_all_principals,Unknown,"S3 Buckets must not allow Put Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Put, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy)",,,[]
1461,d25edb51-07fb-4a73-97d4-41cecdc53a22,Glue With Vulnerable Policy,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/glue_with_vulnerable_policy,Unknown,"Glue policy should avoid wildcard in 'principals' and 'actions'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/glue_resource_policy#policy)",,,[]
1462,d364984a-a222-4b5f-a8b0-e23ab19ebff3,Athena Workgroup Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/athena_workgroup_not_encrypted,Unknown,"Athena Workgroup query results should be encrypted, for all queries that run in the workgroup<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration)",,,[]
1463,d6047119-a0b2-4b59-a4f2-127a36fb685b,Role With Privilege Escalation By Actions 'iam:PutGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PutGroupPolicy,Unknown,"Role with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1464,d7b9d850-3e06-4a75-852f-c46c2e92240b,Hardcoded AWS Access Key,Terraform,High,Secret Management,https://cwe.mitre.org/data/definitions/798.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/hardcoded_aws_access_key,Unknown,"AWS Access Key should not be hardcoded<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance)",,,[]
1465,db0ec4c4-852c-46a2-b4f3-7ec13cdb12a8,CloudWatch Logs Destination With Vulnerable Policy,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_logs_destination_with_vulnerable_policy,Unknown,"CloudWatch Logs destination policy should avoid wildcard in 'principals' and 'actions'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_destination_policy#access_policy)",,,[]
1466,db78d14b-10e5-4e6e-84b1-dace6327b1ec,Group With Privilege Escalation By Actions 'iam:AttachUserPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_AttachUserPolicy,Unknown,"Group with privilege escalation by actions 'iam:AttachUserPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1467,de7f5e83-da88-4046-871f-ea18504b1d43,ALB Listening on HTTP,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/alb_listening_on_http,Unknown,"AWS Application Load Balancer (alb) should not listen on HTTP<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener)",,,[]
1468,e08ed7eb-f3ef-494d-9d22-2e3db756a347,Lambda Permission Principal Is Wildcard,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/lambda_permission_principal_is_wildcard,Unknown,"Lambda Permission Principal should not contain a wildcard.<br>
[Documentation](https://docs.ansible.com/ansible/latest/collections/community/aws/lambda_policy_module.html)",,,[]
1469,e227091e-2228-4b40-b046-fc13650d8e88,User With Privilege Escalation By Actions 'iam:AttachRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_AttachRolePolicy,Unknown,"User with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1470,e35c16a2-d54e-419d-8546-a804d8e024d0,Sensitive Port Is Exposed To Small Public Network,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sensitive_port_is_exposed_to_small_public_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for a small public network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1471,e38a8e0a-b88b-4902-b3fe-b0fcb17d5c10,Resource Not Using Tags,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/resource_not_using_tags,Unknown,"AWS services resource tags are an essential part of managing components. As a best practice, the field 'tags' should have additional tags defined other than 'Name'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging)",,,[]
1472,e39bee8c-fe54-4a3f-824d-e5e2d1cca40a,IAM Role Policy passRole Allows All,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_role_policy_passrole_allows_all,Unknown,"Using the iam:passrole action with wildcards (*) in the resource can be overly permissive because it allows iam:passrole permissions on multiple resources<br>
[Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource)",,,[]
1473,e542bd46-58c4-4e0f-a52a-1fb4f9548e02,RDS Cluster With Backup Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/rds_cluster_with_backup_disabled,Unknown,"RDS Cluster backup retention period should be specifically defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period)",,,[]
1474,e592a0c5-5bdb-414c-9066-5dba7cdea370,IAM Access Analyzer Not Enabled,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_access_analyzer_not_enabled,Unknown,"IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer)",,,[]
1475,e6b4b943-6883-47a9-9739-7ada9568f8ca,EBS Volume Snapshot Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ebs_volume_snapshot_not_encrypted,Unknown,"The value on AWS EBS Volume Snapshot Encryptation must be true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ebs_snapshot#encrypted)",,,[]
1476,e7530c3c-b7cf-4149-8db9-d037a0b5268e,Elasticsearch Without IAM Authentication,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_without_iam_authentication,Unknown,"AWS Elasticsearch should ensure IAM Authentication<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain)",,,[]
1477,e77c89f6-9c85-49ea-b95b-5f960fe5be92,Group With Privilege Escalation By Actions 'iam:PutGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_PutGroupPolicy,Unknown,"Group with privilege escalation by actions 'iam:PutGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1478,e86e26fc-489e-44f0-9bcd-97305e4ba69a,ECR Repository Is Publicly Accessible,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ecr_repository_is_publicly_accessible,Unknown,"Amazon ECR image repositories shouldn't have public access<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy)",,,[]
1479,e979fcbc-df6c-422d-9458-c33d65e71c45,ElasticSearch Without Slow Logs,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/elasticsearch_without_slow_logs,Unknown,"Ensure that AWS Elasticsearch enables support for slow logs<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_publishing_options)",,,[]
1480,e9b7acf9-9ba0-4837-a744-31e7df1e434d,SQS VPC Endpoint Without DNS Resolution,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sqs_vpc_endpoint_without_dns_resolution,Unknown,"SQS VPC Endpoint should have DNS resolution enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc#enable_dns_support)",,,[]
1481,eaaba502-2f94-411a-a3c2-83d63cc1776d,CloudWatch IAM Policy Changes Alarm Missing,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_iam_policy_changes_alarm_missing,Unknown,"Ensure a log metric filter and alarm exist for IAM policy changes<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_metric_filter#pattern)",,,[]
1482,eb64f1e9-f67d-4e35-8a3c-3d6a2f9efea7,Role With Privilege Escalation By Actions 'iam:PutRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PutRolePolicy,Unknown,"Role with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1483,ec28bf61-a474-4dbe-b414-6dd3a067d6f0,Cognito UserPool Without MFA,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cognito_userpool_without_mfa,Unknown,"AWS Cognito UserPool should have MFA (Multi-Factor Authentication) defined to users<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cognito_user_pool)",,,[]
1484,ec49cbfd-fae4-45f3-81b1-860526d66e3f,Group With Privilege Escalation By Actions 'iam:CreatePolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/group_with_privilege_escalation_by_actions_iam_CreatePolicyVersion,Unknown,"Group with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_policy#policy)",,,[]
1485,eccc4d59-74b9-4974-86f1-74386e0c7f33,BOM - AWS SNS,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/sns,Unknown,"A list of SNS resources specified. Amazon Simple Notification Service (Amazon SNS) is a fully managed messaging service for both application-to-application (A2A) and application-to-person (A2P) communication.<br>
[Documentation](https://kics.io)",,,[]
1486,ed35928e-195c-4405-a252-98ccb664ab7b,API Gateway With Invalid Compression,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/api_gateway_with_invalid_compression,Unknown,"API Gateway should have valid compression, which means attribute 'minimum_compression_size' should be set and its value should be greater than -1 and smaller than 10485760.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_rest_api)",,,[]
1487,eda48c88-2b7d-4e34-b6ca-04c0194aee17,Role With Privilege Escalation By Actions 'glue:UpdateDevEndpoint',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_glue_UpdateDevEndpoint,Unknown,"Role with privilege escalation by actions 'glue:UpdateDevEndpoint' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1488,ee49557d-750c-4cc1-aa95-94ab36cbefde,Role With Privilege Escalation By Actions 'iam:CreatePolicyVersion',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_CreatePolicyVersion,Unknown,"Role with privilege escalation by actions 'iam:CreatePolicyVersion' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1489,ee9e50e8-b2ed-4176-ad42-8fc0cf7593f4,CloudTrail Log Files S3 Bucket with Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudtrail_log_files_s3_bucket_with_logging_disabled,Unknown,"CloudTrail Log Files S3 Bucket should have 'logging' enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#s3_bucket_name)",,,[]
1490,eeb4d37a-3c59-4789-a00c-1509bc3af1e5,User With Privilege Escalation By Actions 'iam:PutRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/user_with_privilege_escalation_by_actions_iam_PutRolePolicy,Unknown,"User with privilege escalation by actions 'iam:PutRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user_policy#policy)",,,[]
1491,ef0b316a-211e-42f1-888e-64efe172b755,CloudWatch Without Retention Period Specified,Terraform,Info,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/cloudwatch_without_retention_period_specified,Unknown,"AWS CloudWatch Log groups should have retention days specified<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group)",,,[]
1492,f0d8781f-99bf-4958-9917-d39283b168a0,DB Security Group Has Public Interface,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/db_security_group_has_public_interface,Unknown,"The CIDR IP should not be a public interface<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_security_group)",,,[]
1493,f1173d8c-3264-4148-9fdb-61181e031b51,Role With Privilege Escalation By Actions 'iam:UpdateAssumeRolePolicy' And 'sts:AssumeRole',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_UpdateAssumeRolePolicy_and_sts_AssumeRole,Unknown,"Role with privilege escalation by actions 'iam:UpdateAssumeRolePolicy' and 'sts:AssumeRole' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1494,f11aec39-858f-4b6f-b946-0a1bf46c0c87,DAX Cluster Not Encrypted,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/dax_cluster_not_encrypted,Unknown,"AWS DAX Cluster should have server-side encryption at rest<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#enabled)",,,[]
1495,f1adc521-f79a-4d71-b55b-a68294687432,EC2 Instance Using Default Security Group,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/ec2_instance_using_default_security_group,Unknown,"EC2 instances should not use default security group(s)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#security_groups)",,,[]
1496,f3674e0c-f6be-43fa-b71c-bf346d1aed99,Sagemaker Notebook Instance Without KMS,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/sagemaker_notebook_instance_without_kms,Unknown,"AWS SageMaker should encrypt model artifacts at rest using Amazon S3 server-side encryption with an AWS KMS<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance#kms_key_id)",,,[]
1497,f465fff1-0a0f-457d-aa4d-1bddb6f204ff,Role With Privilege Escalation By Actions 'iam:AttachRolePolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_AttachRolePolicy,Unknown,"Role with privilege escalation by actions 'iam:AttachRolePolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1498,f53f16d6-46a9-4277-9fbe-617b1e24cdca,BOM - AWS EFS,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/efs,Unknown,"A list of EFS resources found. Amazon Elastic File System (Amazon EFS) automatically grows and shrinks as you add and remove files with no need for management or provisioning.<br>
[Documentation](https://kics.io)",,,[]
1499,f83121ea-03da-434f-9277-9cd247ab3047,VPC FlowLogs Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vpc_flowlogs_disabled,Unknown,"Every VPC resource should have an associated Flow Log<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc)",,,[]
1500,f861041c-8c9f-4156-acfc-5e6e524f5884,S3 Bucket Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_logging_disabled,Unknown,"Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket)",,,[]
1501,f906113d-cdc0-415a-ba60-609cc6daaf4d,Role With Privilege Escalation By Actions 'iam:AttachGroupPolicy',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_AttachGroupPolicy,Unknown,"Role with privilege escalation by actions 'iam:AttachGroupPolicy' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1502,fa00ce45-386d-4718-8392-fb485e1f3c5b,Secrets Manager With Vulnerable Policy,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/secrets_manager_with_vulnerable_policy,Unknown,"Secrets Manager policy should avoid wildcard in 'Principal' and 'Action'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret_policy#policy)",,,[]
1503,fa62ac4f-f5b9-45b9-97c1-625c8b6253ca,Role With Privilege Escalation By Actions 'lambda:CreateFunction' And 'iam:PassRole' And 'lambda:InvokeFunction',Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/269.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/role_with_privilege_escalation_by_actions_iam_PassRole_and_lambda_CreateFunction_lambda_InvokeFunction,Unknown,"Role with privilege escalation by actions 'lambda:CreateFunction' and 'iam:PassRole' and 'lambda:InvokeFunction' and Resource set to '*'. For more information see https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_role_policy#policy)",,,[]
1504,fae52418-bb8b-4ac2-b287-0b9082d6a3fd,EFS With Vulnerable Policy,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/155.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/efs_with_vulnerable_policy,Unknown,"EFS (Elastic File System) policy should avoid wildcard in 'Action' and 'Principal'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system_policy#policy)",,,[]
1505,fc101ca7-c9dd-4198-a1eb-0fbe92e80044,IAM Group Without Users,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/iam_group_without_users,Unknown,"IAM Group should have at least one user associated<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_group_membership#users)",,,[]
1506,fcb1b388-f558-4b7f-9b6e-f4e98abb7380,BOM - AWS MQ,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws_bom/mq,Unknown,"A list of MQ resources found. Amazon MQ is a managed message broker service for Apache ActiveMQ and RabbitMQ that makes it easy to set up and operate message brokers on AWS.<br>
[Documentation](https://kics.io)",,,[]
1507,fd632aaf-b8a1-424d-a4d1-0de22fd3247a,VPC Without Network Firewall,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/vpc_without_network_firewall,Unknown,"VPC should have a Network Firewall associated<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id)",,,[]
1508,ffac8a12-322e-42c1-b9b9-81ff85c39ef7,HTTP Port Open To Internet,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/http_port_open,Unknown,"The HTTP port is open to the internet in a Security Group<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group)",,,[]
1509,ffdf4b37-7703-4dfe-a682-9d2e99bc6c09,S3 Bucket Allows Delete Action From All Principals,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/aws/s3_bucket_allows_delete_action_from_all_principals,Unknown,"S3 Buckets must not allow Delete Action From All Principals, as to prevent leaking private information to the entire internet or allow unauthorized data tampering / deletion. This means the 'Effect' must not be 'Allow' when the 'Action' is Delete, for all Principals.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_policy)",,,[]
1510,0437633b-daa6-4bbc-8526-c0d2443b946e,SSL Enforce Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/ssl_enforce_is_disabled,Unknown,"Make sure that for PosgreSQL, the 'Enforce SSL connection' is set to 'ENABLED'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server)",,,[]
1511,07f7134f-9f37-476e-8664-670c218e4702,PostgreSQL Log Disconnections Not Set,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_log_disconnections_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_disconnections' is set to 'ON'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1512,0a70d5f3-1ecd-4c8e-9292-928fc9a8c4f1,MariaDB Server Geo-redundant Backup Disabled,Terraform,Low,Backup,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mariadb_server_georedundant_backup_disabled,Unknown,"MariaDB Server Geo-redundant Backup should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#geo_redundant_backup_enabled)",,,[]
1513,11e9a948-c6c3-4a0f-8dcf-b5cf1763cdbe,Web App Accepting Traffic Other Than HTTPS,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/web_app_accepting_traffic_other_than_https,Unknown,"Web app should only accept HTTPS traffic in Azure Web App Service.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#https_only)",,,[]
1514,12944ec4-1fa0-47be-8b17-42a034f937c2,Storage Account Not Forcing HTTPS,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/storage_account_not_forcing_https,Unknown,"Storage Accounts should enforce the use of HTTPS<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account)",,,[]
1515,16e0879a-c4ae-4ff8-a67d-a2eed5d67b8f,PostgreSQL Log Duration Not Set,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_log_duration_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_duration' is set to 'ON'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1516,17f75827-0684-48f4-8747-61129c7e4198,Public Storage Account,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/public_storage_account,Unknown,"Storage Account should not be public to grant the principle of least privileges<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account)",,,[]
1517,25c0ea09-f1c5-4380-b055-3b83863f2bb8,SQLServer Ingress From Any IP,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_server_ingress_from_any_ip,Unknown,"Check if all IPs are allowed, check from start 0.0.0.0 to end 255.255.255.255.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule)",,,[]
1518,261a83f8-dd72-4e8c-b5e1-ebf06e8fe606,Small PostgreSQL DB Server Log Retention Period,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/small_postgresql_db_server_log_retention_period,Unknown,"Check if PostgreSQL Database Server retains logs for less than 3 Days<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1519,2ab6de9a-0136-415c-be92-79d2e4fd750f,SQL Server Predictable Admin Account Name,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_server_predictable_admin_account_name,Unknown,"Azure SQL Server's Admin account login must avoid using names like 'Admin', that are too predictable, which means the attribute 'administrator_login' must be set to a name that is not easy to predict<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server)",,,[]
1520,2b3c671f-1b76-4741-8789-ed1fe0785dc4,PostgreSQL Server Without Connection Throttling,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/770.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_server_without_connection_throttling,Unknown,"Ensure that Connection Throttling is set for the PostgreSQL server<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1521,2b856bf9-8e8c-4005-875f-303a8cba3918,Small Activity Log Retention Period,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/small_activity_log_retention_period,Unknown,"Ensure that Activity Log Retention is set 365 days or greater<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile)",,,[]
1522,2e48d91c-50e4-45c8-9312-27b625868a72,WAF Is Disabled For Azure Application Gateway,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/waf_is_disabled_for_azure_application_gateway,Unknown,"Check if Web Application Firewall is disabled or not configured for Azure's Application Gateway.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/application_gateway)",,,[]
1523,34664094-59e0-4524-b69f-deaa1a68cce3,Security Contact Email,Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/security_contact_email,Unknown,"Security Contact Email should be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#email)",,,[]
1524,3790d386-be81-4dcf-9850-eaa7df6c10d9,PostgreSQL Log Checkpoints Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_log_checkpoints_disabled,Unknown,"Make sure that for Postgre SQL Database Server, parameter 'log_checkpoints' is set to 'ON'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1525,38c71c00-c177-4cd7-8d36-cd1007cdb190,Vault Auditing Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/vault_auditing_disabled,Unknown,"Ensure that logging for Azure KeyVault is 'Enabled'<br>
[Documentation](https://www.terraform.io/docs/providers/azurerm/r/key_vault.html)",,,[]
1526,3ac3e75c-6374-4a32-8ba0-6ed69bda404e,Storage Table Allows All ACL Permissions,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/storage_table_allows_all_acl_permissions,Unknown,"Azure Storage Table should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list).<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_table#permissions)",,,[]
1527,3e3c175e-aadf-4e2b-a464-3fdac5748d24,SSH Is Exposed To The Internet,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/ssh_is_exposed_to_the_internet,Unknown,"Port 22 (SSH) is exposed to the internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule)",,,[]
1528,3fa5900f-9aac-4982-96b2-a6143d9c99fb,Role Definition Allows Custom Role Creation,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/role_definition_allows_custom_role_creation,Unknown,"Role Definition should not allow custom role creation (Microsoft.Authorization/roleDefinitions/write)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions)",,,[]
1529,4216ebac-d74c-4423-b437-35025cb88af5,Network Interfaces IP Forwarding Enabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/network_interfaces_ip_forwarding_enabled,Unknown,"Network Interfaces IP Forwarding should be disabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_interface#enable_ip_forwarding)",,,[]
1530,43789711-161b-4708-b5bb-9d1c626f7492,AKS Uses Azure Policies Add-On Disabled,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/aks_uses_azure_policies_addon_disabled,Unknown,"Azure Container Service (AKS) should use Azure Policies Add-On<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#azure_policy)",,,[]
1531,45fc717a-bd86-415c-bdd8-677901be1aa6,Function App Not Using Latest TLS Encryption Version,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_not_using_latest_tls_encryption_version,Unknown,"Ensure Function App is using the latest version of TLS encryption<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#min_tls_version)",,,[]
1532,48bbe0fd-57e4-4678-a4a1-119e79c90fc3,Storage Share File Allows All ACL Permissions,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/storage_share_file_allows_all_acl_permissions,Unknown,"Azure Storage Share File should not allow all ACL (Access Control List) permissions - r (read), w (write), d (delete), and l (list).<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_share_file)",,,[]
1533,4a9e0f00-0765-4f72-a0d4-d31110b78279,Azure Cognitive Search Public Network Access Enabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_cognitive_search_public_network_access_enabled,Unknown,"Public Network Access should be disabled for Azure Cognitive Search<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/search_service#public_network_access_enabled)",,,[]
1534,4d080822-5ee2-49a4-8984-68f3d4c890fc,Key Expiration Not Set,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/key_expiration_not_set,Unknown,"Make sure that for all keys the expiration date is set<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key)",,,[]
1535,5089d055-53ff-421b-9482-a5267bdce629,Redis Publicly Accessible,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/redis_publicly_accessible,Unknown,"Firewall rule allowing unrestricted access to Redis from other Azure sources<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_firewall_rule)",,,[]
1536,525b53be-62ed-4244-b4df-41aecfcb4071,App Service HTTP2 Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_http2_disabled,Unknown,"App Service should have 'http2_enabled' enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled)",,,[]
1537,5400f379-a347-4bdd-a032-446465fdcc6f,Trusted Microsoft Services Not Enabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/trusted_microsoft_services_not_enabled,Unknown,"Trusted Microsoft Services should be enabled for Storage Account access<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass)",,,[]
1538,55975007-f6e7-4134-83c3-298f1fe4b519,SQL Server Alert Email Disabled,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_server_alert_email_disabled,Unknown,"SQL Server alert email should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins)",,,[]
1539,56dad03e-e94f-4dd6-93a4-c253a03ff7a0,Cosmos DB Account Without Tags,Terraform,Low,Build Process,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/cosmos_db_account_without_tags,Unknown,"Cosmos DB Account must have a mapping of tags.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_account)",,,[]
1540,594c198b-4d79-41b8-9b36-fde13348b619,Sensitive Port Is Exposed To Entire Network,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sensitive_port_is_exposed_to_entire_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule)",,,[]
1541,599318f2-6653-4569-9e21-041d06c63a89,AKS Private Cluster Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/aks_private_cluster_disabled,Unknown,"Azure Kubernetes Service (AKS) API should not be exposed to the internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#private_cluster_enabled)",,,[]
1542,59acb56b-2b10-4c2c-ba38-f2223c3f5cfc,Small MSSQL Server Audit Retention,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/small_msql_server_audit_retention,Unknown,"Make sure for SQL Servers that Auditing Retention is greater than 90 days<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server)",,,[]
1543,5c822443-e1ea-46b8-84eb-758ec602e844,Security Group is Not Configured,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/security_group_is_not_configured,Unknown,"Azure Virtual Network subnet must be configured with a Network Security Group, which means the attribute 'security_group' must be defined and not empty<br>
[Documentation](https://www.terraform.io/docs/providers/azure/r/virtual_network.html)",,,[]
1544,609839ae-bd81-4375-9910-5bce72ae7b92,MSSQL Server Auditing Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mssql_server_auditing_disabled,Unknown,"Make sure that for MSSQL Servers, 'Auditing' is set to 'On'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server)",,,[]
1545,61c3cb8b-0715-47e4-b788-86dde40dd2db,Dashboard Is Enabled,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/dashboard_is_enabled,Unknown,"Check if the Kubernetes Dashboard is enabled.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster)",,,[]
1546,6425c98b-ca4e-41fe-896a-c78772c131f8,PostgreSQL Server Infrastructure Encryption Disabled,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_server_infrastructure_encryption_disabled,Unknown,"PostgreSQL Server Infrastructure Encryption should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#infrastructure_encryption_enabled)",,,[]
1547,73e42469-3a86-4f39-ad78-098f325b4e9f,MySQL SSL Connection Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mysql_ssl_connection_disabled,Unknown,"Make sure that for MySQL Database Server, 'Enforce SSL connection' is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server)",,,[]
1548,7750fcca-dd03-4d38-b663-4b70289bcfd4,Small Flow Logs Retention Period,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/small_flow_logs_retention_period,Unknown,"Flow logs enable capturing information about IP traffic flowing in and out of the network security groups. Network Security Group Flow Logs must be enabled with retention period greater than or equal to 90 days. This is important, because these logs are used to check for anomalies and give information of suspected breaches<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log)",,,[]
1549,7f0a8696-7159-4337-ad0d-8a3ab4a78195,MariaDB Server Public Network Access Enabled,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mariadb_public_network_access_enabled,Unknown,"MariaDB Server Public Network Access should be disabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled)",,,[]
1550,819d50fd-1cdf-45c3-9936-be408aaad93e,Security Center Pricing Tier Is Not Standard,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/security_center_pricing_tier_is_not_standard,Unknown,"Make sure that the 'Standard' pricing tiers were selected.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing)",,,[]
1551,8263f146-5e03-43e0-9cfe-db960d56d1e7,Storage Account Not Using Latest TLS Encryption Version,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/storage_account_not_using_latest_tls_encryption_version,Unknown,"Ensure Storage Account is using the latest version of TLS encryption<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account)",,,[]
1552,835a4f2f-df43-437d-9943-545ccfc55961,Azure Front Door WAF Disabled,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_front_door_waf_disabled,Unknown,"Azure Front Door WAF should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/frontdoor#web_application_firewall_policy_link_id)",,,[]
1553,83a229ba-483e-47c6-8db7-dc96969bce5a,SQL Database Audit Disabled,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_database_audit_disabled,Unknown,"Ensure that 'Threat Detection' is enabled for Azure SQL Database<br>
[Documentation](https://www.terraform.io/docs/providers/azurerm/r/sql_database.html)",,,[]
1554,85da374f-b00f-4832-9d44-84a1ca1e89f8,App Service FTPS Enforce Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_ftps_enforce_disabled,Unknown,"Azure App Service should only enforce FTPS when 'ftps_state' is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#ftps_state)",,,[]
1555,86f92117-eed8-4614-9c6c-b26da20ff37f,AKS RBAC Disabled,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/aks_rbac_disabled,Unknown,"Azure Container Service (AKS) instance should have role-based access control (RBAC) enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#role_based_access_control)",,,[]
1556,8b042c30-e441-453f-b162-7696982ebc58,Geo Redundancy Is Disabled,Terraform,Low,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/geo_redundancy_is_disabled,Unknown,"Make sure that on PostgreSQL Geo Redundant Backups is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server)",,,[]
1557,8e75e431-449f-49e9-b56a-c8f1378025cf,Role Assignment Not Limit Guest User Permissions,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/role_assignment_not_limit_guest_users_permissions,Unknown,"Role Assignment should limit guest user permissions<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment)",,,[]
1558,96fe318e-d631-4156-99fa-9080d57280ae,App Service Without Latest PHP Version,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_without_latest_php_version,Unknown,"Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#php_version)",,,[]
1559,9bb3c639-5edf-458c-8ee5-30c17c7d671d,Function App Client Certificates Unrequired,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_client_certificates_unrequired,Unknown,"Azure Function App should have 'client_cert_mode' set to required<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#client_cert_mode)",,,[]
1560,9c301481-e6ec-44f7-8a49-8ec63e2969ea,Small MSSQL Audit Retention Period,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/small_mssql_audit_retention_period,Unknown,"Make sure that for MSSQL Server, the Auditing Retention is greater than 90 days<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server)",,,[]
1561,9dab0179-433d-4dff-af8f-0091025691df,Function App FTPS Enforce Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_ftps_enforce_disabled,Unknown,"Azure Function App should only enforce FTPS when 'ftps_state' is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#ftps_state)",,,[]
1562,9db38e87-f6aa-4b5e-a1ec-7266df259409,Email Alerts Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/email_alerts_disabled,Unknown,"Make sure that alerts notifications are set to 'On' in the Azure Security Center Contact<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact)",,,[]
1563,a187ac47-8163-42ce-8a63-c115236be6fb,Azure Container Registry With No Locks,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/639.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_container_registry_with_no_locks,Unknown,"Azurerm Container Registry should contain associated locks, which means 'azurerm_management_lock.scope' should be associated with 'azurerm_container_registry'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/container_registry)",,,[]
1564,a21c8da9-41bf-40cf-941d-330cf0d11fc7,Azure Active Directory Authentication,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_active_directory_authentication,Unknown,"Azure Active Directory must be used for authentication for Service Fabric<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/service_fabric_cluster#tenant_id)",,,[]
1565,a3a055d2-9a2e-4cc9-b9fb-12850a1a3a4b,AD Admin Not Configured For SQL Server,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/ad_admin_not_configured_for_sql_server,Unknown,"The Active Directory Administrator is not configured for a SQL server<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator)",,,[]
1566,a5613650-32ec-4975-a305-31af783153ea,Default Azure Storage Account Network Access Is Too Permissive,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/default_azure_storage_account_network_access_is_too_permissive,Unknown,"Default Azure Storage Account network access should be set to Deny<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action)",,,[]
1567,a81573f9-3691-4d83-88a0-7d4af63e17a3,Azure App Service Client Certificate Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_app_service_client_certificate_disabled,Unknown,"Azure App Service client certificate should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled)",,,[]
1568,a829b715-cf75-4e92-b645-54c9b739edfb,Firewall Rule Allows Too Many Hosts To Access Redis Cache,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/firewall_rule_allows_too_many_hosts_to_access_redis_cache,Unknown,"Check if any firewall rule allows too many hosts to access Redis Cache<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_firewall_rule)",,,[]
1569,a99130ab-4c0e-43aa-97f8-78d4fcb30024,Encryption On Managed Disk Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/encryption_on_managed_disk_disabled,Unknown,"Ensure that the encryption is active on the disk<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk#encryption_settings)",,,[]
1570,ace823d1-4432-4dee-945b-cdf11a5a6bd0,Function App HTTP2 Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_http2_disabled,Unknown,"Function App should have 'http2_enabled' enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#http2_enabled)",,,[]
1571,ade36cf4-329f-4830-a83d-9db72c800507,MSSQL Server Public Network Access Enabled,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mssql_server_public_network_access_enabled,Unknown,"MSSQL Server public network access should be disabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#public_network_access_enabled)",,,[]
1572,b17d8bb8-4c08-4785-867e-cb9e62a622aa,AKS Disk Encryption Set ID Undefined,Terraform,Low,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/aks_disk_encryption_set_id_undefined,Unknown,"Azure Container Service (AKS) should use Disk Encryption Set ID in supported types of disk<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#disk_encryption_set_id)",,,[]
1573,b4cc2c52-34a6-4b43-b57c-4bdeb4514a5a,Virtual Network with DDoS Protection Plan disabled,Terraform,Low,Availability,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/virtual_network_with_ddos_protection_plan_disabled,Unknown,"Virtual Network should have DDoS Protection Plan enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_network#ddos_protection_plan)",,,[]
1574,b61cce4b-0cc4-472b-8096-15617a6d769b,App Service Managed Identity Disabled,Terraform,Low,Resource Management,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_managed_identity_disabled,Unknown,"Azure App Service should have managed identity enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity)",,,[]
1575,b7b9d1c7-2d3b-49b4-b867-ebbe68d0b643,App Service Not Using Latest TLS Encryption Version,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_not_using_latest_tls_encryption_version,Unknown,"Ensure App Service is using the latest version of TLS encryption<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version)",,,[]
1576,b897dfbf-322c-45a8-b67c-1e698beeaa51,Admin User Enabled For Container Registry,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/admin_user_enabled_for_container_registry,Unknown,"Admin user is enabled for Container Registry<br>
[Documentation](https://www.terraform.io/docs/providers/azurerm/r/container_registry.html)",,,[]
1577,b90842e5-6779-44d4-9760-972f4c03ba1c,Network Watcher Flow Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/779.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/network_watcher_flow_disabled,Unknown,"Check if enable field in the resource azurerm_network_watcher_flow_log is false.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log)",,,[]
1578,b947809d-dd2f-4de9-b724-04d101c515aa,Redis Not Updated Regularly,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/912.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/redis_not_updated_regularly,Unknown,"Redis Cache is not configured to be updated regularly with security and operational updates<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_cache#patch_schedule)",,,[]
1579,bbf6b3df-4b65-4f87-82cc-da9f30f8c033,VM Not Attached To Network,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/vm_not_attached_to_network,Unknown,"No Network Security Group is attached to the Virtual Machine<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#network_interface_ids)",,,[]
1580,bcd3fc01-5902-4f2a-b05a-227f9bbf5450,SQL Server Predictable Active Directory Account Name,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/522.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_server_predictable_active_directory_admin_account_name,Unknown,"Azure SQL Server must avoid using predictable Active Directory Administrator Account names, like 'Admin', which means the attribute 'login' must be set to a name that is not easy to predict<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_active_directory_administrator)",,,[]
1581,c1573577-e494-4417-8854-7e119368dc8b,Network Interfaces With Public IP,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/network_interfaces_with_public_ip,Unknown,"Network Interfaces should not be exposed with a public IP address. If configured, additional security baselines should be followed (https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/virtual-network-security-baseline, https://docs.microsoft.com/en-us/security/benchmark/azure/baselines/public-ip-security-baseline)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_interface#public_ip_address_id)",,,[]
1582,c2a3efb6-8a58-481c-82f2-bfddf34bb4b7,CosmosDB Account IP Range Filter Not Set,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/cosmosdb_account_ip_range_filter_not_set,Unknown,"The IP range filter should be defined to secure the data stored<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_account#ip_range_filter)",,,[]
1583,c407c3cf-c409-4b29-b590-db5f4138d332,PostgreSQL Server Threat Detection Policy Disabled,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_server_threat_detection_policy_disabled,Unknown,"PostgreSQL Server Threat Detection Policy should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#threat_detection_policy)",,,[]
1584,c640d783-10c5-4071-b6c1-23507300d333,PostgreSQL Log Connections Not Set,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/postgresql_log_connections_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_connections' is set to 'ON'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1585,c6c7b33d-d7f6-4ab8-8c82-ca0431ecdb7e,Sensitive Port Is Exposed To Wide Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sensitive_port_is_exposed_to_wide_private_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for wide private network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule)",,,[]
1586,c7fc1481-2899-4490-bbd8-544a3a61a2f3,App Service Authentication Disabled,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_authentication_disabled,Unknown,"Azure App Service authentication settings should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled)",,,[]
1587,c87749b3-ff10-41f5-9df2-c421e8151759,Function App Managed Identity Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_managed_identity_disabled,Unknown,"Azure Function App should have managed identity enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#identity)",,,[]
1588,cc4aaa9d-1070-461a-b519-04e00f42db8a,App Service Without Latest Python Version,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/app_service_without_latest_python_version,Unknown,"Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#python_version)",,,[]
1589,d7ba74da-2da0-4d4b-83c8-2fd72a3f6c28,Unrestricted SQL Server Access,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/unrestricted_sql_server_access,Unknown,"Azure SQL Server Accessibility should be set to a minimal address range to grant the principle of least privileges, which means the difference between the values of the 'end_ip_address' and 'start_ip_address' must be less than 256. Additionally, both ips must be different from '0.0.0.0'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule)",,,[]
1590,dafe30ec-325d-4516-85d1-e8e6776f012c,Azure Instance Using Basic Authentication,Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/azure_instance_using_basic_authentication,Unknown,"Azure Instances should use SSH Key instead of basic authentication<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#admin_ssh_key)",,,[]
1591,dd5230f8-a577-4bbb-b7ac-f2c2fe7d5299,Storage Container Is Publicly Accessible,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/storage_container_is_publicly_accessible,Unknown,"Anonymous, public read access to a container and its blobs are enabled in Azure Blob Storage<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_container#container_access_type)",,,[]
1592,dfa20ffa-f476-428f-a490-424b41e91c7f,Secret Expiration Not Set,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/521.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/secret_expiration_not_set,Unknown,"Make sure that for all secrets the expiration date is set<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret)",,,[]
1593,e29a75e6-aba3-4896-b42d-b87818c16b58,Redis Cache Allows Non SSL Connections,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/redis_cache_allows_non_ssl_connections,Unknown,"Redis Cache resources should not allow non-SSL connections<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_cache)",,,[]
1594,e65a0733-94a0-4826-82f4-df529f4c593f,Function App Authentication Disabled,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/function_app_authentication_disabled,Unknown,"Azure Function App authentication settings should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#auth_settings)",,,[]
1595,e9dee01f-2505-4df2-b9bf-7804d1fd9082,Sensitive Port Is Exposed To Small Public Network,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sensitive_port_is_exposed_to_small_public_network,Unknown,"A sensitive port, such as port 23 or port 110, is open for small public network in either TCP or UDP protocol<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule)",,,[]
1596,efbf6449-5ec5-4cfe-8f15-acc51e0d787c,RDP Is Exposed To The Internet,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/rdp_is_exposed_to_the_internet,Unknown,"Port 3389 (Remote Desktop) is exposed to the internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule)",,,[]
1597,f118890b-2468-42b1-9ce9-af35146b425b,MySQL Server Public Access Enabled,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/mysql_server_public_access_enabled,Unknown,"MySQL Server public access should be disabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled)",,,[]
1598,f5342045-b935-402d-adf1-8dbbd09c0eef,AKS Network Policy Misconfigured,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/aks_network_policy_misconfigured,Unknown,"Azure Kubernetes Service should have the proper network policy configuration to ensure the principle of least privileges, which means that 'network_profile.network_policy' should be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/kubernetes_cluster)",,,[]
1599,f7e296b0-6660-4bc5-8f87-22ac4a815edf,SQL Server Auditing Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/sql_server_auditing_disabled,Unknown,"Make sure that for SQL Servers, 'Auditing' is set to 'On'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_server)",,,[]
1600,f8e08a38-fc6e-4915-abbe-a7aadf1d59ef,Key Vault Secrets Content Type Undefined,Terraform,Medium,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/key_vault_secrets_content_type_undefined,Unknown,"Key Vault Secrets should have set Content Type<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type)",,,[]
1601,fd8da341-6760-4450-b26c-9f6d8850575e,Redis Entirely Accessible,Terraform,Critical,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/redis_entirely_accessible,Unknown,"Firewall rule allowing unrestricted access to Redis from the Internet<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_firewall_rule)",,,[]
1602,ffb02aca-0d12-475e-b77c-a726f7aeff4b,Log Retention Is Not Set,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/azure/log_retention_is_not_set,Unknown,"Make sure that for PostgreSQL Database, server parameter 'log_retention' is set to 'ON'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration)",,,[]
1603,02474449-71aa-40a1-87ae-e14497747b00,SQL DB Instance With SSL Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/sql_db_instance_with_ssl_disabled,Unknown,"Cloud SQL Database Instance should have SSL enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#require_ssl)",,,[]
1604,11e7550e-c4b6-472e-adff-c698f157cdd7,Network Policy Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/network_policy_disabled,Unknown,"Kubernetes Engine Clusters must have Network Policy enabled, meaning that the attribute 'network_policy.enabled' must be true and the attribute 'addons_config.network_policy_config.disabled' must be false <br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1605,128df7ec-f185-48bc-8913-ce756a3ccb85,Outdated GKE Version,Terraform,Low,Best Practices,https://cwe.mitre.org/data/definitions/1395.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/outdated_gke_version,Unknown,"Running outdated versions of Google Kubernetes Engine (GKE) can expose it to known vulnerabilities and attacks. To reduce these risks, it is recommended to ensure that GKE is always running the latest version.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#master_version)",,,[]
1606,14a457f0-473d-4d1d-9e37-6d99b355b336,Google Compute SSL Policy Weak Cipher In Use,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_ssl_policy_weak_cipher_in_use,Unknown,"This query confirms if Google Compute SSL Policy Weak Chyper Suits is Enabled, to do so we need to check if TLS is TLS_1_2, because other version have Weak Chypers<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_ssl_policy)",,,[]
1607,16cc87d1-dd47-4f46-b3ce-4dfcac8fd2f5,KMS Crypto Key is Publicly Accessible,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/kms_crypto_key_publicly_accessible,Unknown,"KMS Crypto Key should not be publicly accessible. In other words, the KMS Crypto Key policy should not set 'allUsers' or 'allAuthenticatedUsers' in the attribute 'member'/'members'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_kms_crypto_key_iam#google_kms_crypto_key_iam_policy)",,,[]
1608,1b44e234-3d73-41a8-9954-0b154135280e,Shielded VM Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/shielded_vm_disabled,Unknown,"Compute instances must be launched with Shielded VM enabled, which means the attribute 'shielded_instance_config' must be defined and its sub attributes 'enable_secure_boot', 'enable_vtpm' and 'enable_integrity_monitoring' must be set to true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#shielded_instance_config)",,,[]
1609,1c8eef02-17b1-4a3e-b01d-dcc3292d2c38,GKE Using Default Service Account,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/gke_using_default_service_account,Unknown,"Kubernetes Engine Clusters should not be configured to use the default service account<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#node_config)",,,[]
1610,22ef1d26-80f8-4a6c-8c15-f35aab3cac78,Google Compute Network Using Firewall Rule that Allows All Ports,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_network_using_firewall_rule_allows_all_ports,Unknown,"Google Compute Network should not use a firewall rule that allows all ports<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow)",,,[]
1611,2f06d22c-56bd-4f73-8a51-db001fcf2150,BOM - GCP SB,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/sb,Unknown,"A list of Storage Bucket resources found. Buckets are the basic containers that hold your data. Everything that you store in Cloud Storage must be contained in a bucket.<br>
[Documentation](https://kics.io)",,,[]
1612,30e8dfd2-3591-4d19-8d11-79e93106c93d,Stackdriver Monitoring Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/stackdriver_monitoring_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Monitoring enabled, which means the attribute 'monitoring_service' must be defined and different than 'none'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#monitoring_service)",,,[]
1613,32ecd6eb-0711-421f-9627-1a28d9eff217,OSLogin Disabled,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/os_login_disabled,Unknown,"Verifies that the OSLogin is enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_project_metadata#metadata)",,,[]
1614,3cb4af0b-056d-4fb1-8b95-fdc4593625ff,Using Default Service Account,Terraform,Medium,Insecure Defaults,https://cwe.mitre.org/data/definitions/250.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/using_default_service_account,Unknown,"Instances should not be configured to use the Default Service Account, that has full access to all Cloud APIs, which means the attribute 'service_account' and its sub attribute 'email' must be defined. Additionally, 'email' must not be empty and must also not be a default Google Compute Engine service account.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance)",,,[]
1615,3e4d5ce6-3280-4027-8010-c26eeea1ec01,Project-wide SSH Keys Are Enabled In VM Instances,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/project_wide_ssh_keys_are_enabled_in_vm_instances,Unknown,"VM Instance should block project-wide SSH keys<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance)",,,[]
1616,40430747-442d-450a-a34f-dc57149f4609,Google Compute Subnetwork Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/788.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_subnetwork_logging_disabled,Unknown,"This query checks if logs are enabled for a Google Compute Subnetwork resource.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork)",,,[]
1617,40abce54-95b1-478c-8e5f-ea0bf0bb0e33,Google Compute Network Using Default Firewall Rule,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_network_using_default_firewall_rule,Unknown,"Google Compute Network should not use default firewall rule<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#name)",,,[]
1618,4b82202a-b18e-4891-a1eb-a0989850bbb3,BOM - GCP PST,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/pst,Unknown,"A list of Pub/Sub Topic resources found. Cloud Pub/Sub is designed to provide reliable, many-to-many, asynchronous messaging between applications. Publisher applications can send messages to a 'topic' and other applications can subscribe to that topic to receive the messages.<br>
[Documentation](https://kics.io)",,,[]
1619,4c7ebcb2-eae2-461e-bc83-456ee2d4f694,Stackdriver Logging Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/stackdriver_logging_disabled,Unknown,"Kubernetes Engine Clusters must have Stackdriver Logging enabled, which means the attribute 'logging_service' must be defined and different from 'none'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service)",,,[]
1620,579a0727-9c29-4d58-8195-fc5802a8bdb4,Shielded GKE Nodes Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/shielded_gke_nodes_disabled,Unknown,"GKE cluster nodes must be launched with Shielded VM enabled, which means the attribute 'enable_shielded_nodes' must be set to 'true'.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_shielded_nodes)",,,[]
1621,59571246-3f62-4965-a96f-c7d97e269351,Google Project Auto Create Network Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_project_auto_create_network_disabled,Unknown,"Verifies if the Google Project Auto Create Network is Disabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project)",,,[]
1622,5baa92d2-d8ee-4c75-88a4-52d9d8bb8067,GKE Legacy Authorization Enabled,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/gke_legacy_authorization_enabled,Unknown,"Kubernetes Engine Clusters must have Legacy Authorization set to disabled, which means the attribute 'enable_legacy_abac' must not be true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1623,5ef61c88-bbb4-4725-b1df-55d23c9676bb,Cloud DNS Without DNSSEC,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/350.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cloud_dns_without_dnssec,Unknown,"DNSSEC must be enabled for Cloud DNS<br>
[Documentation](https://www.terraform.io/docs/providers/google/d/dns_managed_zone.html)",,,[]
1624,617ef6ff-711e-4bd7-94ae-e965911b1b40,Google Project IAM Binding Service Account has Token Creator or Account User Role,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_project_iam_binding_service_account_has_token_creator_or_account_user_role,Unknown,"Verifies if Google Project IAM Binding Service Account doesn't have an Account User or Token Creator Role associated<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_binding)",,,[]
1625,65c1bc7a-4835-4ac4-a2b6-13d310b0648d,Cluster Labels Disabled,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cluster_labels_disabled,Unknown,"Kubernetes Clusters must be configured with labels, which means the attribute 'resource_labels' must be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1626,678fd659-96f2-454a-a2a0-c2571f83a4a3,RDP Access Is Not Restricted,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/rdp_access_is_not_restricted,Unknown,"Check if the Google compute firewall allows unrestricted RDP access. Allowed ports should not contain RDP port 3389<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall)",,,[]
1627,6ccb85d7-0420-4907-9380-50313f80946b,Private Cluster Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/private_cluster_disabled,Unknown,"Kubernetes Clusters must be created with Private Clusters enabled, meaning the 'private_cluster_config' must be defined and the attributes 'enable_private_nodes' and 'enable_private_endpoint' must be true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1628,704fcc44-a58f-4af5-82e2-93f2a58ef918,User with IAM Role,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/user_with_iam_role,Unknown,"As a best practice, it is better to assign an IAM Role to a group than to a user<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/iam_policy#role)",,,[]
1629,73fb21a1-b19a-45b1-b648-b47b1678681e,Legacy Client Certificate Auth Enabled,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/299.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/legacy_client_certificate_auth_enabled,Unknown,"Kubernetes Clusters must use the default OAuth authentication, which means 'master_auth' must either be undefined or have 'client_certificate_config' with the attribute 'issue_client_certificate' equal to false<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1630,84d36481-fd63-48cb-838e-635c44806ec2,Google Project IAM Member Service Account Has Admin Role,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_project_iam_member_service_account_has_admin_role,Unknown,"Verifies that Google Project IAM Member Service Account doesn't have an Admin Role associated<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_member)",,,[]
1631,895ed0d9-6fec-4567-8614-d7a74b599a53,BOM - GCP Dataflow,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/dataflow,Unknown,"A list of Dataflow resources found. Unified stream and batch data processing that's serverless, fast, and cost-effective.<br>
[Documentation](https://kics.io)",,,[]
1632,89fe890f-b480-460c-8b6b-7d8b1468adb4,IAM Audit Not Properly Configured,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/iam_audit_not_properly_configured,Unknown,"Audit Logging Configuration is defective<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_audit_config)",,,[]
1633,8a893e46-e267-485a-8690-51f39951de58,COS Node Image Not Used,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cos_node_image_not_used,Unknown,"The node image should be Container-Optimized OS(COS)<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#node_config)",,,[]
1634,9192e0f9-eca5-4056-9282-ae2a736a4088,Pod Security Policy Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/pod_security_policy_disabled,Unknown,"Kubernetes Clusters must have Pod Security Policy controller enabled, which means there must be a 'pod_security_policy_config' with the 'enabled' attribute equal to true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1635,92e4464a-4139-4d57-8742-b5acc0347680,KMS Admin and CryptoKey Roles In Use,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/266.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/kms_admin_and_crypto_key_roles_in_use,Unknown,"Google Project IAM Policy should not assign a KMS admin role and CryptoKey role to the same member<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#policy_data)",,,[]
1636,9356962e-4a4f-4d06-ac59-dc8008775eaa,Not Proper Email Account In Use,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/not_proper_email_account_in_use,Unknown,"Gmail accounts are being used instead of corporate credentials<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_binding)",,,[]
1637,97fa667a-d05b-4f16-9071-58b939f34751,Serial Ports Are Enabled For VM Instances,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/vm_serial_ports_are_enabled_for_vm_instances,Unknown,"Google Compute Engine VM instances should not enable serial ports. When enabled, anyone can access your VM, if they know the username, project ID, SSH key, instance name and zone<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance)",,,[]
1638,a6cd52a1-3056-4910-96a5-894de9f3f3b3,Cloud Storage Anonymous or Publicly Accessible,Terraform,Critical,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cloud_storage_anonymous_or_publicly_accessible,Unknown,"Cloud Storage Buckets must not be anonymously or publicly accessible, which means the attribute 'members' must not possess 'allUsers' or 'allAuthenticatedUsers'<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#google_storage_bucket_iam_binding)",,,[]
1639,acfdbec6-4a17-471f-b412-169d77553332,Google Container Node Pool Auto Repair Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/693.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_container_node_pool_auto_repair_disabled,Unknown,"Google Container Node Pool Auto Repair should be enabled. This service periodically checks for failing nodes and repairs them to ensure a smooth running state.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool)",,,[]
1640,b139213e-7d24-49c2-8025-c18faa21ecaa,Node Auto Upgrade Disabled,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/node_auto_upgrade_disabled,Unknown,"Kubernetes nodes must have auto upgrades set to true, which means Node 'auto_upgrade' should be enabled for Kubernetes Clusters<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade)",,,[]
1641,b187edca-b81e-4fdc-aff4-aab57db45edb,SQL DB Instance Publicly Accessible,Terraform,Critical,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/sql_db_instance_is_publicly_accessible,Unknown,"Cloud SQL instances should not be publicly accessible.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance)",,,[]
1642,b1d51728-7270-4991-ac2f-fc26e2695b38,Disk Encryption Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/disk_encryption_disabled,Unknown,"VM disks for critical VMs must be encrypted with Customer Supplied Encryption Keys (CSEK) or with Customer-managed encryption keys (CMEK), which means the attribute 'disk_encryption_key' must be defined and its sub attributes 'raw_key' or 'kms_key_self_link' must also be defined<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk)",,,[]
1643,bb0db090-5509-4853-a827-75ced0b3caa0,Google Storage Bucket Level Access Disabled,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_storage_bucket_level_access_disabled,Unknown,"Google Storage Bucket Level Access should be enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket)",,,[]
1644,bc280331-27b9-4acb-a010-018e8098aa5d,VM With Full Cloud Access,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/vm_with_full_cloud_access,Unknown,"A VM instance is configured to use the default service account with full access to all Cloud APIs<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#scopes)",,,[]
1645,bc75ce52-a60a-4660-b533-bce837a5019b,BOM - GCP Redis,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/redis,Unknown,"A list of Redis Instance resources found. Memorystore for Redis is a fully managed Redis service for Google Cloud. Applications running on Google Cloud can achieve extreme performance by leveraging the highly scalable, available, secure Redis service without the burden of managing complex Redis deployments.<br>
[Documentation](https://kics.io)",,,[]
1646,c010082c-76e0-4b91-91d9-6e8439e455dd,Cloud Storage Bucket Is Publicly Accessible,Terraform,Medium,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cloud_storage_bucket_is_publicly_accessible,Unknown,"Cloud Storage Bucket is anonymously or publicly accessible<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#member/members)",,,[]
1647,c4dcdcdf-10dd-4bf4-b4a0-8f6239e6aaa0,SSH Access Is Not Restricted,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/ssh_access_is_not_restricted,Unknown,"Google Firewall should not allow SSH access (port 22) from the Internet (public CIDR block) to ensure the principle of least privileges<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall)",,,[]
1648,c606ba1d-d736-43eb-ac24-e16108f3a9e0,IP Aliasing Disabled,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/ip_aliasing_disabled,Unknown,"Kubernetes Clusters must be created with Alias IP ranges enabled, which means the attribut 'ip_allocation_policy' must be defined and, if defined, the attribute 'networking_mode' must be VPC_NATIVE <br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster)",,,[]
1649,c68b4e6d-4e01-4ca1-b256-1e18e875785c,Google Project IAM Member Service Account has Token Creator or Account User Role,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_project_iam_member_service_account_has_token_creator_or_account_user_role,Unknown,"Verifies if Google Poject IAM Member Service Account doesn't have a Account User or Token Creator associated<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_member)",,,[]
1650,c9d81239-c818-4869-9917-1570c62b81fd,BOM - GCP FI,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/fi,Unknown,"A list of Filestore Instance resources found. Filestore instances are fully managed file servers on Google Cloud that can be connected to Compute Engine VMs, GKE clusters, and your on-premises machines. Once provisioned, you can scale the capacity of your instances according to need without any downtime.<br>
[Documentation](https://kics.io)",,,[]
1651,ccc3100c-0fdd-4a5e-9908-c10107291860,DNSSEC Using RSASHA1,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/dnssec_using_rsasha1,Unknown,"DNSSEC should not use the RSASHA1 algorithm, which means if, within the 'dnssec_config' block, the 'default_key_specs' block exists with the 'algorithm' field is 'rsasha1' which is bad.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#algorithm)",,,[]
1652,cefdad16-0dd5-4ac5-8ed2-a37502c78672,Service Account with Improper Privileges,Terraform,Medium,Resource Management,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/service_account_with_improper_privileges,Unknown,"Service account should not have improper privileges like admin, editor, owner, or write roles<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/iam_policy#role)",,,[]
1653,cf3c7631-cd1e-42f3-8801-a561214a6e79,SQL DB Instance Backup Disabled,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/799.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/sql_db_instance_backup_disabled,Unknown,"Checks if backup configuration is enabled for all Cloud SQL Database instances<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance)",,,[]
1654,d0b4d550-c001-46c3-bbdb-d5d75d33f05f,OSLogin Is Disabled For VM Instance,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/os_login_is_disabled_for_vm_instance,Unknown,"Check if any VM instance disables OSLogin<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance)",,,[]
1655,d6cabc3a-d57e-48c2-b341-bf3dd4f4a120,Cloud Storage Bucket Logging Not Enabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cloud_storage_bucket_logging_not_enabled,Unknown,"Cloud storage bucket should have logging enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#log_bucket)",,,[]
1656,d8c57c4e-bf6f-4e32-a2bf-8643532de77b,High Google KMS Crypto Key Rotation Period,Terraform,Medium,Secret Management,https://cwe.mitre.org/data/definitions/326.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/high_google_kms_crypto_key_rotation_period,Unknown,"KMS encryption keys should be rotated every 90 days or less. A short lifetime of encryption keys reduces the potential blast radius in case of compromise.<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/kms_crypto_key)",,,[]
1657,dd7d70aa-a6ec-460d-b5d2-38b40253b16f,BOM - GCP PD,Terraform,Trace,Bill Of Materials,https://cwe.mitre.org/data/definitions/532.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp_bom/pd,Unknown,"A list of Persistent Disk resources found. Persistent Disk is Google's local durable storage service, fully integrated with Google Cloud products, Compute Engine and Google Kubernetes Engine.<br>
[Documentation](https://kics.io)",,,[]
1658,e576ce44-dd03-4022-a8c0-3906acca2ab4,BigQuery Dataset Is Public,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/bigquery_dataset_is_public,Unknown,"BigQuery dataset is anonymously or publicly accessible<br>
[Documentation](https://www.terraform.io/docs/providers/google/r/bigquery_dataset.html)",,,[]
1659,e6f61c37-106b-449f-a5bb-81bfcaceb8b4,Google Compute Network Using Firewall Rule that Allows Port Range,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_network_using_firewall_rule_allows_port_range,Unknown,"Google Compute Network should not use a firewall rule that allows port range<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow)",,,[]
1660,e7e961ac-d17e-4413-84bc-8a1fbe242944,Cloud Storage Bucket Versioning Disabled,Terraform,Medium,Observability,https://cwe.mitre.org/data/definitions/710.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/cloud_storage_bucket_versioning_disabled,Unknown,"Cloud Storage Bucket should have versioning enabled<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#enabled)",,,[]
1661,ee7b93c1-b3f8-4a3b-9588-146d481814f5,Google Compute Subnetwork with Private Google Access Disabled,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/google_compute_subnetwork_with_private_google_access_disabled,Unknown,"Google Compute Subnetwork should have Private Google Access enabled, which means 'private_ip_google_access' should be set to true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#private_ip_google_access)",,,[]
1662,f34c0c25-47b4-41eb-9c79-249b4dd47b89,IP Forwarding Enabled,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/1188.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/gcp/ip_forwarding_enabled,Unknown,"Instances must not have IP forwarding enabled, which means the attribute 'can_ip_forward' must not be true<br>
[Documentation](https://registry.terraform.io/providers/hashicorp/google/latest/docs/data-sources/compute_instance)",,,[]
1663,30c2760c-740e-4672-9d7f-2c29e0cb385d,Nifcloud Router Has Common Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/router_has_common_private,Unknown,"The Router has common private network<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/router#network_id)",,,[]
1664,41c127a9-3a85-4bc3-a333-ed374eb9c3e4,Nifcloud Computing Undefined Description To Security Group,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/computing_security_group_description_undefined,Unknown,"It's considered a best practice for Security Group to have a description<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/security_group#description)",,,[]
1665,4b801c38-ebb4-4c81-984b-1ba525d43adf,Nifcloud NAS Has Common Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/nas_instance_has_common_private,Unknown,"The NAS has common private network<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/nas_instance#network_id)",,,[]
1666,5061f84c-ab66-4660-90b9-680c9df346c0,Nifcloud ELB Has Common Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/elb_has_common_private,Unknown,"The ELB has common private network<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/elb#network_id)",,,[]
1667,675e8eaa-2754-42b7-bf33-bfa295d1601d,Nifcloud LB Using Insecure TLS Policy Name,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/load_balancer_use_insecure_tls_policy_name,Unknown,"The LB using insecure TLS policy<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/load_balancer#ssl_policy_name)",,,[]
1668,89218b48-75c9-4cb3-aaba-5299e852e8bc,Nifcloud Computing Undefined Security Group To Instance,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/computing_instance_security_group_undefined,Unknown,"Missing security group for instance<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/instance#security_group)",,,[]
1669,8d7758a7-d9cd-499a-a83e-c9bdcbff728d,Nifcloud NAS Has Public Ingress NAS Security Group Rule,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/nas_security_group_has_public_ingress_sgr,Unknown,"An ingress NAS security group rule allows traffic from /0<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/nas_security_group#cidr_ip)",,,[]
1670,940ddce2-26bd-4e31-a9b4-382714f73231,Nifcloud RDB Undefined Description To DB Security Group,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/db_security_group_description_undefined,Unknown,"Missing description for DB security group<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/db_security_group#description)",,,[]
1671,944439c7-b4b8-476a-8f83-14641ea876ba,Nifcloud LB Using Insecure TLS Policy ID,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/295.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/load_balancer_use_insecure_tls_policy_id,Unknown,"The LB using insecure TLS policy<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/load_balancer#ssl_policy_id)",,,[]
1672,94e47f3f-b90b-43a1-a36d-521580bae863,Nifcloud LB Using HTTP Port,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/load_balancer_use_http,Unknown,"The LB using HTTP port<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/load_balancer#load_balancer_port)",,,[]
1673,9bf57c23-fbab-4222-85f3-3f207a53c6a8,Nifcloud RDB Has Common Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/db_instance_has_common_private,Unknown,"The RDB has common private network<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/db_instance#network_id)",,,[]
1674,9f751a80-31f0-43a3-926c-20772791a038,Nifcloud LB Listener Using HTTP Port,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/load_balancer_listener_use_http,Unknown,"The LB listener using HTTP port<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/load_balancer_listener#load_balancer_port)",,,[]
1675,a0b846e8-815f-4f15-b660-bc4ab9fa1e1a,Nifcloud RDB Has Public DB Ingress Security Group Rule,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/db_security_group_has_public_ingress_sgr,Unknown,"A DB ingress security group rule allows traffic from /0<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/db_security_group#cidr_ip)",,,[]
1676,a1defcb6-55e8-4511-8c2a-30b615b0e057,Nifcloud DNS Has Verified Record,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/dns_has_verified_record,Unknown,"Removing verified record of TXT auth the risk that If the authentication record remains, anyone can register the zone<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/dns_record#record)",,,[]
1677,afcb0771-4f94-44ed-ad4a-9f73f11ce6e0,Nifcloud ELB Listener Using HTTP Protocol,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/elb_listener_use_http,Unknown,"The ELB listener using http protocol<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/elb_listener#protocol)",,,[]
1678,b2ea2367-8dc9-4231-a035-d0b28bfa3dde,Nifcloud Computing Has Public Ingress Security Group Rule,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/computing_instance_has_public_ingress_sgr,Unknown,"An ingress security group rule allows traffic from /0<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/security_group_rule#cidr_ip)",,,[]
1679,b3535a48-910c-47f8-8b3b-14222f29ef80,Nifcloud VPN Gateway Undefined Security Group,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/vpn_gateway_security_group_undefined,Unknown,"Missing security group for VPN gateway<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/vpn_gateway#security_group)",,,[]
1680,df58dd45-8009-43c2-90f7-c90eb9d53ed9,Nifcloud Computing Has Common Private Network,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/computing_instance_has_common_private,Unknown,"The instance has common private network<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/instance#network_id)",,,[]
1681,e2de2b80-2fc2-4502-a764-40930dfcc70a,Nifcloud ELB Using HTTP Protocol,Terraform,Medium,Networking and Firewall,https://cwe.mitre.org/data/definitions/319.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/elb_use_http,Unknown,"The ELB using HTTP protocol<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/elb#protocol)",,,[]
1682,e4610872-0b1c-4fb7-ab57-d81c0afdb291,Nifcloud Computing Undefined Description To Security Group Rule,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/computing_security_group_rule_description_undefined,Unknown,"It's considered a best practice for Security Group Rules to have a description<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/security_group_rule#description)",,,[]
1683,e5071f76-cbe7-468d-bb2b-d10f02d2b713,Nifcloud Low RDB Backup Retention Period,Terraform,Low,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/db_does_not_have_long_backup_retention,Unknown,"Nifcloud RDB backup retention should be at least 7 days<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/db_instance#backup_retention_period)",,,[]
1684,e7dada38-af20-4899-8955-dabea84ab1f0,Nifcloud Router Undefined Security Group,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/router_security_group_undefined,Unknown,"Missing security group for Router<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/router#security_group)",,,[]
1685,e840c54a-7a4c-405f-b8c1-c49a54b87d11,Nifcloud NAS Undefined Description To NAS Security Group,Terraform,Info,Best Practices,https://cwe.mitre.org/data/definitions/665.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/nas_security_group_description_undefined,Unknown,"It's considered a best practice for NAS Security Group to have a description<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/nas_security_group#description)",,,[]
1686,fb387023-e4bb-42a8-9a70-6708aa7ff21b,Nifcloud RDB Has Public DB Access,Terraform,High,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/nifcloud/db_has_public_access,Unknown,"The RDB has public DB access<br>
[Documentation](https://registry.terraform.io/providers/nifcloud/nifcloud/latest/docs/resources/db_instance#publicly_accessible)",,,[]
1687,18d6aa4b-7570-4d95-9c75-90363ef1abd9,Beta - CDB Instance Internet Using Default Intranet Port,Terraform,Low,Insecure Configurations,https://cwe.mitre.org/data/definitions/668.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cdb_instance_using_default_intranet_port,Unknown,"CDB Instance Internet should not use have default intranet port<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/mysql_instance#intranet_port)",,,[]
1688,1ee0f202-31da-49ba-bbce-04a989912e4b,Beta - Disk Encryption Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/disk_encryption_disabled,Unknown,"Disks should have encryption enabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/cbs_storage#encrypt)",,,[]
1689,3ed47402-e322-465f-a0f0-8681135a17b0,Beta - TKE Cluster Encryption Protection Disabled,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/311.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/tke_cluster_encryption_protection_disabled,Unknown,"TKE Cluster should have encryption protection enabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/kubernetes_encryption_protection)",,,[]
1690,5bb6fa08-5e84-4760-a54a-cdcd66626976,Beta - CVM Instance Using User Data,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cvm_instance_using_user_data,Unknown,"CVM instances should use roles to be granted access<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/instance#user_data)",,,[]
1691,5d820574-4a60-4916-b049-0810b8629731,Beta - CDB Instance Internet Service Enabled,Terraform,High,Insecure Configurations,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cdb_instance_internet_service_enabled,Unknown,"CDB Instance Internet should have internet service disabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/mysql_instance#internet_service)",,,[]
1692,93bb2065-63ec-45a2-a466-f106b56f2e32,Beta - CVM Instance Using Default Security Group,Terraform,Low,Access Control,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cvm_instance_using_default_security_group,Unknown,"CVM instances should not use default security group(s)<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/instance#orderly_security_groups)",,,[]
1693,966ed4f7-b8a5-4e8d-b2bf-098657c98960,Beta - CVM Instance Disable Monitor Service,Terraform,Info,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cvm_instance_disable_monitor_service,Unknown,"CVM Instance should have detailed monitor service enabled.<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/instance#disable_monitor_service)",,,[]
1694,a3240001-40db-47b7-abb9-2bcd6a04c430,Beta - VPC Flow Logs Disabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/vpc_flow_log_disabled,Unknown,"VPC resources should have Flow Log enabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/vpc_flow_log_config#enable)",,,[]
1695,a74b4602-a62c-4a02-956a-e19f86ea24b5,Beta - CVM Instance Has Public IP,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cvm_instance_has_public_ip,Unknown,"CVM Instance should not have a public IP address.<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/instance#allocate_public_ip)",,,[]
1696,ada01ed1-b10c-4f2a-b110-b20fa4f9baa6,Beta - CLB Instance Log Setting Disabled,Terraform,Medium,Encryption,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/clb_instance_log_setting_disabled,Unknown,"CLB Instance should set log enabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/clb_instance#log_set_id)",,,[]
1697,b4e75c5c-83d5-4568-90e3-57ed5ec4051b,Beta - CVM Instance Using Default VPC,Terraform,Low,Networking and Firewall,https://cwe.mitre.org/data/definitions/200.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cvm_instance_using_default_vpc,Unknown,"CVM Instances should not be configured under a default VPC network<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/instance#vpc_id)",,,[]
1698,ca94be07-7de3-4ae7-85ef-67e0462ec694,Beta - CDB Instance Without Backup Policy,Terraform,Medium,Backup,https://cwe.mitre.org/data/definitions/754.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/cdb_instance_without_backup_policy,Unknown,"CDB Instance should have set Backup Policy<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/mysql_backup_policy)",,,[]
1699,d135a36e-c474-452f-b891-76db1e6d1cd5,Beta - Security Group Rule Set Accepts All Traffic,Terraform,High,Networking and Firewall,https://cwe.mitre.org/data/definitions/285.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/security_group_rule_set_accepts_all_traffic,Unknown,"Security Group Rule Set accepts all traffic<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/security_group_rule_set#ingress)",,,[]
1700,df6928ed-02f4-421f-9a67-a529860dd7e7,Beta - TKE Cluster Has Public Access,Terraform,Medium,Insecure Configurations,https://cwe.mitre.org/data/definitions/732.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/tke_cluster_has_public_access,Unknown,"TKE Cluster 'public_ip_assigned' should be set to false<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/kubernetes_cluster#public_ip_assigned)",,,[]
1701,fe08b81c-12e9-4b5e-9006-4218fca750fd,Beta - CLB Listener Using Insecure Protocols,Terraform,High,Encryption,https://cwe.mitre.org/data/definitions/284.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/clb_listener_using_insecure_protocols,Unknown,"CLB Listener protocol must not use insecure protocols<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/clb_listener#protocol)",,,[]
1702,fe405074-7e18-40f9-9aef-024aa1d0a889,Beta - TKE Cluster Log Agent Is Not Enabled,Terraform,Low,Observability,https://cwe.mitre.org/data/definitions/778.html,https://github.com/Checkmarx/kics/tree/master/assets/queries/terraform/tencentcloud/tke_cluster_log_disabled,Unknown,"TKE cluster log agent should be enabled<br>
[Documentation](https://registry.terraform.io/providers/tencentcloudstack/tencentcloud/latest/docs/resources/kubernetes_cluster#log_agent)",,,[]
