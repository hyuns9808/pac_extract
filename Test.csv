,Query Name,Query ID,Platform,Severity,Category,CWE,CWE Link,Repo URL,Repo Link,Description,Insecure Example,Secure Example
0,ECR Repository Is Publicly Accessible,fb5a5df7-6d74-4243-ab82-ff779a958bfd,Ansible,Critical,Access Control,668,https://cwe.mitre.org/data/definitions/668.html,Github,https://github.com/Checkmarx/kics/tree/master/assets/queries/ansible/aws/ecr_repository_is_publicly_accessible,Amazon ECR image repositories shouldn't have public access Documentation,"# ---- Code Sample 1 ---- -- Positive test num. 1 - yaml file
- name: set-policy as object
  community.aws.ecs_ecr:
    name: needs-policy-object
    policy:
      Version: '2008-10-17'
      Statement:
        - Sid: read-only
          Effect: Allow
          Principal: '*'
          Action:
            - ecr:GetDownloadUrlForLayer
            - ecr:BatchGetImage
            - ecr:BatchCheckLayerAvailability
- name: set-policy as string
  community.aws.ecs_ecr:
    name: needs-policy-string
    policy: >
        {
          ""Id"": ""id113"",
          ""Version"": ""2012-10-17"",
          ""Statement"": [
            {
              ""Action"": [
                ""s3:put""
              ],
              ""Effect"": ""Allow"",
              ""Resource"": ""arn:aws:s3:::S3B_181355/*"",
              ""Principal"": ""*""
            }
          ]
        }","# ---- Code Sample 1 ---- -- Negative test num. 1 - yaml file
- name: set-policy as object
  community.aws.ecs_ecr:
    name: needs-policy-object
    policy:
      Version: '2008-10-17'
      Statement:
      - Sid: read-only
        Effect: Allow
        Action:
        - ecr:GetDownloadUrlForLayer
        - ecr:BatchGetImage
        - ecr:BatchCheckLayerAvailability"
